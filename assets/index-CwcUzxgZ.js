(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();var Sy={exports:{}},Wc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wI;function GP(){if(wI)return Wc;wI=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,s,o){var u=null;if(o!==void 0&&(u=""+o),s.key!==void 0&&(u=""+s.key),"key"in s){o={};for(var h in s)h!=="key"&&(o[h]=s[h])}else o=s;return s=o.ref,{$$typeof:n,type:i,key:u,ref:s!==void 0?s:null,props:o}}return Wc.Fragment=e,Wc.jsx=t,Wc.jsxs=t,Wc}var bI;function KP(){return bI||(bI=1,Sy.exports=GP()),Sy.exports}var ae=KP(),Ay={exports:{}},$c={},Ry={exports:{}},Cy={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var II;function YP(){return II||(II=1,function(n){function e(W,ce){var ve=W.length;W.push(ce);e:for(;0<ve;){var We=ve-1>>>1,P=W[We];if(0<s(P,ce))W[We]=ce,W[ve]=P,ve=We;else break e}}function t(W){return W.length===0?null:W[0]}function i(W){if(W.length===0)return null;var ce=W[0],ve=W.pop();if(ve!==ce){W[0]=ve;e:for(var We=0,P=W.length,te=P>>>1;We<te;){var he=2*(We+1)-1,re=W[he],Te=he+1,ke=W[Te];if(0>s(re,ve))Te<P&&0>s(ke,re)?(W[We]=ke,W[Te]=ve,We=Te):(W[We]=re,W[he]=ve,We=he);else if(Te<P&&0>s(ke,ve))W[We]=ke,W[Te]=ve,We=Te;else break e}}return ce}function s(W,ce){var ve=W.sortIndex-ce.sortIndex;return ve!==0?ve:W.id-ce.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var u=Date,h=u.now();n.unstable_now=function(){return u.now()-h}}var f=[],p=[],_=1,v=null,T=3,S=!1,N=!1,x=!1,U=!1,Z=typeof setTimeout=="function"?setTimeout:null,ee=typeof clearTimeout=="function"?clearTimeout:null,Y=typeof setImmediate<"u"?setImmediate:null;function ie(W){for(var ce=t(p);ce!==null;){if(ce.callback===null)i(p);else if(ce.startTime<=W)i(p),ce.sortIndex=ce.expirationTime,e(f,ce);else break;ce=t(p)}}function se(W){if(x=!1,ie(W),!N)if(t(f)!==null)N=!0,me||(me=!0,F());else{var ce=t(p);ce!==null&&St(se,ce.startTime-W)}}var me=!1,O=-1,A=5,C=-1;function M(){return U?!0:!(n.unstable_now()-C<A)}function V(){if(U=!1,me){var W=n.unstable_now();C=W;var ce=!0;try{e:{N=!1,x&&(x=!1,ee(O),O=-1),S=!0;var ve=T;try{t:{for(ie(W),v=t(f);v!==null&&!(v.expirationTime>W&&M());){var We=v.callback;if(typeof We=="function"){v.callback=null,T=v.priorityLevel;var P=We(v.expirationTime<=W);if(W=n.unstable_now(),typeof P=="function"){v.callback=P,ie(W),ce=!0;break t}v===t(f)&&i(f),ie(W)}else i(f);v=t(f)}if(v!==null)ce=!0;else{var te=t(p);te!==null&&St(se,te.startTime-W),ce=!1}}break e}finally{v=null,T=ve,S=!1}ce=void 0}}finally{ce?F():me=!1}}}var F;if(typeof Y=="function")F=function(){Y(V)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,an=D.port2;D.port1.onmessage=V,F=function(){an.postMessage(null)}}else F=function(){Z(V,0)};function St(W,ce){O=Z(function(){W(n.unstable_now())},ce)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(W){W.callback=null},n.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<W?Math.floor(1e3/W):5},n.unstable_getCurrentPriorityLevel=function(){return T},n.unstable_next=function(W){switch(T){case 1:case 2:case 3:var ce=3;break;default:ce=T}var ve=T;T=ce;try{return W()}finally{T=ve}},n.unstable_requestPaint=function(){U=!0},n.unstable_runWithPriority=function(W,ce){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var ve=T;T=W;try{return ce()}finally{T=ve}},n.unstable_scheduleCallback=function(W,ce,ve){var We=n.unstable_now();switch(typeof ve=="object"&&ve!==null?(ve=ve.delay,ve=typeof ve=="number"&&0<ve?We+ve:We):ve=We,W){case 1:var P=-1;break;case 2:P=250;break;case 5:P=1073741823;break;case 4:P=1e4;break;default:P=5e3}return P=ve+P,W={id:_++,callback:ce,priorityLevel:W,startTime:ve,expirationTime:P,sortIndex:-1},ve>We?(W.sortIndex=ve,e(p,W),t(f)===null&&W===t(p)&&(x?(ee(O),O=-1):x=!0,St(se,ve-We))):(W.sortIndex=P,e(f,W),N||S||(N=!0,me||(me=!0,F()))),W},n.unstable_shouldYield=M,n.unstable_wrapCallback=function(W){var ce=T;return function(){var ve=T;T=ce;try{return W.apply(this,arguments)}finally{T=ve}}}}(Cy)),Cy}var SI;function QP(){return SI||(SI=1,Ry.exports=YP()),Ry.exports}var Dy={exports:{}},Ne={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AI;function WP(){if(AI)return Ne;AI=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),u=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),v=Symbol.iterator;function T(P){return P===null||typeof P!="object"?null:(P=v&&P[v]||P["@@iterator"],typeof P=="function"?P:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N=Object.assign,x={};function U(P,te,he){this.props=P,this.context=te,this.refs=x,this.updater=he||S}U.prototype.isReactComponent={},U.prototype.setState=function(P,te){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,te,"setState")},U.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function Z(){}Z.prototype=U.prototype;function ee(P,te,he){this.props=P,this.context=te,this.refs=x,this.updater=he||S}var Y=ee.prototype=new Z;Y.constructor=ee,N(Y,U.prototype),Y.isPureReactComponent=!0;var ie=Array.isArray,se={H:null,A:null,T:null,S:null,V:null},me=Object.prototype.hasOwnProperty;function O(P,te,he,re,Te,ke){return he=ke.ref,{$$typeof:n,type:P,key:te,ref:he!==void 0?he:null,props:ke}}function A(P,te){return O(P.type,te,void 0,void 0,void 0,P.props)}function C(P){return typeof P=="object"&&P!==null&&P.$$typeof===n}function M(P){var te={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(he){return te[he]})}var V=/\/+/g;function F(P,te){return typeof P=="object"&&P!==null&&P.key!=null?M(""+P.key):te.toString(36)}function D(){}function an(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then(D,D):(P.status="pending",P.then(function(te){P.status==="pending"&&(P.status="fulfilled",P.value=te)},function(te){P.status==="pending"&&(P.status="rejected",P.reason=te)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function St(P,te,he,re,Te){var ke=typeof P;(ke==="undefined"||ke==="boolean")&&(P=null);var Ce=!1;if(P===null)Ce=!0;else switch(ke){case"bigint":case"string":case"number":Ce=!0;break;case"object":switch(P.$$typeof){case n:case e:Ce=!0;break;case _:return Ce=P._init,St(Ce(P._payload),te,he,re,Te)}}if(Ce)return Te=Te(P),Ce=re===""?"."+F(P,0):re,ie(Te)?(he="",Ce!=null&&(he=Ce.replace(V,"$&/")+"/"),St(Te,te,he,"",function(Ui){return Ui})):Te!=null&&(C(Te)&&(Te=A(Te,he+(Te.key==null||P&&P.key===Te.key?"":(""+Te.key).replace(V,"$&/")+"/")+Ce)),te.push(Te)),1;Ce=0;var Xt=re===""?".":re+":";if(ie(P))for(var dt=0;dt<P.length;dt++)re=P[dt],ke=Xt+F(re,dt),Ce+=St(re,te,he,ke,Te);else if(dt=T(P),typeof dt=="function")for(P=dt.call(P),dt=0;!(re=P.next()).done;)re=re.value,ke=Xt+F(re,dt++),Ce+=St(re,te,he,ke,Te);else if(ke==="object"){if(typeof P.then=="function")return St(an(P),te,he,re,Te);throw te=String(P),Error("Objects are not valid as a React child (found: "+(te==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":te)+"). If you meant to render a collection of children, use an array instead.")}return Ce}function W(P,te,he){if(P==null)return P;var re=[],Te=0;return St(P,re,"","",function(ke){return te.call(he,ke,Te++)}),re}function ce(P){if(P._status===-1){var te=P._result;te=te(),te.then(function(he){(P._status===0||P._status===-1)&&(P._status=1,P._result=he)},function(he){(P._status===0||P._status===-1)&&(P._status=2,P._result=he)}),P._status===-1&&(P._status=0,P._result=te)}if(P._status===1)return P._result.default;throw P._result}var ve=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var te=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent(te))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)};function We(){}return Ne.Children={map:W,forEach:function(P,te,he){W(P,function(){te.apply(this,arguments)},he)},count:function(P){var te=0;return W(P,function(){te++}),te},toArray:function(P){return W(P,function(te){return te})||[]},only:function(P){if(!C(P))throw Error("React.Children.only expected to receive a single React element child.");return P}},Ne.Component=U,Ne.Fragment=t,Ne.Profiler=s,Ne.PureComponent=ee,Ne.StrictMode=i,Ne.Suspense=f,Ne.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=se,Ne.__COMPILER_RUNTIME={__proto__:null,c:function(P){return se.H.useMemoCache(P)}},Ne.cache=function(P){return function(){return P.apply(null,arguments)}},Ne.cloneElement=function(P,te,he){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var re=N({},P.props),Te=P.key,ke=void 0;if(te!=null)for(Ce in te.ref!==void 0&&(ke=void 0),te.key!==void 0&&(Te=""+te.key),te)!me.call(te,Ce)||Ce==="key"||Ce==="__self"||Ce==="__source"||Ce==="ref"&&te.ref===void 0||(re[Ce]=te[Ce]);var Ce=arguments.length-2;if(Ce===1)re.children=he;else if(1<Ce){for(var Xt=Array(Ce),dt=0;dt<Ce;dt++)Xt[dt]=arguments[dt+2];re.children=Xt}return O(P.type,Te,void 0,void 0,ke,re)},Ne.createContext=function(P){return P={$$typeof:u,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:o,_context:P},P},Ne.createElement=function(P,te,he){var re,Te={},ke=null;if(te!=null)for(re in te.key!==void 0&&(ke=""+te.key),te)me.call(te,re)&&re!=="key"&&re!=="__self"&&re!=="__source"&&(Te[re]=te[re]);var Ce=arguments.length-2;if(Ce===1)Te.children=he;else if(1<Ce){for(var Xt=Array(Ce),dt=0;dt<Ce;dt++)Xt[dt]=arguments[dt+2];Te.children=Xt}if(P&&P.defaultProps)for(re in Ce=P.defaultProps,Ce)Te[re]===void 0&&(Te[re]=Ce[re]);return O(P,ke,void 0,void 0,null,Te)},Ne.createRef=function(){return{current:null}},Ne.forwardRef=function(P){return{$$typeof:h,render:P}},Ne.isValidElement=C,Ne.lazy=function(P){return{$$typeof:_,_payload:{_status:-1,_result:P},_init:ce}},Ne.memo=function(P,te){return{$$typeof:p,type:P,compare:te===void 0?null:te}},Ne.startTransition=function(P){var te=se.T,he={};se.T=he;try{var re=P(),Te=se.S;Te!==null&&Te(he,re),typeof re=="object"&&re!==null&&typeof re.then=="function"&&re.then(We,ve)}catch(ke){ve(ke)}finally{se.T=te}},Ne.unstable_useCacheRefresh=function(){return se.H.useCacheRefresh()},Ne.use=function(P){return se.H.use(P)},Ne.useActionState=function(P,te,he){return se.H.useActionState(P,te,he)},Ne.useCallback=function(P,te){return se.H.useCallback(P,te)},Ne.useContext=function(P){return se.H.useContext(P)},Ne.useDebugValue=function(){},Ne.useDeferredValue=function(P,te){return se.H.useDeferredValue(P,te)},Ne.useEffect=function(P,te,he){var re=se.H;if(typeof he=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return re.useEffect(P,te)},Ne.useId=function(){return se.H.useId()},Ne.useImperativeHandle=function(P,te,he){return se.H.useImperativeHandle(P,te,he)},Ne.useInsertionEffect=function(P,te){return se.H.useInsertionEffect(P,te)},Ne.useLayoutEffect=function(P,te){return se.H.useLayoutEffect(P,te)},Ne.useMemo=function(P,te){return se.H.useMemo(P,te)},Ne.useOptimistic=function(P,te){return se.H.useOptimistic(P,te)},Ne.useReducer=function(P,te,he){return se.H.useReducer(P,te,he)},Ne.useRef=function(P){return se.H.useRef(P)},Ne.useState=function(P){return se.H.useState(P)},Ne.useSyncExternalStore=function(P,te,he){return se.H.useSyncExternalStore(P,te,he)},Ne.useTransition=function(){return se.H.useTransition()},Ne.version="19.1.0",Ne}var RI;function aE(){return RI||(RI=1,Dy.exports=WP()),Dy.exports}var Ny={exports:{}},gn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CI;function $P(){if(CI)return gn;CI=1;var n=aE();function e(f){var p="https://react.dev/errors/"+f;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)p+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+f+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function o(f,p,_){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:v==null?null:""+v,children:f,containerInfo:p,implementation:_}}var u=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(f,p){if(f==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return gn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,gn.createPortal=function(f,p){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return o(f,p,null,_)},gn.flushSync=function(f){var p=u.T,_=i.p;try{if(u.T=null,i.p=2,f)return f()}finally{u.T=p,i.p=_,i.d.f()}},gn.preconnect=function(f,p){typeof f=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,i.d.C(f,p))},gn.prefetchDNS=function(f){typeof f=="string"&&i.d.D(f)},gn.preinit=function(f,p){if(typeof f=="string"&&p&&typeof p.as=="string"){var _=p.as,v=h(_,p.crossOrigin),T=typeof p.integrity=="string"?p.integrity:void 0,S=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;_==="style"?i.d.S(f,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:v,integrity:T,fetchPriority:S}):_==="script"&&i.d.X(f,{crossOrigin:v,integrity:T,fetchPriority:S,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},gn.preinitModule=function(f,p){if(typeof f=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var _=h(p.as,p.crossOrigin);i.d.M(f,{crossOrigin:_,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&i.d.M(f)},gn.preload=function(f,p){if(typeof f=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var _=p.as,v=h(_,p.crossOrigin);i.d.L(f,_,{crossOrigin:v,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},gn.preloadModule=function(f,p){if(typeof f=="string")if(p){var _=h(p.as,p.crossOrigin);i.d.m(f,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:_,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else i.d.m(f)},gn.requestFormReset=function(f){i.d.r(f)},gn.unstable_batchedUpdates=function(f,p){return f(p)},gn.useFormState=function(f,p,_){return u.H.useFormState(f,p,_)},gn.useFormStatus=function(){return u.H.useHostTransitionStatus()},gn.version="19.1.0",gn}var DI;function XP(){if(DI)return Ny.exports;DI=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Ny.exports=$P(),Ny.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NI;function JP(){if(NI)return $c;NI=1;var n=QP(),e=aE(),t=XP();function i(r){var a="https://react.dev/errors/"+r;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)a+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+r+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function o(r){var a=r,l=r;if(r.alternate)for(;a.return;)a=a.return;else{r=a;do a=r,(a.flags&4098)!==0&&(l=a.return),r=a.return;while(r)}return a.tag===3?l:null}function u(r){if(r.tag===13){var a=r.memoizedState;if(a===null&&(r=r.alternate,r!==null&&(a=r.memoizedState)),a!==null)return a.dehydrated}return null}function h(r){if(o(r)!==r)throw Error(i(188))}function f(r){var a=r.alternate;if(!a){if(a=o(r),a===null)throw Error(i(188));return a!==r?null:r}for(var l=r,c=a;;){var m=l.return;if(m===null)break;var g=m.alternate;if(g===null){if(c=m.return,c!==null){l=c;continue}break}if(m.child===g.child){for(g=m.child;g;){if(g===l)return h(m),r;if(g===c)return h(m),a;g=g.sibling}throw Error(i(188))}if(l.return!==c.return)l=m,c=g;else{for(var w=!1,b=m.child;b;){if(b===l){w=!0,l=m,c=g;break}if(b===c){w=!0,c=m,l=g;break}b=b.sibling}if(!w){for(b=g.child;b;){if(b===l){w=!0,l=g,c=m;break}if(b===c){w=!0,c=g,l=m;break}b=b.sibling}if(!w)throw Error(i(189))}}if(l.alternate!==c)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?r:a}function p(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r;for(r=r.child;r!==null;){if(a=p(r),a!==null)return a;r=r.sibling}return null}var _=Object.assign,v=Symbol.for("react.element"),T=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),U=Symbol.for("react.profiler"),Z=Symbol.for("react.provider"),ee=Symbol.for("react.consumer"),Y=Symbol.for("react.context"),ie=Symbol.for("react.forward_ref"),se=Symbol.for("react.suspense"),me=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),C=Symbol.for("react.activity"),M=Symbol.for("react.memo_cache_sentinel"),V=Symbol.iterator;function F(r){return r===null||typeof r!="object"?null:(r=V&&r[V]||r["@@iterator"],typeof r=="function"?r:null)}var D=Symbol.for("react.client.reference");function an(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===D?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case N:return"Fragment";case U:return"Profiler";case x:return"StrictMode";case se:return"Suspense";case me:return"SuspenseList";case C:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case S:return"Portal";case Y:return(r.displayName||"Context")+".Provider";case ee:return(r._context.displayName||"Context")+".Consumer";case ie:var a=r.render;return r=r.displayName,r||(r=a.displayName||a.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case O:return a=r.displayName||null,a!==null?a:an(r.type)||"Memo";case A:a=r._payload,r=r._init;try{return an(r(a))}catch{}}return null}var St=Array.isArray,W=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ce=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ve={pending:!1,data:null,method:null,action:null},We=[],P=-1;function te(r){return{current:r}}function he(r){0>P||(r.current=We[P],We[P]=null,P--)}function re(r,a){P++,We[P]=r.current,r.current=a}var Te=te(null),ke=te(null),Ce=te(null),Xt=te(null);function dt(r,a){switch(re(Ce,a),re(ke,r),re(Te,null),a.nodeType){case 9:case 11:r=(r=a.documentElement)&&(r=r.namespaceURI)?$b(r):0;break;default:if(r=a.tagName,a=a.namespaceURI)a=$b(a),r=Xb(a,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}he(Te),re(Te,r)}function Ui(){he(Te),he(ke),he(Ce)}function ss(r){r.memoizedState!==null&&re(Xt,r);var a=Te.current,l=Xb(a,r.type);a!==l&&(re(ke,r),re(Te,l))}function dr(r){ke.current===r&&(he(Te),he(ke)),Xt.current===r&&(he(Xt),Hc._currentValue=ve)}var ma=Object.prototype.hasOwnProperty,pa=n.unstable_scheduleCallback,ga=n.unstable_cancelCallback,zu=n.unstable_shouldYield,xd=n.unstable_requestPaint,ai=n.unstable_now,Sg=n.unstable_getCurrentPriorityLevel,qu=n.unstable_ImmediatePriority,Uo=n.unstable_UserBlockingPriority,_a=n.unstable_NormalPriority,Ag=n.unstable_LowPriority,Fo=n.unstable_IdlePriority,ju=n.log,Pd=n.unstable_setDisableYieldValue,At=null,Ze=null;function jn(r){if(typeof ju=="function"&&Pd(r),Ze&&typeof Ze.setStrictMode=="function")try{Ze.setStrictMode(At,r)}catch{}}var mn=Math.clz32?Math.clz32:ya,kd=Math.log,Rg=Math.LN2;function ya(r){return r>>>=0,r===0?32:31-(kd(r)/Rg|0)|0}var va=256,Ea=4194304;function Ai(r){var a=r&42;if(a!==0)return a;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Bo(r,a,l){var c=r.pendingLanes;if(c===0)return 0;var m=0,g=r.suspendedLanes,w=r.pingedLanes;r=r.warmLanes;var b=c&134217727;return b!==0?(c=b&~g,c!==0?m=Ai(c):(w&=b,w!==0?m=Ai(w):l||(l=b&~r,l!==0&&(m=Ai(l))))):(b=c&~g,b!==0?m=Ai(b):w!==0?m=Ai(w):l||(l=c&~r,l!==0&&(m=Ai(l)))),m===0?0:a!==0&&a!==m&&(a&g)===0&&(g=m&-m,l=a&-a,g>=l||g===32&&(l&4194048)!==0)?a:m}function Ta(r,a){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&a)===0}function Hu(r,a){switch(r){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Gu(){var r=va;return va<<=1,(va&4194048)===0&&(va=256),r}function Ku(){var r=Ea;return Ea<<=1,(Ea&62914560)===0&&(Ea=4194304),r}function fr(r){for(var a=[],l=0;31>l;l++)a.push(r);return a}function mr(r,a){r.pendingLanes|=a,a!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function Yu(r,a,l,c,m,g){var w=r.pendingLanes;r.pendingLanes=l,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=l,r.entangledLanes&=l,r.errorRecoveryDisabledLanes&=l,r.shellSuspendCounter=0;var b=r.entanglements,R=r.expirationTimes,j=r.hiddenUpdates;for(l=w&~l;0<l;){var $=31-mn(l),J=1<<$;b[$]=0,R[$]=-1;var H=j[$];if(H!==null)for(j[$]=null,$=0;$<H.length;$++){var G=H[$];G!==null&&(G.lane&=-536870913)}l&=~J}c!==0&&Fi(r,c,0),g!==0&&m===0&&r.tag!==0&&(r.suspendedLanes|=g&~(w&~a))}function Fi(r,a,l){r.pendingLanes|=a,r.suspendedLanes&=~a;var c=31-mn(a);r.entangledLanes|=a,r.entanglements[c]=r.entanglements[c]|1073741824|l&4194090}function Qu(r,a){var l=r.entangledLanes|=a;for(r=r.entanglements;l;){var c=31-mn(l),m=1<<c;m&a|r[c]&a&&(r[c]|=a),l&=~m}}function as(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function zo(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function os(){var r=ce.p;return r!==0?r:(r=window.event,r===void 0?32:gI(r.type))}function Md(r,a){var l=ce.p;try{return ce.p=r,a()}finally{ce.p=l}}var _t=Math.random().toString(36).slice(2),qt="__reactFiber$"+_t,Lt="__reactProps$"+_t,oi="__reactContainer$"+_t,Wu="__reactEvents$"+_t,Cg="__reactListeners$"+_t,ls="__reactHandles$"+_t,Vd="__reactResources$"+_t,wa="__reactMarker$"+_t;function us(r){delete r[qt],delete r[Lt],delete r[Wu],delete r[Cg],delete r[ls]}function pr(r){var a=r[qt];if(a)return a;for(var l=r.parentNode;l;){if(a=l[oi]||l[qt]){if(l=a.alternate,a.child!==null||l!==null&&l.child!==null)for(r=tI(r);r!==null;){if(l=r[qt])return l;r=tI(r)}return a}r=l,l=r.parentNode}return null}function Bi(r){if(r=r[qt]||r[oi]){var a=r.tag;if(a===5||a===6||a===13||a===26||a===27||a===3)return r}return null}function zi(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r.stateNode;throw Error(i(33))}function Sn(r){var a=r[Vd];return a||(a=r[Vd]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function Nt(r){r[wa]=!0}var $u=new Set,qo={};function Ri(r,a){gr(r,a),gr(r+"Capture",a)}function gr(r,a){for(qo[r]=a,r=0;r<a.length;r++)$u.add(a[r])}var Ld=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ud={},ba={};function Fd(r){return ma.call(ba,r)?!0:ma.call(Ud,r)?!1:Ld.test(r)?ba[r]=!0:(Ud[r]=!0,!1)}function cs(r,a,l){if(Fd(a))if(l===null)r.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":r.removeAttribute(a);return;case"boolean":var c=a.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){r.removeAttribute(a);return}}r.setAttribute(a,""+l)}}function qi(r,a,l){if(l===null)r.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(a);return}r.setAttribute(a,""+l)}}function on(r,a,l,c){if(c===null)r.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(l);return}r.setAttributeNS(a,l,""+c)}}var Ia,Bd;function _r(r){if(Ia===void 0)try{throw Error()}catch(l){var a=l.stack.trim().match(/\n( *(at )?)/);Ia=a&&a[1]||"",Bd=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ia+r+Bd}var jo=!1;function Ho(r,a){if(!r||jo)return"";jo=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(a){var J=function(){throw Error()};if(Object.defineProperty(J.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(J,[])}catch(G){var H=G}Reflect.construct(r,[],J)}else{try{J.call()}catch(G){H=G}r.call(J.prototype)}}else{try{throw Error()}catch(G){H=G}(J=r())&&typeof J.catch=="function"&&J.catch(function(){})}}catch(G){if(G&&H&&typeof G.stack=="string")return[G.stack,H.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=c.DetermineComponentFrameRoot(),w=g[0],b=g[1];if(w&&b){var R=w.split(`
`),j=b.split(`
`);for(m=c=0;c<R.length&&!R[c].includes("DetermineComponentFrameRoot");)c++;for(;m<j.length&&!j[m].includes("DetermineComponentFrameRoot");)m++;if(c===R.length||m===j.length)for(c=R.length-1,m=j.length-1;1<=c&&0<=m&&R[c]!==j[m];)m--;for(;1<=c&&0<=m;c--,m--)if(R[c]!==j[m]){if(c!==1||m!==1)do if(c--,m--,0>m||R[c]!==j[m]){var $=`
`+R[c].replace(" at new "," at ");return r.displayName&&$.includes("<anonymous>")&&($=$.replace("<anonymous>",r.displayName)),$}while(1<=c&&0<=m);break}}}finally{jo=!1,Error.prepareStackTrace=l}return(l=r?r.displayName||r.name:"")?_r(l):""}function Xu(r){switch(r.tag){case 26:case 27:case 5:return _r(r.type);case 16:return _r("Lazy");case 13:return _r("Suspense");case 19:return _r("SuspenseList");case 0:case 15:return Ho(r.type,!1);case 11:return Ho(r.type.render,!1);case 1:return Ho(r.type,!0);case 31:return _r("Activity");default:return""}}function Go(r){try{var a="";do a+=Xu(r),r=r.return;while(r);return a}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function An(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Ju(r){var a=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Dg(r){var a=Ju(r)?"checked":"value",l=Object.getOwnPropertyDescriptor(r.constructor.prototype,a),c=""+r[a];if(!r.hasOwnProperty(a)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var m=l.get,g=l.set;return Object.defineProperty(r,a,{configurable:!0,get:function(){return m.call(this)},set:function(w){c=""+w,g.call(this,w)}}),Object.defineProperty(r,a,{enumerable:l.enumerable}),{getValue:function(){return c},setValue:function(w){c=""+w},stopTracking:function(){r._valueTracker=null,delete r[a]}}}}function Ko(r){r._valueTracker||(r._valueTracker=Dg(r))}function Zu(r){if(!r)return!1;var a=r._valueTracker;if(!a)return!0;var l=a.getValue(),c="";return r&&(c=Ju(r)?r.checked?"true":"false":r.value),r=c,r!==l?(a.setValue(r),!0):!1}function Sa(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Ng=/[\n"\\]/g;function Ut(r){return r.replace(Ng,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Hn(r,a,l,c,m,g,w,b){r.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?r.type=w:r.removeAttribute("type"),a!=null?w==="number"?(a===0&&r.value===""||r.value!=a)&&(r.value=""+An(a)):r.value!==""+An(a)&&(r.value=""+An(a)):w!=="submit"&&w!=="reset"||r.removeAttribute("value"),a!=null?hs(r,w,An(a)):l!=null?hs(r,w,An(l)):c!=null&&r.removeAttribute("value"),m==null&&g!=null&&(r.defaultChecked=!!g),m!=null&&(r.checked=m&&typeof m!="function"&&typeof m!="symbol"),b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?r.name=""+An(b):r.removeAttribute("name")}function Aa(r,a,l,c,m,g,w,b){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(r.type=g),a!=null||l!=null){if(!(g!=="submit"&&g!=="reset"||a!=null))return;l=l!=null?""+An(l):"",a=a!=null?""+An(a):l,b||a===r.value||(r.value=a),r.defaultValue=a}c=c??m,c=typeof c!="function"&&typeof c!="symbol"&&!!c,r.checked=b?r.checked:!!c,r.defaultChecked=!!c,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(r.name=w)}function hs(r,a,l){a==="number"&&Sa(r.ownerDocument)===r||r.defaultValue===""+l||(r.defaultValue=""+l)}function yr(r,a,l,c){if(r=r.options,a){a={};for(var m=0;m<l.length;m++)a["$"+l[m]]=!0;for(l=0;l<r.length;l++)m=a.hasOwnProperty("$"+r[l].value),r[l].selected!==m&&(r[l].selected=m),m&&c&&(r[l].defaultSelected=!0)}else{for(l=""+An(l),a=null,m=0;m<r.length;m++){if(r[m].value===l){r[m].selected=!0,c&&(r[m].defaultSelected=!0);return}a!==null||r[m].disabled||(a=r[m])}a!==null&&(a.selected=!0)}}function at(r,a,l){if(a!=null&&(a=""+An(a),a!==r.value&&(r.value=a),l==null)){r.defaultValue!==a&&(r.defaultValue=a);return}r.defaultValue=l!=null?""+An(l):""}function Ra(r,a,l,c){if(a==null){if(c!=null){if(l!=null)throw Error(i(92));if(St(c)){if(1<c.length)throw Error(i(93));c=c[0]}l=c}l==null&&(l=""),a=l}l=An(a),r.defaultValue=l,c=r.textContent,c===l&&c!==""&&c!==null&&(r.value=c)}function li(r,a){if(a){var l=r.firstChild;if(l&&l===r.lastChild&&l.nodeType===3){l.nodeValue=a;return}}r.textContent=a}var Ca=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function zd(r,a,l){var c=a.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?c?r.setProperty(a,""):a==="float"?r.cssFloat="":r[a]="":c?r.setProperty(a,l):typeof l!="number"||l===0||Ca.has(a)?a==="float"?r.cssFloat=l:r[a]=(""+l).trim():r[a]=l+"px"}function ec(r,a,l){if(a!=null&&typeof a!="object")throw Error(i(62));if(r=r.style,l!=null){for(var c in l)!l.hasOwnProperty(c)||a!=null&&a.hasOwnProperty(c)||(c.indexOf("--")===0?r.setProperty(c,""):c==="float"?r.cssFloat="":r[c]="");for(var m in a)c=a[m],a.hasOwnProperty(m)&&l[m]!==c&&zd(r,m,c)}else for(var g in a)a.hasOwnProperty(g)&&zd(r,g,a[g])}function tc(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Og=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),xg=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Yo(r){return xg.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}var vr=null;function ui(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Er=null,Tr=null;function nc(r){var a=Bi(r);if(a&&(r=a.stateNode)){var l=r[Lt]||null;e:switch(r=a.stateNode,a.type){case"input":if(Hn(r,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),a=l.name,l.type==="radio"&&a!=null){for(l=r;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Ut(""+a)+'"][type="radio"]'),a=0;a<l.length;a++){var c=l[a];if(c!==r&&c.form===r.form){var m=c[Lt]||null;if(!m)throw Error(i(90));Hn(c,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(a=0;a<l.length;a++)c=l[a],c.form===r.form&&Zu(c)}break e;case"textarea":at(r,l.value,l.defaultValue);break e;case"select":a=l.value,a!=null&&yr(r,!!l.multiple,a,!1)}}}var ji=!1;function qd(r,a,l){if(ji)return r(a,l);ji=!0;try{var c=r(a);return c}finally{if(ji=!1,(Er!==null||Tr!==null)&&(Vf(),Er&&(a=Er,r=Tr,Tr=Er=null,nc(a),r)))for(a=0;a<r.length;a++)nc(r[a])}}function Da(r,a){var l=r.stateNode;if(l===null)return null;var c=l[Lt]||null;if(c===null)return null;l=c[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(r=r.type,c=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!c;break e;default:r=!1}if(r)return null;if(l&&typeof l!="function")throw Error(i(231,a,typeof l));return l}var Ci=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ci=!1;if(Ci)try{var Na={};Object.defineProperty(Na,"passive",{get:function(){ci=!0}}),window.addEventListener("test",Na,Na),window.removeEventListener("test",Na,Na)}catch{ci=!1}var Hi=null,ds=null,wr=null;function ic(){if(wr)return wr;var r,a=ds,l=a.length,c,m="value"in Hi?Hi.value:Hi.textContent,g=m.length;for(r=0;r<l&&a[r]===m[r];r++);var w=l-r;for(c=1;c<=w&&a[l-c]===m[g-c];c++);return wr=m.slice(r,1<c?1-c:void 0)}function Gi(r){var a=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&a===13&&(r=13)):r=a,r===10&&(r=13),32<=r||r===13?r:0}function Ki(){return!0}function rc(){return!1}function Jt(r){function a(l,c,m,g,w){this._reactName=l,this._targetInst=m,this.type=c,this.nativeEvent=g,this.target=w,this.currentTarget=null;for(var b in r)r.hasOwnProperty(b)&&(l=r[b],this[b]=l?l(g):g[b]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?Ki:rc,this.isPropagationStopped=rc,this}return _(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Ki)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Ki)},persist:function(){},isPersistent:Ki}),a}var Xe={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qo=Jt(Xe),Oa=_({},Xe,{view:0,detail:0}),jd=Jt(Oa),Wo,$o,Yi,xa=_({},Oa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ma,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Yi&&(Yi&&r.type==="mousemove"?(Wo=r.screenX-Yi.screenX,$o=r.screenY-Yi.screenY):$o=Wo=0,Yi=r),Wo)},movementY:function(r){return"movementY"in r?r.movementY:$o}}),hi=Jt(xa),Hd=_({},xa,{dataTransfer:0}),Pg=Jt(Hd),Pa=_({},Oa,{relatedTarget:0}),Xo=Jt(Pa),sc=_({},Xe,{animationName:0,elapsedTime:0,pseudoElement:0}),Jo=Jt(sc),Gd=_({},Xe,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Zo=Jt(Gd),kg=_({},Xe,{data:0}),ac=Jt(kg),ka={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Kd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Yd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function oc(r){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(r):(r=Yd[r])?!!a[r]:!1}function Ma(){return oc}var Qd=_({},Oa,{key:function(r){if(r.key){var a=ka[r.key]||r.key;if(a!=="Unidentified")return a}return r.type==="keypress"?(r=Gi(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Kd[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ma,charCode:function(r){return r.type==="keypress"?Gi(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Gi(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),el=Jt(Qd),Wd=_({},xa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lc=Jt(Wd),br=_({},Oa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ma}),$d=Jt(br),Xd=_({},Xe,{propertyName:0,elapsedTime:0,pseudoElement:0}),Jd=Jt(Xd),Zd=_({},xa,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),tl=Jt(Zd),Rn=_({},Xe,{newState:0,oldState:0}),ef=Jt(Rn),tf=[9,13,27,32],Qi=Ci&&"CompositionEvent"in window,d=null;Ci&&"documentMode"in document&&(d=document.documentMode);var y=Ci&&"TextEvent"in window&&!d,E=Ci&&(!Qi||d&&8<d&&11>=d),I=" ",B=!1;function K(r,a){switch(r){case"keyup":return tf.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function oe(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var qe=!1;function jt(r,a){switch(r){case"compositionend":return oe(a);case"keypress":return a.which!==32?null:(B=!0,I);case"textInput":return r=a.data,r===I&&B?null:r;default:return null}}function je(r,a){if(qe)return r==="compositionend"||!Qi&&K(r,a)?(r=ic(),wr=ds=Hi=null,qe=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return E&&a.locale!=="ko"?null:a.data;default:return null}}var Zt={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ht(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a==="input"?!!Zt[r.type]:a==="textarea"}function Ir(r,a,l,c){Er?Tr?Tr.push(c):Tr=[c]:Er=c,a=qf(a,"onChange"),0<a.length&&(l=new Qo("onChange","change",null,l,c),r.push({event:l,listeners:a}))}var ln=null,Wi=null;function uc(r){Gb(r,0)}function nf(r){var a=zi(r);if(Zu(a))return r}function dw(r,a){if(r==="change")return a}var fw=!1;if(Ci){var Mg;if(Ci){var Vg="oninput"in document;if(!Vg){var mw=document.createElement("div");mw.setAttribute("oninput","return;"),Vg=typeof mw.oninput=="function"}Mg=Vg}else Mg=!1;fw=Mg&&(!document.documentMode||9<document.documentMode)}function pw(){ln&&(ln.detachEvent("onpropertychange",gw),Wi=ln=null)}function gw(r){if(r.propertyName==="value"&&nf(Wi)){var a=[];Ir(a,Wi,r,ui(r)),qd(uc,a)}}function Tx(r,a,l){r==="focusin"?(pw(),ln=a,Wi=l,ln.attachEvent("onpropertychange",gw)):r==="focusout"&&pw()}function wx(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return nf(Wi)}function bx(r,a){if(r==="click")return nf(a)}function Ix(r,a){if(r==="input"||r==="change")return nf(a)}function Sx(r,a){return r===a&&(r!==0||1/r===1/a)||r!==r&&a!==a}var Gn=typeof Object.is=="function"?Object.is:Sx;function cc(r,a){if(Gn(r,a))return!0;if(typeof r!="object"||r===null||typeof a!="object"||a===null)return!1;var l=Object.keys(r),c=Object.keys(a);if(l.length!==c.length)return!1;for(c=0;c<l.length;c++){var m=l[c];if(!ma.call(a,m)||!Gn(r[m],a[m]))return!1}return!0}function _w(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function yw(r,a){var l=_w(r);r=0;for(var c;l;){if(l.nodeType===3){if(c=r+l.textContent.length,r<=a&&c>=a)return{node:l,offset:a-r};r=c}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=_w(l)}}function vw(r,a){return r&&a?r===a?!0:r&&r.nodeType===3?!1:a&&a.nodeType===3?vw(r,a.parentNode):"contains"in r?r.contains(a):r.compareDocumentPosition?!!(r.compareDocumentPosition(a)&16):!1:!1}function Ew(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var a=Sa(r.document);a instanceof r.HTMLIFrameElement;){try{var l=typeof a.contentWindow.location.href=="string"}catch{l=!1}if(l)r=a.contentWindow;else break;a=Sa(r.document)}return a}function Lg(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a&&(a==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||a==="textarea"||r.contentEditable==="true")}var Ax=Ci&&"documentMode"in document&&11>=document.documentMode,nl=null,Ug=null,hc=null,Fg=!1;function Tw(r,a,l){var c=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Fg||nl==null||nl!==Sa(c)||(c=nl,"selectionStart"in c&&Lg(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),hc&&cc(hc,c)||(hc=c,c=qf(Ug,"onSelect"),0<c.length&&(a=new Qo("onSelect","select",null,a,l),r.push({event:a,listeners:c}),a.target=nl)))}function Va(r,a){var l={};return l[r.toLowerCase()]=a.toLowerCase(),l["Webkit"+r]="webkit"+a,l["Moz"+r]="moz"+a,l}var il={animationend:Va("Animation","AnimationEnd"),animationiteration:Va("Animation","AnimationIteration"),animationstart:Va("Animation","AnimationStart"),transitionrun:Va("Transition","TransitionRun"),transitionstart:Va("Transition","TransitionStart"),transitioncancel:Va("Transition","TransitionCancel"),transitionend:Va("Transition","TransitionEnd")},Bg={},ww={};Ci&&(ww=document.createElement("div").style,"AnimationEvent"in window||(delete il.animationend.animation,delete il.animationiteration.animation,delete il.animationstart.animation),"TransitionEvent"in window||delete il.transitionend.transition);function La(r){if(Bg[r])return Bg[r];if(!il[r])return r;var a=il[r],l;for(l in a)if(a.hasOwnProperty(l)&&l in ww)return Bg[r]=a[l];return r}var bw=La("animationend"),Iw=La("animationiteration"),Sw=La("animationstart"),Rx=La("transitionrun"),Cx=La("transitionstart"),Dx=La("transitioncancel"),Aw=La("transitionend"),Rw=new Map,zg="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");zg.push("scrollEnd");function Di(r,a){Rw.set(r,a),Ri(a,[r])}var Cw=new WeakMap;function di(r,a){if(typeof r=="object"&&r!==null){var l=Cw.get(r);return l!==void 0?l:(a={value:r,source:a,stack:Go(a)},Cw.set(r,a),a)}return{value:r,source:a,stack:Go(a)}}var fi=[],rl=0,qg=0;function rf(){for(var r=rl,a=qg=rl=0;a<r;){var l=fi[a];fi[a++]=null;var c=fi[a];fi[a++]=null;var m=fi[a];fi[a++]=null;var g=fi[a];if(fi[a++]=null,c!==null&&m!==null){var w=c.pending;w===null?m.next=m:(m.next=w.next,w.next=m),c.pending=m}g!==0&&Dw(l,m,g)}}function sf(r,a,l,c){fi[rl++]=r,fi[rl++]=a,fi[rl++]=l,fi[rl++]=c,qg|=c,r.lanes|=c,r=r.alternate,r!==null&&(r.lanes|=c)}function jg(r,a,l,c){return sf(r,a,l,c),af(r)}function sl(r,a){return sf(r,null,null,a),af(r)}function Dw(r,a,l){r.lanes|=l;var c=r.alternate;c!==null&&(c.lanes|=l);for(var m=!1,g=r.return;g!==null;)g.childLanes|=l,c=g.alternate,c!==null&&(c.childLanes|=l),g.tag===22&&(r=g.stateNode,r===null||r._visibility&1||(m=!0)),r=g,g=g.return;return r.tag===3?(g=r.stateNode,m&&a!==null&&(m=31-mn(l),r=g.hiddenUpdates,c=r[m],c===null?r[m]=[a]:c.push(a),a.lane=l|536870912),g):null}function af(r){if(50<Vc)throw Vc=0,W_=null,Error(i(185));for(var a=r.return;a!==null;)r=a,a=r.return;return r.tag===3?r.stateNode:null}var al={};function Nx(r,a,l,c){this.tag=r,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Kn(r,a,l,c){return new Nx(r,a,l,c)}function Hg(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Sr(r,a){var l=r.alternate;return l===null?(l=Kn(r.tag,a,r.key,r.mode),l.elementType=r.elementType,l.type=r.type,l.stateNode=r.stateNode,l.alternate=r,r.alternate=l):(l.pendingProps=a,l.type=r.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=r.flags&65011712,l.childLanes=r.childLanes,l.lanes=r.lanes,l.child=r.child,l.memoizedProps=r.memoizedProps,l.memoizedState=r.memoizedState,l.updateQueue=r.updateQueue,a=r.dependencies,l.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},l.sibling=r.sibling,l.index=r.index,l.ref=r.ref,l.refCleanup=r.refCleanup,l}function Nw(r,a){r.flags&=65011714;var l=r.alternate;return l===null?(r.childLanes=0,r.lanes=a,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=l.childLanes,r.lanes=l.lanes,r.child=l.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=l.memoizedProps,r.memoizedState=l.memoizedState,r.updateQueue=l.updateQueue,r.type=l.type,a=l.dependencies,r.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),r}function of(r,a,l,c,m,g){var w=0;if(c=r,typeof r=="function")Hg(r)&&(w=1);else if(typeof r=="string")w=xP(r,l,Te.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case C:return r=Kn(31,l,a,m),r.elementType=C,r.lanes=g,r;case N:return Ua(l.children,m,g,a);case x:w=8,m|=24;break;case U:return r=Kn(12,l,a,m|2),r.elementType=U,r.lanes=g,r;case se:return r=Kn(13,l,a,m),r.elementType=se,r.lanes=g,r;case me:return r=Kn(19,l,a,m),r.elementType=me,r.lanes=g,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case Z:case Y:w=10;break e;case ee:w=9;break e;case ie:w=11;break e;case O:w=14;break e;case A:w=16,c=null;break e}w=29,l=Error(i(130,r===null?"null":typeof r,"")),c=null}return a=Kn(w,l,a,m),a.elementType=r,a.type=c,a.lanes=g,a}function Ua(r,a,l,c){return r=Kn(7,r,c,a),r.lanes=l,r}function Gg(r,a,l){return r=Kn(6,r,null,a),r.lanes=l,r}function Kg(r,a,l){return a=Kn(4,r.children!==null?r.children:[],r.key,a),a.lanes=l,a.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},a}var ol=[],ll=0,lf=null,uf=0,mi=[],pi=0,Fa=null,Ar=1,Rr="";function Ba(r,a){ol[ll++]=uf,ol[ll++]=lf,lf=r,uf=a}function Ow(r,a,l){mi[pi++]=Ar,mi[pi++]=Rr,mi[pi++]=Fa,Fa=r;var c=Ar;r=Rr;var m=32-mn(c)-1;c&=~(1<<m),l+=1;var g=32-mn(a)+m;if(30<g){var w=m-m%5;g=(c&(1<<w)-1).toString(32),c>>=w,m-=w,Ar=1<<32-mn(a)+m|l<<m|c,Rr=g+r}else Ar=1<<g|l<<m|c,Rr=r}function Yg(r){r.return!==null&&(Ba(r,1),Ow(r,1,0))}function Qg(r){for(;r===lf;)lf=ol[--ll],ol[ll]=null,uf=ol[--ll],ol[ll]=null;for(;r===Fa;)Fa=mi[--pi],mi[pi]=null,Rr=mi[--pi],mi[pi]=null,Ar=mi[--pi],mi[pi]=null}var Cn=null,Rt=null,$e=!1,za=null,$i=!1,Wg=Error(i(519));function qa(r){var a=Error(i(418,""));throw mc(di(a,r)),Wg}function xw(r){var a=r.stateNode,l=r.type,c=r.memoizedProps;switch(a[qt]=r,a[Lt]=c,l){case"dialog":Fe("cancel",a),Fe("close",a);break;case"iframe":case"object":case"embed":Fe("load",a);break;case"video":case"audio":for(l=0;l<Uc.length;l++)Fe(Uc[l],a);break;case"source":Fe("error",a);break;case"img":case"image":case"link":Fe("error",a),Fe("load",a);break;case"details":Fe("toggle",a);break;case"input":Fe("invalid",a),Aa(a,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0),Ko(a);break;case"select":Fe("invalid",a);break;case"textarea":Fe("invalid",a),Ra(a,c.value,c.defaultValue,c.children),Ko(a)}l=c.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||a.textContent===""+l||c.suppressHydrationWarning===!0||Wb(a.textContent,l)?(c.popover!=null&&(Fe("beforetoggle",a),Fe("toggle",a)),c.onScroll!=null&&Fe("scroll",a),c.onScrollEnd!=null&&Fe("scrollend",a),c.onClick!=null&&(a.onclick=jf),a=!0):a=!1,a||qa(r)}function Pw(r){for(Cn=r.return;Cn;)switch(Cn.tag){case 5:case 13:$i=!1;return;case 27:case 3:$i=!0;return;default:Cn=Cn.return}}function dc(r){if(r!==Cn)return!1;if(!$e)return Pw(r),$e=!0,!1;var a=r.tag,l;if((l=a!==3&&a!==27)&&((l=a===5)&&(l=r.type,l=!(l!=="form"&&l!=="button")||hy(r.type,r.memoizedProps)),l=!l),l&&Rt&&qa(r),Pw(r),a===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));e:{for(r=r.nextSibling,a=0;r;){if(r.nodeType===8)if(l=r.data,l==="/$"){if(a===0){Rt=Oi(r.nextSibling);break e}a--}else l!=="$"&&l!=="$!"&&l!=="$?"||a++;r=r.nextSibling}Rt=null}}else a===27?(a=Rt,Cs(r.type)?(r=py,py=null,Rt=r):Rt=a):Rt=Cn?Oi(r.stateNode.nextSibling):null;return!0}function fc(){Rt=Cn=null,$e=!1}function kw(){var r=za;return r!==null&&(Ln===null?Ln=r:Ln.push.apply(Ln,r),za=null),r}function mc(r){za===null?za=[r]:za.push(r)}var $g=te(null),ja=null,Cr=null;function fs(r,a,l){re($g,a._currentValue),a._currentValue=l}function Dr(r){r._currentValue=$g.current,he($g)}function Xg(r,a,l){for(;r!==null;){var c=r.alternate;if((r.childLanes&a)!==a?(r.childLanes|=a,c!==null&&(c.childLanes|=a)):c!==null&&(c.childLanes&a)!==a&&(c.childLanes|=a),r===l)break;r=r.return}}function Jg(r,a,l,c){var m=r.child;for(m!==null&&(m.return=r);m!==null;){var g=m.dependencies;if(g!==null){var w=m.child;g=g.firstContext;e:for(;g!==null;){var b=g;g=m;for(var R=0;R<a.length;R++)if(b.context===a[R]){g.lanes|=l,b=g.alternate,b!==null&&(b.lanes|=l),Xg(g.return,l,r),c||(w=null);break e}g=b.next}}else if(m.tag===18){if(w=m.return,w===null)throw Error(i(341));w.lanes|=l,g=w.alternate,g!==null&&(g.lanes|=l),Xg(w,l,r),w=null}else w=m.child;if(w!==null)w.return=m;else for(w=m;w!==null;){if(w===r){w=null;break}if(m=w.sibling,m!==null){m.return=w.return,w=m;break}w=w.return}m=w}}function pc(r,a,l,c){r=null;for(var m=a,g=!1;m!==null;){if(!g){if((m.flags&524288)!==0)g=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var w=m.alternate;if(w===null)throw Error(i(387));if(w=w.memoizedProps,w!==null){var b=m.type;Gn(m.pendingProps.value,w.value)||(r!==null?r.push(b):r=[b])}}else if(m===Xt.current){if(w=m.alternate,w===null)throw Error(i(387));w.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(r!==null?r.push(Hc):r=[Hc])}m=m.return}r!==null&&Jg(a,r,l,c),a.flags|=262144}function cf(r){for(r=r.firstContext;r!==null;){if(!Gn(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Ha(r){ja=r,Cr=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function pn(r){return Mw(ja,r)}function hf(r,a){return ja===null&&Ha(r),Mw(r,a)}function Mw(r,a){var l=a._currentValue;if(a={context:a,memoizedValue:l,next:null},Cr===null){if(r===null)throw Error(i(308));Cr=a,r.dependencies={lanes:0,firstContext:a},r.flags|=524288}else Cr=Cr.next=a;return l}var Ox=typeof AbortController<"u"?AbortController:function(){var r=[],a=this.signal={aborted:!1,addEventListener:function(l,c){r.push(c)}};this.abort=function(){a.aborted=!0,r.forEach(function(l){return l()})}},xx=n.unstable_scheduleCallback,Px=n.unstable_NormalPriority,Gt={$$typeof:Y,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Zg(){return{controller:new Ox,data:new Map,refCount:0}}function gc(r){r.refCount--,r.refCount===0&&xx(Px,function(){r.controller.abort()})}var _c=null,e_=0,ul=0,cl=null;function kx(r,a){if(_c===null){var l=_c=[];e_=0,ul=ny(),cl={status:"pending",value:void 0,then:function(c){l.push(c)}}}return e_++,a.then(Vw,Vw),a}function Vw(){if(--e_===0&&_c!==null){cl!==null&&(cl.status="fulfilled");var r=_c;_c=null,ul=0,cl=null;for(var a=0;a<r.length;a++)(0,r[a])()}}function Mx(r,a){var l=[],c={status:"pending",value:null,reason:null,then:function(m){l.push(m)}};return r.then(function(){c.status="fulfilled",c.value=a;for(var m=0;m<l.length;m++)(0,l[m])(a)},function(m){for(c.status="rejected",c.reason=m,m=0;m<l.length;m++)(0,l[m])(void 0)}),c}var Lw=W.S;W.S=function(r,a){typeof a=="object"&&a!==null&&typeof a.then=="function"&&kx(r,a),Lw!==null&&Lw(r,a)};var Ga=te(null);function t_(){var r=Ga.current;return r!==null?r:ft.pooledCache}function df(r,a){a===null?re(Ga,Ga.current):re(Ga,a.pool)}function Uw(){var r=t_();return r===null?null:{parent:Gt._currentValue,pool:r}}var yc=Error(i(460)),Fw=Error(i(474)),ff=Error(i(542)),n_={then:function(){}};function Bw(r){return r=r.status,r==="fulfilled"||r==="rejected"}function mf(){}function zw(r,a,l){switch(l=r[l],l===void 0?r.push(a):l!==a&&(a.then(mf,mf),a=l),a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,jw(r),r;default:if(typeof a.status=="string")a.then(mf,mf);else{if(r=ft,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=a,r.status="pending",r.then(function(c){if(a.status==="pending"){var m=a;m.status="fulfilled",m.value=c}},function(c){if(a.status==="pending"){var m=a;m.status="rejected",m.reason=c}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,jw(r),r}throw vc=a,yc}}var vc=null;function qw(){if(vc===null)throw Error(i(459));var r=vc;return vc=null,r}function jw(r){if(r===yc||r===ff)throw Error(i(483))}var ms=!1;function i_(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function r_(r,a){r=r.updateQueue,a.updateQueue===r&&(a.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function ps(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function gs(r,a,l){var c=r.updateQueue;if(c===null)return null;if(c=c.shared,(et&2)!==0){var m=c.pending;return m===null?a.next=a:(a.next=m.next,m.next=a),c.pending=a,a=af(r),Dw(r,null,l),a}return sf(r,c,a,l),af(r)}function Ec(r,a,l){if(a=a.updateQueue,a!==null&&(a=a.shared,(l&4194048)!==0)){var c=a.lanes;c&=r.pendingLanes,l|=c,a.lanes=l,Qu(r,l)}}function s_(r,a){var l=r.updateQueue,c=r.alternate;if(c!==null&&(c=c.updateQueue,l===c)){var m=null,g=null;if(l=l.firstBaseUpdate,l!==null){do{var w={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};g===null?m=g=w:g=g.next=w,l=l.next}while(l!==null);g===null?m=g=a:g=g.next=a}else m=g=a;l={baseState:c.baseState,firstBaseUpdate:m,lastBaseUpdate:g,shared:c.shared,callbacks:c.callbacks},r.updateQueue=l;return}r=l.lastBaseUpdate,r===null?l.firstBaseUpdate=a:r.next=a,l.lastBaseUpdate=a}var a_=!1;function Tc(){if(a_){var r=cl;if(r!==null)throw r}}function wc(r,a,l,c){a_=!1;var m=r.updateQueue;ms=!1;var g=m.firstBaseUpdate,w=m.lastBaseUpdate,b=m.shared.pending;if(b!==null){m.shared.pending=null;var R=b,j=R.next;R.next=null,w===null?g=j:w.next=j,w=R;var $=r.alternate;$!==null&&($=$.updateQueue,b=$.lastBaseUpdate,b!==w&&(b===null?$.firstBaseUpdate=j:b.next=j,$.lastBaseUpdate=R))}if(g!==null){var J=m.baseState;w=0,$=j=R=null,b=g;do{var H=b.lane&-536870913,G=H!==b.lane;if(G?(He&H)===H:(c&H)===H){H!==0&&H===ul&&(a_=!0),$!==null&&($=$.next={lane:0,tag:b.tag,payload:b.payload,callback:null,next:null});e:{var Re=r,we=b;H=a;var ut=l;switch(we.tag){case 1:if(Re=we.payload,typeof Re=="function"){J=Re.call(ut,J,H);break e}J=Re;break e;case 3:Re.flags=Re.flags&-65537|128;case 0:if(Re=we.payload,H=typeof Re=="function"?Re.call(ut,J,H):Re,H==null)break e;J=_({},J,H);break e;case 2:ms=!0}}H=b.callback,H!==null&&(r.flags|=64,G&&(r.flags|=8192),G=m.callbacks,G===null?m.callbacks=[H]:G.push(H))}else G={lane:H,tag:b.tag,payload:b.payload,callback:b.callback,next:null},$===null?(j=$=G,R=J):$=$.next=G,w|=H;if(b=b.next,b===null){if(b=m.shared.pending,b===null)break;G=b,b=G.next,G.next=null,m.lastBaseUpdate=G,m.shared.pending=null}}while(!0);$===null&&(R=J),m.baseState=R,m.firstBaseUpdate=j,m.lastBaseUpdate=$,g===null&&(m.shared.lanes=0),Is|=w,r.lanes=w,r.memoizedState=J}}function Hw(r,a){if(typeof r!="function")throw Error(i(191,r));r.call(a)}function Gw(r,a){var l=r.callbacks;if(l!==null)for(r.callbacks=null,r=0;r<l.length;r++)Hw(l[r],a)}var hl=te(null),pf=te(0);function Kw(r,a){r=Vr,re(pf,r),re(hl,a),Vr=r|a.baseLanes}function o_(){re(pf,Vr),re(hl,hl.current)}function l_(){Vr=pf.current,he(hl),he(pf)}var _s=0,Oe=null,ot=null,Ft=null,gf=!1,dl=!1,Ka=!1,_f=0,bc=0,fl=null,Vx=0;function Ot(){throw Error(i(321))}function u_(r,a){if(a===null)return!1;for(var l=0;l<a.length&&l<r.length;l++)if(!Gn(r[l],a[l]))return!1;return!0}function c_(r,a,l,c,m,g){return _s=g,Oe=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,W.H=r===null||r.memoizedState===null?D0:N0,Ka=!1,g=l(c,m),Ka=!1,dl&&(g=Qw(a,l,c,m)),Yw(r),g}function Yw(r){W.H=bf;var a=ot!==null&&ot.next!==null;if(_s=0,Ft=ot=Oe=null,gf=!1,bc=0,fl=null,a)throw Error(i(300));r===null||en||(r=r.dependencies,r!==null&&cf(r)&&(en=!0))}function Qw(r,a,l,c){Oe=r;var m=0;do{if(dl&&(fl=null),bc=0,dl=!1,25<=m)throw Error(i(301));if(m+=1,Ft=ot=null,r.updateQueue!=null){var g=r.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}W.H=jx,g=a(l,c)}while(dl);return g}function Lx(){var r=W.H,a=r.useState()[0];return a=typeof a.then=="function"?Ic(a):a,r=r.useState()[0],(ot!==null?ot.memoizedState:null)!==r&&(Oe.flags|=1024),a}function h_(){var r=_f!==0;return _f=0,r}function d_(r,a,l){a.updateQueue=r.updateQueue,a.flags&=-2053,r.lanes&=~l}function f_(r){if(gf){for(r=r.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}gf=!1}_s=0,Ft=ot=Oe=null,dl=!1,bc=_f=0,fl=null}function Mn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ft===null?Oe.memoizedState=Ft=r:Ft=Ft.next=r,Ft}function Bt(){if(ot===null){var r=Oe.alternate;r=r!==null?r.memoizedState:null}else r=ot.next;var a=Ft===null?Oe.memoizedState:Ft.next;if(a!==null)Ft=a,ot=r;else{if(r===null)throw Oe.alternate===null?Error(i(467)):Error(i(310));ot=r,r={memoizedState:ot.memoizedState,baseState:ot.baseState,baseQueue:ot.baseQueue,queue:ot.queue,next:null},Ft===null?Oe.memoizedState=Ft=r:Ft=Ft.next=r}return Ft}function m_(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ic(r){var a=bc;return bc+=1,fl===null&&(fl=[]),r=zw(fl,r,a),a=Oe,(Ft===null?a.memoizedState:Ft.next)===null&&(a=a.alternate,W.H=a===null||a.memoizedState===null?D0:N0),r}function yf(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Ic(r);if(r.$$typeof===Y)return pn(r)}throw Error(i(438,String(r)))}function p_(r){var a=null,l=Oe.updateQueue;if(l!==null&&(a=l.memoCache),a==null){var c=Oe.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(a={data:c.data.map(function(m){return m.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),l===null&&(l=m_(),Oe.updateQueue=l),l.memoCache=a,l=a.data[a.index],l===void 0)for(l=a.data[a.index]=Array(r),c=0;c<r;c++)l[c]=M;return a.index++,l}function Nr(r,a){return typeof a=="function"?a(r):a}function vf(r){var a=Bt();return g_(a,ot,r)}function g_(r,a,l){var c=r.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=l;var m=r.baseQueue,g=c.pending;if(g!==null){if(m!==null){var w=m.next;m.next=g.next,g.next=w}a.baseQueue=m=g,c.pending=null}if(g=r.baseState,m===null)r.memoizedState=g;else{a=m.next;var b=w=null,R=null,j=a,$=!1;do{var J=j.lane&-536870913;if(J!==j.lane?(He&J)===J:(_s&J)===J){var H=j.revertLane;if(H===0)R!==null&&(R=R.next={lane:0,revertLane:0,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null}),J===ul&&($=!0);else if((_s&H)===H){j=j.next,H===ul&&($=!0);continue}else J={lane:0,revertLane:j.revertLane,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null},R===null?(b=R=J,w=g):R=R.next=J,Oe.lanes|=H,Is|=H;J=j.action,Ka&&l(g,J),g=j.hasEagerState?j.eagerState:l(g,J)}else H={lane:J,revertLane:j.revertLane,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null},R===null?(b=R=H,w=g):R=R.next=H,Oe.lanes|=J,Is|=J;j=j.next}while(j!==null&&j!==a);if(R===null?w=g:R.next=b,!Gn(g,r.memoizedState)&&(en=!0,$&&(l=cl,l!==null)))throw l;r.memoizedState=g,r.baseState=w,r.baseQueue=R,c.lastRenderedState=g}return m===null&&(c.lanes=0),[r.memoizedState,c.dispatch]}function __(r){var a=Bt(),l=a.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=r;var c=l.dispatch,m=l.pending,g=a.memoizedState;if(m!==null){l.pending=null;var w=m=m.next;do g=r(g,w.action),w=w.next;while(w!==m);Gn(g,a.memoizedState)||(en=!0),a.memoizedState=g,a.baseQueue===null&&(a.baseState=g),l.lastRenderedState=g}return[g,c]}function Ww(r,a,l){var c=Oe,m=Bt(),g=$e;if(g){if(l===void 0)throw Error(i(407));l=l()}else l=a();var w=!Gn((ot||m).memoizedState,l);w&&(m.memoizedState=l,en=!0),m=m.queue;var b=Jw.bind(null,c,m,r);if(Sc(2048,8,b,[r]),m.getSnapshot!==a||w||Ft!==null&&Ft.memoizedState.tag&1){if(c.flags|=2048,ml(9,Ef(),Xw.bind(null,c,m,l,a),null),ft===null)throw Error(i(349));g||(_s&124)!==0||$w(c,a,l)}return l}function $w(r,a,l){r.flags|=16384,r={getSnapshot:a,value:l},a=Oe.updateQueue,a===null?(a=m_(),Oe.updateQueue=a,a.stores=[r]):(l=a.stores,l===null?a.stores=[r]:l.push(r))}function Xw(r,a,l,c){a.value=l,a.getSnapshot=c,Zw(a)&&e0(r)}function Jw(r,a,l){return l(function(){Zw(a)&&e0(r)})}function Zw(r){var a=r.getSnapshot;r=r.value;try{var l=a();return!Gn(r,l)}catch{return!0}}function e0(r){var a=sl(r,2);a!==null&&Xn(a,r,2)}function y_(r){var a=Mn();if(typeof r=="function"){var l=r;if(r=l(),Ka){jn(!0);try{l()}finally{jn(!1)}}}return a.memoizedState=a.baseState=r,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Nr,lastRenderedState:r},a}function t0(r,a,l,c){return r.baseState=l,g_(r,ot,typeof c=="function"?c:Nr)}function Ux(r,a,l,c,m){if(wf(r))throw Error(i(485));if(r=a.action,r!==null){var g={payload:m,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){g.listeners.push(w)}};W.T!==null?l(!0):g.isTransition=!1,c(g),l=a.pending,l===null?(g.next=a.pending=g,n0(a,g)):(g.next=l.next,a.pending=l.next=g)}}function n0(r,a){var l=a.action,c=a.payload,m=r.state;if(a.isTransition){var g=W.T,w={};W.T=w;try{var b=l(m,c),R=W.S;R!==null&&R(w,b),i0(r,a,b)}catch(j){v_(r,a,j)}finally{W.T=g}}else try{g=l(m,c),i0(r,a,g)}catch(j){v_(r,a,j)}}function i0(r,a,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(c){r0(r,a,c)},function(c){return v_(r,a,c)}):r0(r,a,l)}function r0(r,a,l){a.status="fulfilled",a.value=l,s0(a),r.state=l,a=r.pending,a!==null&&(l=a.next,l===a?r.pending=null:(l=l.next,a.next=l,n0(r,l)))}function v_(r,a,l){var c=r.pending;if(r.pending=null,c!==null){c=c.next;do a.status="rejected",a.reason=l,s0(a),a=a.next;while(a!==c)}r.action=null}function s0(r){r=r.listeners;for(var a=0;a<r.length;a++)(0,r[a])()}function a0(r,a){return a}function o0(r,a){if($e){var l=ft.formState;if(l!==null){e:{var c=Oe;if($e){if(Rt){t:{for(var m=Rt,g=$i;m.nodeType!==8;){if(!g){m=null;break t}if(m=Oi(m.nextSibling),m===null){m=null;break t}}g=m.data,m=g==="F!"||g==="F"?m:null}if(m){Rt=Oi(m.nextSibling),c=m.data==="F!";break e}}qa(c)}c=!1}c&&(a=l[0])}}return l=Mn(),l.memoizedState=l.baseState=a,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a0,lastRenderedState:a},l.queue=c,l=A0.bind(null,Oe,c),c.dispatch=l,c=y_(!1),g=I_.bind(null,Oe,!1,c.queue),c=Mn(),m={state:a,dispatch:null,action:r,pending:null},c.queue=m,l=Ux.bind(null,Oe,m,g,l),m.dispatch=l,c.memoizedState=r,[a,l,!1]}function l0(r){var a=Bt();return u0(a,ot,r)}function u0(r,a,l){if(a=g_(r,a,a0)[0],r=vf(Nr)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var c=Ic(a)}catch(w){throw w===yc?ff:w}else c=a;a=Bt();var m=a.queue,g=m.dispatch;return l!==a.memoizedState&&(Oe.flags|=2048,ml(9,Ef(),Fx.bind(null,m,l),null)),[c,g,r]}function Fx(r,a){r.action=a}function c0(r){var a=Bt(),l=ot;if(l!==null)return u0(a,l,r);Bt(),a=a.memoizedState,l=Bt();var c=l.queue.dispatch;return l.memoizedState=r,[a,c,!1]}function ml(r,a,l,c){return r={tag:r,create:l,deps:c,inst:a,next:null},a=Oe.updateQueue,a===null&&(a=m_(),Oe.updateQueue=a),l=a.lastEffect,l===null?a.lastEffect=r.next=r:(c=l.next,l.next=r,r.next=c,a.lastEffect=r),r}function Ef(){return{destroy:void 0,resource:void 0}}function h0(){return Bt().memoizedState}function Tf(r,a,l,c){var m=Mn();c=c===void 0?null:c,Oe.flags|=r,m.memoizedState=ml(1|a,Ef(),l,c)}function Sc(r,a,l,c){var m=Bt();c=c===void 0?null:c;var g=m.memoizedState.inst;ot!==null&&c!==null&&u_(c,ot.memoizedState.deps)?m.memoizedState=ml(a,g,l,c):(Oe.flags|=r,m.memoizedState=ml(1|a,g,l,c))}function d0(r,a){Tf(8390656,8,r,a)}function f0(r,a){Sc(2048,8,r,a)}function m0(r,a){return Sc(4,2,r,a)}function p0(r,a){return Sc(4,4,r,a)}function g0(r,a){if(typeof a=="function"){r=r();var l=a(r);return function(){typeof l=="function"?l():a(null)}}if(a!=null)return r=r(),a.current=r,function(){a.current=null}}function _0(r,a,l){l=l!=null?l.concat([r]):null,Sc(4,4,g0.bind(null,a,r),l)}function E_(){}function y0(r,a){var l=Bt();a=a===void 0?null:a;var c=l.memoizedState;return a!==null&&u_(a,c[1])?c[0]:(l.memoizedState=[r,a],r)}function v0(r,a){var l=Bt();a=a===void 0?null:a;var c=l.memoizedState;if(a!==null&&u_(a,c[1]))return c[0];if(c=r(),Ka){jn(!0);try{r()}finally{jn(!1)}}return l.memoizedState=[c,a],c}function T_(r,a,l){return l===void 0||(_s&1073741824)!==0?r.memoizedState=a:(r.memoizedState=l,r=wb(),Oe.lanes|=r,Is|=r,l)}function E0(r,a,l,c){return Gn(l,a)?l:hl.current!==null?(r=T_(r,l,c),Gn(r,a)||(en=!0),r):(_s&42)===0?(en=!0,r.memoizedState=l):(r=wb(),Oe.lanes|=r,Is|=r,a)}function T0(r,a,l,c,m){var g=ce.p;ce.p=g!==0&&8>g?g:8;var w=W.T,b={};W.T=b,I_(r,!1,a,l);try{var R=m(),j=W.S;if(j!==null&&j(b,R),R!==null&&typeof R=="object"&&typeof R.then=="function"){var $=Mx(R,c);Ac(r,a,$,$n(r))}else Ac(r,a,c,$n(r))}catch(J){Ac(r,a,{then:function(){},status:"rejected",reason:J},$n())}finally{ce.p=g,W.T=w}}function Bx(){}function w_(r,a,l,c){if(r.tag!==5)throw Error(i(476));var m=w0(r).queue;T0(r,m,a,ve,l===null?Bx:function(){return b0(r),l(c)})}function w0(r){var a=r.memoizedState;if(a!==null)return a;a={memoizedState:ve,baseState:ve,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Nr,lastRenderedState:ve},next:null};var l={};return a.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Nr,lastRenderedState:l},next:null},r.memoizedState=a,r=r.alternate,r!==null&&(r.memoizedState=a),a}function b0(r){var a=w0(r).next.queue;Ac(r,a,{},$n())}function b_(){return pn(Hc)}function I0(){return Bt().memoizedState}function S0(){return Bt().memoizedState}function zx(r){for(var a=r.return;a!==null;){switch(a.tag){case 24:case 3:var l=$n();r=ps(l);var c=gs(a,r,l);c!==null&&(Xn(c,a,l),Ec(c,a,l)),a={cache:Zg()},r.payload=a;return}a=a.return}}function qx(r,a,l){var c=$n();l={lane:c,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},wf(r)?R0(a,l):(l=jg(r,a,l,c),l!==null&&(Xn(l,r,c),C0(l,a,c)))}function A0(r,a,l){var c=$n();Ac(r,a,l,c)}function Ac(r,a,l,c){var m={lane:c,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(wf(r))R0(a,m);else{var g=r.alternate;if(r.lanes===0&&(g===null||g.lanes===0)&&(g=a.lastRenderedReducer,g!==null))try{var w=a.lastRenderedState,b=g(w,l);if(m.hasEagerState=!0,m.eagerState=b,Gn(b,w))return sf(r,a,m,0),ft===null&&rf(),!1}catch{}finally{}if(l=jg(r,a,m,c),l!==null)return Xn(l,r,c),C0(l,a,c),!0}return!1}function I_(r,a,l,c){if(c={lane:2,revertLane:ny(),action:c,hasEagerState:!1,eagerState:null,next:null},wf(r)){if(a)throw Error(i(479))}else a=jg(r,l,c,2),a!==null&&Xn(a,r,2)}function wf(r){var a=r.alternate;return r===Oe||a!==null&&a===Oe}function R0(r,a){dl=gf=!0;var l=r.pending;l===null?a.next=a:(a.next=l.next,l.next=a),r.pending=a}function C0(r,a,l){if((l&4194048)!==0){var c=a.lanes;c&=r.pendingLanes,l|=c,a.lanes=l,Qu(r,l)}}var bf={readContext:pn,use:yf,useCallback:Ot,useContext:Ot,useEffect:Ot,useImperativeHandle:Ot,useLayoutEffect:Ot,useInsertionEffect:Ot,useMemo:Ot,useReducer:Ot,useRef:Ot,useState:Ot,useDebugValue:Ot,useDeferredValue:Ot,useTransition:Ot,useSyncExternalStore:Ot,useId:Ot,useHostTransitionStatus:Ot,useFormState:Ot,useActionState:Ot,useOptimistic:Ot,useMemoCache:Ot,useCacheRefresh:Ot},D0={readContext:pn,use:yf,useCallback:function(r,a){return Mn().memoizedState=[r,a===void 0?null:a],r},useContext:pn,useEffect:d0,useImperativeHandle:function(r,a,l){l=l!=null?l.concat([r]):null,Tf(4194308,4,g0.bind(null,a,r),l)},useLayoutEffect:function(r,a){return Tf(4194308,4,r,a)},useInsertionEffect:function(r,a){Tf(4,2,r,a)},useMemo:function(r,a){var l=Mn();a=a===void 0?null:a;var c=r();if(Ka){jn(!0);try{r()}finally{jn(!1)}}return l.memoizedState=[c,a],c},useReducer:function(r,a,l){var c=Mn();if(l!==void 0){var m=l(a);if(Ka){jn(!0);try{l(a)}finally{jn(!1)}}}else m=a;return c.memoizedState=c.baseState=m,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:m},c.queue=r,r=r.dispatch=qx.bind(null,Oe,r),[c.memoizedState,r]},useRef:function(r){var a=Mn();return r={current:r},a.memoizedState=r},useState:function(r){r=y_(r);var a=r.queue,l=A0.bind(null,Oe,a);return a.dispatch=l,[r.memoizedState,l]},useDebugValue:E_,useDeferredValue:function(r,a){var l=Mn();return T_(l,r,a)},useTransition:function(){var r=y_(!1);return r=T0.bind(null,Oe,r.queue,!0,!1),Mn().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,a,l){var c=Oe,m=Mn();if($e){if(l===void 0)throw Error(i(407));l=l()}else{if(l=a(),ft===null)throw Error(i(349));(He&124)!==0||$w(c,a,l)}m.memoizedState=l;var g={value:l,getSnapshot:a};return m.queue=g,d0(Jw.bind(null,c,g,r),[r]),c.flags|=2048,ml(9,Ef(),Xw.bind(null,c,g,l,a),null),l},useId:function(){var r=Mn(),a=ft.identifierPrefix;if($e){var l=Rr,c=Ar;l=(c&~(1<<32-mn(c)-1)).toString(32)+l,a="«"+a+"R"+l,l=_f++,0<l&&(a+="H"+l.toString(32)),a+="»"}else l=Vx++,a="«"+a+"r"+l.toString(32)+"»";return r.memoizedState=a},useHostTransitionStatus:b_,useFormState:o0,useActionState:o0,useOptimistic:function(r){var a=Mn();a.memoizedState=a.baseState=r;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=l,a=I_.bind(null,Oe,!0,l),l.dispatch=a,[r,a]},useMemoCache:p_,useCacheRefresh:function(){return Mn().memoizedState=zx.bind(null,Oe)}},N0={readContext:pn,use:yf,useCallback:y0,useContext:pn,useEffect:f0,useImperativeHandle:_0,useInsertionEffect:m0,useLayoutEffect:p0,useMemo:v0,useReducer:vf,useRef:h0,useState:function(){return vf(Nr)},useDebugValue:E_,useDeferredValue:function(r,a){var l=Bt();return E0(l,ot.memoizedState,r,a)},useTransition:function(){var r=vf(Nr)[0],a=Bt().memoizedState;return[typeof r=="boolean"?r:Ic(r),a]},useSyncExternalStore:Ww,useId:I0,useHostTransitionStatus:b_,useFormState:l0,useActionState:l0,useOptimistic:function(r,a){var l=Bt();return t0(l,ot,r,a)},useMemoCache:p_,useCacheRefresh:S0},jx={readContext:pn,use:yf,useCallback:y0,useContext:pn,useEffect:f0,useImperativeHandle:_0,useInsertionEffect:m0,useLayoutEffect:p0,useMemo:v0,useReducer:__,useRef:h0,useState:function(){return __(Nr)},useDebugValue:E_,useDeferredValue:function(r,a){var l=Bt();return ot===null?T_(l,r,a):E0(l,ot.memoizedState,r,a)},useTransition:function(){var r=__(Nr)[0],a=Bt().memoizedState;return[typeof r=="boolean"?r:Ic(r),a]},useSyncExternalStore:Ww,useId:I0,useHostTransitionStatus:b_,useFormState:c0,useActionState:c0,useOptimistic:function(r,a){var l=Bt();return ot!==null?t0(l,ot,r,a):(l.baseState=r,[r,l.queue.dispatch])},useMemoCache:p_,useCacheRefresh:S0},pl=null,Rc=0;function If(r){var a=Rc;return Rc+=1,pl===null&&(pl=[]),zw(pl,r,a)}function Cc(r,a){a=a.props.ref,r.ref=a!==void 0?a:null}function Sf(r,a){throw a.$$typeof===v?Error(i(525)):(r=Object.prototype.toString.call(a),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":r)))}function O0(r){var a=r._init;return a(r._payload)}function x0(r){function a(L,k){if(r){var q=L.deletions;q===null?(L.deletions=[k],L.flags|=16):q.push(k)}}function l(L,k){if(!r)return null;for(;k!==null;)a(L,k),k=k.sibling;return null}function c(L){for(var k=new Map;L!==null;)L.key!==null?k.set(L.key,L):k.set(L.index,L),L=L.sibling;return k}function m(L,k){return L=Sr(L,k),L.index=0,L.sibling=null,L}function g(L,k,q){return L.index=q,r?(q=L.alternate,q!==null?(q=q.index,q<k?(L.flags|=67108866,k):q):(L.flags|=67108866,k)):(L.flags|=1048576,k)}function w(L){return r&&L.alternate===null&&(L.flags|=67108866),L}function b(L,k,q,X){return k===null||k.tag!==6?(k=Gg(q,L.mode,X),k.return=L,k):(k=m(k,q),k.return=L,k)}function R(L,k,q,X){var pe=q.type;return pe===N?$(L,k,q.props.children,X,q.key):k!==null&&(k.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===A&&O0(pe)===k.type)?(k=m(k,q.props),Cc(k,q),k.return=L,k):(k=of(q.type,q.key,q.props,null,L.mode,X),Cc(k,q),k.return=L,k)}function j(L,k,q,X){return k===null||k.tag!==4||k.stateNode.containerInfo!==q.containerInfo||k.stateNode.implementation!==q.implementation?(k=Kg(q,L.mode,X),k.return=L,k):(k=m(k,q.children||[]),k.return=L,k)}function $(L,k,q,X,pe){return k===null||k.tag!==7?(k=Ua(q,L.mode,X,pe),k.return=L,k):(k=m(k,q),k.return=L,k)}function J(L,k,q){if(typeof k=="string"&&k!==""||typeof k=="number"||typeof k=="bigint")return k=Gg(""+k,L.mode,q),k.return=L,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case T:return q=of(k.type,k.key,k.props,null,L.mode,q),Cc(q,k),q.return=L,q;case S:return k=Kg(k,L.mode,q),k.return=L,k;case A:var X=k._init;return k=X(k._payload),J(L,k,q)}if(St(k)||F(k))return k=Ua(k,L.mode,q,null),k.return=L,k;if(typeof k.then=="function")return J(L,If(k),q);if(k.$$typeof===Y)return J(L,hf(L,k),q);Sf(L,k)}return null}function H(L,k,q,X){var pe=k!==null?k.key:null;if(typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint")return pe!==null?null:b(L,k,""+q,X);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case T:return q.key===pe?R(L,k,q,X):null;case S:return q.key===pe?j(L,k,q,X):null;case A:return pe=q._init,q=pe(q._payload),H(L,k,q,X)}if(St(q)||F(q))return pe!==null?null:$(L,k,q,X,null);if(typeof q.then=="function")return H(L,k,If(q),X);if(q.$$typeof===Y)return H(L,k,hf(L,q),X);Sf(L,q)}return null}function G(L,k,q,X,pe){if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return L=L.get(q)||null,b(k,L,""+X,pe);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case T:return L=L.get(X.key===null?q:X.key)||null,R(k,L,X,pe);case S:return L=L.get(X.key===null?q:X.key)||null,j(k,L,X,pe);case A:var Me=X._init;return X=Me(X._payload),G(L,k,q,X,pe)}if(St(X)||F(X))return L=L.get(q)||null,$(k,L,X,pe,null);if(typeof X.then=="function")return G(L,k,q,If(X),pe);if(X.$$typeof===Y)return G(L,k,q,hf(k,X),pe);Sf(k,X)}return null}function Re(L,k,q,X){for(var pe=null,Me=null,ye=k,be=k=0,nn=null;ye!==null&&be<q.length;be++){ye.index>be?(nn=ye,ye=null):nn=ye.sibling;var Ye=H(L,ye,q[be],X);if(Ye===null){ye===null&&(ye=nn);break}r&&ye&&Ye.alternate===null&&a(L,ye),k=g(Ye,k,be),Me===null?pe=Ye:Me.sibling=Ye,Me=Ye,ye=nn}if(be===q.length)return l(L,ye),$e&&Ba(L,be),pe;if(ye===null){for(;be<q.length;be++)ye=J(L,q[be],X),ye!==null&&(k=g(ye,k,be),Me===null?pe=ye:Me.sibling=ye,Me=ye);return $e&&Ba(L,be),pe}for(ye=c(ye);be<q.length;be++)nn=G(ye,L,be,q[be],X),nn!==null&&(r&&nn.alternate!==null&&ye.delete(nn.key===null?be:nn.key),k=g(nn,k,be),Me===null?pe=nn:Me.sibling=nn,Me=nn);return r&&ye.forEach(function(Ps){return a(L,Ps)}),$e&&Ba(L,be),pe}function we(L,k,q,X){if(q==null)throw Error(i(151));for(var pe=null,Me=null,ye=k,be=k=0,nn=null,Ye=q.next();ye!==null&&!Ye.done;be++,Ye=q.next()){ye.index>be?(nn=ye,ye=null):nn=ye.sibling;var Ps=H(L,ye,Ye.value,X);if(Ps===null){ye===null&&(ye=nn);break}r&&ye&&Ps.alternate===null&&a(L,ye),k=g(Ps,k,be),Me===null?pe=Ps:Me.sibling=Ps,Me=Ps,ye=nn}if(Ye.done)return l(L,ye),$e&&Ba(L,be),pe;if(ye===null){for(;!Ye.done;be++,Ye=q.next())Ye=J(L,Ye.value,X),Ye!==null&&(k=g(Ye,k,be),Me===null?pe=Ye:Me.sibling=Ye,Me=Ye);return $e&&Ba(L,be),pe}for(ye=c(ye);!Ye.done;be++,Ye=q.next())Ye=G(ye,L,be,Ye.value,X),Ye!==null&&(r&&Ye.alternate!==null&&ye.delete(Ye.key===null?be:Ye.key),k=g(Ye,k,be),Me===null?pe=Ye:Me.sibling=Ye,Me=Ye);return r&&ye.forEach(function(HP){return a(L,HP)}),$e&&Ba(L,be),pe}function ut(L,k,q,X){if(typeof q=="object"&&q!==null&&q.type===N&&q.key===null&&(q=q.props.children),typeof q=="object"&&q!==null){switch(q.$$typeof){case T:e:{for(var pe=q.key;k!==null;){if(k.key===pe){if(pe=q.type,pe===N){if(k.tag===7){l(L,k.sibling),X=m(k,q.props.children),X.return=L,L=X;break e}}else if(k.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===A&&O0(pe)===k.type){l(L,k.sibling),X=m(k,q.props),Cc(X,q),X.return=L,L=X;break e}l(L,k);break}else a(L,k);k=k.sibling}q.type===N?(X=Ua(q.props.children,L.mode,X,q.key),X.return=L,L=X):(X=of(q.type,q.key,q.props,null,L.mode,X),Cc(X,q),X.return=L,L=X)}return w(L);case S:e:{for(pe=q.key;k!==null;){if(k.key===pe)if(k.tag===4&&k.stateNode.containerInfo===q.containerInfo&&k.stateNode.implementation===q.implementation){l(L,k.sibling),X=m(k,q.children||[]),X.return=L,L=X;break e}else{l(L,k);break}else a(L,k);k=k.sibling}X=Kg(q,L.mode,X),X.return=L,L=X}return w(L);case A:return pe=q._init,q=pe(q._payload),ut(L,k,q,X)}if(St(q))return Re(L,k,q,X);if(F(q)){if(pe=F(q),typeof pe!="function")throw Error(i(150));return q=pe.call(q),we(L,k,q,X)}if(typeof q.then=="function")return ut(L,k,If(q),X);if(q.$$typeof===Y)return ut(L,k,hf(L,q),X);Sf(L,q)}return typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint"?(q=""+q,k!==null&&k.tag===6?(l(L,k.sibling),X=m(k,q),X.return=L,L=X):(l(L,k),X=Gg(q,L.mode,X),X.return=L,L=X),w(L)):l(L,k)}return function(L,k,q,X){try{Rc=0;var pe=ut(L,k,q,X);return pl=null,pe}catch(ye){if(ye===yc||ye===ff)throw ye;var Me=Kn(29,ye,null,L.mode);return Me.lanes=X,Me.return=L,Me}finally{}}}var gl=x0(!0),P0=x0(!1),gi=te(null),Xi=null;function ys(r){var a=r.alternate;re(Kt,Kt.current&1),re(gi,r),Xi===null&&(a===null||hl.current!==null||a.memoizedState!==null)&&(Xi=r)}function k0(r){if(r.tag===22){if(re(Kt,Kt.current),re(gi,r),Xi===null){var a=r.alternate;a!==null&&a.memoizedState!==null&&(Xi=r)}}else vs()}function vs(){re(Kt,Kt.current),re(gi,gi.current)}function Or(r){he(gi),Xi===r&&(Xi=null),he(Kt)}var Kt=te(0);function Af(r){for(var a=r;a!==null;){if(a.tag===13){var l=a.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||my(l)))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}function S_(r,a,l,c){a=r.memoizedState,l=l(c,a),l=l==null?a:_({},a,l),r.memoizedState=l,r.lanes===0&&(r.updateQueue.baseState=l)}var A_={enqueueSetState:function(r,a,l){r=r._reactInternals;var c=$n(),m=ps(c);m.payload=a,l!=null&&(m.callback=l),a=gs(r,m,c),a!==null&&(Xn(a,r,c),Ec(a,r,c))},enqueueReplaceState:function(r,a,l){r=r._reactInternals;var c=$n(),m=ps(c);m.tag=1,m.payload=a,l!=null&&(m.callback=l),a=gs(r,m,c),a!==null&&(Xn(a,r,c),Ec(a,r,c))},enqueueForceUpdate:function(r,a){r=r._reactInternals;var l=$n(),c=ps(l);c.tag=2,a!=null&&(c.callback=a),a=gs(r,c,l),a!==null&&(Xn(a,r,l),Ec(a,r,l))}};function M0(r,a,l,c,m,g,w){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(c,g,w):a.prototype&&a.prototype.isPureReactComponent?!cc(l,c)||!cc(m,g):!0}function V0(r,a,l,c){r=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(l,c),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(l,c),a.state!==r&&A_.enqueueReplaceState(a,a.state,null)}function Ya(r,a){var l=a;if("ref"in a){l={};for(var c in a)c!=="ref"&&(l[c]=a[c])}if(r=r.defaultProps){l===a&&(l=_({},l));for(var m in r)l[m]===void 0&&(l[m]=r[m])}return l}var Rf=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)};function L0(r){Rf(r)}function U0(r){console.error(r)}function F0(r){Rf(r)}function Cf(r,a){try{var l=r.onUncaughtError;l(a.value,{componentStack:a.stack})}catch(c){setTimeout(function(){throw c})}}function B0(r,a,l){try{var c=r.onCaughtError;c(l.value,{componentStack:l.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function R_(r,a,l){return l=ps(l),l.tag=3,l.payload={element:null},l.callback=function(){Cf(r,a)},l}function z0(r){return r=ps(r),r.tag=3,r}function q0(r,a,l,c){var m=l.type.getDerivedStateFromError;if(typeof m=="function"){var g=c.value;r.payload=function(){return m(g)},r.callback=function(){B0(a,l,c)}}var w=l.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(r.callback=function(){B0(a,l,c),typeof m!="function"&&(Ss===null?Ss=new Set([this]):Ss.add(this));var b=c.stack;this.componentDidCatch(c.value,{componentStack:b!==null?b:""})})}function Hx(r,a,l,c,m){if(l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(a=l.alternate,a!==null&&pc(a,l,m,!0),l=gi.current,l!==null){switch(l.tag){case 13:return Xi===null?X_():l.alternate===null&&Ct===0&&(Ct=3),l.flags&=-257,l.flags|=65536,l.lanes=m,c===n_?l.flags|=16384:(a=l.updateQueue,a===null?l.updateQueue=new Set([c]):a.add(c),Z_(r,c,m)),!1;case 22:return l.flags|=65536,c===n_?l.flags|=16384:(a=l.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([c])},l.updateQueue=a):(l=a.retryQueue,l===null?a.retryQueue=new Set([c]):l.add(c)),Z_(r,c,m)),!1}throw Error(i(435,l.tag))}return Z_(r,c,m),X_(),!1}if($e)return a=gi.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=m,c!==Wg&&(r=Error(i(422),{cause:c}),mc(di(r,l)))):(c!==Wg&&(a=Error(i(423),{cause:c}),mc(di(a,l))),r=r.current.alternate,r.flags|=65536,m&=-m,r.lanes|=m,c=di(c,l),m=R_(r.stateNode,c,m),s_(r,m),Ct!==4&&(Ct=2)),!1;var g=Error(i(520),{cause:c});if(g=di(g,l),Mc===null?Mc=[g]:Mc.push(g),Ct!==4&&(Ct=2),a===null)return!0;c=di(c,l),l=a;do{switch(l.tag){case 3:return l.flags|=65536,r=m&-m,l.lanes|=r,r=R_(l.stateNode,c,r),s_(l,r),!1;case 1:if(a=l.type,g=l.stateNode,(l.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Ss===null||!Ss.has(g))))return l.flags|=65536,m&=-m,l.lanes|=m,m=z0(m),q0(m,r,l,c),s_(l,m),!1}l=l.return}while(l!==null);return!1}var j0=Error(i(461)),en=!1;function un(r,a,l,c){a.child=r===null?P0(a,null,l,c):gl(a,r.child,l,c)}function H0(r,a,l,c,m){l=l.render;var g=a.ref;if("ref"in c){var w={};for(var b in c)b!=="ref"&&(w[b]=c[b])}else w=c;return Ha(a),c=c_(r,a,l,w,g,m),b=h_(),r!==null&&!en?(d_(r,a,m),xr(r,a,m)):($e&&b&&Yg(a),a.flags|=1,un(r,a,c,m),a.child)}function G0(r,a,l,c,m){if(r===null){var g=l.type;return typeof g=="function"&&!Hg(g)&&g.defaultProps===void 0&&l.compare===null?(a.tag=15,a.type=g,K0(r,a,g,c,m)):(r=of(l.type,null,c,a,a.mode,m),r.ref=a.ref,r.return=a,a.child=r)}if(g=r.child,!M_(r,m)){var w=g.memoizedProps;if(l=l.compare,l=l!==null?l:cc,l(w,c)&&r.ref===a.ref)return xr(r,a,m)}return a.flags|=1,r=Sr(g,c),r.ref=a.ref,r.return=a,a.child=r}function K0(r,a,l,c,m){if(r!==null){var g=r.memoizedProps;if(cc(g,c)&&r.ref===a.ref)if(en=!1,a.pendingProps=c=g,M_(r,m))(r.flags&131072)!==0&&(en=!0);else return a.lanes=r.lanes,xr(r,a,m)}return C_(r,a,l,c,m)}function Y0(r,a,l){var c=a.pendingProps,m=c.children,g=r!==null?r.memoizedState:null;if(c.mode==="hidden"){if((a.flags&128)!==0){if(c=g!==null?g.baseLanes|l:l,r!==null){for(m=a.child=r.child,g=0;m!==null;)g=g|m.lanes|m.childLanes,m=m.sibling;a.childLanes=g&~c}else a.childLanes=0,a.child=null;return Q0(r,a,c,l)}if((l&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},r!==null&&df(a,g!==null?g.cachePool:null),g!==null?Kw(a,g):o_(),k0(a);else return a.lanes=a.childLanes=536870912,Q0(r,a,g!==null?g.baseLanes|l:l,l)}else g!==null?(df(a,g.cachePool),Kw(a,g),vs(),a.memoizedState=null):(r!==null&&df(a,null),o_(),vs());return un(r,a,m,l),a.child}function Q0(r,a,l,c){var m=t_();return m=m===null?null:{parent:Gt._currentValue,pool:m},a.memoizedState={baseLanes:l,cachePool:m},r!==null&&df(a,null),o_(),k0(a),r!==null&&pc(r,a,c,!0),null}function Df(r,a){var l=a.ref;if(l===null)r!==null&&r.ref!==null&&(a.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(r===null||r.ref!==l)&&(a.flags|=4194816)}}function C_(r,a,l,c,m){return Ha(a),l=c_(r,a,l,c,void 0,m),c=h_(),r!==null&&!en?(d_(r,a,m),xr(r,a,m)):($e&&c&&Yg(a),a.flags|=1,un(r,a,l,m),a.child)}function W0(r,a,l,c,m,g){return Ha(a),a.updateQueue=null,l=Qw(a,c,l,m),Yw(r),c=h_(),r!==null&&!en?(d_(r,a,g),xr(r,a,g)):($e&&c&&Yg(a),a.flags|=1,un(r,a,l,g),a.child)}function $0(r,a,l,c,m){if(Ha(a),a.stateNode===null){var g=al,w=l.contextType;typeof w=="object"&&w!==null&&(g=pn(w)),g=new l(c,g),a.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=A_,a.stateNode=g,g._reactInternals=a,g=a.stateNode,g.props=c,g.state=a.memoizedState,g.refs={},i_(a),w=l.contextType,g.context=typeof w=="object"&&w!==null?pn(w):al,g.state=a.memoizedState,w=l.getDerivedStateFromProps,typeof w=="function"&&(S_(a,l,w,c),g.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(w=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),w!==g.state&&A_.enqueueReplaceState(g,g.state,null),wc(a,c,g,m),Tc(),g.state=a.memoizedState),typeof g.componentDidMount=="function"&&(a.flags|=4194308),c=!0}else if(r===null){g=a.stateNode;var b=a.memoizedProps,R=Ya(l,b);g.props=R;var j=g.context,$=l.contextType;w=al,typeof $=="object"&&$!==null&&(w=pn($));var J=l.getDerivedStateFromProps;$=typeof J=="function"||typeof g.getSnapshotBeforeUpdate=="function",b=a.pendingProps!==b,$||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(b||j!==w)&&V0(a,g,c,w),ms=!1;var H=a.memoizedState;g.state=H,wc(a,c,g,m),Tc(),j=a.memoizedState,b||H!==j||ms?(typeof J=="function"&&(S_(a,l,J,c),j=a.memoizedState),(R=ms||M0(a,l,R,c,H,j,w))?($||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(a.flags|=4194308)):(typeof g.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=c,a.memoizedState=j),g.props=c,g.state=j,g.context=w,c=R):(typeof g.componentDidMount=="function"&&(a.flags|=4194308),c=!1)}else{g=a.stateNode,r_(r,a),w=a.memoizedProps,$=Ya(l,w),g.props=$,J=a.pendingProps,H=g.context,j=l.contextType,R=al,typeof j=="object"&&j!==null&&(R=pn(j)),b=l.getDerivedStateFromProps,(j=typeof b=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(w!==J||H!==R)&&V0(a,g,c,R),ms=!1,H=a.memoizedState,g.state=H,wc(a,c,g,m),Tc();var G=a.memoizedState;w!==J||H!==G||ms||r!==null&&r.dependencies!==null&&cf(r.dependencies)?(typeof b=="function"&&(S_(a,l,b,c),G=a.memoizedState),($=ms||M0(a,l,$,c,H,G,R)||r!==null&&r.dependencies!==null&&cf(r.dependencies))?(j||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(c,G,R),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(c,G,R)),typeof g.componentDidUpdate=="function"&&(a.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof g.componentDidUpdate!="function"||w===r.memoizedProps&&H===r.memoizedState||(a.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||w===r.memoizedProps&&H===r.memoizedState||(a.flags|=1024),a.memoizedProps=c,a.memoizedState=G),g.props=c,g.state=G,g.context=R,c=$):(typeof g.componentDidUpdate!="function"||w===r.memoizedProps&&H===r.memoizedState||(a.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||w===r.memoizedProps&&H===r.memoizedState||(a.flags|=1024),c=!1)}return g=c,Df(r,a),c=(a.flags&128)!==0,g||c?(g=a.stateNode,l=c&&typeof l.getDerivedStateFromError!="function"?null:g.render(),a.flags|=1,r!==null&&c?(a.child=gl(a,r.child,null,m),a.child=gl(a,null,l,m)):un(r,a,l,m),a.memoizedState=g.state,r=a.child):r=xr(r,a,m),r}function X0(r,a,l,c){return fc(),a.flags|=256,un(r,a,l,c),a.child}var D_={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function N_(r){return{baseLanes:r,cachePool:Uw()}}function O_(r,a,l){return r=r!==null?r.childLanes&~l:0,a&&(r|=_i),r}function J0(r,a,l){var c=a.pendingProps,m=!1,g=(a.flags&128)!==0,w;if((w=g)||(w=r!==null&&r.memoizedState===null?!1:(Kt.current&2)!==0),w&&(m=!0,a.flags&=-129),w=(a.flags&32)!==0,a.flags&=-33,r===null){if($e){if(m?ys(a):vs(),$e){var b=Rt,R;if(R=b){e:{for(R=b,b=$i;R.nodeType!==8;){if(!b){b=null;break e}if(R=Oi(R.nextSibling),R===null){b=null;break e}}b=R}b!==null?(a.memoizedState={dehydrated:b,treeContext:Fa!==null?{id:Ar,overflow:Rr}:null,retryLane:536870912,hydrationErrors:null},R=Kn(18,null,null,0),R.stateNode=b,R.return=a,a.child=R,Cn=a,Rt=null,R=!0):R=!1}R||qa(a)}if(b=a.memoizedState,b!==null&&(b=b.dehydrated,b!==null))return my(b)?a.lanes=32:a.lanes=536870912,null;Or(a)}return b=c.children,c=c.fallback,m?(vs(),m=a.mode,b=Nf({mode:"hidden",children:b},m),c=Ua(c,m,l,null),b.return=a,c.return=a,b.sibling=c,a.child=b,m=a.child,m.memoizedState=N_(l),m.childLanes=O_(r,w,l),a.memoizedState=D_,c):(ys(a),x_(a,b))}if(R=r.memoizedState,R!==null&&(b=R.dehydrated,b!==null)){if(g)a.flags&256?(ys(a),a.flags&=-257,a=P_(r,a,l)):a.memoizedState!==null?(vs(),a.child=r.child,a.flags|=128,a=null):(vs(),m=c.fallback,b=a.mode,c=Nf({mode:"visible",children:c.children},b),m=Ua(m,b,l,null),m.flags|=2,c.return=a,m.return=a,c.sibling=m,a.child=c,gl(a,r.child,null,l),c=a.child,c.memoizedState=N_(l),c.childLanes=O_(r,w,l),a.memoizedState=D_,a=m);else if(ys(a),my(b)){if(w=b.nextSibling&&b.nextSibling.dataset,w)var j=w.dgst;w=j,c=Error(i(419)),c.stack="",c.digest=w,mc({value:c,source:null,stack:null}),a=P_(r,a,l)}else if(en||pc(r,a,l,!1),w=(l&r.childLanes)!==0,en||w){if(w=ft,w!==null&&(c=l&-l,c=(c&42)!==0?1:as(c),c=(c&(w.suspendedLanes|l))!==0?0:c,c!==0&&c!==R.retryLane))throw R.retryLane=c,sl(r,c),Xn(w,r,c),j0;b.data==="$?"||X_(),a=P_(r,a,l)}else b.data==="$?"?(a.flags|=192,a.child=r.child,a=null):(r=R.treeContext,Rt=Oi(b.nextSibling),Cn=a,$e=!0,za=null,$i=!1,r!==null&&(mi[pi++]=Ar,mi[pi++]=Rr,mi[pi++]=Fa,Ar=r.id,Rr=r.overflow,Fa=a),a=x_(a,c.children),a.flags|=4096);return a}return m?(vs(),m=c.fallback,b=a.mode,R=r.child,j=R.sibling,c=Sr(R,{mode:"hidden",children:c.children}),c.subtreeFlags=R.subtreeFlags&65011712,j!==null?m=Sr(j,m):(m=Ua(m,b,l,null),m.flags|=2),m.return=a,c.return=a,c.sibling=m,a.child=c,c=m,m=a.child,b=r.child.memoizedState,b===null?b=N_(l):(R=b.cachePool,R!==null?(j=Gt._currentValue,R=R.parent!==j?{parent:j,pool:j}:R):R=Uw(),b={baseLanes:b.baseLanes|l,cachePool:R}),m.memoizedState=b,m.childLanes=O_(r,w,l),a.memoizedState=D_,c):(ys(a),l=r.child,r=l.sibling,l=Sr(l,{mode:"visible",children:c.children}),l.return=a,l.sibling=null,r!==null&&(w=a.deletions,w===null?(a.deletions=[r],a.flags|=16):w.push(r)),a.child=l,a.memoizedState=null,l)}function x_(r,a){return a=Nf({mode:"visible",children:a},r.mode),a.return=r,r.child=a}function Nf(r,a){return r=Kn(22,r,null,a),r.lanes=0,r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},r}function P_(r,a,l){return gl(a,r.child,null,l),r=x_(a,a.pendingProps.children),r.flags|=2,a.memoizedState=null,r}function Z0(r,a,l){r.lanes|=a;var c=r.alternate;c!==null&&(c.lanes|=a),Xg(r.return,a,l)}function k_(r,a,l,c,m){var g=r.memoizedState;g===null?r.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:c,tail:l,tailMode:m}:(g.isBackwards=a,g.rendering=null,g.renderingStartTime=0,g.last=c,g.tail=l,g.tailMode=m)}function eb(r,a,l){var c=a.pendingProps,m=c.revealOrder,g=c.tail;if(un(r,a,c.children,l),c=Kt.current,(c&2)!==0)c=c&1|2,a.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=a.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Z0(r,l,a);else if(r.tag===19)Z0(r,l,a);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===a)break e;for(;r.sibling===null;){if(r.return===null||r.return===a)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}c&=1}switch(re(Kt,c),m){case"forwards":for(l=a.child,m=null;l!==null;)r=l.alternate,r!==null&&Af(r)===null&&(m=l),l=l.sibling;l=m,l===null?(m=a.child,a.child=null):(m=l.sibling,l.sibling=null),k_(a,!1,m,l,g);break;case"backwards":for(l=null,m=a.child,a.child=null;m!==null;){if(r=m.alternate,r!==null&&Af(r)===null){a.child=m;break}r=m.sibling,m.sibling=l,l=m,m=r}k_(a,!0,l,null,g);break;case"together":k_(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function xr(r,a,l){if(r!==null&&(a.dependencies=r.dependencies),Is|=a.lanes,(l&a.childLanes)===0)if(r!==null){if(pc(r,a,l,!1),(l&a.childLanes)===0)return null}else return null;if(r!==null&&a.child!==r.child)throw Error(i(153));if(a.child!==null){for(r=a.child,l=Sr(r,r.pendingProps),a.child=l,l.return=a;r.sibling!==null;)r=r.sibling,l=l.sibling=Sr(r,r.pendingProps),l.return=a;l.sibling=null}return a.child}function M_(r,a){return(r.lanes&a)!==0?!0:(r=r.dependencies,!!(r!==null&&cf(r)))}function Gx(r,a,l){switch(a.tag){case 3:dt(a,a.stateNode.containerInfo),fs(a,Gt,r.memoizedState.cache),fc();break;case 27:case 5:ss(a);break;case 4:dt(a,a.stateNode.containerInfo);break;case 10:fs(a,a.type,a.memoizedProps.value);break;case 13:var c=a.memoizedState;if(c!==null)return c.dehydrated!==null?(ys(a),a.flags|=128,null):(l&a.child.childLanes)!==0?J0(r,a,l):(ys(a),r=xr(r,a,l),r!==null?r.sibling:null);ys(a);break;case 19:var m=(r.flags&128)!==0;if(c=(l&a.childLanes)!==0,c||(pc(r,a,l,!1),c=(l&a.childLanes)!==0),m){if(c)return eb(r,a,l);a.flags|=128}if(m=a.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),re(Kt,Kt.current),c)break;return null;case 22:case 23:return a.lanes=0,Y0(r,a,l);case 24:fs(a,Gt,r.memoizedState.cache)}return xr(r,a,l)}function tb(r,a,l){if(r!==null)if(r.memoizedProps!==a.pendingProps)en=!0;else{if(!M_(r,l)&&(a.flags&128)===0)return en=!1,Gx(r,a,l);en=(r.flags&131072)!==0}else en=!1,$e&&(a.flags&1048576)!==0&&Ow(a,uf,a.index);switch(a.lanes=0,a.tag){case 16:e:{r=a.pendingProps;var c=a.elementType,m=c._init;if(c=m(c._payload),a.type=c,typeof c=="function")Hg(c)?(r=Ya(c,r),a.tag=1,a=$0(null,a,c,r,l)):(a.tag=0,a=C_(null,a,c,r,l));else{if(c!=null){if(m=c.$$typeof,m===ie){a.tag=11,a=H0(null,a,c,r,l);break e}else if(m===O){a.tag=14,a=G0(null,a,c,r,l);break e}}throw a=an(c)||c,Error(i(306,a,""))}}return a;case 0:return C_(r,a,a.type,a.pendingProps,l);case 1:return c=a.type,m=Ya(c,a.pendingProps),$0(r,a,c,m,l);case 3:e:{if(dt(a,a.stateNode.containerInfo),r===null)throw Error(i(387));c=a.pendingProps;var g=a.memoizedState;m=g.element,r_(r,a),wc(a,c,null,l);var w=a.memoizedState;if(c=w.cache,fs(a,Gt,c),c!==g.cache&&Jg(a,[Gt],l,!0),Tc(),c=w.element,g.isDehydrated)if(g={element:c,isDehydrated:!1,cache:w.cache},a.updateQueue.baseState=g,a.memoizedState=g,a.flags&256){a=X0(r,a,c,l);break e}else if(c!==m){m=di(Error(i(424)),a),mc(m),a=X0(r,a,c,l);break e}else{switch(r=a.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(Rt=Oi(r.firstChild),Cn=a,$e=!0,za=null,$i=!0,l=P0(a,null,c,l),a.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(fc(),c===m){a=xr(r,a,l);break e}un(r,a,c,l)}a=a.child}return a;case 26:return Df(r,a),r===null?(l=sI(a.type,null,a.pendingProps,null))?a.memoizedState=l:$e||(l=a.type,r=a.pendingProps,c=Hf(Ce.current).createElement(l),c[qt]=a,c[Lt]=r,hn(c,l,r),Nt(c),a.stateNode=c):a.memoizedState=sI(a.type,r.memoizedProps,a.pendingProps,r.memoizedState),null;case 27:return ss(a),r===null&&$e&&(c=a.stateNode=nI(a.type,a.pendingProps,Ce.current),Cn=a,$i=!0,m=Rt,Cs(a.type)?(py=m,Rt=Oi(c.firstChild)):Rt=m),un(r,a,a.pendingProps.children,l),Df(r,a),r===null&&(a.flags|=4194304),a.child;case 5:return r===null&&$e&&((m=c=Rt)&&(c=vP(c,a.type,a.pendingProps,$i),c!==null?(a.stateNode=c,Cn=a,Rt=Oi(c.firstChild),$i=!1,m=!0):m=!1),m||qa(a)),ss(a),m=a.type,g=a.pendingProps,w=r!==null?r.memoizedProps:null,c=g.children,hy(m,g)?c=null:w!==null&&hy(m,w)&&(a.flags|=32),a.memoizedState!==null&&(m=c_(r,a,Lx,null,null,l),Hc._currentValue=m),Df(r,a),un(r,a,c,l),a.child;case 6:return r===null&&$e&&((r=l=Rt)&&(l=EP(l,a.pendingProps,$i),l!==null?(a.stateNode=l,Cn=a,Rt=null,r=!0):r=!1),r||qa(a)),null;case 13:return J0(r,a,l);case 4:return dt(a,a.stateNode.containerInfo),c=a.pendingProps,r===null?a.child=gl(a,null,c,l):un(r,a,c,l),a.child;case 11:return H0(r,a,a.type,a.pendingProps,l);case 7:return un(r,a,a.pendingProps,l),a.child;case 8:return un(r,a,a.pendingProps.children,l),a.child;case 12:return un(r,a,a.pendingProps.children,l),a.child;case 10:return c=a.pendingProps,fs(a,a.type,c.value),un(r,a,c.children,l),a.child;case 9:return m=a.type._context,c=a.pendingProps.children,Ha(a),m=pn(m),c=c(m),a.flags|=1,un(r,a,c,l),a.child;case 14:return G0(r,a,a.type,a.pendingProps,l);case 15:return K0(r,a,a.type,a.pendingProps,l);case 19:return eb(r,a,l);case 31:return c=a.pendingProps,l=a.mode,c={mode:c.mode,children:c.children},r===null?(l=Nf(c,l),l.ref=a.ref,a.child=l,l.return=a,a=l):(l=Sr(r.child,c),l.ref=a.ref,a.child=l,l.return=a,a=l),a;case 22:return Y0(r,a,l);case 24:return Ha(a),c=pn(Gt),r===null?(m=t_(),m===null&&(m=ft,g=Zg(),m.pooledCache=g,g.refCount++,g!==null&&(m.pooledCacheLanes|=l),m=g),a.memoizedState={parent:c,cache:m},i_(a),fs(a,Gt,m)):((r.lanes&l)!==0&&(r_(r,a),wc(a,null,null,l),Tc()),m=r.memoizedState,g=a.memoizedState,m.parent!==c?(m={parent:c,cache:c},a.memoizedState=m,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=m),fs(a,Gt,c)):(c=g.cache,fs(a,Gt,c),c!==m.cache&&Jg(a,[Gt],l,!0))),un(r,a,a.pendingProps.children,l),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function Pr(r){r.flags|=4}function nb(r,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!cI(a)){if(a=gi.current,a!==null&&((He&4194048)===He?Xi!==null:(He&62914560)!==He&&(He&536870912)===0||a!==Xi))throw vc=n_,Fw;r.flags|=8192}}function Of(r,a){a!==null&&(r.flags|=4),r.flags&16384&&(a=r.tag!==22?Ku():536870912,r.lanes|=a,El|=a)}function Dc(r,a){if(!$e)switch(r.tailMode){case"hidden":a=r.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?r.tail=null:l.sibling=null;break;case"collapsed":l=r.tail;for(var c=null;l!==null;)l.alternate!==null&&(c=l),l=l.sibling;c===null?a||r.tail===null?r.tail=null:r.tail.sibling=null:c.sibling=null}}function Et(r){var a=r.alternate!==null&&r.alternate.child===r.child,l=0,c=0;if(a)for(var m=r.child;m!==null;)l|=m.lanes|m.childLanes,c|=m.subtreeFlags&65011712,c|=m.flags&65011712,m.return=r,m=m.sibling;else for(m=r.child;m!==null;)l|=m.lanes|m.childLanes,c|=m.subtreeFlags,c|=m.flags,m.return=r,m=m.sibling;return r.subtreeFlags|=c,r.childLanes=l,a}function Kx(r,a,l){var c=a.pendingProps;switch(Qg(a),a.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Et(a),null;case 1:return Et(a),null;case 3:return l=a.stateNode,c=null,r!==null&&(c=r.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),Dr(Gt),Ui(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(r===null||r.child===null)&&(dc(a)?Pr(a):r===null||r.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,kw())),Et(a),null;case 26:return l=a.memoizedState,r===null?(Pr(a),l!==null?(Et(a),nb(a,l)):(Et(a),a.flags&=-16777217)):l?l!==r.memoizedState?(Pr(a),Et(a),nb(a,l)):(Et(a),a.flags&=-16777217):(r.memoizedProps!==c&&Pr(a),Et(a),a.flags&=-16777217),null;case 27:dr(a),l=Ce.current;var m=a.type;if(r!==null&&a.stateNode!=null)r.memoizedProps!==c&&Pr(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return Et(a),null}r=Te.current,dc(a)?xw(a):(r=nI(m,c,l),a.stateNode=r,Pr(a))}return Et(a),null;case 5:if(dr(a),l=a.type,r!==null&&a.stateNode!=null)r.memoizedProps!==c&&Pr(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return Et(a),null}if(r=Te.current,dc(a))xw(a);else{switch(m=Hf(Ce.current),r){case 1:r=m.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:r=m.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":r=m.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":r=m.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":r=m.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof c.is=="string"?m.createElement("select",{is:c.is}):m.createElement("select"),c.multiple?r.multiple=!0:c.size&&(r.size=c.size);break;default:r=typeof c.is=="string"?m.createElement(l,{is:c.is}):m.createElement(l)}}r[qt]=a,r[Lt]=c;e:for(m=a.child;m!==null;){if(m.tag===5||m.tag===6)r.appendChild(m.stateNode);else if(m.tag!==4&&m.tag!==27&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===a)break e;for(;m.sibling===null;){if(m.return===null||m.return===a)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}a.stateNode=r;e:switch(hn(r,l,c),l){case"button":case"input":case"select":case"textarea":r=!!c.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&Pr(a)}}return Et(a),a.flags&=-16777217,null;case 6:if(r&&a.stateNode!=null)r.memoizedProps!==c&&Pr(a);else{if(typeof c!="string"&&a.stateNode===null)throw Error(i(166));if(r=Ce.current,dc(a)){if(r=a.stateNode,l=a.memoizedProps,c=null,m=Cn,m!==null)switch(m.tag){case 27:case 5:c=m.memoizedProps}r[qt]=a,r=!!(r.nodeValue===l||c!==null&&c.suppressHydrationWarning===!0||Wb(r.nodeValue,l)),r||qa(a)}else r=Hf(r).createTextNode(c),r[qt]=a,a.stateNode=r}return Et(a),null;case 13:if(c=a.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(m=dc(a),c!==null&&c.dehydrated!==null){if(r===null){if(!m)throw Error(i(318));if(m=a.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));m[qt]=a}else fc(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Et(a),m=!1}else m=kw(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=m),m=!0;if(!m)return a.flags&256?(Or(a),a):(Or(a),null)}if(Or(a),(a.flags&128)!==0)return a.lanes=l,a;if(l=c!==null,r=r!==null&&r.memoizedState!==null,l){c=a.child,m=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(m=c.alternate.memoizedState.cachePool.pool);var g=null;c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(g=c.memoizedState.cachePool.pool),g!==m&&(c.flags|=2048)}return l!==r&&l&&(a.child.flags|=8192),Of(a,a.updateQueue),Et(a),null;case 4:return Ui(),r===null&&ay(a.stateNode.containerInfo),Et(a),null;case 10:return Dr(a.type),Et(a),null;case 19:if(he(Kt),m=a.memoizedState,m===null)return Et(a),null;if(c=(a.flags&128)!==0,g=m.rendering,g===null)if(c)Dc(m,!1);else{if(Ct!==0||r!==null&&(r.flags&128)!==0)for(r=a.child;r!==null;){if(g=Af(r),g!==null){for(a.flags|=128,Dc(m,!1),r=g.updateQueue,a.updateQueue=r,Of(a,r),a.subtreeFlags=0,r=l,l=a.child;l!==null;)Nw(l,r),l=l.sibling;return re(Kt,Kt.current&1|2),a.child}r=r.sibling}m.tail!==null&&ai()>kf&&(a.flags|=128,c=!0,Dc(m,!1),a.lanes=4194304)}else{if(!c)if(r=Af(g),r!==null){if(a.flags|=128,c=!0,r=r.updateQueue,a.updateQueue=r,Of(a,r),Dc(m,!0),m.tail===null&&m.tailMode==="hidden"&&!g.alternate&&!$e)return Et(a),null}else 2*ai()-m.renderingStartTime>kf&&l!==536870912&&(a.flags|=128,c=!0,Dc(m,!1),a.lanes=4194304);m.isBackwards?(g.sibling=a.child,a.child=g):(r=m.last,r!==null?r.sibling=g:a.child=g,m.last=g)}return m.tail!==null?(a=m.tail,m.rendering=a,m.tail=a.sibling,m.renderingStartTime=ai(),a.sibling=null,r=Kt.current,re(Kt,c?r&1|2:r&1),a):(Et(a),null);case 22:case 23:return Or(a),l_(),c=a.memoizedState!==null,r!==null?r.memoizedState!==null!==c&&(a.flags|=8192):c&&(a.flags|=8192),c?(l&536870912)!==0&&(a.flags&128)===0&&(Et(a),a.subtreeFlags&6&&(a.flags|=8192)):Et(a),l=a.updateQueue,l!==null&&Of(a,l.retryQueue),l=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),c=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),c!==l&&(a.flags|=2048),r!==null&&he(Ga),null;case 24:return l=null,r!==null&&(l=r.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),Dr(Gt),Et(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function Yx(r,a){switch(Qg(a),a.tag){case 1:return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 3:return Dr(Gt),Ui(),r=a.flags,(r&65536)!==0&&(r&128)===0?(a.flags=r&-65537|128,a):null;case 26:case 27:case 5:return dr(a),null;case 13:if(Or(a),r=a.memoizedState,r!==null&&r.dehydrated!==null){if(a.alternate===null)throw Error(i(340));fc()}return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 19:return he(Kt),null;case 4:return Ui(),null;case 10:return Dr(a.type),null;case 22:case 23:return Or(a),l_(),r!==null&&he(Ga),r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 24:return Dr(Gt),null;case 25:return null;default:return null}}function ib(r,a){switch(Qg(a),a.tag){case 3:Dr(Gt),Ui();break;case 26:case 27:case 5:dr(a);break;case 4:Ui();break;case 13:Or(a);break;case 19:he(Kt);break;case 10:Dr(a.type);break;case 22:case 23:Or(a),l_(),r!==null&&he(Ga);break;case 24:Dr(Gt)}}function Nc(r,a){try{var l=a.updateQueue,c=l!==null?l.lastEffect:null;if(c!==null){var m=c.next;l=m;do{if((l.tag&r)===r){c=void 0;var g=l.create,w=l.inst;c=g(),w.destroy=c}l=l.next}while(l!==m)}}catch(b){ct(a,a.return,b)}}function Es(r,a,l){try{var c=a.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var g=m.next;c=g;do{if((c.tag&r)===r){var w=c.inst,b=w.destroy;if(b!==void 0){w.destroy=void 0,m=a;var R=l,j=b;try{j()}catch($){ct(m,R,$)}}}c=c.next}while(c!==g)}}catch($){ct(a,a.return,$)}}function rb(r){var a=r.updateQueue;if(a!==null){var l=r.stateNode;try{Gw(a,l)}catch(c){ct(r,r.return,c)}}}function sb(r,a,l){l.props=Ya(r.type,r.memoizedProps),l.state=r.memoizedState;try{l.componentWillUnmount()}catch(c){ct(r,a,c)}}function Oc(r,a){try{var l=r.ref;if(l!==null){switch(r.tag){case 26:case 27:case 5:var c=r.stateNode;break;case 30:c=r.stateNode;break;default:c=r.stateNode}typeof l=="function"?r.refCleanup=l(c):l.current=c}}catch(m){ct(r,a,m)}}function Ji(r,a){var l=r.ref,c=r.refCleanup;if(l!==null)if(typeof c=="function")try{c()}catch(m){ct(r,a,m)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(m){ct(r,a,m)}else l.current=null}function ab(r){var a=r.type,l=r.memoizedProps,c=r.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":l.autoFocus&&c.focus();break e;case"img":l.src?c.src=l.src:l.srcSet&&(c.srcset=l.srcSet)}}catch(m){ct(r,r.return,m)}}function V_(r,a,l){try{var c=r.stateNode;mP(c,r.type,l,a),c[Lt]=a}catch(m){ct(r,r.return,m)}}function ob(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Cs(r.type)||r.tag===4}function L_(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||ob(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Cs(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function U_(r,a,l){var c=r.tag;if(c===5||c===6)r=r.stateNode,a?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(r,a):(a=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,a.appendChild(r),l=l._reactRootContainer,l!=null||a.onclick!==null||(a.onclick=jf));else if(c!==4&&(c===27&&Cs(r.type)&&(l=r.stateNode,a=null),r=r.child,r!==null))for(U_(r,a,l),r=r.sibling;r!==null;)U_(r,a,l),r=r.sibling}function xf(r,a,l){var c=r.tag;if(c===5||c===6)r=r.stateNode,a?l.insertBefore(r,a):l.appendChild(r);else if(c!==4&&(c===27&&Cs(r.type)&&(l=r.stateNode),r=r.child,r!==null))for(xf(r,a,l),r=r.sibling;r!==null;)xf(r,a,l),r=r.sibling}function lb(r){var a=r.stateNode,l=r.memoizedProps;try{for(var c=r.type,m=a.attributes;m.length;)a.removeAttributeNode(m[0]);hn(a,c,l),a[qt]=r,a[Lt]=l}catch(g){ct(r,r.return,g)}}var kr=!1,xt=!1,F_=!1,ub=typeof WeakSet=="function"?WeakSet:Set,tn=null;function Qx(r,a){if(r=r.containerInfo,uy=$f,r=Ew(r),Lg(r)){if("selectionStart"in r)var l={start:r.selectionStart,end:r.selectionEnd};else e:{l=(l=r.ownerDocument)&&l.defaultView||window;var c=l.getSelection&&l.getSelection();if(c&&c.rangeCount!==0){l=c.anchorNode;var m=c.anchorOffset,g=c.focusNode;c=c.focusOffset;try{l.nodeType,g.nodeType}catch{l=null;break e}var w=0,b=-1,R=-1,j=0,$=0,J=r,H=null;t:for(;;){for(var G;J!==l||m!==0&&J.nodeType!==3||(b=w+m),J!==g||c!==0&&J.nodeType!==3||(R=w+c),J.nodeType===3&&(w+=J.nodeValue.length),(G=J.firstChild)!==null;)H=J,J=G;for(;;){if(J===r)break t;if(H===l&&++j===m&&(b=w),H===g&&++$===c&&(R=w),(G=J.nextSibling)!==null)break;J=H,H=J.parentNode}J=G}l=b===-1||R===-1?null:{start:b,end:R}}else l=null}l=l||{start:0,end:0}}else l=null;for(cy={focusedElem:r,selectionRange:l},$f=!1,tn=a;tn!==null;)if(a=tn,r=a.child,(a.subtreeFlags&1024)!==0&&r!==null)r.return=a,tn=r;else for(;tn!==null;){switch(a=tn,g=a.alternate,r=a.flags,a.tag){case 0:break;case 11:case 15:break;case 1:if((r&1024)!==0&&g!==null){r=void 0,l=a,m=g.memoizedProps,g=g.memoizedState,c=l.stateNode;try{var Re=Ya(l.type,m,l.elementType===l.type);r=c.getSnapshotBeforeUpdate(Re,g),c.__reactInternalSnapshotBeforeUpdate=r}catch(we){ct(l,l.return,we)}}break;case 3:if((r&1024)!==0){if(r=a.stateNode.containerInfo,l=r.nodeType,l===9)fy(r);else if(l===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":fy(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=a.sibling,r!==null){r.return=a.return,tn=r;break}tn=a.return}}function cb(r,a,l){var c=l.flags;switch(l.tag){case 0:case 11:case 15:Ts(r,l),c&4&&Nc(5,l);break;case 1:if(Ts(r,l),c&4)if(r=l.stateNode,a===null)try{r.componentDidMount()}catch(w){ct(l,l.return,w)}else{var m=Ya(l.type,a.memoizedProps);a=a.memoizedState;try{r.componentDidUpdate(m,a,r.__reactInternalSnapshotBeforeUpdate)}catch(w){ct(l,l.return,w)}}c&64&&rb(l),c&512&&Oc(l,l.return);break;case 3:if(Ts(r,l),c&64&&(r=l.updateQueue,r!==null)){if(a=null,l.child!==null)switch(l.child.tag){case 27:case 5:a=l.child.stateNode;break;case 1:a=l.child.stateNode}try{Gw(r,a)}catch(w){ct(l,l.return,w)}}break;case 27:a===null&&c&4&&lb(l);case 26:case 5:Ts(r,l),a===null&&c&4&&ab(l),c&512&&Oc(l,l.return);break;case 12:Ts(r,l);break;case 13:Ts(r,l),c&4&&fb(r,l),c&64&&(r=l.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(l=iP.bind(null,l),TP(r,l))));break;case 22:if(c=l.memoizedState!==null||kr,!c){a=a!==null&&a.memoizedState!==null||xt,m=kr;var g=xt;kr=c,(xt=a)&&!g?ws(r,l,(l.subtreeFlags&8772)!==0):Ts(r,l),kr=m,xt=g}break;case 30:break;default:Ts(r,l)}}function hb(r){var a=r.alternate;a!==null&&(r.alternate=null,hb(a)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(a=r.stateNode,a!==null&&us(a)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var yt=null,Vn=!1;function Mr(r,a,l){for(l=l.child;l!==null;)db(r,a,l),l=l.sibling}function db(r,a,l){if(Ze&&typeof Ze.onCommitFiberUnmount=="function")try{Ze.onCommitFiberUnmount(At,l)}catch{}switch(l.tag){case 26:xt||Ji(l,a),Mr(r,a,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:xt||Ji(l,a);var c=yt,m=Vn;Cs(l.type)&&(yt=l.stateNode,Vn=!1),Mr(r,a,l),Bc(l.stateNode),yt=c,Vn=m;break;case 5:xt||Ji(l,a);case 6:if(c=yt,m=Vn,yt=null,Mr(r,a,l),yt=c,Vn=m,yt!==null)if(Vn)try{(yt.nodeType===9?yt.body:yt.nodeName==="HTML"?yt.ownerDocument.body:yt).removeChild(l.stateNode)}catch(g){ct(l,a,g)}else try{yt.removeChild(l.stateNode)}catch(g){ct(l,a,g)}break;case 18:yt!==null&&(Vn?(r=yt,eI(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,l.stateNode),Qc(r)):eI(yt,l.stateNode));break;case 4:c=yt,m=Vn,yt=l.stateNode.containerInfo,Vn=!0,Mr(r,a,l),yt=c,Vn=m;break;case 0:case 11:case 14:case 15:xt||Es(2,l,a),xt||Es(4,l,a),Mr(r,a,l);break;case 1:xt||(Ji(l,a),c=l.stateNode,typeof c.componentWillUnmount=="function"&&sb(l,a,c)),Mr(r,a,l);break;case 21:Mr(r,a,l);break;case 22:xt=(c=xt)||l.memoizedState!==null,Mr(r,a,l),xt=c;break;default:Mr(r,a,l)}}function fb(r,a){if(a.memoizedState===null&&(r=a.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Qc(r)}catch(l){ct(a,a.return,l)}}function Wx(r){switch(r.tag){case 13:case 19:var a=r.stateNode;return a===null&&(a=r.stateNode=new ub),a;case 22:return r=r.stateNode,a=r._retryCache,a===null&&(a=r._retryCache=new ub),a;default:throw Error(i(435,r.tag))}}function B_(r,a){var l=Wx(r);a.forEach(function(c){var m=rP.bind(null,r,c);l.has(c)||(l.add(c),c.then(m,m))})}function Yn(r,a){var l=a.deletions;if(l!==null)for(var c=0;c<l.length;c++){var m=l[c],g=r,w=a,b=w;e:for(;b!==null;){switch(b.tag){case 27:if(Cs(b.type)){yt=b.stateNode,Vn=!1;break e}break;case 5:yt=b.stateNode,Vn=!1;break e;case 3:case 4:yt=b.stateNode.containerInfo,Vn=!0;break e}b=b.return}if(yt===null)throw Error(i(160));db(g,w,m),yt=null,Vn=!1,g=m.alternate,g!==null&&(g.return=null),m.return=null}if(a.subtreeFlags&13878)for(a=a.child;a!==null;)mb(a,r),a=a.sibling}var Ni=null;function mb(r,a){var l=r.alternate,c=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Yn(a,r),Qn(r),c&4&&(Es(3,r,r.return),Nc(3,r),Es(5,r,r.return));break;case 1:Yn(a,r),Qn(r),c&512&&(xt||l===null||Ji(l,l.return)),c&64&&kr&&(r=r.updateQueue,r!==null&&(c=r.callbacks,c!==null&&(l=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=l===null?c:l.concat(c))));break;case 26:var m=Ni;if(Yn(a,r),Qn(r),c&512&&(xt||l===null||Ji(l,l.return)),c&4){var g=l!==null?l.memoizedState:null;if(c=r.memoizedState,l===null)if(c===null)if(r.stateNode===null){e:{c=r.type,l=r.memoizedProps,m=m.ownerDocument||m;t:switch(c){case"title":g=m.getElementsByTagName("title")[0],(!g||g[wa]||g[qt]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=m.createElement(c),m.head.insertBefore(g,m.querySelector("head > title"))),hn(g,c,l),g[qt]=r,Nt(g),c=g;break e;case"link":var w=lI("link","href",m).get(c+(l.href||""));if(w){for(var b=0;b<w.length;b++)if(g=w[b],g.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&g.getAttribute("rel")===(l.rel==null?null:l.rel)&&g.getAttribute("title")===(l.title==null?null:l.title)&&g.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){w.splice(b,1);break t}}g=m.createElement(c),hn(g,c,l),m.head.appendChild(g);break;case"meta":if(w=lI("meta","content",m).get(c+(l.content||""))){for(b=0;b<w.length;b++)if(g=w[b],g.getAttribute("content")===(l.content==null?null:""+l.content)&&g.getAttribute("name")===(l.name==null?null:l.name)&&g.getAttribute("property")===(l.property==null?null:l.property)&&g.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&g.getAttribute("charset")===(l.charSet==null?null:l.charSet)){w.splice(b,1);break t}}g=m.createElement(c),hn(g,c,l),m.head.appendChild(g);break;default:throw Error(i(468,c))}g[qt]=r,Nt(g),c=g}r.stateNode=c}else uI(m,r.type,r.stateNode);else r.stateNode=oI(m,c,r.memoizedProps);else g!==c?(g===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):g.count--,c===null?uI(m,r.type,r.stateNode):oI(m,c,r.memoizedProps)):c===null&&r.stateNode!==null&&V_(r,r.memoizedProps,l.memoizedProps)}break;case 27:Yn(a,r),Qn(r),c&512&&(xt||l===null||Ji(l,l.return)),l!==null&&c&4&&V_(r,r.memoizedProps,l.memoizedProps);break;case 5:if(Yn(a,r),Qn(r),c&512&&(xt||l===null||Ji(l,l.return)),r.flags&32){m=r.stateNode;try{li(m,"")}catch(G){ct(r,r.return,G)}}c&4&&r.stateNode!=null&&(m=r.memoizedProps,V_(r,m,l!==null?l.memoizedProps:m)),c&1024&&(F_=!0);break;case 6:if(Yn(a,r),Qn(r),c&4){if(r.stateNode===null)throw Error(i(162));c=r.memoizedProps,l=r.stateNode;try{l.nodeValue=c}catch(G){ct(r,r.return,G)}}break;case 3:if(Yf=null,m=Ni,Ni=Gf(a.containerInfo),Yn(a,r),Ni=m,Qn(r),c&4&&l!==null&&l.memoizedState.isDehydrated)try{Qc(a.containerInfo)}catch(G){ct(r,r.return,G)}F_&&(F_=!1,pb(r));break;case 4:c=Ni,Ni=Gf(r.stateNode.containerInfo),Yn(a,r),Qn(r),Ni=c;break;case 12:Yn(a,r),Qn(r);break;case 13:Yn(a,r),Qn(r),r.child.flags&8192&&r.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(K_=ai()),c&4&&(c=r.updateQueue,c!==null&&(r.updateQueue=null,B_(r,c)));break;case 22:m=r.memoizedState!==null;var R=l!==null&&l.memoizedState!==null,j=kr,$=xt;if(kr=j||m,xt=$||R,Yn(a,r),xt=$,kr=j,Qn(r),c&8192)e:for(a=r.stateNode,a._visibility=m?a._visibility&-2:a._visibility|1,m&&(l===null||R||kr||xt||Qa(r)),l=null,a=r;;){if(a.tag===5||a.tag===26){if(l===null){R=l=a;try{if(g=R.stateNode,m)w=g.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{b=R.stateNode;var J=R.memoizedProps.style,H=J!=null&&J.hasOwnProperty("display")?J.display:null;b.style.display=H==null||typeof H=="boolean"?"":(""+H).trim()}}catch(G){ct(R,R.return,G)}}}else if(a.tag===6){if(l===null){R=a;try{R.stateNode.nodeValue=m?"":R.memoizedProps}catch(G){ct(R,R.return,G)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===r)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break e;for(;a.sibling===null;){if(a.return===null||a.return===r)break e;l===a&&(l=null),a=a.return}l===a&&(l=null),a.sibling.return=a.return,a=a.sibling}c&4&&(c=r.updateQueue,c!==null&&(l=c.retryQueue,l!==null&&(c.retryQueue=null,B_(r,l))));break;case 19:Yn(a,r),Qn(r),c&4&&(c=r.updateQueue,c!==null&&(r.updateQueue=null,B_(r,c)));break;case 30:break;case 21:break;default:Yn(a,r),Qn(r)}}function Qn(r){var a=r.flags;if(a&2){try{for(var l,c=r.return;c!==null;){if(ob(c)){l=c;break}c=c.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var m=l.stateNode,g=L_(r);xf(r,g,m);break;case 5:var w=l.stateNode;l.flags&32&&(li(w,""),l.flags&=-33);var b=L_(r);xf(r,b,w);break;case 3:case 4:var R=l.stateNode.containerInfo,j=L_(r);U_(r,j,R);break;default:throw Error(i(161))}}catch($){ct(r,r.return,$)}r.flags&=-3}a&4096&&(r.flags&=-4097)}function pb(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var a=r;pb(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),r=r.sibling}}function Ts(r,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)cb(r,a.alternate,a),a=a.sibling}function Qa(r){for(r=r.child;r!==null;){var a=r;switch(a.tag){case 0:case 11:case 14:case 15:Es(4,a,a.return),Qa(a);break;case 1:Ji(a,a.return);var l=a.stateNode;typeof l.componentWillUnmount=="function"&&sb(a,a.return,l),Qa(a);break;case 27:Bc(a.stateNode);case 26:case 5:Ji(a,a.return),Qa(a);break;case 22:a.memoizedState===null&&Qa(a);break;case 30:Qa(a);break;default:Qa(a)}r=r.sibling}}function ws(r,a,l){for(l=l&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var c=a.alternate,m=r,g=a,w=g.flags;switch(g.tag){case 0:case 11:case 15:ws(m,g,l),Nc(4,g);break;case 1:if(ws(m,g,l),c=g,m=c.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(j){ct(c,c.return,j)}if(c=g,m=c.updateQueue,m!==null){var b=c.stateNode;try{var R=m.shared.hiddenCallbacks;if(R!==null)for(m.shared.hiddenCallbacks=null,m=0;m<R.length;m++)Hw(R[m],b)}catch(j){ct(c,c.return,j)}}l&&w&64&&rb(g),Oc(g,g.return);break;case 27:lb(g);case 26:case 5:ws(m,g,l),l&&c===null&&w&4&&ab(g),Oc(g,g.return);break;case 12:ws(m,g,l);break;case 13:ws(m,g,l),l&&w&4&&fb(m,g);break;case 22:g.memoizedState===null&&ws(m,g,l),Oc(g,g.return);break;case 30:break;default:ws(m,g,l)}a=a.sibling}}function z_(r,a){var l=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),r=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(r=a.memoizedState.cachePool.pool),r!==l&&(r!=null&&r.refCount++,l!=null&&gc(l))}function q_(r,a){r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&gc(r))}function Zi(r,a,l,c){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)gb(r,a,l,c),a=a.sibling}function gb(r,a,l,c){var m=a.flags;switch(a.tag){case 0:case 11:case 15:Zi(r,a,l,c),m&2048&&Nc(9,a);break;case 1:Zi(r,a,l,c);break;case 3:Zi(r,a,l,c),m&2048&&(r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&gc(r)));break;case 12:if(m&2048){Zi(r,a,l,c),r=a.stateNode;try{var g=a.memoizedProps,w=g.id,b=g.onPostCommit;typeof b=="function"&&b(w,a.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(R){ct(a,a.return,R)}}else Zi(r,a,l,c);break;case 13:Zi(r,a,l,c);break;case 23:break;case 22:g=a.stateNode,w=a.alternate,a.memoizedState!==null?g._visibility&2?Zi(r,a,l,c):xc(r,a):g._visibility&2?Zi(r,a,l,c):(g._visibility|=2,_l(r,a,l,c,(a.subtreeFlags&10256)!==0)),m&2048&&z_(w,a);break;case 24:Zi(r,a,l,c),m&2048&&q_(a.alternate,a);break;default:Zi(r,a,l,c)}}function _l(r,a,l,c,m){for(m=m&&(a.subtreeFlags&10256)!==0,a=a.child;a!==null;){var g=r,w=a,b=l,R=c,j=w.flags;switch(w.tag){case 0:case 11:case 15:_l(g,w,b,R,m),Nc(8,w);break;case 23:break;case 22:var $=w.stateNode;w.memoizedState!==null?$._visibility&2?_l(g,w,b,R,m):xc(g,w):($._visibility|=2,_l(g,w,b,R,m)),m&&j&2048&&z_(w.alternate,w);break;case 24:_l(g,w,b,R,m),m&&j&2048&&q_(w.alternate,w);break;default:_l(g,w,b,R,m)}a=a.sibling}}function xc(r,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var l=r,c=a,m=c.flags;switch(c.tag){case 22:xc(l,c),m&2048&&z_(c.alternate,c);break;case 24:xc(l,c),m&2048&&q_(c.alternate,c);break;default:xc(l,c)}a=a.sibling}}var Pc=8192;function yl(r){if(r.subtreeFlags&Pc)for(r=r.child;r!==null;)_b(r),r=r.sibling}function _b(r){switch(r.tag){case 26:yl(r),r.flags&Pc&&r.memoizedState!==null&&kP(Ni,r.memoizedState,r.memoizedProps);break;case 5:yl(r);break;case 3:case 4:var a=Ni;Ni=Gf(r.stateNode.containerInfo),yl(r),Ni=a;break;case 22:r.memoizedState===null&&(a=r.alternate,a!==null&&a.memoizedState!==null?(a=Pc,Pc=16777216,yl(r),Pc=a):yl(r));break;default:yl(r)}}function yb(r){var a=r.alternate;if(a!==null&&(r=a.child,r!==null)){a.child=null;do a=r.sibling,r.sibling=null,r=a;while(r!==null)}}function kc(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var c=a[l];tn=c,Eb(c,r)}yb(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)vb(r),r=r.sibling}function vb(r){switch(r.tag){case 0:case 11:case 15:kc(r),r.flags&2048&&Es(9,r,r.return);break;case 3:kc(r);break;case 12:kc(r);break;case 22:var a=r.stateNode;r.memoizedState!==null&&a._visibility&2&&(r.return===null||r.return.tag!==13)?(a._visibility&=-3,Pf(r)):kc(r);break;default:kc(r)}}function Pf(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var c=a[l];tn=c,Eb(c,r)}yb(r)}for(r=r.child;r!==null;){switch(a=r,a.tag){case 0:case 11:case 15:Es(8,a,a.return),Pf(a);break;case 22:l=a.stateNode,l._visibility&2&&(l._visibility&=-3,Pf(a));break;default:Pf(a)}r=r.sibling}}function Eb(r,a){for(;tn!==null;){var l=tn;switch(l.tag){case 0:case 11:case 15:Es(8,l,a);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var c=l.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:gc(l.memoizedState.cache)}if(c=l.child,c!==null)c.return=l,tn=c;else e:for(l=r;tn!==null;){c=tn;var m=c.sibling,g=c.return;if(hb(c),c===l){tn=null;break e}if(m!==null){m.return=g,tn=m;break e}tn=g}}}var $x={getCacheForType:function(r){var a=pn(Gt),l=a.data.get(r);return l===void 0&&(l=r(),a.data.set(r,l)),l}},Xx=typeof WeakMap=="function"?WeakMap:Map,et=0,ft=null,Ue=null,He=0,tt=0,Wn=null,bs=!1,vl=!1,j_=!1,Vr=0,Ct=0,Is=0,Wa=0,H_=0,_i=0,El=0,Mc=null,Ln=null,G_=!1,K_=0,kf=1/0,Mf=null,Ss=null,cn=0,As=null,Tl=null,wl=0,Y_=0,Q_=null,Tb=null,Vc=0,W_=null;function $n(){if((et&2)!==0&&He!==0)return He&-He;if(W.T!==null){var r=ul;return r!==0?r:ny()}return os()}function wb(){_i===0&&(_i=(He&536870912)===0||$e?Gu():536870912);var r=gi.current;return r!==null&&(r.flags|=32),_i}function Xn(r,a,l){(r===ft&&(tt===2||tt===9)||r.cancelPendingCommit!==null)&&(bl(r,0),Rs(r,He,_i,!1)),mr(r,l),((et&2)===0||r!==ft)&&(r===ft&&((et&2)===0&&(Wa|=l),Ct===4&&Rs(r,He,_i,!1)),er(r))}function bb(r,a,l){if((et&6)!==0)throw Error(i(327));var c=!l&&(a&124)===0&&(a&r.expiredLanes)===0||Ta(r,a),m=c?eP(r,a):J_(r,a,!0),g=c;do{if(m===0){vl&&!c&&Rs(r,a,0,!1);break}else{if(l=r.current.alternate,g&&!Jx(l)){m=J_(r,a,!1),g=!1;continue}if(m===2){if(g=a,r.errorRecoveryDisabledLanes&g)var w=0;else w=r.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){a=w;e:{var b=r;m=Mc;var R=b.current.memoizedState.isDehydrated;if(R&&(bl(b,w).flags|=256),w=J_(b,w,!1),w!==2){if(j_&&!R){b.errorRecoveryDisabledLanes|=g,Wa|=g,m=4;break e}g=Ln,Ln=m,g!==null&&(Ln===null?Ln=g:Ln.push.apply(Ln,g))}m=w}if(g=!1,m!==2)continue}}if(m===1){bl(r,0),Rs(r,a,0,!0);break}e:{switch(c=r,g=m,g){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:Rs(c,a,_i,!bs);break e;case 2:Ln=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(m=K_+300-ai(),10<m)){if(Rs(c,a,_i,!bs),Bo(c,0,!0)!==0)break e;c.timeoutHandle=Jb(Ib.bind(null,c,l,Ln,Mf,G_,a,_i,Wa,El,bs,g,2,-0,0),m);break e}Ib(c,l,Ln,Mf,G_,a,_i,Wa,El,bs,g,0,-0,0)}}break}while(!0);er(r)}function Ib(r,a,l,c,m,g,w,b,R,j,$,J,H,G){if(r.timeoutHandle=-1,J=a.subtreeFlags,(J&8192||(J&16785408)===16785408)&&(jc={stylesheets:null,count:0,unsuspend:PP},_b(a),J=MP(),J!==null)){r.cancelPendingCommit=J(Ob.bind(null,r,a,g,l,c,m,w,b,R,$,1,H,G)),Rs(r,g,w,!j);return}Ob(r,a,g,l,c,m,w,b,R)}function Jx(r){for(var a=r;;){var l=a.tag;if((l===0||l===11||l===15)&&a.flags&16384&&(l=a.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var c=0;c<l.length;c++){var m=l[c],g=m.getSnapshot;m=m.value;try{if(!Gn(g(),m))return!1}catch{return!1}}if(l=a.child,a.subtreeFlags&16384&&l!==null)l.return=a,a=l;else{if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Rs(r,a,l,c){a&=~H_,a&=~Wa,r.suspendedLanes|=a,r.pingedLanes&=~a,c&&(r.warmLanes|=a),c=r.expirationTimes;for(var m=a;0<m;){var g=31-mn(m),w=1<<g;c[g]=-1,m&=~w}l!==0&&Fi(r,l,a)}function Vf(){return(et&6)===0?(Lc(0),!1):!0}function $_(){if(Ue!==null){if(tt===0)var r=Ue.return;else r=Ue,Cr=ja=null,f_(r),pl=null,Rc=0,r=Ue;for(;r!==null;)ib(r.alternate,r),r=r.return;Ue=null}}function bl(r,a){var l=r.timeoutHandle;l!==-1&&(r.timeoutHandle=-1,gP(l)),l=r.cancelPendingCommit,l!==null&&(r.cancelPendingCommit=null,l()),$_(),ft=r,Ue=l=Sr(r.current,null),He=a,tt=0,Wn=null,bs=!1,vl=Ta(r,a),j_=!1,El=_i=H_=Wa=Is=Ct=0,Ln=Mc=null,G_=!1,(a&8)!==0&&(a|=a&32);var c=r.entangledLanes;if(c!==0)for(r=r.entanglements,c&=a;0<c;){var m=31-mn(c),g=1<<m;a|=r[m],c&=~g}return Vr=a,rf(),l}function Sb(r,a){Oe=null,W.H=bf,a===yc||a===ff?(a=qw(),tt=3):a===Fw?(a=qw(),tt=4):tt=a===j0?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Wn=a,Ue===null&&(Ct=1,Cf(r,di(a,r.current)))}function Ab(){var r=W.H;return W.H=bf,r===null?bf:r}function Rb(){var r=W.A;return W.A=$x,r}function X_(){Ct=4,bs||(He&4194048)!==He&&gi.current!==null||(vl=!0),(Is&134217727)===0&&(Wa&134217727)===0||ft===null||Rs(ft,He,_i,!1)}function J_(r,a,l){var c=et;et|=2;var m=Ab(),g=Rb();(ft!==r||He!==a)&&(Mf=null,bl(r,a)),a=!1;var w=Ct;e:do try{if(tt!==0&&Ue!==null){var b=Ue,R=Wn;switch(tt){case 8:$_(),w=6;break e;case 3:case 2:case 9:case 6:gi.current===null&&(a=!0);var j=tt;if(tt=0,Wn=null,Il(r,b,R,j),l&&vl){w=0;break e}break;default:j=tt,tt=0,Wn=null,Il(r,b,R,j)}}Zx(),w=Ct;break}catch($){Sb(r,$)}while(!0);return a&&r.shellSuspendCounter++,Cr=ja=null,et=c,W.H=m,W.A=g,Ue===null&&(ft=null,He=0,rf()),w}function Zx(){for(;Ue!==null;)Cb(Ue)}function eP(r,a){var l=et;et|=2;var c=Ab(),m=Rb();ft!==r||He!==a?(Mf=null,kf=ai()+500,bl(r,a)):vl=Ta(r,a);e:do try{if(tt!==0&&Ue!==null){a=Ue;var g=Wn;t:switch(tt){case 1:tt=0,Wn=null,Il(r,a,g,1);break;case 2:case 9:if(Bw(g)){tt=0,Wn=null,Db(a);break}a=function(){tt!==2&&tt!==9||ft!==r||(tt=7),er(r)},g.then(a,a);break e;case 3:tt=7;break e;case 4:tt=5;break e;case 7:Bw(g)?(tt=0,Wn=null,Db(a)):(tt=0,Wn=null,Il(r,a,g,7));break;case 5:var w=null;switch(Ue.tag){case 26:w=Ue.memoizedState;case 5:case 27:var b=Ue;if(!w||cI(w)){tt=0,Wn=null;var R=b.sibling;if(R!==null)Ue=R;else{var j=b.return;j!==null?(Ue=j,Lf(j)):Ue=null}break t}}tt=0,Wn=null,Il(r,a,g,5);break;case 6:tt=0,Wn=null,Il(r,a,g,6);break;case 8:$_(),Ct=6;break e;default:throw Error(i(462))}}tP();break}catch($){Sb(r,$)}while(!0);return Cr=ja=null,W.H=c,W.A=m,et=l,Ue!==null?0:(ft=null,He=0,rf(),Ct)}function tP(){for(;Ue!==null&&!zu();)Cb(Ue)}function Cb(r){var a=tb(r.alternate,r,Vr);r.memoizedProps=r.pendingProps,a===null?Lf(r):Ue=a}function Db(r){var a=r,l=a.alternate;switch(a.tag){case 15:case 0:a=W0(l,a,a.pendingProps,a.type,void 0,He);break;case 11:a=W0(l,a,a.pendingProps,a.type.render,a.ref,He);break;case 5:f_(a);default:ib(l,a),a=Ue=Nw(a,Vr),a=tb(l,a,Vr)}r.memoizedProps=r.pendingProps,a===null?Lf(r):Ue=a}function Il(r,a,l,c){Cr=ja=null,f_(a),pl=null,Rc=0;var m=a.return;try{if(Hx(r,m,a,l,He)){Ct=1,Cf(r,di(l,r.current)),Ue=null;return}}catch(g){if(m!==null)throw Ue=m,g;Ct=1,Cf(r,di(l,r.current)),Ue=null;return}a.flags&32768?($e||c===1?r=!0:vl||(He&536870912)!==0?r=!1:(bs=r=!0,(c===2||c===9||c===3||c===6)&&(c=gi.current,c!==null&&c.tag===13&&(c.flags|=16384))),Nb(a,r)):Lf(a)}function Lf(r){var a=r;do{if((a.flags&32768)!==0){Nb(a,bs);return}r=a.return;var l=Kx(a.alternate,a,Vr);if(l!==null){Ue=l;return}if(a=a.sibling,a!==null){Ue=a;return}Ue=a=r}while(a!==null);Ct===0&&(Ct=5)}function Nb(r,a){do{var l=Yx(r.alternate,r);if(l!==null){l.flags&=32767,Ue=l;return}if(l=r.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!a&&(r=r.sibling,r!==null)){Ue=r;return}Ue=r=l}while(r!==null);Ct=6,Ue=null}function Ob(r,a,l,c,m,g,w,b,R){r.cancelPendingCommit=null;do Uf();while(cn!==0);if((et&6)!==0)throw Error(i(327));if(a!==null){if(a===r.current)throw Error(i(177));if(g=a.lanes|a.childLanes,g|=qg,Yu(r,l,g,w,b,R),r===ft&&(Ue=ft=null,He=0),Tl=a,As=r,wl=l,Y_=g,Q_=m,Tb=c,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,sP(_a,function(){return Vb(),null})):(r.callbackNode=null,r.callbackPriority=0),c=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||c){c=W.T,W.T=null,m=ce.p,ce.p=2,w=et,et|=4;try{Qx(r,a,l)}finally{et=w,ce.p=m,W.T=c}}cn=1,xb(),Pb(),kb()}}function xb(){if(cn===1){cn=0;var r=As,a=Tl,l=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||l){l=W.T,W.T=null;var c=ce.p;ce.p=2;var m=et;et|=4;try{mb(a,r);var g=cy,w=Ew(r.containerInfo),b=g.focusedElem,R=g.selectionRange;if(w!==b&&b&&b.ownerDocument&&vw(b.ownerDocument.documentElement,b)){if(R!==null&&Lg(b)){var j=R.start,$=R.end;if($===void 0&&($=j),"selectionStart"in b)b.selectionStart=j,b.selectionEnd=Math.min($,b.value.length);else{var J=b.ownerDocument||document,H=J&&J.defaultView||window;if(H.getSelection){var G=H.getSelection(),Re=b.textContent.length,we=Math.min(R.start,Re),ut=R.end===void 0?we:Math.min(R.end,Re);!G.extend&&we>ut&&(w=ut,ut=we,we=w);var L=yw(b,we),k=yw(b,ut);if(L&&k&&(G.rangeCount!==1||G.anchorNode!==L.node||G.anchorOffset!==L.offset||G.focusNode!==k.node||G.focusOffset!==k.offset)){var q=J.createRange();q.setStart(L.node,L.offset),G.removeAllRanges(),we>ut?(G.addRange(q),G.extend(k.node,k.offset)):(q.setEnd(k.node,k.offset),G.addRange(q))}}}}for(J=[],G=b;G=G.parentNode;)G.nodeType===1&&J.push({element:G,left:G.scrollLeft,top:G.scrollTop});for(typeof b.focus=="function"&&b.focus(),b=0;b<J.length;b++){var X=J[b];X.element.scrollLeft=X.left,X.element.scrollTop=X.top}}$f=!!uy,cy=uy=null}finally{et=m,ce.p=c,W.T=l}}r.current=a,cn=2}}function Pb(){if(cn===2){cn=0;var r=As,a=Tl,l=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||l){l=W.T,W.T=null;var c=ce.p;ce.p=2;var m=et;et|=4;try{cb(r,a.alternate,a)}finally{et=m,ce.p=c,W.T=l}}cn=3}}function kb(){if(cn===4||cn===3){cn=0,xd();var r=As,a=Tl,l=wl,c=Tb;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?cn=5:(cn=0,Tl=As=null,Mb(r,r.pendingLanes));var m=r.pendingLanes;if(m===0&&(Ss=null),zo(l),a=a.stateNode,Ze&&typeof Ze.onCommitFiberRoot=="function")try{Ze.onCommitFiberRoot(At,a,void 0,(a.current.flags&128)===128)}catch{}if(c!==null){a=W.T,m=ce.p,ce.p=2,W.T=null;try{for(var g=r.onRecoverableError,w=0;w<c.length;w++){var b=c[w];g(b.value,{componentStack:b.stack})}}finally{W.T=a,ce.p=m}}(wl&3)!==0&&Uf(),er(r),m=r.pendingLanes,(l&4194090)!==0&&(m&42)!==0?r===W_?Vc++:(Vc=0,W_=r):Vc=0,Lc(0)}}function Mb(r,a){(r.pooledCacheLanes&=a)===0&&(a=r.pooledCache,a!=null&&(r.pooledCache=null,gc(a)))}function Uf(r){return xb(),Pb(),kb(),Vb()}function Vb(){if(cn!==5)return!1;var r=As,a=Y_;Y_=0;var l=zo(wl),c=W.T,m=ce.p;try{ce.p=32>l?32:l,W.T=null,l=Q_,Q_=null;var g=As,w=wl;if(cn=0,Tl=As=null,wl=0,(et&6)!==0)throw Error(i(331));var b=et;if(et|=4,vb(g.current),gb(g,g.current,w,l),et=b,Lc(0,!1),Ze&&typeof Ze.onPostCommitFiberRoot=="function")try{Ze.onPostCommitFiberRoot(At,g)}catch{}return!0}finally{ce.p=m,W.T=c,Mb(r,a)}}function Lb(r,a,l){a=di(l,a),a=R_(r.stateNode,a,2),r=gs(r,a,2),r!==null&&(mr(r,2),er(r))}function ct(r,a,l){if(r.tag===3)Lb(r,r,l);else for(;a!==null;){if(a.tag===3){Lb(a,r,l);break}else if(a.tag===1){var c=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Ss===null||!Ss.has(c))){r=di(l,r),l=z0(2),c=gs(a,l,2),c!==null&&(q0(l,c,a,r),mr(c,2),er(c));break}}a=a.return}}function Z_(r,a,l){var c=r.pingCache;if(c===null){c=r.pingCache=new Xx;var m=new Set;c.set(a,m)}else m=c.get(a),m===void 0&&(m=new Set,c.set(a,m));m.has(l)||(j_=!0,m.add(l),r=nP.bind(null,r,a,l),a.then(r,r))}function nP(r,a,l){var c=r.pingCache;c!==null&&c.delete(a),r.pingedLanes|=r.suspendedLanes&l,r.warmLanes&=~l,ft===r&&(He&l)===l&&(Ct===4||Ct===3&&(He&62914560)===He&&300>ai()-K_?(et&2)===0&&bl(r,0):H_|=l,El===He&&(El=0)),er(r)}function Ub(r,a){a===0&&(a=Ku()),r=sl(r,a),r!==null&&(mr(r,a),er(r))}function iP(r){var a=r.memoizedState,l=0;a!==null&&(l=a.retryLane),Ub(r,l)}function rP(r,a){var l=0;switch(r.tag){case 13:var c=r.stateNode,m=r.memoizedState;m!==null&&(l=m.retryLane);break;case 19:c=r.stateNode;break;case 22:c=r.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(a),Ub(r,l)}function sP(r,a){return pa(r,a)}var Ff=null,Sl=null,ey=!1,Bf=!1,ty=!1,$a=0;function er(r){r!==Sl&&r.next===null&&(Sl===null?Ff=Sl=r:Sl=Sl.next=r),Bf=!0,ey||(ey=!0,oP())}function Lc(r,a){if(!ty&&Bf){ty=!0;do for(var l=!1,c=Ff;c!==null;){if(r!==0){var m=c.pendingLanes;if(m===0)var g=0;else{var w=c.suspendedLanes,b=c.pingedLanes;g=(1<<31-mn(42|r)+1)-1,g&=m&~(w&~b),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(l=!0,qb(c,g))}else g=He,g=Bo(c,c===ft?g:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(g&3)===0||Ta(c,g)||(l=!0,qb(c,g));c=c.next}while(l);ty=!1}}function aP(){Fb()}function Fb(){Bf=ey=!1;var r=0;$a!==0&&(pP()&&(r=$a),$a=0);for(var a=ai(),l=null,c=Ff;c!==null;){var m=c.next,g=Bb(c,a);g===0?(c.next=null,l===null?Ff=m:l.next=m,m===null&&(Sl=l)):(l=c,(r!==0||(g&3)!==0)&&(Bf=!0)),c=m}Lc(r)}function Bb(r,a){for(var l=r.suspendedLanes,c=r.pingedLanes,m=r.expirationTimes,g=r.pendingLanes&-62914561;0<g;){var w=31-mn(g),b=1<<w,R=m[w];R===-1?((b&l)===0||(b&c)!==0)&&(m[w]=Hu(b,a)):R<=a&&(r.expiredLanes|=b),g&=~b}if(a=ft,l=He,l=Bo(r,r===a?l:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),c=r.callbackNode,l===0||r===a&&(tt===2||tt===9)||r.cancelPendingCommit!==null)return c!==null&&c!==null&&ga(c),r.callbackNode=null,r.callbackPriority=0;if((l&3)===0||Ta(r,l)){if(a=l&-l,a===r.callbackPriority)return a;switch(c!==null&&ga(c),zo(l)){case 2:case 8:l=Uo;break;case 32:l=_a;break;case 268435456:l=Fo;break;default:l=_a}return c=zb.bind(null,r),l=pa(l,c),r.callbackPriority=a,r.callbackNode=l,a}return c!==null&&c!==null&&ga(c),r.callbackPriority=2,r.callbackNode=null,2}function zb(r,a){if(cn!==0&&cn!==5)return r.callbackNode=null,r.callbackPriority=0,null;var l=r.callbackNode;if(Uf()&&r.callbackNode!==l)return null;var c=He;return c=Bo(r,r===ft?c:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),c===0?null:(bb(r,c,a),Bb(r,ai()),r.callbackNode!=null&&r.callbackNode===l?zb.bind(null,r):null)}function qb(r,a){if(Uf())return null;bb(r,a,!0)}function oP(){_P(function(){(et&6)!==0?pa(qu,aP):Fb()})}function ny(){return $a===0&&($a=Gu()),$a}function jb(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Yo(""+r)}function Hb(r,a){var l=a.ownerDocument.createElement("input");return l.name=a.name,l.value=a.value,r.id&&l.setAttribute("form",r.id),a.parentNode.insertBefore(l,a),r=new FormData(r),l.parentNode.removeChild(l),r}function lP(r,a,l,c,m){if(a==="submit"&&l&&l.stateNode===m){var g=jb((m[Lt]||null).action),w=c.submitter;w&&(a=(a=w[Lt]||null)?jb(a.formAction):w.getAttribute("formAction"),a!==null&&(g=a,w=null));var b=new Qo("action","action",null,c,m);r.push({event:b,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if($a!==0){var R=w?Hb(m,w):new FormData(m);w_(l,{pending:!0,data:R,method:m.method,action:g},null,R)}}else typeof g=="function"&&(b.preventDefault(),R=w?Hb(m,w):new FormData(m),w_(l,{pending:!0,data:R,method:m.method,action:g},g,R))},currentTarget:m}]})}}for(var iy=0;iy<zg.length;iy++){var ry=zg[iy],uP=ry.toLowerCase(),cP=ry[0].toUpperCase()+ry.slice(1);Di(uP,"on"+cP)}Di(bw,"onAnimationEnd"),Di(Iw,"onAnimationIteration"),Di(Sw,"onAnimationStart"),Di("dblclick","onDoubleClick"),Di("focusin","onFocus"),Di("focusout","onBlur"),Di(Rx,"onTransitionRun"),Di(Cx,"onTransitionStart"),Di(Dx,"onTransitionCancel"),Di(Aw,"onTransitionEnd"),gr("onMouseEnter",["mouseout","mouseover"]),gr("onMouseLeave",["mouseout","mouseover"]),gr("onPointerEnter",["pointerout","pointerover"]),gr("onPointerLeave",["pointerout","pointerover"]),Ri("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ri("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ri("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ri("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ri("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ri("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Uc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),hP=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Uc));function Gb(r,a){a=(a&4)!==0;for(var l=0;l<r.length;l++){var c=r[l],m=c.event;c=c.listeners;e:{var g=void 0;if(a)for(var w=c.length-1;0<=w;w--){var b=c[w],R=b.instance,j=b.currentTarget;if(b=b.listener,R!==g&&m.isPropagationStopped())break e;g=b,m.currentTarget=j;try{g(m)}catch($){Rf($)}m.currentTarget=null,g=R}else for(w=0;w<c.length;w++){if(b=c[w],R=b.instance,j=b.currentTarget,b=b.listener,R!==g&&m.isPropagationStopped())break e;g=b,m.currentTarget=j;try{g(m)}catch($){Rf($)}m.currentTarget=null,g=R}}}}function Fe(r,a){var l=a[Wu];l===void 0&&(l=a[Wu]=new Set);var c=r+"__bubble";l.has(c)||(Kb(a,r,2,!1),l.add(c))}function sy(r,a,l){var c=0;a&&(c|=4),Kb(l,r,c,a)}var zf="_reactListening"+Math.random().toString(36).slice(2);function ay(r){if(!r[zf]){r[zf]=!0,$u.forEach(function(l){l!=="selectionchange"&&(hP.has(l)||sy(l,!1,r),sy(l,!0,r))});var a=r.nodeType===9?r:r.ownerDocument;a===null||a[zf]||(a[zf]=!0,sy("selectionchange",!1,a))}}function Kb(r,a,l,c){switch(gI(a)){case 2:var m=UP;break;case 8:m=FP;break;default:m=Ey}l=m.bind(null,a,l,r),m=void 0,!ci||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(m=!0),c?m!==void 0?r.addEventListener(a,l,{capture:!0,passive:m}):r.addEventListener(a,l,!0):m!==void 0?r.addEventListener(a,l,{passive:m}):r.addEventListener(a,l,!1)}function oy(r,a,l,c,m){var g=c;if((a&1)===0&&(a&2)===0&&c!==null)e:for(;;){if(c===null)return;var w=c.tag;if(w===3||w===4){var b=c.stateNode.containerInfo;if(b===m)break;if(w===4)for(w=c.return;w!==null;){var R=w.tag;if((R===3||R===4)&&w.stateNode.containerInfo===m)return;w=w.return}for(;b!==null;){if(w=pr(b),w===null)return;if(R=w.tag,R===5||R===6||R===26||R===27){c=g=w;continue e}b=b.parentNode}}c=c.return}qd(function(){var j=g,$=ui(l),J=[];e:{var H=Rw.get(r);if(H!==void 0){var G=Qo,Re=r;switch(r){case"keypress":if(Gi(l)===0)break e;case"keydown":case"keyup":G=el;break;case"focusin":Re="focus",G=Xo;break;case"focusout":Re="blur",G=Xo;break;case"beforeblur":case"afterblur":G=Xo;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":G=hi;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":G=Pg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":G=$d;break;case bw:case Iw:case Sw:G=Jo;break;case Aw:G=Jd;break;case"scroll":case"scrollend":G=jd;break;case"wheel":G=tl;break;case"copy":case"cut":case"paste":G=Zo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":G=lc;break;case"toggle":case"beforetoggle":G=ef}var we=(a&4)!==0,ut=!we&&(r==="scroll"||r==="scrollend"),L=we?H!==null?H+"Capture":null:H;we=[];for(var k=j,q;k!==null;){var X=k;if(q=X.stateNode,X=X.tag,X!==5&&X!==26&&X!==27||q===null||L===null||(X=Da(k,L),X!=null&&we.push(Fc(k,X,q))),ut)break;k=k.return}0<we.length&&(H=new G(H,Re,null,l,$),J.push({event:H,listeners:we}))}}if((a&7)===0){e:{if(H=r==="mouseover"||r==="pointerover",G=r==="mouseout"||r==="pointerout",H&&l!==vr&&(Re=l.relatedTarget||l.fromElement)&&(pr(Re)||Re[oi]))break e;if((G||H)&&(H=$.window===$?$:(H=$.ownerDocument)?H.defaultView||H.parentWindow:window,G?(Re=l.relatedTarget||l.toElement,G=j,Re=Re?pr(Re):null,Re!==null&&(ut=o(Re),we=Re.tag,Re!==ut||we!==5&&we!==27&&we!==6)&&(Re=null)):(G=null,Re=j),G!==Re)){if(we=hi,X="onMouseLeave",L="onMouseEnter",k="mouse",(r==="pointerout"||r==="pointerover")&&(we=lc,X="onPointerLeave",L="onPointerEnter",k="pointer"),ut=G==null?H:zi(G),q=Re==null?H:zi(Re),H=new we(X,k+"leave",G,l,$),H.target=ut,H.relatedTarget=q,X=null,pr($)===j&&(we=new we(L,k+"enter",Re,l,$),we.target=q,we.relatedTarget=ut,X=we),ut=X,G&&Re)t:{for(we=G,L=Re,k=0,q=we;q;q=Al(q))k++;for(q=0,X=L;X;X=Al(X))q++;for(;0<k-q;)we=Al(we),k--;for(;0<q-k;)L=Al(L),q--;for(;k--;){if(we===L||L!==null&&we===L.alternate)break t;we=Al(we),L=Al(L)}we=null}else we=null;G!==null&&Yb(J,H,G,we,!1),Re!==null&&ut!==null&&Yb(J,ut,Re,we,!0)}}e:{if(H=j?zi(j):window,G=H.nodeName&&H.nodeName.toLowerCase(),G==="select"||G==="input"&&H.type==="file")var pe=dw;else if(Ht(H))if(fw)pe=Ix;else{pe=wx;var Me=Tx}else G=H.nodeName,!G||G.toLowerCase()!=="input"||H.type!=="checkbox"&&H.type!=="radio"?j&&tc(j.elementType)&&(pe=dw):pe=bx;if(pe&&(pe=pe(r,j))){Ir(J,pe,l,$);break e}Me&&Me(r,H,j),r==="focusout"&&j&&H.type==="number"&&j.memoizedProps.value!=null&&hs(H,"number",H.value)}switch(Me=j?zi(j):window,r){case"focusin":(Ht(Me)||Me.contentEditable==="true")&&(nl=Me,Ug=j,hc=null);break;case"focusout":hc=Ug=nl=null;break;case"mousedown":Fg=!0;break;case"contextmenu":case"mouseup":case"dragend":Fg=!1,Tw(J,l,$);break;case"selectionchange":if(Ax)break;case"keydown":case"keyup":Tw(J,l,$)}var ye;if(Qi)e:{switch(r){case"compositionstart":var be="onCompositionStart";break e;case"compositionend":be="onCompositionEnd";break e;case"compositionupdate":be="onCompositionUpdate";break e}be=void 0}else qe?K(r,l)&&(be="onCompositionEnd"):r==="keydown"&&l.keyCode===229&&(be="onCompositionStart");be&&(E&&l.locale!=="ko"&&(qe||be!=="onCompositionStart"?be==="onCompositionEnd"&&qe&&(ye=ic()):(Hi=$,ds="value"in Hi?Hi.value:Hi.textContent,qe=!0)),Me=qf(j,be),0<Me.length&&(be=new ac(be,r,null,l,$),J.push({event:be,listeners:Me}),ye?be.data=ye:(ye=oe(l),ye!==null&&(be.data=ye)))),(ye=y?jt(r,l):je(r,l))&&(be=qf(j,"onBeforeInput"),0<be.length&&(Me=new ac("onBeforeInput","beforeinput",null,l,$),J.push({event:Me,listeners:be}),Me.data=ye)),lP(J,r,j,l,$)}Gb(J,a)})}function Fc(r,a,l){return{instance:r,listener:a,currentTarget:l}}function qf(r,a){for(var l=a+"Capture",c=[];r!==null;){var m=r,g=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||g===null||(m=Da(r,l),m!=null&&c.unshift(Fc(r,m,g)),m=Da(r,a),m!=null&&c.push(Fc(r,m,g))),r.tag===3)return c;r=r.return}return[]}function Al(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function Yb(r,a,l,c,m){for(var g=a._reactName,w=[];l!==null&&l!==c;){var b=l,R=b.alternate,j=b.stateNode;if(b=b.tag,R!==null&&R===c)break;b!==5&&b!==26&&b!==27||j===null||(R=j,m?(j=Da(l,g),j!=null&&w.unshift(Fc(l,j,R))):m||(j=Da(l,g),j!=null&&w.push(Fc(l,j,R)))),l=l.return}w.length!==0&&r.push({event:a,listeners:w})}var dP=/\r\n?/g,fP=/\u0000|\uFFFD/g;function Qb(r){return(typeof r=="string"?r:""+r).replace(dP,`
`).replace(fP,"")}function Wb(r,a){return a=Qb(a),Qb(r)===a}function jf(){}function lt(r,a,l,c,m,g){switch(l){case"children":typeof c=="string"?a==="body"||a==="textarea"&&c===""||li(r,c):(typeof c=="number"||typeof c=="bigint")&&a!=="body"&&li(r,""+c);break;case"className":qi(r,"class",c);break;case"tabIndex":qi(r,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":qi(r,l,c);break;case"style":ec(r,c,g);break;case"data":if(a!=="object"){qi(r,"data",c);break}case"src":case"href":if(c===""&&(a!=="a"||l!=="href")){r.removeAttribute(l);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){r.removeAttribute(l);break}c=Yo(""+c),r.setAttribute(l,c);break;case"action":case"formAction":if(typeof c=="function"){r.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(l==="formAction"?(a!=="input"&&lt(r,a,"name",m.name,m,null),lt(r,a,"formEncType",m.formEncType,m,null),lt(r,a,"formMethod",m.formMethod,m,null),lt(r,a,"formTarget",m.formTarget,m,null)):(lt(r,a,"encType",m.encType,m,null),lt(r,a,"method",m.method,m,null),lt(r,a,"target",m.target,m,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){r.removeAttribute(l);break}c=Yo(""+c),r.setAttribute(l,c);break;case"onClick":c!=null&&(r.onclick=jf);break;case"onScroll":c!=null&&Fe("scroll",r);break;case"onScrollEnd":c!=null&&Fe("scrollend",r);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(l=c.__html,l!=null){if(m.children!=null)throw Error(i(60));r.innerHTML=l}}break;case"multiple":r.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":r.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){r.removeAttribute("xlink:href");break}l=Yo(""+c),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?r.setAttribute(l,""+c):r.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?r.setAttribute(l,""):r.removeAttribute(l);break;case"capture":case"download":c===!0?r.setAttribute(l,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?r.setAttribute(l,c):r.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?r.setAttribute(l,c):r.removeAttribute(l);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?r.removeAttribute(l):r.setAttribute(l,c);break;case"popover":Fe("beforetoggle",r),Fe("toggle",r),cs(r,"popover",c);break;case"xlinkActuate":on(r,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":on(r,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":on(r,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":on(r,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":on(r,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":on(r,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":on(r,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":on(r,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":on(r,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":cs(r,"is",c);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Og.get(l)||l,cs(r,l,c))}}function ly(r,a,l,c,m,g){switch(l){case"style":ec(r,c,g);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(l=c.__html,l!=null){if(m.children!=null)throw Error(i(60));r.innerHTML=l}}break;case"children":typeof c=="string"?li(r,c):(typeof c=="number"||typeof c=="bigint")&&li(r,""+c);break;case"onScroll":c!=null&&Fe("scroll",r);break;case"onScrollEnd":c!=null&&Fe("scrollend",r);break;case"onClick":c!=null&&(r.onclick=jf);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!qo.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(m=l.endsWith("Capture"),a=l.slice(2,m?l.length-7:void 0),g=r[Lt]||null,g=g!=null?g[l]:null,typeof g=="function"&&r.removeEventListener(a,g,m),typeof c=="function")){typeof g!="function"&&g!==null&&(l in r?r[l]=null:r.hasAttribute(l)&&r.removeAttribute(l)),r.addEventListener(a,c,m);break e}l in r?r[l]=c:c===!0?r.setAttribute(l,""):cs(r,l,c)}}}function hn(r,a,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Fe("error",r),Fe("load",r);var c=!1,m=!1,g;for(g in l)if(l.hasOwnProperty(g)){var w=l[g];if(w!=null)switch(g){case"src":c=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:lt(r,a,g,w,l,null)}}m&&lt(r,a,"srcSet",l.srcSet,l,null),c&&lt(r,a,"src",l.src,l,null);return;case"input":Fe("invalid",r);var b=g=w=m=null,R=null,j=null;for(c in l)if(l.hasOwnProperty(c)){var $=l[c];if($!=null)switch(c){case"name":m=$;break;case"type":w=$;break;case"checked":R=$;break;case"defaultChecked":j=$;break;case"value":g=$;break;case"defaultValue":b=$;break;case"children":case"dangerouslySetInnerHTML":if($!=null)throw Error(i(137,a));break;default:lt(r,a,c,$,l,null)}}Aa(r,g,b,R,j,w,m,!1),Ko(r);return;case"select":Fe("invalid",r),c=w=g=null;for(m in l)if(l.hasOwnProperty(m)&&(b=l[m],b!=null))switch(m){case"value":g=b;break;case"defaultValue":w=b;break;case"multiple":c=b;default:lt(r,a,m,b,l,null)}a=g,l=w,r.multiple=!!c,a!=null?yr(r,!!c,a,!1):l!=null&&yr(r,!!c,l,!0);return;case"textarea":Fe("invalid",r),g=m=c=null;for(w in l)if(l.hasOwnProperty(w)&&(b=l[w],b!=null))switch(w){case"value":c=b;break;case"defaultValue":m=b;break;case"children":g=b;break;case"dangerouslySetInnerHTML":if(b!=null)throw Error(i(91));break;default:lt(r,a,w,b,l,null)}Ra(r,c,m,g),Ko(r);return;case"option":for(R in l)if(l.hasOwnProperty(R)&&(c=l[R],c!=null))switch(R){case"selected":r.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:lt(r,a,R,c,l,null)}return;case"dialog":Fe("beforetoggle",r),Fe("toggle",r),Fe("cancel",r),Fe("close",r);break;case"iframe":case"object":Fe("load",r);break;case"video":case"audio":for(c=0;c<Uc.length;c++)Fe(Uc[c],r);break;case"image":Fe("error",r),Fe("load",r);break;case"details":Fe("toggle",r);break;case"embed":case"source":case"link":Fe("error",r),Fe("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(j in l)if(l.hasOwnProperty(j)&&(c=l[j],c!=null))switch(j){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:lt(r,a,j,c,l,null)}return;default:if(tc(a)){for($ in l)l.hasOwnProperty($)&&(c=l[$],c!==void 0&&ly(r,a,$,c,l,void 0));return}}for(b in l)l.hasOwnProperty(b)&&(c=l[b],c!=null&&lt(r,a,b,c,l,null))}function mP(r,a,l,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,g=null,w=null,b=null,R=null,j=null,$=null;for(G in l){var J=l[G];if(l.hasOwnProperty(G)&&J!=null)switch(G){case"checked":break;case"value":break;case"defaultValue":R=J;default:c.hasOwnProperty(G)||lt(r,a,G,null,c,J)}}for(var H in c){var G=c[H];if(J=l[H],c.hasOwnProperty(H)&&(G!=null||J!=null))switch(H){case"type":g=G;break;case"name":m=G;break;case"checked":j=G;break;case"defaultChecked":$=G;break;case"value":w=G;break;case"defaultValue":b=G;break;case"children":case"dangerouslySetInnerHTML":if(G!=null)throw Error(i(137,a));break;default:G!==J&&lt(r,a,H,G,c,J)}}Hn(r,w,b,R,j,$,g,m);return;case"select":G=w=b=H=null;for(g in l)if(R=l[g],l.hasOwnProperty(g)&&R!=null)switch(g){case"value":break;case"multiple":G=R;default:c.hasOwnProperty(g)||lt(r,a,g,null,c,R)}for(m in c)if(g=c[m],R=l[m],c.hasOwnProperty(m)&&(g!=null||R!=null))switch(m){case"value":H=g;break;case"defaultValue":b=g;break;case"multiple":w=g;default:g!==R&&lt(r,a,m,g,c,R)}a=b,l=w,c=G,H!=null?yr(r,!!l,H,!1):!!c!=!!l&&(a!=null?yr(r,!!l,a,!0):yr(r,!!l,l?[]:"",!1));return;case"textarea":G=H=null;for(b in l)if(m=l[b],l.hasOwnProperty(b)&&m!=null&&!c.hasOwnProperty(b))switch(b){case"value":break;case"children":break;default:lt(r,a,b,null,c,m)}for(w in c)if(m=c[w],g=l[w],c.hasOwnProperty(w)&&(m!=null||g!=null))switch(w){case"value":H=m;break;case"defaultValue":G=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(i(91));break;default:m!==g&&lt(r,a,w,m,c,g)}at(r,H,G);return;case"option":for(var Re in l)if(H=l[Re],l.hasOwnProperty(Re)&&H!=null&&!c.hasOwnProperty(Re))switch(Re){case"selected":r.selected=!1;break;default:lt(r,a,Re,null,c,H)}for(R in c)if(H=c[R],G=l[R],c.hasOwnProperty(R)&&H!==G&&(H!=null||G!=null))switch(R){case"selected":r.selected=H&&typeof H!="function"&&typeof H!="symbol";break;default:lt(r,a,R,H,c,G)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var we in l)H=l[we],l.hasOwnProperty(we)&&H!=null&&!c.hasOwnProperty(we)&&lt(r,a,we,null,c,H);for(j in c)if(H=c[j],G=l[j],c.hasOwnProperty(j)&&H!==G&&(H!=null||G!=null))switch(j){case"children":case"dangerouslySetInnerHTML":if(H!=null)throw Error(i(137,a));break;default:lt(r,a,j,H,c,G)}return;default:if(tc(a)){for(var ut in l)H=l[ut],l.hasOwnProperty(ut)&&H!==void 0&&!c.hasOwnProperty(ut)&&ly(r,a,ut,void 0,c,H);for($ in c)H=c[$],G=l[$],!c.hasOwnProperty($)||H===G||H===void 0&&G===void 0||ly(r,a,$,H,c,G);return}}for(var L in l)H=l[L],l.hasOwnProperty(L)&&H!=null&&!c.hasOwnProperty(L)&&lt(r,a,L,null,c,H);for(J in c)H=c[J],G=l[J],!c.hasOwnProperty(J)||H===G||H==null&&G==null||lt(r,a,J,H,c,G)}var uy=null,cy=null;function Hf(r){return r.nodeType===9?r:r.ownerDocument}function $b(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Xb(r,a){if(r===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&a==="foreignObject"?0:r}function hy(r,a){return r==="textarea"||r==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var dy=null;function pP(){var r=window.event;return r&&r.type==="popstate"?r===dy?!1:(dy=r,!0):(dy=null,!1)}var Jb=typeof setTimeout=="function"?setTimeout:void 0,gP=typeof clearTimeout=="function"?clearTimeout:void 0,Zb=typeof Promise=="function"?Promise:void 0,_P=typeof queueMicrotask=="function"?queueMicrotask:typeof Zb<"u"?function(r){return Zb.resolve(null).then(r).catch(yP)}:Jb;function yP(r){setTimeout(function(){throw r})}function Cs(r){return r==="head"}function eI(r,a){var l=a,c=0,m=0;do{var g=l.nextSibling;if(r.removeChild(l),g&&g.nodeType===8)if(l=g.data,l==="/$"){if(0<c&&8>c){l=c;var w=r.ownerDocument;if(l&1&&Bc(w.documentElement),l&2&&Bc(w.body),l&4)for(l=w.head,Bc(l),w=l.firstChild;w;){var b=w.nextSibling,R=w.nodeName;w[wa]||R==="SCRIPT"||R==="STYLE"||R==="LINK"&&w.rel.toLowerCase()==="stylesheet"||l.removeChild(w),w=b}}if(m===0){r.removeChild(g),Qc(a);return}m--}else l==="$"||l==="$?"||l==="$!"?m++:c=l.charCodeAt(0)-48;else c=0;l=g}while(l);Qc(a)}function fy(r){var a=r.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var l=a;switch(a=a.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":fy(l),us(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}r.removeChild(l)}}function vP(r,a,l,c){for(;r.nodeType===1;){var m=l;if(r.nodeName.toLowerCase()!==a.toLowerCase()){if(!c&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(c){if(!r[wa])switch(a){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(g=r.getAttribute("rel"),g==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(g!==m.rel||r.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||r.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||r.getAttribute("title")!==(m.title==null?null:m.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(g=r.getAttribute("src"),(g!==(m.src==null?null:m.src)||r.getAttribute("type")!==(m.type==null?null:m.type)||r.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&g&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(a==="input"&&r.type==="hidden"){var g=m.name==null?null:""+m.name;if(m.type==="hidden"&&r.getAttribute("name")===g)return r}else return r;if(r=Oi(r.nextSibling),r===null)break}return null}function EP(r,a,l){if(a==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!l||(r=Oi(r.nextSibling),r===null))return null;return r}function my(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState==="complete"}function TP(r,a){var l=r.ownerDocument;if(r.data!=="$?"||l.readyState==="complete")a();else{var c=function(){a(),l.removeEventListener("DOMContentLoaded",c)};l.addEventListener("DOMContentLoaded",c),r._reactRetry=c}}function Oi(r){for(;r!=null;r=r.nextSibling){var a=r.nodeType;if(a===1||a===3)break;if(a===8){if(a=r.data,a==="$"||a==="$!"||a==="$?"||a==="F!"||a==="F")break;if(a==="/$")return null}}return r}var py=null;function tI(r){r=r.previousSibling;for(var a=0;r;){if(r.nodeType===8){var l=r.data;if(l==="$"||l==="$!"||l==="$?"){if(a===0)return r;a--}else l==="/$"&&a++}r=r.previousSibling}return null}function nI(r,a,l){switch(a=Hf(l),r){case"html":if(r=a.documentElement,!r)throw Error(i(452));return r;case"head":if(r=a.head,!r)throw Error(i(453));return r;case"body":if(r=a.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function Bc(r){for(var a=r.attributes;a.length;)r.removeAttributeNode(a[0]);us(r)}var yi=new Map,iI=new Set;function Gf(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Lr=ce.d;ce.d={f:wP,r:bP,D:IP,C:SP,L:AP,m:RP,X:DP,S:CP,M:NP};function wP(){var r=Lr.f(),a=Vf();return r||a}function bP(r){var a=Bi(r);a!==null&&a.tag===5&&a.type==="form"?b0(a):Lr.r(r)}var Rl=typeof document>"u"?null:document;function rI(r,a,l){var c=Rl;if(c&&typeof a=="string"&&a){var m=Ut(a);m='link[rel="'+r+'"][href="'+m+'"]',typeof l=="string"&&(m+='[crossorigin="'+l+'"]'),iI.has(m)||(iI.add(m),r={rel:r,crossOrigin:l,href:a},c.querySelector(m)===null&&(a=c.createElement("link"),hn(a,"link",r),Nt(a),c.head.appendChild(a)))}}function IP(r){Lr.D(r),rI("dns-prefetch",r,null)}function SP(r,a){Lr.C(r,a),rI("preconnect",r,a)}function AP(r,a,l){Lr.L(r,a,l);var c=Rl;if(c&&r&&a){var m='link[rel="preload"][as="'+Ut(a)+'"]';a==="image"&&l&&l.imageSrcSet?(m+='[imagesrcset="'+Ut(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(m+='[imagesizes="'+Ut(l.imageSizes)+'"]')):m+='[href="'+Ut(r)+'"]';var g=m;switch(a){case"style":g=Cl(r);break;case"script":g=Dl(r)}yi.has(g)||(r=_({rel:"preload",href:a==="image"&&l&&l.imageSrcSet?void 0:r,as:a},l),yi.set(g,r),c.querySelector(m)!==null||a==="style"&&c.querySelector(zc(g))||a==="script"&&c.querySelector(qc(g))||(a=c.createElement("link"),hn(a,"link",r),Nt(a),c.head.appendChild(a)))}}function RP(r,a){Lr.m(r,a);var l=Rl;if(l&&r){var c=a&&typeof a.as=="string"?a.as:"script",m='link[rel="modulepreload"][as="'+Ut(c)+'"][href="'+Ut(r)+'"]',g=m;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=Dl(r)}if(!yi.has(g)&&(r=_({rel:"modulepreload",href:r},a),yi.set(g,r),l.querySelector(m)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(qc(g)))return}c=l.createElement("link"),hn(c,"link",r),Nt(c),l.head.appendChild(c)}}}function CP(r,a,l){Lr.S(r,a,l);var c=Rl;if(c&&r){var m=Sn(c).hoistableStyles,g=Cl(r);a=a||"default";var w=m.get(g);if(!w){var b={loading:0,preload:null};if(w=c.querySelector(zc(g)))b.loading=5;else{r=_({rel:"stylesheet",href:r,"data-precedence":a},l),(l=yi.get(g))&&gy(r,l);var R=w=c.createElement("link");Nt(R),hn(R,"link",r),R._p=new Promise(function(j,$){R.onload=j,R.onerror=$}),R.addEventListener("load",function(){b.loading|=1}),R.addEventListener("error",function(){b.loading|=2}),b.loading|=4,Kf(w,a,c)}w={type:"stylesheet",instance:w,count:1,state:b},m.set(g,w)}}}function DP(r,a){Lr.X(r,a);var l=Rl;if(l&&r){var c=Sn(l).hoistableScripts,m=Dl(r),g=c.get(m);g||(g=l.querySelector(qc(m)),g||(r=_({src:r,async:!0},a),(a=yi.get(m))&&_y(r,a),g=l.createElement("script"),Nt(g),hn(g,"link",r),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(m,g))}}function NP(r,a){Lr.M(r,a);var l=Rl;if(l&&r){var c=Sn(l).hoistableScripts,m=Dl(r),g=c.get(m);g||(g=l.querySelector(qc(m)),g||(r=_({src:r,async:!0,type:"module"},a),(a=yi.get(m))&&_y(r,a),g=l.createElement("script"),Nt(g),hn(g,"link",r),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(m,g))}}function sI(r,a,l,c){var m=(m=Ce.current)?Gf(m):null;if(!m)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(a=Cl(l.href),l=Sn(m).hoistableStyles,c=l.get(a),c||(c={type:"style",instance:null,count:0,state:null},l.set(a,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){r=Cl(l.href);var g=Sn(m).hoistableStyles,w=g.get(r);if(w||(m=m.ownerDocument||m,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(r,w),(g=m.querySelector(zc(r)))&&!g._p&&(w.instance=g,w.state.loading=5),yi.has(r)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},yi.set(r,l),g||OP(m,r,l,w.state))),a&&c===null)throw Error(i(528,""));return w}if(a&&c!==null)throw Error(i(529,""));return null;case"script":return a=l.async,l=l.src,typeof l=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Dl(l),l=Sn(m).hoistableScripts,c=l.get(a),c||(c={type:"script",instance:null,count:0,state:null},l.set(a,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function Cl(r){return'href="'+Ut(r)+'"'}function zc(r){return'link[rel="stylesheet"]['+r+"]"}function aI(r){return _({},r,{"data-precedence":r.precedence,precedence:null})}function OP(r,a,l,c){r.querySelector('link[rel="preload"][as="style"]['+a+"]")?c.loading=1:(a=r.createElement("link"),c.preload=a,a.addEventListener("load",function(){return c.loading|=1}),a.addEventListener("error",function(){return c.loading|=2}),hn(a,"link",l),Nt(a),r.head.appendChild(a))}function Dl(r){return'[src="'+Ut(r)+'"]'}function qc(r){return"script[async]"+r}function oI(r,a,l){if(a.count++,a.instance===null)switch(a.type){case"style":var c=r.querySelector('style[data-href~="'+Ut(l.href)+'"]');if(c)return a.instance=c,Nt(c),c;var m=_({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return c=(r.ownerDocument||r).createElement("style"),Nt(c),hn(c,"style",m),Kf(c,l.precedence,r),a.instance=c;case"stylesheet":m=Cl(l.href);var g=r.querySelector(zc(m));if(g)return a.state.loading|=4,a.instance=g,Nt(g),g;c=aI(l),(m=yi.get(m))&&gy(c,m),g=(r.ownerDocument||r).createElement("link"),Nt(g);var w=g;return w._p=new Promise(function(b,R){w.onload=b,w.onerror=R}),hn(g,"link",c),a.state.loading|=4,Kf(g,l.precedence,r),a.instance=g;case"script":return g=Dl(l.src),(m=r.querySelector(qc(g)))?(a.instance=m,Nt(m),m):(c=l,(m=yi.get(g))&&(c=_({},l),_y(c,m)),r=r.ownerDocument||r,m=r.createElement("script"),Nt(m),hn(m,"link",c),r.head.appendChild(m),a.instance=m);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(c=a.instance,a.state.loading|=4,Kf(c,l.precedence,r));return a.instance}function Kf(r,a,l){for(var c=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=c.length?c[c.length-1]:null,g=m,w=0;w<c.length;w++){var b=c[w];if(b.dataset.precedence===a)g=b;else if(g!==m)break}g?g.parentNode.insertBefore(r,g.nextSibling):(a=l.nodeType===9?l.head:l,a.insertBefore(r,a.firstChild))}function gy(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.title==null&&(r.title=a.title)}function _y(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.integrity==null&&(r.integrity=a.integrity)}var Yf=null;function lI(r,a,l){if(Yf===null){var c=new Map,m=Yf=new Map;m.set(l,c)}else m=Yf,c=m.get(l),c||(c=new Map,m.set(l,c));if(c.has(r))return c;for(c.set(r,null),l=l.getElementsByTagName(r),m=0;m<l.length;m++){var g=l[m];if(!(g[wa]||g[qt]||r==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var w=g.getAttribute(a)||"";w=r+w;var b=c.get(w);b?b.push(g):c.set(w,[g])}}return c}function uI(r,a,l){r=r.ownerDocument||r,r.head.insertBefore(l,a==="title"?r.querySelector("head > title"):null)}function xP(r,a,l){if(l===1||a.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return r=a.disabled,typeof a.precedence=="string"&&r==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function cI(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}var jc=null;function PP(){}function kP(r,a,l){if(jc===null)throw Error(i(475));var c=jc;if(a.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var m=Cl(l.href),g=r.querySelector(zc(m));if(g){r=g._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(c.count++,c=Qf.bind(c),r.then(c,c)),a.state.loading|=4,a.instance=g,Nt(g);return}g=r.ownerDocument||r,l=aI(l),(m=yi.get(m))&&gy(l,m),g=g.createElement("link"),Nt(g);var w=g;w._p=new Promise(function(b,R){w.onload=b,w.onerror=R}),hn(g,"link",l),a.instance=g}c.stylesheets===null&&(c.stylesheets=new Map),c.stylesheets.set(a,r),(r=a.state.preload)&&(a.state.loading&3)===0&&(c.count++,a=Qf.bind(c),r.addEventListener("load",a),r.addEventListener("error",a))}}function MP(){if(jc===null)throw Error(i(475));var r=jc;return r.stylesheets&&r.count===0&&yy(r,r.stylesheets),0<r.count?function(a){var l=setTimeout(function(){if(r.stylesheets&&yy(r,r.stylesheets),r.unsuspend){var c=r.unsuspend;r.unsuspend=null,c()}},6e4);return r.unsuspend=a,function(){r.unsuspend=null,clearTimeout(l)}}:null}function Qf(){if(this.count--,this.count===0){if(this.stylesheets)yy(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Wf=null;function yy(r,a){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Wf=new Map,a.forEach(VP,r),Wf=null,Qf.call(r))}function VP(r,a){if(!(a.state.loading&4)){var l=Wf.get(r);if(l)var c=l.get(null);else{l=new Map,Wf.set(r,l);for(var m=r.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<m.length;g++){var w=m[g];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(l.set(w.dataset.precedence,w),c=w)}c&&l.set(null,c)}m=a.instance,w=m.getAttribute("data-precedence"),g=l.get(w)||c,g===c&&l.set(null,m),l.set(w,m),this.count++,c=Qf.bind(this),m.addEventListener("load",c),m.addEventListener("error",c),g?g.parentNode.insertBefore(m,g.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(m,r.firstChild)),a.state.loading|=4}}var Hc={$$typeof:Y,Provider:null,Consumer:null,_currentValue:ve,_currentValue2:ve,_threadCount:0};function LP(r,a,l,c,m,g,w,b){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=fr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fr(0),this.hiddenUpdates=fr(null),this.identifierPrefix=c,this.onUncaughtError=m,this.onCaughtError=g,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=b,this.incompleteTransitions=new Map}function hI(r,a,l,c,m,g,w,b,R,j,$,J){return r=new LP(r,a,l,w,b,R,j,J),a=1,g===!0&&(a|=24),g=Kn(3,null,null,a),r.current=g,g.stateNode=r,a=Zg(),a.refCount++,r.pooledCache=a,a.refCount++,g.memoizedState={element:c,isDehydrated:l,cache:a},i_(g),r}function dI(r){return r?(r=al,r):al}function fI(r,a,l,c,m,g){m=dI(m),c.context===null?c.context=m:c.pendingContext=m,c=ps(a),c.payload={element:l},g=g===void 0?null:g,g!==null&&(c.callback=g),l=gs(r,c,a),l!==null&&(Xn(l,r,a),Ec(l,r,a))}function mI(r,a){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var l=r.retryLane;r.retryLane=l!==0&&l<a?l:a}}function vy(r,a){mI(r,a),(r=r.alternate)&&mI(r,a)}function pI(r){if(r.tag===13){var a=sl(r,67108864);a!==null&&Xn(a,r,67108864),vy(r,67108864)}}var $f=!0;function UP(r,a,l,c){var m=W.T;W.T=null;var g=ce.p;try{ce.p=2,Ey(r,a,l,c)}finally{ce.p=g,W.T=m}}function FP(r,a,l,c){var m=W.T;W.T=null;var g=ce.p;try{ce.p=8,Ey(r,a,l,c)}finally{ce.p=g,W.T=m}}function Ey(r,a,l,c){if($f){var m=Ty(c);if(m===null)oy(r,a,c,Xf,l),_I(r,c);else if(zP(m,r,a,l,c))c.stopPropagation();else if(_I(r,c),a&4&&-1<BP.indexOf(r)){for(;m!==null;){var g=Bi(m);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var w=Ai(g.pendingLanes);if(w!==0){var b=g;for(b.pendingLanes|=2,b.entangledLanes|=2;w;){var R=1<<31-mn(w);b.entanglements[1]|=R,w&=~R}er(g),(et&6)===0&&(kf=ai()+500,Lc(0))}}break;case 13:b=sl(g,2),b!==null&&Xn(b,g,2),Vf(),vy(g,2)}if(g=Ty(c),g===null&&oy(r,a,c,Xf,l),g===m)break;m=g}m!==null&&c.stopPropagation()}else oy(r,a,c,null,l)}}function Ty(r){return r=ui(r),wy(r)}var Xf=null;function wy(r){if(Xf=null,r=pr(r),r!==null){var a=o(r);if(a===null)r=null;else{var l=a.tag;if(l===13){if(r=u(a),r!==null)return r;r=null}else if(l===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;r=null}else a!==r&&(r=null)}}return Xf=r,null}function gI(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Sg()){case qu:return 2;case Uo:return 8;case _a:case Ag:return 32;case Fo:return 268435456;default:return 32}default:return 32}}var by=!1,Ds=null,Ns=null,Os=null,Gc=new Map,Kc=new Map,xs=[],BP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function _I(r,a){switch(r){case"focusin":case"focusout":Ds=null;break;case"dragenter":case"dragleave":Ns=null;break;case"mouseover":case"mouseout":Os=null;break;case"pointerover":case"pointerout":Gc.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Kc.delete(a.pointerId)}}function Yc(r,a,l,c,m,g){return r===null||r.nativeEvent!==g?(r={blockedOn:a,domEventName:l,eventSystemFlags:c,nativeEvent:g,targetContainers:[m]},a!==null&&(a=Bi(a),a!==null&&pI(a)),r):(r.eventSystemFlags|=c,a=r.targetContainers,m!==null&&a.indexOf(m)===-1&&a.push(m),r)}function zP(r,a,l,c,m){switch(a){case"focusin":return Ds=Yc(Ds,r,a,l,c,m),!0;case"dragenter":return Ns=Yc(Ns,r,a,l,c,m),!0;case"mouseover":return Os=Yc(Os,r,a,l,c,m),!0;case"pointerover":var g=m.pointerId;return Gc.set(g,Yc(Gc.get(g)||null,r,a,l,c,m)),!0;case"gotpointercapture":return g=m.pointerId,Kc.set(g,Yc(Kc.get(g)||null,r,a,l,c,m)),!0}return!1}function yI(r){var a=pr(r.target);if(a!==null){var l=o(a);if(l!==null){if(a=l.tag,a===13){if(a=u(l),a!==null){r.blockedOn=a,Md(r.priority,function(){if(l.tag===13){var c=$n();c=as(c);var m=sl(l,c);m!==null&&Xn(m,l,c),vy(l,c)}});return}}else if(a===3&&l.stateNode.current.memoizedState.isDehydrated){r.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Jf(r){if(r.blockedOn!==null)return!1;for(var a=r.targetContainers;0<a.length;){var l=Ty(r.nativeEvent);if(l===null){l=r.nativeEvent;var c=new l.constructor(l.type,l);vr=c,l.target.dispatchEvent(c),vr=null}else return a=Bi(l),a!==null&&pI(a),r.blockedOn=l,!1;a.shift()}return!0}function vI(r,a,l){Jf(r)&&l.delete(a)}function qP(){by=!1,Ds!==null&&Jf(Ds)&&(Ds=null),Ns!==null&&Jf(Ns)&&(Ns=null),Os!==null&&Jf(Os)&&(Os=null),Gc.forEach(vI),Kc.forEach(vI)}function Zf(r,a){r.blockedOn===a&&(r.blockedOn=null,by||(by=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,qP)))}var em=null;function EI(r){em!==r&&(em=r,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){em===r&&(em=null);for(var a=0;a<r.length;a+=3){var l=r[a],c=r[a+1],m=r[a+2];if(typeof c!="function"){if(wy(c||l)===null)continue;break}var g=Bi(l);g!==null&&(r.splice(a,3),a-=3,w_(g,{pending:!0,data:m,method:l.method,action:c},c,m))}}))}function Qc(r){function a(R){return Zf(R,r)}Ds!==null&&Zf(Ds,r),Ns!==null&&Zf(Ns,r),Os!==null&&Zf(Os,r),Gc.forEach(a),Kc.forEach(a);for(var l=0;l<xs.length;l++){var c=xs[l];c.blockedOn===r&&(c.blockedOn=null)}for(;0<xs.length&&(l=xs[0],l.blockedOn===null);)yI(l),l.blockedOn===null&&xs.shift();if(l=(r.ownerDocument||r).$$reactFormReplay,l!=null)for(c=0;c<l.length;c+=3){var m=l[c],g=l[c+1],w=m[Lt]||null;if(typeof g=="function")w||EI(l);else if(w){var b=null;if(g&&g.hasAttribute("formAction")){if(m=g,w=g[Lt]||null)b=w.formAction;else if(wy(m)!==null)continue}else b=w.action;typeof b=="function"?l[c+1]=b:(l.splice(c,3),c-=3),EI(l)}}}function Iy(r){this._internalRoot=r}tm.prototype.render=Iy.prototype.render=function(r){var a=this._internalRoot;if(a===null)throw Error(i(409));var l=a.current,c=$n();fI(l,c,r,a,null,null)},tm.prototype.unmount=Iy.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var a=r.containerInfo;fI(r.current,2,null,r,null,null),Vf(),a[oi]=null}};function tm(r){this._internalRoot=r}tm.prototype.unstable_scheduleHydration=function(r){if(r){var a=os();r={blockedOn:null,target:r,priority:a};for(var l=0;l<xs.length&&a!==0&&a<xs[l].priority;l++);xs.splice(l,0,r),l===0&&yI(r)}};var TI=e.version;if(TI!=="19.1.0")throw Error(i(527,TI,"19.1.0"));ce.findDOMNode=function(r){var a=r._reactInternals;if(a===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=f(a),r=r!==null?p(r):null,r=r===null?null:r.stateNode,r};var jP={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:W,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nm.isDisabled&&nm.supportsFiber)try{At=nm.inject(jP),Ze=nm}catch{}}return $c.createRoot=function(r,a){if(!s(r))throw Error(i(299));var l=!1,c="",m=L0,g=U0,w=F0,b=null;return a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(c=a.identifierPrefix),a.onUncaughtError!==void 0&&(m=a.onUncaughtError),a.onCaughtError!==void 0&&(g=a.onCaughtError),a.onRecoverableError!==void 0&&(w=a.onRecoverableError),a.unstable_transitionCallbacks!==void 0&&(b=a.unstable_transitionCallbacks)),a=hI(r,1,!1,null,null,l,c,m,g,w,b,null),r[oi]=a.current,ay(r),new Iy(a)},$c.hydrateRoot=function(r,a,l){if(!s(r))throw Error(i(299));var c=!1,m="",g=L0,w=U0,b=F0,R=null,j=null;return l!=null&&(l.unstable_strictMode===!0&&(c=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onUncaughtError!==void 0&&(g=l.onUncaughtError),l.onCaughtError!==void 0&&(w=l.onCaughtError),l.onRecoverableError!==void 0&&(b=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(R=l.unstable_transitionCallbacks),l.formState!==void 0&&(j=l.formState)),a=hI(r,1,!0,a,l??null,c,m,g,w,b,R,j),a.context=dI(null),l=a.current,c=$n(),c=as(c),m=ps(c),m.callback=null,gs(l,m,c),l=c,a.current.lanes=l,mr(a,l),er(a),r[oi]=a.current,ay(r),new tm(a)},$c.version="19.1.0",$c}var OI;function ZP(){if(OI)return Ay.exports;OI=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Ay.exports=JP(),Ay.exports}var ek=ZP(),De=aE();const tk=()=>{};var xI={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VR={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const le=function(n,e){if(!n)throw Ru(e)},Ru=function(n){return new Error("Firebase Database ("+VR.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LR=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},nk=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const s=n[t++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const o=n[t++];e[i++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=n[t++],u=n[t++],h=n[t++],f=((s&7)<<18|(o&63)<<12|(u&63)<<6|h&63)-65536;e[i++]=String.fromCharCode(55296+(f>>10)),e[i++]=String.fromCharCode(56320+(f&1023))}else{const o=n[t++],u=n[t++];e[i++]=String.fromCharCode((s&15)<<12|(o&63)<<6|u&63)}}return e.join("")},oE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<n.length;s+=3){const o=n[s],u=s+1<n.length,h=u?n[s+1]:0,f=s+2<n.length,p=f?n[s+2]:0,_=o>>2,v=(o&3)<<4|h>>4;let T=(h&15)<<2|p>>6,S=p&63;f||(S=64,u||(T=64)),i.push(t[_],t[v],t[T],t[S])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(LR(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):nk(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<n.length;){const o=t[n.charAt(s++)],h=s<n.length?t[n.charAt(s)]:0;++s;const p=s<n.length?t[n.charAt(s)]:64;++s;const v=s<n.length?t[n.charAt(s)]:64;if(++s,o==null||h==null||p==null||v==null)throw new ik;const T=o<<2|h>>4;if(i.push(T),p!==64){const S=h<<4&240|p>>2;if(i.push(S),v!==64){const N=p<<6&192|v;i.push(N)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class ik extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const UR=function(n){const e=LR(n);return oE.encodeByteArray(e,!0)},Mm=function(n){return UR(n).replace(/\./g,"")},Vm=function(n){try{return oE.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rk(n){return FR(void 0,n)}function FR(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!sk(t)||(n[t]=FR(n[t],e[t]));return n}function sk(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ak=()=>BR().__FIREBASE_DEFAULTS__,ok=()=>{if(typeof process>"u"||typeof xI>"u")return;const n=xI.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},lk=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Vm(n[1]);return e&&JSON.parse(e)},xp=()=>{try{return tk()||ak()||ok()||lk()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},zR=n=>{var e,t;return(t=(e=xp())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},qR=n=>{const e=zR(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},jR=()=>{var n;return(n=xp())===null||n===void 0?void 0:n.config},HR=n=>{var e;return(e=xp())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zr(n){return n.endsWith(".cloudworkstations.dev")}async function Pp(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GR(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",s=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Mm(JSON.stringify(t)),Mm(JSON.stringify(u)),""].join(".")}const _h={};function uk(){const n={prod:[],emulator:[]};for(const e of Object.keys(_h))_h[e]?n.emulator.push(e):n.prod.push(e);return n}function ck(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let PI=!1;function Po(n,e){if(typeof window>"u"||typeof document>"u"||!Zr(window.location.host)||_h[n]===e||_h[n]||PI)return;_h[n]=e;function t(T){return`__firebase__banner__${T}`}const i="__firebase__banner",o=uk().prod.length>0;function u(){const T=document.getElementById(i);T&&T.remove()}function h(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function f(T,S){T.setAttribute("width","24"),T.setAttribute("id",S),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function p(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{PI=!0,u()},T}function _(T,S){T.setAttribute("id",S),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function v(){const T=ck(i),S=t("text"),N=document.getElementById(S)||document.createElement("span"),x=t("learnmore"),U=document.getElementById(x)||document.createElement("a"),Z=t("preprendIcon"),ee=document.getElementById(Z)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const Y=T.element;h(Y),_(U,x);const ie=p();f(ee,Z),Y.append(ee,N,U,ie),document.body.appendChild(Y)}o?(N.innerText="Preview backend disconnected.",ee.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(ee.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,N.innerText="Preview backend running in this workspace."),N.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function lE(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Qt())}function hk(){var n;const e=(n=xp())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function dk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function KR(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function YR(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function fk(){const n=Qt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function mk(){return VR.NODE_ADMIN===!0}function QR(){return!hk()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function uE(){try{return typeof indexedDB=="object"}catch{return!1}}function WR(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var o;e(((o=s.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}function pk(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gk="FirebaseError";class Si extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=gk,Object.setPrototypeOf(this,Si.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ko.prototype.create)}}class ko{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},s=`${this.service}/${e}`,o=this.errors[e],u=o?_k(o,i):"Error",h=`${this.serviceName}: ${u} (${s}).`;return new Si(s,h,i)}}function _k(n,e){return n.replace(yk,(t,i)=>{const s=e[i];return s!=null?String(s):`<${i}?>`})}const yk=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kh(n){return JSON.parse(n)}function Yt(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $R=function(n){let e={},t={},i={},s="";try{const o=n.split(".");e=kh(Vm(o[0])||""),t=kh(Vm(o[1])||""),s=o[2],i=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:i,signature:s}},vk=function(n){const e=$R(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},Ek=function(n){const e=$R(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hr(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function tu(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function Lm(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Um(n,e,t){const i={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=e.call(t,n[s],s,n));return i}function Yr(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const s of t){if(!i.includes(s))return!1;const o=n[s],u=e[s];if(kI(o)&&kI(u)){if(!Yr(o,u))return!1}else if(o!==u)return!1}for(const s of i)if(!t.includes(s))return!1;return!0}function kI(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cu(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function uh(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[s,o]=i.split("=");e[decodeURIComponent(s)]=decodeURIComponent(o)}}),e}function ch(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tk{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const i=this.W_;if(typeof e=="string")for(let v=0;v<16;v++)i[v]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let v=0;v<16;v++)i[v]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let v=16;v<80;v++){const T=i[v-3]^i[v-8]^i[v-14]^i[v-16];i[v]=(T<<1|T>>>31)&4294967295}let s=this.chain_[0],o=this.chain_[1],u=this.chain_[2],h=this.chain_[3],f=this.chain_[4],p,_;for(let v=0;v<80;v++){v<40?v<20?(p=h^o&(u^h),_=1518500249):(p=o^u^h,_=1859775393):v<60?(p=o&u|h&(o|u),_=2400959708):(p=o^u^h,_=3395469782);const T=(s<<5|s>>>27)+p+f+_+i[v]&4294967295;f=h,h=u,u=(o<<30|o>>>2)&4294967295,o=s,s=T}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+f&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const i=t-this.blockSize;let s=0;const o=this.buf_;let u=this.inbuf_;for(;s<t;){if(u===0)for(;s<=i;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<t;)if(o[u]=e.charCodeAt(s),++u,++s,u===this.blockSize){this.compress_(o),u=0;break}}else for(;s<t;)if(o[u]=e[s],++u,++s,u===this.blockSize){this.compress_(o),u=0;break}}this.inbuf_=u,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=t&255,t/=256;this.compress_(this.buf_);let i=0;for(let s=0;s<5;s++)for(let o=24;o>=0;o-=8)e[i]=this.chain_[s]>>o&255,++i;return e}}function wk(n,e){const t=new bk(n,e);return t.subscribe.bind(t)}class bk{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let s;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");Ik(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:i},s.next===void 0&&(s.next=Oy),s.error===void 0&&(s.error=Oy),s.complete===void 0&&(s.complete=Oy);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Ik(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Oy(){}function nu(n,e){return`${n} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sk=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);if(s>=55296&&s<=56319){const o=s-55296;i++,le(i<n.length,"Surrogate pair missing trail surrogate.");const u=n.charCodeAt(i)-56320;s=65536+(o<<10)+u}s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):s<65536?(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},kp=function(n){let e=0;for(let t=0;t<n.length;t++){const i=n.charCodeAt(t);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ak=1e3,Rk=2,Ck=4*60*60*1e3,Dk=.5;function MI(n,e=Ak,t=Rk){const i=e*Math.pow(t,n),s=Math.round(Dk*i*(Math.random()-.5)*2);return Math.min(Ck,i+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ke(n){return n&&n._delegate?n._delegate:n}class ri{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ja="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nk{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new Ur;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(xk(e))try{this.getOrInitializeService({instanceIdentifier:Ja})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:s});i.resolve(o)}catch{}}}}clearInstance(e=Ja){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ja){return this.instances.has(e)}getOptions(e=Ja){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[o,u]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(o);i===h&&u.resolve(s)}return s}onInit(e,t){var i;const s=this.normalizeInstanceIdentifier(t),o=(i=this.onInitCallbacks.get(s))!==null&&i!==void 0?i:new Set;o.add(e),this.onInitCallbacks.set(s,o);const u=this.instances.get(s);return u&&e(u,s),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const s of i)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:Ok(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ja){return this.component?this.component.multipleInstances?e:Ja:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Ok(n){return n===Ja?void 0:n}function xk(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pk{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Nk(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Be;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Be||(Be={}));const kk={debug:Be.DEBUG,verbose:Be.VERBOSE,info:Be.INFO,warn:Be.WARN,error:Be.ERROR,silent:Be.SILENT},Mk=Be.INFO,Vk={[Be.DEBUG]:"log",[Be.VERBOSE]:"log",[Be.INFO]:"info",[Be.WARN]:"warn",[Be.ERROR]:"error"},Lk=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),s=Vk[e];if(s)console[s](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ud{constructor(e){this.name=e,this._logLevel=Mk,this._logHandler=Lk,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Be))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?kk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Be.DEBUG,...e),this._logHandler(this,Be.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Be.VERBOSE,...e),this._logHandler(this,Be.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Be.INFO,...e),this._logHandler(this,Be.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Be.WARN,...e),this._logHandler(this,Be.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Be.ERROR,...e),this._logHandler(this,Be.ERROR,...e)}}const Uk=(n,e)=>e.some(t=>n instanceof t);let VI,LI;function Fk(){return VI||(VI=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Bk(){return LI||(LI=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const XR=new WeakMap,ov=new WeakMap,JR=new WeakMap,xy=new WeakMap,cE=new WeakMap;function zk(n){const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("success",o),n.removeEventListener("error",u)},o=()=>{t(Gs(n.result)),s()},u=()=>{i(n.error),s()};n.addEventListener("success",o),n.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&XR.set(t,n)}).catch(()=>{}),cE.set(e,n),e}function qk(n){if(ov.has(n))return;const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",u),n.removeEventListener("abort",u)},o=()=>{t(),s()},u=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",o),n.addEventListener("error",u),n.addEventListener("abort",u)});ov.set(n,e)}let lv={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ov.get(n);if(e==="objectStoreNames")return n.objectStoreNames||JR.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Gs(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function jk(n){lv=n(lv)}function Hk(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Py(this),e,...t);return JR.set(i,e.sort?e.sort():[e]),Gs(i)}:Bk().includes(n)?function(...e){return n.apply(Py(this),e),Gs(XR.get(this))}:function(...e){return Gs(n.apply(Py(this),e))}}function Gk(n){return typeof n=="function"?Hk(n):(n instanceof IDBTransaction&&qk(n),Uk(n,Fk())?new Proxy(n,lv):n)}function Gs(n){if(n instanceof IDBRequest)return zk(n);if(xy.has(n))return xy.get(n);const e=Gk(n);return e!==n&&(xy.set(n,e),cE.set(e,n)),e}const Py=n=>cE.get(n);function ZR(n,e,{blocked:t,upgrade:i,blocking:s,terminated:o}={}){const u=indexedDB.open(n,e),h=Gs(u);return i&&u.addEventListener("upgradeneeded",f=>{i(Gs(u.result),f.oldVersion,f.newVersion,Gs(u.transaction),f)}),t&&u.addEventListener("blocked",f=>t(f.oldVersion,f.newVersion,f)),h.then(f=>{o&&f.addEventListener("close",()=>o()),s&&f.addEventListener("versionchange",p=>s(p.oldVersion,p.newVersion,p))}).catch(()=>{}),h}const Kk=["get","getKey","getAll","getAllKeys","count"],Yk=["put","add","delete","clear"],ky=new Map;function UI(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(ky.get(e))return ky.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,s=Yk.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(s||Kk.includes(t)))return;const o=async function(u,...h){const f=this.transaction(u,s?"readwrite":"readonly");let p=f.store;return i&&(p=p.index(h.shift())),(await Promise.all([p[t](...h),s&&f.done]))[0]};return ky.set(e,o),o}jk(n=>({...n,get:(e,t,i)=>UI(e,t)||n.get(e,t,i),has:(e,t)=>!!UI(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qk{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Wk(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function Wk(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const uv="@firebase/app",FI="0.12.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qr=new ud("@firebase/app"),$k="@firebase/app-compat",Xk="@firebase/analytics-compat",Jk="@firebase/analytics",Zk="@firebase/app-check-compat",eM="@firebase/app-check",tM="@firebase/auth",nM="@firebase/auth-compat",iM="@firebase/database",rM="@firebase/data-connect",sM="@firebase/database-compat",aM="@firebase/functions",oM="@firebase/functions-compat",lM="@firebase/installations",uM="@firebase/installations-compat",cM="@firebase/messaging",hM="@firebase/messaging-compat",dM="@firebase/performance",fM="@firebase/performance-compat",mM="@firebase/remote-config",pM="@firebase/remote-config-compat",gM="@firebase/storage",_M="@firebase/storage-compat",yM="@firebase/firestore",vM="@firebase/vertexai",EM="@firebase/firestore-compat",TM="firebase",wM="11.7.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cv="[DEFAULT]",bM={[uv]:"fire-core",[$k]:"fire-core-compat",[Jk]:"fire-analytics",[Xk]:"fire-analytics-compat",[eM]:"fire-app-check",[Zk]:"fire-app-check-compat",[tM]:"fire-auth",[nM]:"fire-auth-compat",[iM]:"fire-rtdb",[rM]:"fire-data-connect",[sM]:"fire-rtdb-compat",[aM]:"fire-fn",[oM]:"fire-fn-compat",[lM]:"fire-iid",[uM]:"fire-iid-compat",[cM]:"fire-fcm",[hM]:"fire-fcm-compat",[dM]:"fire-perf",[fM]:"fire-perf-compat",[mM]:"fire-rc",[pM]:"fire-rc-compat",[gM]:"fire-gcs",[_M]:"fire-gcs-compat",[yM]:"fire-fst",[EM]:"fire-fst-compat",[vM]:"fire-vertex","fire-js":"fire-js",[TM]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fm=new Map,IM=new Map,hv=new Map;function BI(n,e){try{n.container.addComponent(e)}catch(t){Qr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function wi(n){const e=n.name;if(hv.has(e))return Qr.debug(`There were multiple attempts to register component ${e}.`),!1;hv.set(e,n);for(const t of Fm.values())BI(t,n);for(const t of IM.values())BI(t,n);return!0}function es(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function On(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SM={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ks=new ko("app","Firebase",SM);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AM{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ri("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ks.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aa=wM;function eC(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:cv,automaticDataCollectionEnabled:!1},e),s=i.name;if(typeof s!="string"||!s)throw Ks.create("bad-app-name",{appName:String(s)});if(t||(t=jR()),!t)throw Ks.create("no-options");const o=Fm.get(s);if(o){if(Yr(t,o.options)&&Yr(i,o.config))return o;throw Ks.create("duplicate-app",{appName:s})}const u=new Pk(s);for(const f of hv.values())u.addComponent(f);const h=new AM(t,i,u);return Fm.set(s,h),h}function Mp(n=cv){const e=Fm.get(n);if(!e&&n===cv&&jR())return eC();if(!e)throw Ks.create("no-app",{appName:n});return e}function Tn(n,e,t){var i;let s=(i=bM[n])!==null&&i!==void 0?i:n;t&&(s+=`-${t}`);const o=s.match(/\s|\//),u=e.match(/\s|\//);if(o||u){const h=[`Unable to register library "${s}" with version "${e}":`];o&&h.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&u&&h.push("and"),u&&h.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Qr.warn(h.join(" "));return}wi(new ri(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RM="firebase-heartbeat-database",CM=1,Mh="firebase-heartbeat-store";let My=null;function tC(){return My||(My=ZR(RM,CM,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Mh)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ks.create("idb-open",{originalErrorMessage:n.message})})),My}async function DM(n){try{const t=(await tC()).transaction(Mh),i=await t.objectStore(Mh).get(nC(n));return await t.done,i}catch(e){if(e instanceof Si)Qr.warn(e.message);else{const t=Ks.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Qr.warn(t.message)}}}async function zI(n,e){try{const i=(await tC()).transaction(Mh,"readwrite");await i.objectStore(Mh).put(e,nC(n)),await i.done}catch(t){if(t instanceof Si)Qr.warn(t.message);else{const i=Ks.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Qr.warn(i.message)}}}function nC(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NM=1024,OM=30;class xM{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new kM(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=qI();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(u=>u.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats.length>OM){const u=MM(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(u,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){Qr.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=qI(),{heartbeatsToSend:i,unsentEntries:s}=PM(this._heartbeatsCache.heartbeats),o=Mm(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return Qr.warn(t),""}}}function qI(){return new Date().toISOString().substring(0,10)}function PM(n,e=NM){const t=[];let i=n.slice();for(const s of n){const o=t.find(u=>u.agent===s.agent);if(o){if(o.dates.push(s.date),jI(t)>e){o.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),jI(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class kM{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return uE()?WR().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await DM(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return zI(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return zI(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function jI(n){return Mm(JSON.stringify({version:2,heartbeats:n})).length}function MM(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VM(n){wi(new ri("platform-logger",e=>new Qk(e),"PRIVATE")),wi(new ri("heartbeat",e=>new xM(e),"PRIVATE")),Tn(uv,FI,n),Tn(uv,FI,"esm2017"),Tn("fire-js","")}VM("");var HI={};const GI="@firebase/database",KI="1.0.17";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let iC="";function LM(n){iC=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UM{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Yt(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:kh(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FM{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return hr(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rC=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new UM(e)}}catch{}return new FM},oo=rC("localStorage"),BM=rC("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wl=new ud("@firebase/database"),zM=function(){let n=1;return function(){return n++}}(),sC=function(n){const e=Sk(n),t=new Tk;t.update(e);const i=t.digest();return oE.encodeByteArray(i)},cd=function(...n){let e="";for(let t=0;t<n.length;t++){const i=n[t];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=cd.apply(null,i):typeof i=="object"?e+=Yt(i):e+=i,e+=" "}return e};let yh=null,YI=!0;const qM=function(n,e){le(!0,"Can't turn on custom loggers persistently."),Wl.logLevel=Be.VERBOSE,yh=Wl.log.bind(Wl)},fn=function(...n){if(YI===!0&&(YI=!1,yh===null&&BM.get("logging_enabled")===!0&&qM()),yh){const e=cd.apply(null,n);yh(e)}},hd=function(n){return function(...e){fn(n,...e)}},dv=function(...n){const e="FIREBASE INTERNAL ERROR: "+cd(...n);Wl.error(e)},Wr=function(...n){const e=`FIREBASE FATAL ERROR: ${cd(...n)}`;throw Wl.error(e),new Error(e)},zn=function(...n){const e="FIREBASE WARNING: "+cd(...n);Wl.warn(e)},jM=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&zn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Vp=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},HM=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},iu="[MIN_NAME]",_o="[MAX_NAME]",Mo=function(n,e){if(n===e)return 0;if(n===iu||e===_o)return-1;if(e===iu||n===_o)return 1;{const t=QI(n),i=QI(e);return t!==null?i!==null?t-i===0?n.length-e.length:t-i:-1:i!==null?1:n<e?-1:1}},GM=function(n,e){return n===e?0:n<e?-1:1},Xc=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+Yt(e))},hE=function(n){if(typeof n!="object"||n===null)return Yt(n);const e=[];for(const i in n)e.push(i);e.sort();let t="{";for(let i=0;i<e.length;i++)i!==0&&(t+=","),t+=Yt(e[i]),t+=":",t+=hE(n[e[i]]);return t+="}",t},aC=function(n,e){const t=n.length;if(t<=e)return[n];const i=[];for(let s=0;s<t;s+=e)s+e>t?i.push(n.substring(s,t)):i.push(n.substring(s,s+e));return i};function In(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const oC=function(n){le(!Vp(n),"Invalid JSON number");const e=11,t=52,i=(1<<e-1)-1;let s,o,u,h,f;n===0?(o=0,u=0,s=1/n===-1/0?1:0):(s=n<0,n=Math.abs(n),n>=Math.pow(2,1-i)?(h=Math.min(Math.floor(Math.log(n)/Math.LN2),i),o=h+i,u=Math.round(n*Math.pow(2,t-h)-Math.pow(2,t))):(o=0,u=Math.round(n/Math.pow(2,1-i-t))));const p=[];for(f=t;f;f-=1)p.push(u%2?1:0),u=Math.floor(u/2);for(f=e;f;f-=1)p.push(o%2?1:0),o=Math.floor(o/2);p.push(s?1:0),p.reverse();const _=p.join("");let v="";for(f=0;f<64;f+=8){let T=parseInt(_.substr(f,8),2).toString(16);T.length===1&&(T="0"+T),v=v+T}return v.toLowerCase()},KM=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},YM=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function QM(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const i=new Error(n+" at "+e._path.toString()+": "+t);return i.code=n.toUpperCase(),i}const WM=new RegExp("^-?(0*)\\d{1,10}$"),$M=-2147483648,XM=2147483647,QI=function(n){if(WM.test(n)){const e=Number(n);if(e>=$M&&e<=XM)return e}return null},Du=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw zn("Exception was thrown by user callback.",t),e},Math.floor(0))}},JM=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},vh=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZM{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,On(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(i=>this.appCheck=i)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){zn(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e2{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(fn("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',zn(e)}}class gm{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}gm.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dE="5",lC="v",uC="s",cC="r",hC="f",dC=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,fC="ls",mC="p",fv="ac",pC="websocket",gC="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{constructor(e,t,i,s,o=!1,u="",h=!1,f=!1,p=null){this.secure=t,this.namespace=i,this.webSocketOnly=s,this.nodeAdmin=o,this.persistenceKey=u,this.includeNamespaceInQueryParams=h,this.isUsingEmulator=f,this.emulatorOptions=p,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=oo.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&oo.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function t2(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function yC(n,e,t){le(typeof e=="string","typeof type must == string"),le(typeof t=="object","typeof params must == object");let i;if(e===pC)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===gC)i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);t2(n)&&(t.ns=n.namespace);const s=[];return In(t,(o,u)=>{s.push(o+"="+u)}),i+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2{constructor(){this.counters_={}}incrementCounter(e,t=1){hr(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return rk(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vy={},Ly={};function fE(n){const e=n.toString();return Vy[e]||(Vy[e]=new n2),Vy[e]}function i2(n,e){const t=n.toString();return Ly[t]||(Ly[t]=e()),Ly[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r2{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<i.length;++s)i[s]&&Du(()=>{this.onMessage_(i[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WI="start",s2="close",a2="pLPCommand",o2="pRTLPCB",vC="id",EC="pw",TC="ser",l2="cb",u2="seg",c2="ts",h2="d",d2="dframe",wC=1870,bC=30,f2=wC-bC,m2=25e3,p2=3e4;class Gl{constructor(e,t,i,s,o,u,h){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.transportSessionId=u,this.lastSessionId=h,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=hd(e),this.stats_=fE(t),this.urlFn=f=>(this.appCheckToken&&(f[fv]=this.appCheckToken),yC(t,gC,f))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new r2(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(p2)),HM(()=>{if(this.isClosed_)return;this.scriptTagHolder=new mE((...o)=>{const[u,h,f,p,_]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,u===WI)this.id=h,this.password=f;else if(u===s2)h?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(h,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+u)},(...o)=>{const[u,h]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(u,h)},()=>{this.onClosed_()},this.urlFn);const i={};i[WI]="t",i[TC]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[l2]=this.scriptTagHolder.uniqueCallbackIdentifier),i[lC]=dE,this.transportSessionId&&(i[uC]=this.transportSessionId),this.lastSessionId&&(i[fC]=this.lastSessionId),this.applicationId&&(i[mC]=this.applicationId),this.appCheckToken&&(i[fv]=this.appCheckToken),typeof location<"u"&&location.hostname&&dC.test(location.hostname)&&(i[cC]=hC);const s=this.urlFn(i);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Gl.forceAllow_=!0}static forceDisallow(){Gl.forceDisallow_=!0}static isAvailable(){return Gl.forceAllow_?!0:!Gl.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!KM()&&!YM()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=Yt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=UR(t),s=aC(i,f2);for(let o=0;o<s.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[o]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const i={};i[d2]="t",i[vC]=e,i[EC]=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=Yt(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class mE{constructor(e,t,i,s){this.onDisconnect=i,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=zM(),window[a2+this.uniqueCallbackIdentifier]=e,window[o2+this.uniqueCallbackIdentifier]=t,this.myIFrame=mE.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');const u="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(u),this.myIFrame.doc.close()}catch(h){fn("frame writing exception"),h.stack&&fn(h.stack),fn(h)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||fn("No IE domain setting required")}catch{const i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[vC]=this.myID,e[EC]=this.myPW,e[TC]=this.currentSerial;let t=this.urlFn(e),i="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+bC+i.length<=wC;){const u=this.pendingSegs.shift();i=i+"&"+u2+s+"="+u.seg+"&"+c2+s+"="+u.ts+"&"+h2+s+"="+u.d,s++}return t=t+i,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},s=setTimeout(i,Math.floor(m2)),o=()=>{clearTimeout(s),i()};this.addTag(e,o)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const s=i.readyState;(!s||s==="loaded"||s==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{fn("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g2=16384,_2=45e3;let Bm=null;typeof MozWebSocket<"u"?Bm=MozWebSocket:typeof WebSocket<"u"&&(Bm=WebSocket);class Pi{constructor(e,t,i,s,o,u,h){this.connId=e,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=hd(this.connId),this.stats_=fE(t),this.connURL=Pi.connectionURL_(t,u,h,s,i),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,i,s,o){const u={};return u[lC]=dE,typeof location<"u"&&location.hostname&&dC.test(location.hostname)&&(u[cC]=hC),t&&(u[uC]=t),i&&(u[fC]=i),s&&(u[fv]=s),o&&(u[mC]=o),yC(e,pC,u)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,oo.set("previous_websocket_failure",!0);try{let i;mk(),this.mySock=new Bm(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){Pi.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(t);i&&i.length>1&&parseFloat(i[1])<4.4&&(e=!0)}return!e&&Bm!==null&&!Pi.forceDisallow_}static previouslyFailed(){return oo.isInMemoryStorage||oo.get("previous_websocket_failure")===!0}markConnectionHealthy(){oo.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const i=kh(t);this.onMessage(i)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(le(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const i=this.extractFrameCount_(t);i!==null&&this.appendFrame_(i)}}send(e){this.resetKeepAlive();const t=Yt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=aC(t,g2);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(_2))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Pi.responsesRequiredToBeHealthy=2;Pi.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vh{static get ALL_TRANSPORTS(){return[Gl,Pi]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const t=Pi&&Pi.isAvailable();let i=t&&!Pi.previouslyFailed();if(e.webSocketOnly&&(t||zn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Pi];else{const s=this.transports_=[];for(const o of Vh.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);Vh.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Vh.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y2=6e4,v2=5e3,E2=10*1024,T2=100*1024,Uy="t",$I="d",w2="s",XI="r",b2="e",JI="o",ZI="a",eS="n",tS="p",I2="h";class S2{constructor(e,t,i,s,o,u,h,f,p,_){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=s,this.authToken_=o,this.onMessage_=u,this.onReady_=h,this.onDisconnect_=f,this.onKill_=p,this.lastSessionId=_,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=hd("c:"+this.id+":"),this.transportManager_=new Vh(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=vh(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>T2?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>E2?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Uy in e){const t=e[Uy];t===ZI?this.upgradeIfSecondaryHealthy_():t===XI?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===JI&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Xc("t",e),i=Xc("d",e);if(t==="c")this.onSecondaryControl_(i);else if(t==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:tS,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:ZI,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:eS,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Xc("t",e),i=Xc("d",e);t==="c"?this.onControl_(i):t==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Xc(Uy,e);if($I in e){const i=e[$I];if(t===I2){const s=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(t===eS){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===w2?this.onConnectionShutdown_(i):t===XI?this.onReset_(i):t===b2?dv("Server Error: "+i):t===JI?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):dv("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,i=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),dE!==i&&zn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),vh(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(y2))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):vh(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(v2))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:tS,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(oo.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IC{put(e,t,i,s){}merge(e,t,i,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SC{constructor(e){this.allowedEvents_=e,this.listeners_={},le(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(let s=0;s<i.length;s++)i[s].callback.apply(i[s].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});const s=this.getInitialEvent(e);s&&t.apply(i,s)}off(e,t,i){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let o=0;o<s.length;o++)if(s[o].callback===t&&(!i||i===s[o].context)){s.splice(o,1);return}}validateEventType_(e){le(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zm extends SC{static getInstance(){return new zm}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!lE()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return le(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nS=32,iS=768;class st{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let i=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[i]=this.pieces_[s],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function Qe(){return new st("")}function xe(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Js(n){return n.pieces_.length-n.pieceNum_}function ht(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new st(n.pieces_,e)}function pE(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function A2(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function Lh(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function AC(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new st(e,0)}function kt(n,e){const t=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)t.push(n.pieces_[i]);if(e instanceof st)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{const i=e.split("/");for(let s=0;s<i.length;s++)i[s].length>0&&t.push(i[s])}return new st(t,0)}function Ve(n){return n.pieceNum_>=n.pieces_.length}function xn(n,e){const t=xe(n),i=xe(e);if(t===null)return e;if(t===i)return xn(ht(n),ht(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function R2(n,e){const t=Lh(n,0),i=Lh(e,0);for(let s=0;s<t.length&&s<i.length;s++){const o=Mo(t[s],i[s]);if(o!==0)return o}return t.length===i.length?0:t.length<i.length?-1:1}function gE(n,e){if(Js(n)!==Js(e))return!1;for(let t=n.pieceNum_,i=e.pieceNum_;t<=n.pieces_.length;t++,i++)if(n.pieces_[t]!==e.pieces_[i])return!1;return!0}function Ei(n,e){let t=n.pieceNum_,i=e.pieceNum_;if(Js(n)>Js(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[i])return!1;++t,++i}return!0}class C2{constructor(e,t){this.errorPrefix_=t,this.parts_=Lh(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=kp(this.parts_[i]);RC(this)}}function D2(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=kp(e),RC(n)}function N2(n){const e=n.parts_.pop();n.byteLength_-=kp(e),n.parts_.length>0&&(n.byteLength_-=1)}function RC(n){if(n.byteLength_>iS)throw new Error(n.errorPrefix_+"has a key path longer than "+iS+" bytes ("+n.byteLength_+").");if(n.parts_.length>nS)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+nS+") or object contains a cycle "+Za(n))}function Za(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _E extends SC{static getInstance(){return new _E}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}getInitialEvent(e){return le(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jc=1e3,O2=60*5*1e3,rS=30*1e3,x2=1.3,P2=3e4,k2="server_kill",sS=3;class Hr extends IC{constructor(e,t,i,s,o,u,h,f){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=u,this.appCheckTokenProvider_=h,this.authOverride_=f,this.id=Hr.nextPersistentConnectionId_++,this.log_=hd("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Jc,this.maxReconnectDelay_=O2,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,f)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");_E.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&zm.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,i){const s=++this.requestNumber_,o={r:s,a:e,b:t};this.log_(Yt(o)),le(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(e){this.initConnection_();const t=new Ur,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:u=>{const h=u.d;u.s==="ok"?t.resolve(h):t.reject(h)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),t.promise}listen(e,t,i,s){this.initConnection_();const o=e._queryIdentifier,u=e._path.toString();this.log_("Listen called for "+u+" "+o),this.listens.has(u)||this.listens.set(u,new Map),le(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),le(!this.listens.get(u).has(o),"listen() called twice for same path/queryId.");const h={onComplete:s,hashFn:t,query:e,tag:i};this.listens.get(u).set(o,h),this.connected_&&this.sendListen_(h)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,i=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(i)})}sendListen_(e){const t=e.query,i=t._path.toString(),s=t._queryIdentifier;this.log_("Listen on "+i+" for "+s);const o={p:i},u="q";e.tag&&(o.q=t._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest(u,o,h=>{const f=h.d,p=h.s;Hr.warnOnListenWarnings_(f,t),(this.listens.get(i)&&this.listens.get(i).get(s))===e&&(this.log_("listen response",h),p!=="ok"&&this.removeListen_(i,s),e.onComplete&&e.onComplete(p,f))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&hr(e,"w")){const i=tu(e,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const s='".indexOn": "'+t._queryParams.getIndex().toString()+'"',o=t._path.toString();zn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||Ek(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=rS)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=vk(e)?"auth":"gauth",i={cred:e};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(t,i,s=>{const o=s.s,u=s.d||"error";this.authToken_===e&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,u))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,i=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,i)})}unlisten(e,t){const i=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),le(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,e._queryObject,t)}sendUnlisten_(e,t,i,s){this.log_("Unlisten on "+e+" for "+t);const o={p:e},u="n";s&&(o.q=i,o.t=s),this.sendRequest(u,o)}onDisconnectPut(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:i})}onDisconnectMerge(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:i})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,i,s){const o={p:t,d:i};this.log_("onDisconnect "+e,o),this.sendRequest(e,o,u=>{s&&setTimeout(()=>{s(u.s,u.d)},Math.floor(0))})}put(e,t,i,s){this.putInternal("p",e,t,i,s)}merge(e,t,i,s){this.putInternal("m",e,t,i,s)}putInternal(e,t,i,s,o){this.initConnection_();const u={p:t,d:i};o!==void 0&&(u.h=o),this.outstandingPuts_.push({action:e,request:u,onComplete:s}),this.outstandingPutCount_++;const h=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(h):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,i=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,i,o=>{this.log_(t+" response",o),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,i=>{if(i.s!=="ok"){const o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Yt(e));const t=e.r,i=this.requestCBHash_[t];i&&(delete this.requestCBHash_[t],i(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):dv("Unrecognized action received from server: "+Yt(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){le(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Jc,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Jc,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>P2&&(this.reconnectDelay_=Jc),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*x2)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+Hr.nextConnectionId_++,o=this.lastSessionId;let u=!1,h=null;const f=function(){h?h.close():(u=!0,i())},p=function(v){le(h,"sendRequest call when we're not connected not allowed."),h.sendRequest(v)};this.realtime_={close:f,sendRequest:p};const _=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[v,T]=await Promise.all([this.authTokenProvider_.getToken(_),this.appCheckTokenProvider_.getToken(_)]);u?fn("getToken() completed but was canceled"):(fn("getToken() completed. Creating connection."),this.authToken_=v&&v.accessToken,this.appCheckToken_=T&&T.token,h=new S2(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,i,S=>{zn(S+" ("+this.repoInfo_.toString()+")"),this.interrupt(k2)},o))}catch(v){this.log_("Failed to get token: "+v),u||(this.repoInfo_.nodeAdmin&&zn(v),f())}}}interrupt(e){fn("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){fn("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Lm(this.interruptReasons_)&&(this.reconnectDelay_=Jc,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let i;t?i=t.map(o=>hE(o)).join("$"):i="default";const s=this.removeListen_(e,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,t){const i=new st(e).toString();let s;if(this.listens.has(i)){const o=this.listens.get(i);s=o.get(t),o.delete(t),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(e,t){fn("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=sS&&(this.reconnectDelay_=rS,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){fn("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=sS&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+iC.replace(/\./g,"-")]=1,lE()?e["framework.cordova"]=1:YR()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=zm.getInstance().currentlyOnline();return Lm(this.interruptReasons_)&&e}}Hr.nextPersistentConnectionId_=0;Hr.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Le{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Le(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lp{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const i=new Le(iu,e),s=new Le(iu,t);return this.compare(i,s)!==0}minPost(){return Le.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let im;class CC extends Lp{static get __EMPTY_NODE(){return im}static set __EMPTY_NODE(e){im=e}compare(e,t){return Mo(e.name,t.name)}isDefinedOn(e){throw Ru("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Le.MIN}maxPost(){return new Le(_o,im)}makePost(e,t){return le(typeof e=="string","KeyIndex indexValue must always be a string."),new Le(e,im)}toString(){return".key"}}const $l=new CC;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rm=class{constructor(e,t,i,s,o=null){this.isReverse_=s,this.resultGenerator_=o,this.nodeStack_=[];let u=1;for(;!e.isEmpty();)if(e=e,u=t?i(e.key,t):1,s&&(u*=-1),u<0)this.isReverse_?e=e.left:e=e.right;else if(u===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Jn=class hh{constructor(e,t,i,s,o){this.key=e,this.value=t,this.color=i??hh.RED,this.left=s??ir.EMPTY_NODE,this.right=o??ir.EMPTY_NODE}copy(e,t,i,s,o){return new hh(e??this.key,t??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let s=this;const o=i(e,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(e,t,i),null):o===0?s=s.copy(null,t,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,t,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return ir.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let i,s;if(i=this,t(e,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),t(e,i.key)===0){if(i.right.isEmpty())return ir.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,hh.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,hh.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}};Jn.RED=!0;Jn.BLACK=!1;class M2{copy(e,t,i,s,o){return this}insert(e,t,i){return new Jn(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}let ir=class _m{constructor(e,t=_m.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new _m(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Jn.BLACK,null,null))}remove(e){return new _m(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Jn.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),t===0)return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,s=null;for(;!i.isEmpty();)if(t=this.comparator_(e,i.key),t===0){if(i.left.isEmpty())return s?s.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else t<0?i=i.left:t>0&&(s=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new rm(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new rm(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new rm(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new rm(this.root_,null,this.comparator_,!0,e)}};ir.EMPTY_NODE=new M2;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V2(n,e){return Mo(n.name,e.name)}function yE(n,e){return Mo(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mv;function L2(n){mv=n}const DC=function(n){return typeof n=="number"?"number:"+oC(n):"string:"+n},NC=function(n){if(n.isLeafNode()){const e=n.val();le(typeof e=="string"||typeof e=="number"||typeof e=="object"&&hr(e,".sv"),"Priority must be a string or number.")}else le(n===mv||n.isEmpty(),"priority of unexpected type.");le(n===mv||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let aS;class rn{static set __childrenNodeConstructor(e){aS=e}static get __childrenNodeConstructor(){return aS}constructor(e,t=rn.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,le(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),NC(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new rn(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:rn.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Ve(e)?this:xe(e)===".priority"?this.priorityNode_:rn.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:rn.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const i=xe(e);return i===null?t:t.isEmpty()&&i!==".priority"?this:(le(i!==".priority"||Js(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,rn.__childrenNodeConstructor.EMPTY_NODE.updateChild(ht(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+DC(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=oC(this.value_):e+=this.value_,this.lazyHash_=sC(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===rn.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof rn.__childrenNodeConstructor?-1:(le(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,i=typeof this.value_,s=rn.VALUE_TYPE_ORDER.indexOf(t),o=rn.VALUE_TYPE_ORDER.indexOf(i);return le(s>=0,"Unknown leaf type: "+t),le(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}rn.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let OC,xC;function U2(n){OC=n}function F2(n){xC=n}class B2 extends Lp{compare(e,t){const i=e.node.getPriority(),s=t.node.getPriority(),o=i.compareTo(s);return o===0?Mo(e.name,t.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Le.MIN}maxPost(){return new Le(_o,new rn("[PRIORITY-POST]",xC))}makePost(e,t){const i=OC(e);return new Le(t,new rn("[PRIORITY-POST]",i))}toString(){return".priority"}}const wt=new B2;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z2=Math.log(2);class q2{constructor(e){const t=o=>parseInt(Math.log(o)/z2,10),i=o=>parseInt(Array(o+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const s=i(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const qm=function(n,e,t,i){n.sort(e);const s=function(f,p){const _=p-f;let v,T;if(_===0)return null;if(_===1)return v=n[f],T=t?t(v):v,new Jn(T,v.node,Jn.BLACK,null,null);{const S=parseInt(_/2,10)+f,N=s(f,S),x=s(S+1,p);return v=n[S],T=t?t(v):v,new Jn(T,v.node,Jn.BLACK,N,x)}},o=function(f){let p=null,_=null,v=n.length;const T=function(N,x){const U=v-N,Z=v;v-=N;const ee=s(U+1,Z),Y=n[U],ie=t?t(Y):Y;S(new Jn(ie,Y.node,x,null,ee))},S=function(N){p?(p.left=N,p=N):(_=N,p=N)};for(let N=0;N<f.count;++N){const x=f.nextBitIsOne(),U=Math.pow(2,f.count-(N+1));x?T(U,Jn.BLACK):(T(U,Jn.BLACK),T(U,Jn.RED))}return _},u=new q2(n.length),h=o(u);return new ir(i||e,h)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fy;const Nl={};class Br{static get Default(){return le(Nl&&wt,"ChildrenNode.ts has not been loaded"),Fy=Fy||new Br({".priority":Nl},{".priority":wt}),Fy}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){const t=tu(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof ir?t:null}hasIndex(e){return hr(this.indexSet_,e.toString())}addIndex(e,t){le(e!==$l,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let s=!1;const o=t.getIterator(Le.Wrap);let u=o.getNext();for(;u;)s=s||e.isDefinedOn(u.node),i.push(u),u=o.getNext();let h;s?h=qm(i,e.getCompare()):h=Nl;const f=e.toString(),p=Object.assign({},this.indexSet_);p[f]=e;const _=Object.assign({},this.indexes_);return _[f]=h,new Br(_,p)}addToIndexes(e,t){const i=Um(this.indexes_,(s,o)=>{const u=tu(this.indexSet_,o);if(le(u,"Missing index implementation for "+o),s===Nl)if(u.isDefinedOn(e.node)){const h=[],f=t.getIterator(Le.Wrap);let p=f.getNext();for(;p;)p.name!==e.name&&h.push(p),p=f.getNext();return h.push(e),qm(h,u.getCompare())}else return Nl;else{const h=t.get(e.name);let f=s;return h&&(f=f.remove(new Le(e.name,h))),f.insert(e,e.node)}});return new Br(i,this.indexSet_)}removeFromIndexes(e,t){const i=Um(this.indexes_,s=>{if(s===Nl)return s;{const o=t.get(e.name);return o?s.remove(new Le(e.name,o)):s}});return new Br(i,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zc;class Ae{static get EMPTY_NODE(){return Zc||(Zc=new Ae(new ir(yE),null,Br.Default))}constructor(e,t,i){this.children_=e,this.priorityNode_=t,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&NC(this.priorityNode_),this.children_.isEmpty()&&le(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Zc}updatePriority(e){return this.children_.isEmpty()?this:new Ae(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?Zc:t}}getChild(e){const t=xe(e);return t===null?this:this.getImmediateChild(t).getChild(ht(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(le(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const i=new Le(e,t);let s,o;t.isEmpty()?(s=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(e,t),o=this.indexMap_.addToIndexes(i,this.children_));const u=s.isEmpty()?Zc:this.priorityNode_;return new Ae(s,u,o)}}updateChild(e,t){const i=xe(e);if(i===null)return t;{le(xe(e)!==".priority"||Js(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(i).updateChild(ht(e),t);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let i=0,s=0,o=!0;if(this.forEachChild(wt,(u,h)=>{t[u]=h.val(e),i++,o&&Ae.INTEGER_REGEXP_.test(u)?s=Math.max(s,Number(u)):o=!1}),!e&&o&&s<2*i){const u=[];for(const h in t)u[h]=t[h];return u}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+DC(this.getPriority().val())+":"),this.forEachChild(wt,(t,i)=>{const s=i.hash();s!==""&&(e+=":"+t+":"+s)}),this.lazyHash_=e===""?"":sC(e)}return this.lazyHash_}getPredecessorChildName(e,t,i){const s=this.resolveIndex_(i);if(s){const o=s.getPredecessorKey(new Le(e,t));return o?o.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Le(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Le(t,this.children_.get(t)):null}forEachChild(e,t){const i=this.resolveIndex_(e);return i?i.inorderTraversal(s=>t(s.name,s.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,Le.Wrap);let o=s.peek();for(;o!=null&&t.compare(o,e)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,Le.Wrap);let o=s.peek();for(;o!=null&&t.compare(o,e)>0;)s.getNext(),o=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===dd?-1:0}withIndex(e){if(e===$l||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new Ae(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===$l||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const i=this.getIterator(wt),s=t.getIterator(wt);let o=i.getNext(),u=s.getNext();for(;o&&u;){if(o.name!==u.name||!o.node.equals(u.node))return!1;o=i.getNext(),u=s.getNext()}return o===null&&u===null}else return!1;else return!1}}resolveIndex_(e){return e===$l?null:this.indexMap_.get(e.toString())}}Ae.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class j2 extends Ae{constructor(){super(new ir(yE),Ae.EMPTY_NODE,Br.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Ae.EMPTY_NODE}isEmpty(){return!1}}const dd=new j2;Object.defineProperties(Le,{MIN:{value:new Le(iu,Ae.EMPTY_NODE)},MAX:{value:new Le(_o,dd)}});CC.__EMPTY_NODE=Ae.EMPTY_NODE;rn.__childrenNodeConstructor=Ae;L2(dd);F2(dd);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H2=!0;function Pt(n,e=null){if(n===null)return Ae.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),le(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new rn(t,Pt(e))}if(!(n instanceof Array)&&H2){const t=[];let i=!1;if(In(n,(u,h)=>{if(u.substring(0,1)!=="."){const f=Pt(h);f.isEmpty()||(i=i||!f.getPriority().isEmpty(),t.push(new Le(u,f)))}}),t.length===0)return Ae.EMPTY_NODE;const o=qm(t,V2,u=>u.name,yE);if(i){const u=qm(t,wt.getCompare());return new Ae(o,Pt(e),new Br({".priority":u},{".priority":wt}))}else return new Ae(o,Pt(e),Br.Default)}else{let t=Ae.EMPTY_NODE;return In(n,(i,s)=>{if(hr(n,i)&&i.substring(0,1)!=="."){const o=Pt(s);(o.isLeafNode()||!o.isEmpty())&&(t=t.updateImmediateChild(i,o))}}),t.updatePriority(Pt(e))}}U2(Pt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G2 extends Lp{constructor(e){super(),this.indexPath_=e,le(!Ve(e)&&xe(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const i=this.extractChild(e.node),s=this.extractChild(t.node),o=i.compareTo(s);return o===0?Mo(e.name,t.name):o}makePost(e,t){const i=Pt(e),s=Ae.EMPTY_NODE.updateChild(this.indexPath_,i);return new Le(t,s)}maxPost(){const e=Ae.EMPTY_NODE.updateChild(this.indexPath_,dd);return new Le(_o,e)}toString(){return Lh(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K2 extends Lp{compare(e,t){const i=e.node.compareTo(t.node);return i===0?Mo(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Le.MIN}maxPost(){return Le.MAX}makePost(e,t){const i=Pt(e);return new Le(t,i)}toString(){return".value"}}const Y2=new K2;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PC(n){return{type:"value",snapshotNode:n}}function ru(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Uh(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Fh(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function Q2(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vE{constructor(e){this.index_=e}updateChild(e,t,i,s,o,u){le(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const h=e.getImmediateChild(t);return h.getChild(s).equals(i.getChild(s))&&h.isEmpty()===i.isEmpty()||(u!=null&&(i.isEmpty()?e.hasChild(t)?u.trackChildChange(Uh(t,h)):le(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):h.isEmpty()?u.trackChildChange(ru(t,i)):u.trackChildChange(Fh(t,i,h))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(t,i).withIndex(this.index_)}updateFullNode(e,t,i){return i!=null&&(e.isLeafNode()||e.forEachChild(wt,(s,o)=>{t.hasChild(s)||i.trackChildChange(Uh(s,o))}),t.isLeafNode()||t.forEachChild(wt,(s,o)=>{if(e.hasChild(s)){const u=e.getImmediateChild(s);u.equals(o)||i.trackChildChange(Fh(s,o,u))}else i.trackChildChange(ru(s,o))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?Ae.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bh{constructor(e){this.indexedFilter_=new vE(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Bh.getStartPost_(e),this.endPost_=Bh.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&i}updateChild(e,t,i,s,o,u){return this.matches(new Le(t,i))||(i=Ae.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,i,s,o,u)}updateFullNode(e,t,i){t.isLeafNode()&&(t=Ae.EMPTY_NODE);let s=t.withIndex(this.index_);s=s.updatePriority(Ae.EMPTY_NODE);const o=this;return t.forEachChild(wt,(u,h)=>{o.matches(new Le(u,h))||(s=s.updateImmediateChild(u,Ae.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W2{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=t=>{const i=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new Bh(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,i,s,o,u){return this.rangedFilter_.matches(new Le(t,i))||(i=Ae.EMPTY_NODE),e.getImmediateChild(t).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,i,s,o,u):this.fullLimitUpdateChild_(e,t,i,o,u)}updateFullNode(e,t,i){let s;if(t.isLeafNode()||t.isEmpty())s=Ae.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){s=Ae.EMPTY_NODE.withIndex(this.index_);let o;this.reverse_?o=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):o=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let u=0;for(;o.hasNext()&&u<this.limit_;){const h=o.getNext();if(this.withinDirectionalStart(h))if(this.withinDirectionalEnd(h))s=s.updateImmediateChild(h.name,h.node),u++;else break;else continue}}else{s=t.withIndex(this.index_),s=s.updatePriority(Ae.EMPTY_NODE);let o;this.reverse_?o=s.getReverseIterator(this.index_):o=s.getIterator(this.index_);let u=0;for(;o.hasNext();){const h=o.getNext();u<this.limit_&&this.withinDirectionalStart(h)&&this.withinDirectionalEnd(h)?u++:s=s.updateImmediateChild(h.name,Ae.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,i,s,o){let u;if(this.reverse_){const v=this.index_.getCompare();u=(T,S)=>v(S,T)}else u=this.index_.getCompare();const h=e;le(h.numChildren()===this.limit_,"");const f=new Le(t,i),p=this.reverse_?h.getFirstChild(this.index_):h.getLastChild(this.index_),_=this.rangedFilter_.matches(f);if(h.hasChild(t)){const v=h.getImmediateChild(t);let T=s.getChildAfterChild(this.index_,p,this.reverse_);for(;T!=null&&(T.name===t||h.hasChild(T.name));)T=s.getChildAfterChild(this.index_,T,this.reverse_);const S=T==null?1:u(T,f);if(_&&!i.isEmpty()&&S>=0)return o!=null&&o.trackChildChange(Fh(t,i,v)),h.updateImmediateChild(t,i);{o!=null&&o.trackChildChange(Uh(t,v));const x=h.updateImmediateChild(t,Ae.EMPTY_NODE);return T!=null&&this.rangedFilter_.matches(T)?(o!=null&&o.trackChildChange(ru(T.name,T.node)),x.updateImmediateChild(T.name,T.node)):x}}else return i.isEmpty()?e:_&&u(p,f)>=0?(o!=null&&(o.trackChildChange(Uh(p.name,p.node)),o.trackChildChange(ru(t,i))),h.updateImmediateChild(t,i).updateImmediateChild(p.name,Ae.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EE{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=wt}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return le(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return le(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:iu}hasEnd(){return this.endSet_}getIndexEndValue(){return le(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return le(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:_o}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return le(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===wt}copy(){const e=new EE;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function $2(n){return n.loadsAllData()?new vE(n.getIndex()):n.hasLimit()?new W2(n):new Bh(n)}function oS(n){const e={};if(n.isDefault())return e;let t;if(n.index_===wt?t="$priority":n.index_===Y2?t="$value":n.index_===$l?t="$key":(le(n.index_ instanceof G2,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=Yt(t),n.startSet_){const i=n.startAfterSet_?"startAfter":"startAt";e[i]=Yt(n.indexStartValue_),n.startNameSet_&&(e[i]+=","+Yt(n.indexStartName_))}if(n.endSet_){const i=n.endBeforeSet_?"endBefore":"endAt";e[i]=Yt(n.indexEndValue_),n.endNameSet_&&(e[i]+=","+Yt(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function lS(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==wt&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm extends IC{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(le(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,i,s){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=s,this.log_=hd("p:rest:"),this.listens_={}}listen(e,t,i,s){const o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);const u=jm.getListenId_(e,i),h={};this.listens_[u]=h;const f=oS(e._queryParams);this.restRequest_(o+".json",f,(p,_)=>{let v=_;if(p===404&&(v=null,p=null),p===null&&this.onDataUpdate_(o,v,!1,i),tu(this.listens_,u)===h){let T;p?p===401?T="permission_denied":T="rest_error:"+p:T="ok",s(T,null)}})}unlisten(e,t){const i=jm.getListenId_(e,t);delete this.listens_[i]}get(e){const t=oS(e._queryParams),i=e._path.toString(),s=new Ur;return this.restRequest_(i+".json",t,(o,u)=>{let h=u;o===404&&(h=null,o=null),o===null?(this.onDataUpdate_(i,h,!1,null),s.resolve(h)):s.reject(new Error(h))}),s.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,o])=>{s&&s.accessToken&&(t.auth=s.accessToken),o&&o.token&&(t.ac=o.token);const u=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Cu(t);this.log_("Sending REST request for "+u);const h=new XMLHttpRequest;h.onreadystatechange=()=>{if(i&&h.readyState===4){this.log_("REST Response for "+u+" received. status:",h.status,"response:",h.responseText);let f=null;if(h.status>=200&&h.status<300){try{f=kh(h.responseText)}catch{zn("Failed to parse JSON response for "+u+": "+h.responseText)}i(null,f)}else h.status!==401&&h.status!==404&&zn("Got unsuccessful REST response for "+u+" Status: "+h.status),i(h.status);i=null}},h.open("GET",u,!0),h.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X2{constructor(){this.rootNode_=Ae.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hm(){return{value:null,children:new Map}}function Nu(n,e,t){if(Ve(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const i=xe(e);n.children.has(i)||n.children.set(i,Hm());const s=n.children.get(i);e=ht(e),Nu(s,e,t)}}function pv(n,e){if(Ve(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(wt,(i,s)=>{Nu(n,new st(i),s)}),pv(n,e)}}else if(n.children.size>0){const t=xe(e);return e=ht(e),n.children.has(t)&&pv(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function gv(n,e,t){n.value!==null?t(e,n.value):J2(n,(i,s)=>{const o=new st(e.toString()+"/"+i);gv(s,o,t)})}function J2(n,e){n.children.forEach((t,i)=>{e(i,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z2{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&In(this.last_,(i,s)=>{t[i]=t[i]-s}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uS=10*1e3,eV=30*1e3,tV=5*60*1e3;class nV{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Z2(e);const i=uS+(eV-uS)*Math.random();vh(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const e=this.statsListener_.get(),t={};let i=!1;In(e,(s,o)=>{o>0&&hr(this.statsToReport_,s)&&(t[s]=o,i=!0)}),i&&this.server_.reportStats(t),vh(this.reportStats_.bind(this),Math.floor(Math.random()*2*tV))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ki;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(ki||(ki={}));function kC(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function TE(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function wE(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gm{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=ki.ACK_USER_WRITE,this.source=kC()}operationForChild(e){if(Ve(this.path)){if(this.affectedTree.value!=null)return le(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new st(e));return new Gm(Qe(),t,this.revert)}}else return le(xe(this.path)===e,"operationForChild called for unrelated child."),new Gm(ht(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zh{constructor(e,t){this.source=e,this.path=t,this.type=ki.LISTEN_COMPLETE}operationForChild(e){return Ve(this.path)?new zh(this.source,Qe()):new zh(this.source,ht(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=ki.OVERWRITE}operationForChild(e){return Ve(this.path)?new yo(this.source,Qe(),this.snap.getImmediateChild(e)):new yo(this.source,ht(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=ki.MERGE}operationForChild(e){if(Ve(this.path)){const t=this.children.subtree(new st(e));return t.isEmpty()?null:t.value?new yo(this.source,Qe(),t.value):new qh(this.source,Qe(),t)}else return le(xe(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new qh(this.source,ht(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Ve(e))return this.isFullyInitialized()&&!this.filtered_;const t=xe(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iV{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function rV(n,e,t,i){const s=[],o=[];return e.forEach(u=>{u.type==="child_changed"&&n.index_.indexedValueChanged(u.oldSnap,u.snapshotNode)&&o.push(Q2(u.childName,u.snapshotNode))}),eh(n,s,"child_removed",e,i,t),eh(n,s,"child_added",e,i,t),eh(n,s,"child_moved",o,i,t),eh(n,s,"child_changed",e,i,t),eh(n,s,"value",e,i,t),s}function eh(n,e,t,i,s,o){const u=i.filter(h=>h.type===t);u.sort((h,f)=>aV(n,h,f)),u.forEach(h=>{const f=sV(n,h,o);s.forEach(p=>{p.respondsTo(h.type)&&e.push(p.createEvent(f,n.query_))})})}function sV(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function aV(n,e,t){if(e.childName==null||t.childName==null)throw Ru("Should only compare child_ events.");const i=new Le(e.childName,e.snapshotNode),s=new Le(t.childName,t.snapshotNode);return n.index_.compare(i,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Up(n,e){return{eventCache:n,serverCache:e}}function Eh(n,e,t,i){return Up(new Zs(e,t,i),n.serverCache)}function MC(n,e,t,i){return Up(n.eventCache,new Zs(e,t,i))}function Km(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function vo(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let By;const oV=()=>(By||(By=new ir(GM)),By);class pt{static fromObject(e){let t=new pt(null);return In(e,(i,s)=>{t=t.set(new st(i),s)}),t}constructor(e,t=oV()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Qe(),value:this.value};if(Ve(e))return null;{const i=xe(e),s=this.children.get(i);if(s!==null){const o=s.findRootMostMatchingPathAndValue(ht(e),t);return o!=null?{path:kt(new st(i),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Ve(e))return this;{const t=xe(e),i=this.children.get(t);return i!==null?i.subtree(ht(e)):new pt(null)}}set(e,t){if(Ve(e))return new pt(t,this.children);{const i=xe(e),o=(this.children.get(i)||new pt(null)).set(ht(e),t),u=this.children.insert(i,o);return new pt(this.value,u)}}remove(e){if(Ve(e))return this.children.isEmpty()?new pt(null):new pt(null,this.children);{const t=xe(e),i=this.children.get(t);if(i){const s=i.remove(ht(e));let o;return s.isEmpty()?o=this.children.remove(t):o=this.children.insert(t,s),this.value===null&&o.isEmpty()?new pt(null):new pt(this.value,o)}else return this}}get(e){if(Ve(e))return this.value;{const t=xe(e),i=this.children.get(t);return i?i.get(ht(e)):null}}setTree(e,t){if(Ve(e))return t;{const i=xe(e),o=(this.children.get(i)||new pt(null)).setTree(ht(e),t);let u;return o.isEmpty()?u=this.children.remove(i):u=this.children.insert(i,o),new pt(this.value,u)}}fold(e){return this.fold_(Qe(),e)}fold_(e,t){const i={};return this.children.inorderTraversal((s,o)=>{i[s]=o.fold_(kt(e,s),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,Qe(),t)}findOnPath_(e,t,i){const s=this.value?i(t,this.value):!1;if(s)return s;if(Ve(e))return null;{const o=xe(e),u=this.children.get(o);return u?u.findOnPath_(ht(e),kt(t,o),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Qe(),t)}foreachOnPath_(e,t,i){if(Ve(e))return this;{this.value&&i(t,this.value);const s=xe(e),o=this.children.get(s);return o?o.foreachOnPath_(ht(e),kt(t,s),i):new pt(null)}}foreach(e){this.foreach_(Qe(),e)}foreach_(e,t){this.children.inorderTraversal((i,s)=>{s.foreach_(kt(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi{constructor(e){this.writeTree_=e}static empty(){return new Vi(new pt(null))}}function Th(n,e,t){if(Ve(e))return new Vi(new pt(t));{const i=n.writeTree_.findRootMostValueAndPath(e);if(i!=null){const s=i.path;let o=i.value;const u=xn(s,e);return o=o.updateChild(u,t),new Vi(n.writeTree_.set(s,o))}else{const s=new pt(t),o=n.writeTree_.setTree(e,s);return new Vi(o)}}}function cS(n,e,t){let i=n;return In(t,(s,o)=>{i=Th(i,kt(e,s),o)}),i}function hS(n,e){if(Ve(e))return Vi.empty();{const t=n.writeTree_.setTree(e,new pt(null));return new Vi(t)}}function _v(n,e){return Vo(n,e)!=null}function Vo(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(xn(t.path,e)):null}function dS(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(wt,(i,s)=>{e.push(new Le(i,s))}):n.writeTree_.children.inorderTraversal((i,s)=>{s.value!=null&&e.push(new Le(i,s.value))}),e}function Ys(n,e){if(Ve(e))return n;{const t=Vo(n,e);return t!=null?new Vi(new pt(t)):new Vi(n.writeTree_.subtree(e))}}function yv(n){return n.writeTree_.isEmpty()}function su(n,e){return VC(Qe(),n.writeTree_,e)}function VC(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let i=null;return e.children.inorderTraversal((s,o)=>{s===".priority"?(le(o.value!==null,"Priority writes must always be leaf nodes"),i=o.value):t=VC(kt(n,s),o,t)}),!t.getChild(n).isEmpty()&&i!==null&&(t=t.updateChild(kt(n,".priority"),i)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fp(n,e){return BC(e,n)}function lV(n,e,t,i,s){le(i>n.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),n.allWrites.push({path:e,snap:t,writeId:i,visible:s}),s&&(n.visibleWrites=Th(n.visibleWrites,e,t)),n.lastWriteId=i}function uV(n,e){for(let t=0;t<n.allWrites.length;t++){const i=n.allWrites[t];if(i.writeId===e)return i}return null}function cV(n,e){const t=n.allWrites.findIndex(h=>h.writeId===e);le(t>=0,"removeWrite called with nonexistent writeId.");const i=n.allWrites[t];n.allWrites.splice(t,1);let s=i.visible,o=!1,u=n.allWrites.length-1;for(;s&&u>=0;){const h=n.allWrites[u];h.visible&&(u>=t&&hV(h,i.path)?s=!1:Ei(i.path,h.path)&&(o=!0)),u--}if(s){if(o)return dV(n),!0;if(i.snap)n.visibleWrites=hS(n.visibleWrites,i.path);else{const h=i.children;In(h,f=>{n.visibleWrites=hS(n.visibleWrites,kt(i.path,f))})}return!0}else return!1}function hV(n,e){if(n.snap)return Ei(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&Ei(kt(n.path,t),e))return!0;return!1}function dV(n){n.visibleWrites=LC(n.allWrites,fV,Qe()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function fV(n){return n.visible}function LC(n,e,t){let i=Vi.empty();for(let s=0;s<n.length;++s){const o=n[s];if(e(o)){const u=o.path;let h;if(o.snap)Ei(t,u)?(h=xn(t,u),i=Th(i,h,o.snap)):Ei(u,t)&&(h=xn(u,t),i=Th(i,Qe(),o.snap.getChild(h)));else if(o.children){if(Ei(t,u))h=xn(t,u),i=cS(i,h,o.children);else if(Ei(u,t))if(h=xn(u,t),Ve(h))i=cS(i,Qe(),o.children);else{const f=tu(o.children,xe(h));if(f){const p=f.getChild(ht(h));i=Th(i,Qe(),p)}}}else throw Ru("WriteRecord should have .snap or .children")}}return i}function UC(n,e,t,i,s){if(!i&&!s){const o=Vo(n.visibleWrites,e);if(o!=null)return o;{const u=Ys(n.visibleWrites,e);if(yv(u))return t;if(t==null&&!_v(u,Qe()))return null;{const h=t||Ae.EMPTY_NODE;return su(u,h)}}}else{const o=Ys(n.visibleWrites,e);if(!s&&yv(o))return t;if(!s&&t==null&&!_v(o,Qe()))return null;{const u=function(p){return(p.visible||s)&&(!i||!~i.indexOf(p.writeId))&&(Ei(p.path,e)||Ei(e,p.path))},h=LC(n.allWrites,u,e),f=t||Ae.EMPTY_NODE;return su(h,f)}}}function mV(n,e,t){let i=Ae.EMPTY_NODE;const s=Vo(n.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(wt,(o,u)=>{i=i.updateImmediateChild(o,u)}),i;if(t){const o=Ys(n.visibleWrites,e);return t.forEachChild(wt,(u,h)=>{const f=su(Ys(o,new st(u)),h);i=i.updateImmediateChild(u,f)}),dS(o).forEach(u=>{i=i.updateImmediateChild(u.name,u.node)}),i}else{const o=Ys(n.visibleWrites,e);return dS(o).forEach(u=>{i=i.updateImmediateChild(u.name,u.node)}),i}}function pV(n,e,t,i,s){le(i||s,"Either existingEventSnap or existingServerSnap must exist");const o=kt(e,t);if(_v(n.visibleWrites,o))return null;{const u=Ys(n.visibleWrites,o);return yv(u)?s.getChild(t):su(u,s.getChild(t))}}function gV(n,e,t,i){const s=kt(e,t),o=Vo(n.visibleWrites,s);if(o!=null)return o;if(i.isCompleteForChild(t)){const u=Ys(n.visibleWrites,s);return su(u,i.getNode().getImmediateChild(t))}else return null}function _V(n,e){return Vo(n.visibleWrites,e)}function yV(n,e,t,i,s,o,u){let h;const f=Ys(n.visibleWrites,e),p=Vo(f,Qe());if(p!=null)h=p;else if(t!=null)h=su(f,t);else return[];if(h=h.withIndex(u),!h.isEmpty()&&!h.isLeafNode()){const _=[],v=u.getCompare(),T=o?h.getReverseIteratorFrom(i,u):h.getIteratorFrom(i,u);let S=T.getNext();for(;S&&_.length<s;)v(S,i)!==0&&_.push(S),S=T.getNext();return _}else return[]}function vV(){return{visibleWrites:Vi.empty(),allWrites:[],lastWriteId:-1}}function Ym(n,e,t,i){return UC(n.writeTree,n.treePath,e,t,i)}function bE(n,e){return mV(n.writeTree,n.treePath,e)}function fS(n,e,t,i){return pV(n.writeTree,n.treePath,e,t,i)}function Qm(n,e){return _V(n.writeTree,kt(n.treePath,e))}function EV(n,e,t,i,s,o){return yV(n.writeTree,n.treePath,e,t,i,s,o)}function IE(n,e,t){return gV(n.writeTree,n.treePath,e,t)}function FC(n,e){return BC(kt(n.treePath,e),n.writeTree)}function BC(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TV{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,i=e.childName;le(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),le(i!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(i);if(s){const o=s.type;if(t==="child_added"&&o==="child_removed")this.changeMap.set(i,Fh(i,e.snapshotNode,s.snapshotNode));else if(t==="child_removed"&&o==="child_added")this.changeMap.delete(i);else if(t==="child_removed"&&o==="child_changed")this.changeMap.set(i,Uh(i,s.oldSnap));else if(t==="child_changed"&&o==="child_added")this.changeMap.set(i,ru(i,e.snapshotNode));else if(t==="child_changed"&&o==="child_changed")this.changeMap.set(i,Fh(i,e.snapshotNode,s.oldSnap));else throw Ru("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wV{getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}}const zC=new wV;class SE{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const i=this.optCompleteServerCache_!=null?new Zs(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return IE(this.writes_,e,i)}}getChildAfterChild(e,t,i){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:vo(this.viewCache_),o=EV(this.writes_,s,t,1,i,e);return o.length===0?null:o[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bV(n){return{filter:n}}function IV(n,e){le(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),le(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function SV(n,e,t,i,s){const o=new TV;let u,h;if(t.type===ki.OVERWRITE){const p=t;p.source.fromUser?u=vv(n,e,p.path,p.snap,i,s,o):(le(p.source.fromServer,"Unknown source."),h=p.source.tagged||e.serverCache.isFiltered()&&!Ve(p.path),u=Wm(n,e,p.path,p.snap,i,s,h,o))}else if(t.type===ki.MERGE){const p=t;p.source.fromUser?u=RV(n,e,p.path,p.children,i,s,o):(le(p.source.fromServer,"Unknown source."),h=p.source.tagged||e.serverCache.isFiltered(),u=Ev(n,e,p.path,p.children,i,s,h,o))}else if(t.type===ki.ACK_USER_WRITE){const p=t;p.revert?u=NV(n,e,p.path,i,s,o):u=CV(n,e,p.path,p.affectedTree,i,s,o)}else if(t.type===ki.LISTEN_COMPLETE)u=DV(n,e,t.path,i,o);else throw Ru("Unknown operation type: "+t.type);const f=o.getChanges();return AV(e,u,f),{viewCache:u,changes:f}}function AV(n,e,t){const i=e.eventCache;if(i.isFullyInitialized()){const s=i.getNode().isLeafNode()||i.getNode().isEmpty(),o=Km(n);(t.length>0||!n.eventCache.isFullyInitialized()||s&&!i.getNode().equals(o)||!i.getNode().getPriority().equals(o.getPriority()))&&t.push(PC(Km(e)))}}function qC(n,e,t,i,s,o){const u=e.eventCache;if(Qm(i,t)!=null)return e;{let h,f;if(Ve(t))if(le(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const p=vo(e),_=p instanceof Ae?p:Ae.EMPTY_NODE,v=bE(i,_);h=n.filter.updateFullNode(e.eventCache.getNode(),v,o)}else{const p=Ym(i,vo(e));h=n.filter.updateFullNode(e.eventCache.getNode(),p,o)}else{const p=xe(t);if(p===".priority"){le(Js(t)===1,"Can't have a priority with additional path components");const _=u.getNode();f=e.serverCache.getNode();const v=fS(i,t,_,f);v!=null?h=n.filter.updatePriority(_,v):h=u.getNode()}else{const _=ht(t);let v;if(u.isCompleteForChild(p)){f=e.serverCache.getNode();const T=fS(i,t,u.getNode(),f);T!=null?v=u.getNode().getImmediateChild(p).updateChild(_,T):v=u.getNode().getImmediateChild(p)}else v=IE(i,p,e.serverCache);v!=null?h=n.filter.updateChild(u.getNode(),p,v,_,s,o):h=u.getNode()}}return Eh(e,h,u.isFullyInitialized()||Ve(t),n.filter.filtersNodes())}}function Wm(n,e,t,i,s,o,u,h){const f=e.serverCache;let p;const _=u?n.filter:n.filter.getIndexedFilter();if(Ve(t))p=_.updateFullNode(f.getNode(),i,null);else if(_.filtersNodes()&&!f.isFiltered()){const S=f.getNode().updateChild(t,i);p=_.updateFullNode(f.getNode(),S,null)}else{const S=xe(t);if(!f.isCompleteForPath(t)&&Js(t)>1)return e;const N=ht(t),U=f.getNode().getImmediateChild(S).updateChild(N,i);S===".priority"?p=_.updatePriority(f.getNode(),U):p=_.updateChild(f.getNode(),S,U,N,zC,null)}const v=MC(e,p,f.isFullyInitialized()||Ve(t),_.filtersNodes()),T=new SE(s,v,o);return qC(n,v,t,s,T,h)}function vv(n,e,t,i,s,o,u){const h=e.eventCache;let f,p;const _=new SE(s,e,o);if(Ve(t))p=n.filter.updateFullNode(e.eventCache.getNode(),i,u),f=Eh(e,p,!0,n.filter.filtersNodes());else{const v=xe(t);if(v===".priority")p=n.filter.updatePriority(e.eventCache.getNode(),i),f=Eh(e,p,h.isFullyInitialized(),h.isFiltered());else{const T=ht(t),S=h.getNode().getImmediateChild(v);let N;if(Ve(T))N=i;else{const x=_.getCompleteChild(v);x!=null?pE(T)===".priority"&&x.getChild(AC(T)).isEmpty()?N=x:N=x.updateChild(T,i):N=Ae.EMPTY_NODE}if(S.equals(N))f=e;else{const x=n.filter.updateChild(h.getNode(),v,N,T,_,u);f=Eh(e,x,h.isFullyInitialized(),n.filter.filtersNodes())}}}return f}function mS(n,e){return n.eventCache.isCompleteForChild(e)}function RV(n,e,t,i,s,o,u){let h=e;return i.foreach((f,p)=>{const _=kt(t,f);mS(e,xe(_))&&(h=vv(n,h,_,p,s,o,u))}),i.foreach((f,p)=>{const _=kt(t,f);mS(e,xe(_))||(h=vv(n,h,_,p,s,o,u))}),h}function pS(n,e,t){return t.foreach((i,s)=>{e=e.updateChild(i,s)}),e}function Ev(n,e,t,i,s,o,u,h){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let f=e,p;Ve(t)?p=i:p=new pt(null).setTree(t,i);const _=e.serverCache.getNode();return p.children.inorderTraversal((v,T)=>{if(_.hasChild(v)){const S=e.serverCache.getNode().getImmediateChild(v),N=pS(n,S,T);f=Wm(n,f,new st(v),N,s,o,u,h)}}),p.children.inorderTraversal((v,T)=>{const S=!e.serverCache.isCompleteForChild(v)&&T.value===null;if(!_.hasChild(v)&&!S){const N=e.serverCache.getNode().getImmediateChild(v),x=pS(n,N,T);f=Wm(n,f,new st(v),x,s,o,u,h)}}),f}function CV(n,e,t,i,s,o,u){if(Qm(s,t)!=null)return e;const h=e.serverCache.isFiltered(),f=e.serverCache;if(i.value!=null){if(Ve(t)&&f.isFullyInitialized()||f.isCompleteForPath(t))return Wm(n,e,t,f.getNode().getChild(t),s,o,h,u);if(Ve(t)){let p=new pt(null);return f.getNode().forEachChild($l,(_,v)=>{p=p.set(new st(_),v)}),Ev(n,e,t,p,s,o,h,u)}else return e}else{let p=new pt(null);return i.foreach((_,v)=>{const T=kt(t,_);f.isCompleteForPath(T)&&(p=p.set(_,f.getNode().getChild(T)))}),Ev(n,e,t,p,s,o,h,u)}}function DV(n,e,t,i,s){const o=e.serverCache,u=MC(e,o.getNode(),o.isFullyInitialized()||Ve(t),o.isFiltered());return qC(n,u,t,i,zC,s)}function NV(n,e,t,i,s,o){let u;if(Qm(i,t)!=null)return e;{const h=new SE(i,e,s),f=e.eventCache.getNode();let p;if(Ve(t)||xe(t)===".priority"){let _;if(e.serverCache.isFullyInitialized())_=Ym(i,vo(e));else{const v=e.serverCache.getNode();le(v instanceof Ae,"serverChildren would be complete if leaf node"),_=bE(i,v)}_=_,p=n.filter.updateFullNode(f,_,o)}else{const _=xe(t);let v=IE(i,_,e.serverCache);v==null&&e.serverCache.isCompleteForChild(_)&&(v=f.getImmediateChild(_)),v!=null?p=n.filter.updateChild(f,_,v,ht(t),h,o):e.eventCache.getNode().hasChild(_)?p=n.filter.updateChild(f,_,Ae.EMPTY_NODE,ht(t),h,o):p=f,p.isEmpty()&&e.serverCache.isFullyInitialized()&&(u=Ym(i,vo(e)),u.isLeafNode()&&(p=n.filter.updateFullNode(p,u,o)))}return u=e.serverCache.isFullyInitialized()||Qm(i,Qe())!=null,Eh(e,p,u,n.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OV{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const i=this.query_._queryParams,s=new vE(i.getIndex()),o=$2(i);this.processor_=bV(o);const u=t.serverCache,h=t.eventCache,f=s.updateFullNode(Ae.EMPTY_NODE,u.getNode(),null),p=o.updateFullNode(Ae.EMPTY_NODE,h.getNode(),null),_=new Zs(f,u.isFullyInitialized(),s.filtersNodes()),v=new Zs(p,h.isFullyInitialized(),o.filtersNodes());this.viewCache_=Up(v,_),this.eventGenerator_=new iV(this.query_)}get query(){return this.query_}}function xV(n){return n.viewCache_.serverCache.getNode()}function PV(n){return Km(n.viewCache_)}function kV(n,e){const t=vo(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!Ve(e)&&!t.getImmediateChild(xe(e)).isEmpty())?t.getChild(e):null}function gS(n){return n.eventRegistrations_.length===0}function MV(n,e){n.eventRegistrations_.push(e)}function _S(n,e,t){const i=[];if(t){le(e==null,"A cancel should cancel all event registrations.");const s=n.query._path;n.eventRegistrations_.forEach(o=>{const u=o.createCancelEvent(t,s);u&&i.push(u)})}if(e){let s=[];for(let o=0;o<n.eventRegistrations_.length;++o){const u=n.eventRegistrations_[o];if(!u.matches(e))s.push(u);else if(e.hasAnyCallback()){s=s.concat(n.eventRegistrations_.slice(o+1));break}}n.eventRegistrations_=s}else n.eventRegistrations_=[];return i}function yS(n,e,t,i){e.type===ki.MERGE&&e.source.queryId!==null&&(le(vo(n.viewCache_),"We should always have a full cache before handling merges"),le(Km(n.viewCache_),"Missing event cache, even though we have a server cache"));const s=n.viewCache_,o=SV(n.processor_,s,e,t,i);return IV(n.processor_,o.viewCache),le(o.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=o.viewCache,jC(n,o.changes,o.viewCache.eventCache.getNode(),null)}function VV(n,e){const t=n.viewCache_.eventCache,i=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(wt,(o,u)=>{i.push(ru(o,u))}),t.isFullyInitialized()&&i.push(PC(t.getNode())),jC(n,i,t.getNode(),e)}function jC(n,e,t,i){const s=i?[i]:n.eventRegistrations_;return rV(n.eventGenerator_,e,t,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $m;class HC{constructor(){this.views=new Map}}function LV(n){le(!$m,"__referenceConstructor has already been defined"),$m=n}function UV(){return le($m,"Reference.ts has not been loaded"),$m}function FV(n){return n.views.size===0}function AE(n,e,t,i){const s=e.source.queryId;if(s!==null){const o=n.views.get(s);return le(o!=null,"SyncTree gave us an op for an invalid query."),yS(o,e,t,i)}else{let o=[];for(const u of n.views.values())o=o.concat(yS(u,e,t,i));return o}}function GC(n,e,t,i,s){const o=e._queryIdentifier,u=n.views.get(o);if(!u){let h=Ym(t,s?i:null),f=!1;h?f=!0:i instanceof Ae?(h=bE(t,i),f=!1):(h=Ae.EMPTY_NODE,f=!1);const p=Up(new Zs(h,f,!1),new Zs(i,s,!1));return new OV(e,p)}return u}function BV(n,e,t,i,s,o){const u=GC(n,e,i,s,o);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,u),MV(u,t),VV(u,t)}function zV(n,e,t,i){const s=e._queryIdentifier,o=[];let u=[];const h=ea(n);if(s==="default")for(const[f,p]of n.views.entries())u=u.concat(_S(p,t,i)),gS(p)&&(n.views.delete(f),p.query._queryParams.loadsAllData()||o.push(p.query));else{const f=n.views.get(s);f&&(u=u.concat(_S(f,t,i)),gS(f)&&(n.views.delete(s),f.query._queryParams.loadsAllData()||o.push(f.query)))}return h&&!ea(n)&&o.push(new(UV())(e._repo,e._path)),{removed:o,events:u}}function KC(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Qs(n,e){let t=null;for(const i of n.views.values())t=t||kV(i,e);return t}function YC(n,e){if(e._queryParams.loadsAllData())return Bp(n);{const i=e._queryIdentifier;return n.views.get(i)}}function QC(n,e){return YC(n,e)!=null}function ea(n){return Bp(n)!=null}function Bp(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xm;function qV(n){le(!Xm,"__referenceConstructor has already been defined"),Xm=n}function jV(){return le(Xm,"Reference.ts has not been loaded"),Xm}let HV=1;class vS{constructor(e){this.listenProvider_=e,this.syncPointTree_=new pt(null),this.pendingWriteTree_=vV(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function WC(n,e,t,i,s){return lV(n.pendingWriteTree_,e,t,i,s),s?md(n,new yo(kC(),e,t)):[]}function lo(n,e,t=!1){const i=uV(n.pendingWriteTree_,e);if(cV(n.pendingWriteTree_,e)){let o=new pt(null);return i.snap!=null?o=o.set(Qe(),!0):In(i.children,u=>{o=o.set(new st(u),!0)}),md(n,new Gm(i.path,o,t))}else return[]}function fd(n,e,t){return md(n,new yo(TE(),e,t))}function GV(n,e,t){const i=pt.fromObject(t);return md(n,new qh(TE(),e,i))}function KV(n,e){return md(n,new zh(TE(),e))}function YV(n,e,t){const i=CE(n,t);if(i){const s=DE(i),o=s.path,u=s.queryId,h=xn(o,e),f=new zh(wE(u),h);return NE(n,o,f)}else return[]}function Jm(n,e,t,i,s=!1){const o=e._path,u=n.syncPointTree_.get(o);let h=[];if(u&&(e._queryIdentifier==="default"||QC(u,e))){const f=zV(u,e,t,i);FV(u)&&(n.syncPointTree_=n.syncPointTree_.remove(o));const p=f.removed;if(h=f.events,!s){const _=p.findIndex(T=>T._queryParams.loadsAllData())!==-1,v=n.syncPointTree_.findOnPath(o,(T,S)=>ea(S));if(_&&!v){const T=n.syncPointTree_.subtree(o);if(!T.isEmpty()){const S=$V(T);for(let N=0;N<S.length;++N){const x=S[N],U=x.query,Z=ZC(n,x);n.listenProvider_.startListening(wh(U),jh(n,U),Z.hashFn,Z.onComplete)}}}!v&&p.length>0&&!i&&(_?n.listenProvider_.stopListening(wh(e),null):p.forEach(T=>{const S=n.queryToTagMap.get(zp(T));n.listenProvider_.stopListening(wh(T),S)}))}XV(n,p)}return h}function $C(n,e,t,i){const s=CE(n,i);if(s!=null){const o=DE(s),u=o.path,h=o.queryId,f=xn(u,e),p=new yo(wE(h),f,t);return NE(n,u,p)}else return[]}function QV(n,e,t,i){const s=CE(n,i);if(s){const o=DE(s),u=o.path,h=o.queryId,f=xn(u,e),p=pt.fromObject(t),_=new qh(wE(h),f,p);return NE(n,u,_)}else return[]}function Tv(n,e,t,i=!1){const s=e._path;let o=null,u=!1;n.syncPointTree_.foreachOnPath(s,(T,S)=>{const N=xn(T,s);o=o||Qs(S,N),u=u||ea(S)});let h=n.syncPointTree_.get(s);h?(u=u||ea(h),o=o||Qs(h,Qe())):(h=new HC,n.syncPointTree_=n.syncPointTree_.set(s,h));let f;o!=null?f=!0:(f=!1,o=Ae.EMPTY_NODE,n.syncPointTree_.subtree(s).foreachChild((S,N)=>{const x=Qs(N,Qe());x&&(o=o.updateImmediateChild(S,x))}));const p=QC(h,e);if(!p&&!e._queryParams.loadsAllData()){const T=zp(e);le(!n.queryToTagMap.has(T),"View does not exist, but we have a tag");const S=JV();n.queryToTagMap.set(T,S),n.tagToQueryMap.set(S,T)}const _=Fp(n.pendingWriteTree_,s);let v=BV(h,e,t,_,o,f);if(!p&&!u&&!i){const T=YC(h,e);v=v.concat(ZV(n,e,T))}return v}function RE(n,e,t){const s=n.pendingWriteTree_,o=n.syncPointTree_.findOnPath(e,(u,h)=>{const f=xn(u,e),p=Qs(h,f);if(p)return p});return UC(s,e,o,t,!0)}function WV(n,e){const t=e._path;let i=null;n.syncPointTree_.foreachOnPath(t,(p,_)=>{const v=xn(p,t);i=i||Qs(_,v)});let s=n.syncPointTree_.get(t);s?i=i||Qs(s,Qe()):(s=new HC,n.syncPointTree_=n.syncPointTree_.set(t,s));const o=i!=null,u=o?new Zs(i,!0,!1):null,h=Fp(n.pendingWriteTree_,e._path),f=GC(s,e,h,o?u.getNode():Ae.EMPTY_NODE,o);return PV(f)}function md(n,e){return XC(e,n.syncPointTree_,null,Fp(n.pendingWriteTree_,Qe()))}function XC(n,e,t,i){if(Ve(n.path))return JC(n,e,t,i);{const s=e.get(Qe());t==null&&s!=null&&(t=Qs(s,Qe()));let o=[];const u=xe(n.path),h=n.operationForChild(u),f=e.children.get(u);if(f&&h){const p=t?t.getImmediateChild(u):null,_=FC(i,u);o=o.concat(XC(h,f,p,_))}return s&&(o=o.concat(AE(s,n,i,t))),o}}function JC(n,e,t,i){const s=e.get(Qe());t==null&&s!=null&&(t=Qs(s,Qe()));let o=[];return e.children.inorderTraversal((u,h)=>{const f=t?t.getImmediateChild(u):null,p=FC(i,u),_=n.operationForChild(u);_&&(o=o.concat(JC(_,h,f,p)))}),s&&(o=o.concat(AE(s,n,i,t))),o}function ZC(n,e){const t=e.query,i=jh(n,t);return{hashFn:()=>(xV(e)||Ae.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return i?YV(n,t._path,i):KV(n,t._path);{const o=QM(s,t);return Jm(n,t,null,o)}}}}function jh(n,e){const t=zp(e);return n.queryToTagMap.get(t)}function zp(n){return n._path.toString()+"$"+n._queryIdentifier}function CE(n,e){return n.tagToQueryMap.get(e)}function DE(n){const e=n.indexOf("$");return le(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new st(n.substr(0,e))}}function NE(n,e,t){const i=n.syncPointTree_.get(e);le(i,"Missing sync point for query tag that we're tracking");const s=Fp(n.pendingWriteTree_,e);return AE(i,t,s,null)}function $V(n){return n.fold((e,t,i)=>{if(t&&ea(t))return[Bp(t)];{let s=[];return t&&(s=KC(t)),In(i,(o,u)=>{s=s.concat(u)}),s}})}function wh(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(jV())(n._repo,n._path):n}function XV(n,e){for(let t=0;t<e.length;++t){const i=e[t];if(!i._queryParams.loadsAllData()){const s=zp(i),o=n.queryToTagMap.get(s);n.queryToTagMap.delete(s),n.tagToQueryMap.delete(o)}}}function JV(){return HV++}function ZV(n,e,t){const i=e._path,s=jh(n,e),o=ZC(n,t),u=n.listenProvider_.startListening(wh(e),s,o.hashFn,o.onComplete),h=n.syncPointTree_.subtree(i);if(s)le(!ea(h.value),"If we're adding a query, it shouldn't be shadowed");else{const f=h.fold((p,_,v)=>{if(!Ve(p)&&_&&ea(_))return[Bp(_).query];{let T=[];return _&&(T=T.concat(KC(_).map(S=>S.query))),In(v,(S,N)=>{T=T.concat(N)}),T}});for(let p=0;p<f.length;++p){const _=f[p];n.listenProvider_.stopListening(wh(_),jh(n,_))}}return u}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OE{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new OE(t)}node(){return this.node_}}class xE{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=kt(this.path_,e);return new xE(this.syncTree_,t)}node(){return RE(this.syncTree_,this.path_)}}const eL=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},ES=function(n,e,t){if(!n||typeof n!="object")return n;if(le(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return tL(n[".sv"],e,t);if(typeof n[".sv"]=="object")return nL(n[".sv"],e);le(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},tL=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:le(!1,"Unexpected server value: "+n)}},nL=function(n,e,t){n.hasOwnProperty("increment")||le(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const i=n.increment;typeof i!="number"&&le(!1,"Unexpected increment value: "+i);const s=e.node();if(le(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return i;const u=s.getValue();return typeof u!="number"?i:u+i},iL=function(n,e,t,i){return PE(e,new xE(t,n),i)},e1=function(n,e,t){return PE(n,new OE(e),t)};function PE(n,e,t){const i=n.getPriority().val(),s=ES(i,e.getImmediateChild(".priority"),t);let o;if(n.isLeafNode()){const u=n,h=ES(u.getValue(),e,t);return h!==u.getValue()||s!==u.getPriority().val()?new rn(h,Pt(s)):n}else{const u=n;return o=u,s!==u.getPriority().val()&&(o=o.updatePriority(new rn(s))),u.forEachChild(wt,(h,f)=>{const p=PE(f,e.getImmediateChild(h),t);p!==f&&(o=o.updateImmediateChild(h,p))}),o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kE{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}}function ME(n,e){let t=e instanceof st?e:new st(e),i=n,s=xe(t);for(;s!==null;){const o=tu(i.node.children,s)||{children:{},childCount:0};i=new kE(s,i,o),t=ht(t),s=xe(t)}return i}function Ou(n){return n.node.value}function t1(n,e){n.node.value=e,wv(n)}function n1(n){return n.node.childCount>0}function rL(n){return Ou(n)===void 0&&!n1(n)}function qp(n,e){In(n.node.children,(t,i)=>{e(new kE(t,n,i))})}function i1(n,e,t,i){t&&e(n),qp(n,s=>{i1(s,e,!0)})}function sL(n,e,t){let i=n.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function pd(n){return new st(n.parent===null?n.name:pd(n.parent)+"/"+n.name)}function wv(n){n.parent!==null&&aL(n.parent,n.name,n)}function aL(n,e,t){const i=rL(t),s=hr(n.node.children,e);i&&s?(delete n.node.children[e],n.node.childCount--,wv(n)):!i&&!s&&(n.node.children[e]=t.node,n.node.childCount++,wv(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oL=/[\[\].#$\/\u0000-\u001F\u007F]/,lL=/[\[\].#$\u0000-\u001F\u007F]/,zy=10*1024*1024,VE=function(n){return typeof n=="string"&&n.length!==0&&!oL.test(n)},r1=function(n){return typeof n=="string"&&n.length!==0&&!lL.test(n)},uL=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),r1(n)},s1=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!Vp(n)||n&&typeof n=="object"&&hr(n,".sv")},bv=function(n,e,t,i){jp(nu(n,"value"),e,t)},jp=function(n,e,t){const i=t instanceof st?new C2(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Za(i));if(typeof e=="function")throw new Error(n+"contains a function "+Za(i)+" with contents = "+e.toString());if(Vp(e))throw new Error(n+"contains "+e.toString()+" "+Za(i));if(typeof e=="string"&&e.length>zy/3&&kp(e)>zy)throw new Error(n+"contains a string greater than "+zy+" utf8 bytes "+Za(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,o=!1;if(In(e,(u,h)=>{if(u===".value")s=!0;else if(u!==".priority"&&u!==".sv"&&(o=!0,!VE(u)))throw new Error(n+" contains an invalid key ("+u+") "+Za(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);D2(i,u),jp(n,h,i),N2(i)}),s&&o)throw new Error(n+' contains ".value" child '+Za(i)+" in addition to actual children.")}},cL=function(n,e){let t,i;for(t=0;t<e.length;t++){i=e[t];const o=Lh(i);for(let u=0;u<o.length;u++)if(!(o[u]===".priority"&&u===o.length-1)){if(!VE(o[u]))throw new Error(n+"contains an invalid key ("+o[u]+") in path "+i.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(R2);let s=null;for(t=0;t<e.length;t++){if(i=e[t],s!==null&&Ei(s,i))throw new Error(n+"contains a path "+s.toString()+" that is ancestor of another path "+i.toString());s=i}},hL=function(n,e,t,i){const s=nu(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(s+" must be an object containing the children to replace.");const o=[];In(e,(u,h)=>{const f=new st(u);if(jp(s,h,kt(t,f)),pE(f)===".priority"&&!s1(h))throw new Error(s+"contains an invalid value for '"+f.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(f)}),cL(s,o)},dL=function(n,e,t){if(Vp(e))throw new Error(nu(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!s1(e))throw new Error(nu(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},a1=function(n,e,t,i){if(!r1(t))throw new Error(nu(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},fL=function(n,e,t,i){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),a1(n,e,t)},Kl=function(n,e){if(xe(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},mL=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!VE(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!uL(t))throw new Error(nu(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pL{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function LE(n,e){let t=null;for(let i=0;i<e.length;i++){const s=e[i],o=s.getPath();t!==null&&!gE(o,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:o}),t.events.push(s)}t&&n.eventLists_.push(t)}function o1(n,e,t){LE(n,t),l1(n,i=>gE(i,e))}function ur(n,e,t){LE(n,t),l1(n,i=>Ei(i,e)||Ei(e,i))}function l1(n,e){n.recursionDepth_++;let t=!0;for(let i=0;i<n.eventLists_.length;i++){const s=n.eventLists_[i];if(s){const o=s.path;e(o)?(gL(n.eventLists_[i]),n.eventLists_[i]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function gL(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const i=t.getEventRunner();yh&&fn("event: "+t.toString()),Du(i)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _L="repo_interrupt",yL=25;class vL{constructor(e,t,i,s){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new pL,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Hm(),this.transactionQueueTree_=new kE,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function EL(n,e,t){if(n.stats_=fE(n.repoInfo_),n.forceRestClient_||JM())n.server_=new jm(n.repoInfo_,(i,s,o,u)=>{TS(n,i,s,o,u)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>wS(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Yt(t)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new Hr(n.repoInfo_,e,(i,s,o,u)=>{TS(n,i,s,o,u)},i=>{wS(n,i)},i=>{wL(n,i)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=i2(n.repoInfo_,()=>new nV(n.stats_,n.server_)),n.infoData_=new X2,n.infoSyncTree_=new vS({startListening:(i,s,o,u)=>{let h=[];const f=n.infoData_.getNode(i._path);return f.isEmpty()||(h=fd(n.infoSyncTree_,i._path,f),setTimeout(()=>{u("ok")},0)),h},stopListening:()=>{}}),FE(n,"connected",!1),n.serverSyncTree_=new vS({startListening:(i,s,o,u)=>(n.server_.listen(i,o,s,(h,f)=>{const p=u(h,f);ur(n.eventQueue_,i._path,p)}),[]),stopListening:(i,s)=>{n.server_.unlisten(i,s)}})}function TL(n){const t=n.infoData_.getNode(new st(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function UE(n){return eL({timestamp:TL(n)})}function TS(n,e,t,i,s){n.dataUpdateCount++;const o=new st(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let u=[];if(s)if(i){const f=Um(t,p=>Pt(p));u=QV(n.serverSyncTree_,o,f,s)}else{const f=Pt(t);u=$C(n.serverSyncTree_,o,f,s)}else if(i){const f=Um(t,p=>Pt(p));u=GV(n.serverSyncTree_,o,f)}else{const f=Pt(t);u=fd(n.serverSyncTree_,o,f)}let h=o;u.length>0&&(h=Gp(n,o)),ur(n.eventQueue_,h,u)}function wS(n,e){FE(n,"connected",e),e===!1&&SL(n)}function wL(n,e){In(e,(t,i)=>{FE(n,t,i)})}function FE(n,e,t){const i=new st("/.info/"+e),s=Pt(t);n.infoData_.updateSnapshot(i,s);const o=fd(n.infoSyncTree_,i,s);ur(n.eventQueue_,i,o)}function u1(n){return n.nextWriteId_++}function bL(n,e,t){const i=WV(n.serverSyncTree_,e);return i!=null?Promise.resolve(i):n.server_.get(e).then(s=>{const o=Pt(s).withIndex(e._queryParams.getIndex());Tv(n.serverSyncTree_,e,t,!0);let u;if(e._queryParams.loadsAllData())u=fd(n.serverSyncTree_,e._path,o);else{const h=jh(n.serverSyncTree_,e);u=$C(n.serverSyncTree_,e._path,o,h)}return ur(n.eventQueue_,e._path,u),Jm(n.serverSyncTree_,e,t,null,!0),o},s=>(Hp(n,"get for query "+Yt(e)+" failed: "+s),Promise.reject(new Error(s))))}function IL(n,e,t,i,s){Hp(n,"set",{path:e.toString(),value:t,priority:i});const o=UE(n),u=Pt(t,i),h=RE(n.serverSyncTree_,e),f=e1(u,h,o),p=u1(n),_=WC(n.serverSyncTree_,e,f,p,!0);LE(n.eventQueue_,_),n.server_.put(e.toString(),u.val(!0),(T,S)=>{const N=T==="ok";N||zn("set at "+e+" failed: "+T);const x=lo(n.serverSyncTree_,p,!N);ur(n.eventQueue_,e,x),au(n,s,T,S)});const v=m1(n,e);Gp(n,v),ur(n.eventQueue_,v,[])}function SL(n){Hp(n,"onDisconnectEvents");const e=UE(n),t=Hm();gv(n.onDisconnect_,Qe(),(s,o)=>{const u=iL(s,o,n.serverSyncTree_,e);Nu(t,s,u)});let i=[];gv(t,Qe(),(s,o)=>{i=i.concat(fd(n.serverSyncTree_,s,o));const u=m1(n,s);Gp(n,u)}),n.onDisconnect_=Hm(),ur(n.eventQueue_,Qe(),i)}function AL(n,e,t){n.server_.onDisconnectCancel(e.toString(),(i,s)=>{i==="ok"&&pv(n.onDisconnect_,e),au(n,t,i,s)})}function bS(n,e,t,i){const s=Pt(t);n.server_.onDisconnectPut(e.toString(),s.val(!0),(o,u)=>{o==="ok"&&Nu(n.onDisconnect_,e,s),au(n,i,o,u)})}function RL(n,e,t,i,s){const o=Pt(t,i);n.server_.onDisconnectPut(e.toString(),o.val(!0),(u,h)=>{u==="ok"&&Nu(n.onDisconnect_,e,o),au(n,s,u,h)})}function CL(n,e,t,i){if(Lm(t)){fn("onDisconnect().update() called with empty data.  Don't do anything."),au(n,i,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(s,o)=>{s==="ok"&&In(t,(u,h)=>{const f=Pt(h);Nu(n.onDisconnect_,kt(e,u),f)}),au(n,i,s,o)})}function DL(n,e,t){let i;xe(e._path)===".info"?i=Tv(n.infoSyncTree_,e,t):i=Tv(n.serverSyncTree_,e,t),o1(n.eventQueue_,e._path,i)}function NL(n,e,t){let i;xe(e._path)===".info"?i=Jm(n.infoSyncTree_,e,t):i=Jm(n.serverSyncTree_,e,t),o1(n.eventQueue_,e._path,i)}function OL(n){n.persistentConnection_&&n.persistentConnection_.interrupt(_L)}function Hp(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),fn(t,...e)}function au(n,e,t,i){e&&Du(()=>{if(t==="ok")e(null);else{const s=(t||"error").toUpperCase();let o=s;i&&(o+=": "+i);const u=new Error(o);u.code=s,e(u)}})}function c1(n,e,t){return RE(n.serverSyncTree_,e,t)||Ae.EMPTY_NODE}function BE(n,e=n.transactionQueueTree_){if(e||Kp(n,e),Ou(e)){const t=d1(n,e);le(t.length>0,"Sending zero length transaction queue"),t.every(s=>s.status===0)&&xL(n,pd(e),t)}else n1(e)&&qp(e,t=>{BE(n,t)})}function xL(n,e,t){const i=t.map(p=>p.currentWriteId),s=c1(n,e,i);let o=s;const u=s.hash();for(let p=0;p<t.length;p++){const _=t[p];le(_.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),_.status=1,_.retryCount++;const v=xn(e,_.path);o=o.updateChild(v,_.currentOutputSnapshotRaw)}const h=o.val(!0),f=e;n.server_.put(f.toString(),h,p=>{Hp(n,"transaction put response",{path:f.toString(),status:p});let _=[];if(p==="ok"){const v=[];for(let T=0;T<t.length;T++)t[T].status=2,_=_.concat(lo(n.serverSyncTree_,t[T].currentWriteId)),t[T].onComplete&&v.push(()=>t[T].onComplete(null,!0,t[T].currentOutputSnapshotResolved)),t[T].unwatcher();Kp(n,ME(n.transactionQueueTree_,e)),BE(n,n.transactionQueueTree_),ur(n.eventQueue_,e,_);for(let T=0;T<v.length;T++)Du(v[T])}else{if(p==="datastale")for(let v=0;v<t.length;v++)t[v].status===3?t[v].status=4:t[v].status=0;else{zn("transaction at "+f.toString()+" failed: "+p);for(let v=0;v<t.length;v++)t[v].status=4,t[v].abortReason=p}Gp(n,e)}},u)}function Gp(n,e){const t=h1(n,e),i=pd(t),s=d1(n,t);return PL(n,s,i),i}function PL(n,e,t){if(e.length===0)return;const i=[];let s=[];const u=e.filter(h=>h.status===0).map(h=>h.currentWriteId);for(let h=0;h<e.length;h++){const f=e[h],p=xn(t,f.path);let _=!1,v;if(le(p!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),f.status===4)_=!0,v=f.abortReason,s=s.concat(lo(n.serverSyncTree_,f.currentWriteId,!0));else if(f.status===0)if(f.retryCount>=yL)_=!0,v="maxretry",s=s.concat(lo(n.serverSyncTree_,f.currentWriteId,!0));else{const T=c1(n,f.path,u);f.currentInputSnapshot=T;const S=e[h].update(T.val());if(S!==void 0){jp("transaction failed: Data returned ",S,f.path);let N=Pt(S);typeof S=="object"&&S!=null&&hr(S,".priority")||(N=N.updatePriority(T.getPriority()));const U=f.currentWriteId,Z=UE(n),ee=e1(N,T,Z);f.currentOutputSnapshotRaw=N,f.currentOutputSnapshotResolved=ee,f.currentWriteId=u1(n),u.splice(u.indexOf(U),1),s=s.concat(WC(n.serverSyncTree_,f.path,ee,f.currentWriteId,f.applyLocally)),s=s.concat(lo(n.serverSyncTree_,U,!0))}else _=!0,v="nodata",s=s.concat(lo(n.serverSyncTree_,f.currentWriteId,!0))}ur(n.eventQueue_,t,s),s=[],_&&(e[h].status=2,function(T){setTimeout(T,Math.floor(0))}(e[h].unwatcher),e[h].onComplete&&(v==="nodata"?i.push(()=>e[h].onComplete(null,!1,e[h].currentInputSnapshot)):i.push(()=>e[h].onComplete(new Error(v),!1,null))))}Kp(n,n.transactionQueueTree_);for(let h=0;h<i.length;h++)Du(i[h]);BE(n,n.transactionQueueTree_)}function h1(n,e){let t,i=n.transactionQueueTree_;for(t=xe(e);t!==null&&Ou(i)===void 0;)i=ME(i,t),e=ht(e),t=xe(e);return i}function d1(n,e){const t=[];return f1(n,e,t),t.sort((i,s)=>i.order-s.order),t}function f1(n,e,t){const i=Ou(e);if(i)for(let s=0;s<i.length;s++)t.push(i[s]);qp(e,s=>{f1(n,s,t)})}function Kp(n,e){const t=Ou(e);if(t){let i=0;for(let s=0;s<t.length;s++)t[s].status!==2&&(t[i]=t[s],i++);t.length=i,t1(e,t.length>0?t:void 0)}qp(e,i=>{Kp(n,i)})}function m1(n,e){const t=pd(h1(n,e)),i=ME(n.transactionQueueTree_,e);return sL(i,s=>{qy(n,s)}),qy(n,i),i1(i,s=>{qy(n,s)}),t}function qy(n,e){const t=Ou(e);if(t){const i=[];let s=[],o=-1;for(let u=0;u<t.length;u++)t[u].status===3||(t[u].status===1?(le(o===u-1,"All SENT items should be at beginning of queue."),o=u,t[u].status=3,t[u].abortReason="set"):(le(t[u].status===0,"Unexpected transaction status in abort"),t[u].unwatcher(),s=s.concat(lo(n.serverSyncTree_,t[u].currentWriteId,!0)),t[u].onComplete&&i.push(t[u].onComplete.bind(null,new Error("set"),!1,null))));o===-1?t1(e,void 0):t.length=o+1,ur(n.eventQueue_,pd(e),s);for(let u=0;u<i.length;u++)Du(i[u])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kL(n){let e="";const t=n.split("/");for(let i=0;i<t.length;i++)if(t[i].length>0){let s=t[i];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function ML(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const i=t.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):zn(`Invalid query segment '${t}' in query '${n}'`)}return e}const IS=function(n,e){const t=VL(n),i=t.namespace;t.domain==="firebase.com"&&Wr(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&t.domain!=="localhost"&&Wr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||jM();const s=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new _C(t.host,t.secure,i,s,e,"",i!==t.subdomain),path:new st(t.pathString)}},VL=function(n){let e="",t="",i="",s="",o="",u=!0,h="https",f=443;if(typeof n=="string"){let p=n.indexOf("//");p>=0&&(h=n.substring(0,p-1),n=n.substring(p+2));let _=n.indexOf("/");_===-1&&(_=n.length);let v=n.indexOf("?");v===-1&&(v=n.length),e=n.substring(0,Math.min(_,v)),_<v&&(s=kL(n.substring(_,v)));const T=ML(n.substring(Math.min(n.length,v)));p=e.indexOf(":"),p>=0?(u=h==="https"||h==="wss",f=parseInt(e.substring(p+1),10)):p=e.length;const S=e.slice(0,p);if(S.toLowerCase()==="localhost")t="localhost";else if(S.split(".").length<=2)t=S;else{const N=e.indexOf(".");i=e.substring(0,N).toLowerCase(),t=e.substring(N+1),o=i}"ns"in T&&(o=T.ns)}return{host:e,port:f,domain:t,subdomain:i,secure:u,scheme:h,pathString:s,namespace:o}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LL{constructor(e,t,i,s){this.eventType=e,this.eventRegistration=t,this.snapshot=i,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Yt(this.snapshot.exportVal())}}class UL{constructor(e,t,i){this.eventRegistration=e,this.error=t,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p1{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return le(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FL{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new Ur;return AL(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Kl("OnDisconnect.remove",this._path);const e=new Ur;return bS(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Kl("OnDisconnect.set",this._path),bv("OnDisconnect.set",e,this._path);const t=new Ur;return bS(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){Kl("OnDisconnect.setWithPriority",this._path),bv("OnDisconnect.setWithPriority",e,this._path),dL("OnDisconnect.setWithPriority",t);const i=new Ur;return RL(this._repo,this._path,e,t,i.wrapCallback(()=>{})),i.promise}update(e){Kl("OnDisconnect.update",this._path),hL("OnDisconnect.update",e,this._path);const t=new Ur;return CL(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zE{constructor(e,t,i,s){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=s}get key(){return Ve(this._path)?null:pE(this._path)}get ref(){return new ts(this._repo,this._path)}get _queryIdentifier(){const e=lS(this._queryParams),t=hE(e);return t==="{}"?"default":t}get _queryObject(){return lS(this._queryParams)}isEqual(e){if(e=Ke(e),!(e instanceof zE))return!1;const t=this._repo===e._repo,i=gE(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return t&&i&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+A2(this._path)}}class ts extends zE{constructor(e,t){super(e,t,new EE,!1)}get parent(){const e=AC(this._path);return e===null?null:new ts(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class Hh{constructor(e,t,i){this._node=e,this.ref=t,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new st(e),i=Iv(this.ref,e);return new Hh(this._node.getChild(t),i,wt)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,s)=>e(new Hh(s,Iv(this.ref,i),wt)))}hasChild(e){const t=new st(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Gh(n,e){return n=Ke(n),n._checkNotDeleted("ref"),e!==void 0?Iv(n._root,e):n._root}function Iv(n,e){return n=Ke(n),xe(n._path)===null?fL("child","path",e):a1("child","path",e),new ts(n._repo,kt(n._path,e))}function BL(n){return n=Ke(n),new FL(n._repo,n._path)}function zL(n){return Kl("remove",n._path),qE(n,null)}function qE(n,e){n=Ke(n),Kl("set",n._path),bv("set",e,n._path);const t=new Ur;return IL(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function qL(n){n=Ke(n);const e=new p1(()=>{}),t=new Yp(e);return bL(n._repo,n,t).then(i=>new Hh(i,new ts(n._repo,n._path),n._queryParams.getIndex()))}class Yp{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const i=t._queryParams.getIndex();return new LL("value",this,new Hh(e.snapshotNode,new ts(t._repo,t._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new UL(this,e,t):null}matches(e){return e instanceof Yp?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function jL(n,e,t,i,s){const o=new p1(t,void 0),u=new Yp(o);return DL(n._repo,n,u),()=>NL(n._repo,n,u)}function g1(n,e,t,i){return jL(n,"value",e)}function SS(n,...e){let t=Ke(n);for(const i of e)t=i._apply(t);return t}LV(ts);qV(ts);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HL="FIREBASE_DATABASE_EMULATOR_HOST",Sv={};let GL=!1;function KL(n,e,t,i){const s=e.lastIndexOf(":"),o=e.substring(0,s),u=Zr(o);n.repoInfo_=new _C(e,u,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0,t),i&&(n.authTokenProvider_=i)}function YL(n,e,t,i,s){let o=i||n.options.databaseURL;o===void 0&&(n.options.projectId||Wr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),fn("Using default host for project ",n.options.projectId),o=`${n.options.projectId}-default-rtdb.firebaseio.com`);let u=IS(o,s),h=u.repoInfo,f;typeof process<"u"&&HI&&(f=HI[HL]),f?(o=`http://${f}?ns=${h.namespace}`,u=IS(o,s),h=u.repoInfo):u.repoInfo.secure;const p=new e2(n.name,n.options,e);mL("Invalid Firebase Database URL",u),Ve(u.path)||Wr("Database URL must point to the root of a Firebase Database (not including a child path).");const _=WL(h,n,p,new ZM(n,t));return new $L(_,n)}function QL(n,e){const t=Sv[e];(!t||t[n.key]!==n)&&Wr(`Database ${e}(${n.repoInfo_}) has already been deleted.`),OL(n),delete t[n.key]}function WL(n,e,t,i){let s=Sv[e.name];s||(s={},Sv[e.name]=s);let o=s[n.toURLString()];return o&&Wr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new vL(n,GL,t,i),s[n.toURLString()]=o,o}class $L{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(EL(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0,Po("Database",this._repo.repoInfo_.emulatorOptions!==null)),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ts(this._repo,Qe())),this._rootInternal}_delete(){return this._rootInternal!==null&&(QL(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Wr("Cannot call "+e+" on a deleted database.")}}function _1(n=Mp(),e){const t=es(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const i=qR("database");i&&XL(t,...i)}return t}function XL(n,e,t,i={}){n=Ke(n),n._checkNotDeleted("useEmulator");const s=`${e}:${t}`,o=n._repoInternal;if(n._instanceStarted){if(s===n._repoInternal.repoInfo_.host&&Yr(i,o.repoInfo_.emulatorOptions))return;Wr("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let u;if(o.repoInfo_.nodeAdmin)i.mockUserToken&&Wr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),u=new gm(gm.OWNER);else if(i.mockUserToken){const h=typeof i.mockUserToken=="string"?i.mockUserToken:GR(i.mockUserToken,n.app.options.projectId);u=new gm(h)}Zr(e)&&(Pp(e),Po("Database",!0)),KL(o,s,i,u)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JL(n){LM(aa),wi(new ri("database",(e,{instanceIdentifier:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return YL(i,s,o,t)},"PUBLIC").setMultipleInstances(!0)),Tn(GI,KI,n),Tn(GI,KI,"esm2017")}Hr.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};Hr.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};JL();var ZL="firebase",eU="11.7.3";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Tn(ZL,eU,"app");const y1="@firebase/installations",jE="0.6.16";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v1=1e4,E1=`w:${jE}`,T1="FIS_v2",tU="https://firebaseinstallations.googleapis.com/v1",nU=60*60*1e3,iU="installations",rU="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sU={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Eo=new ko(iU,rU,sU);function w1(n){return n instanceof Si&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b1({projectId:n}){return`${tU}/projects/${n}/installations`}function I1(n){return{token:n.token,requestStatus:2,expiresIn:oU(n.expiresIn),creationTime:Date.now()}}async function S1(n,e){const i=(await e.json()).error;return Eo.create("request-failed",{requestName:n,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function A1({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function aU(n,{refreshToken:e}){const t=A1(n);return t.append("Authorization",lU(e)),t}async function R1(n){const e=await n();return e.status>=500&&e.status<600?n():e}function oU(n){return Number(n.replace("s","000"))}function lU(n){return`${T1} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uU({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const i=b1(n),s=A1(n),o=e.getImmediate({optional:!0});if(o){const p=await o.getHeartbeatsHeader();p&&s.append("x-firebase-client",p)}const u={fid:t,authVersion:T1,appId:n.appId,sdkVersion:E1},h={method:"POST",headers:s,body:JSON.stringify(u)},f=await R1(()=>fetch(i,h));if(f.ok){const p=await f.json();return{fid:p.fid||t,registrationStatus:2,refreshToken:p.refreshToken,authToken:I1(p.authToken)}}else throw await S1("Create Installation",f)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C1(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cU(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hU=/^[cdef][\w-]{21}$/,Av="";function dU(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=fU(n);return hU.test(t)?t:Av}catch{return Av}}function fU(n){return cU(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qp(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D1=new Map;function N1(n,e){const t=Qp(n);O1(t,e),mU(t,e)}function O1(n,e){const t=D1.get(n);if(t)for(const i of t)i(e)}function mU(n,e){const t=pU();t&&t.postMessage({key:n,fid:e}),gU()}let uo=null;function pU(){return!uo&&"BroadcastChannel"in self&&(uo=new BroadcastChannel("[Firebase] FID Change"),uo.onmessage=n=>{O1(n.data.key,n.data.fid)}),uo}function gU(){D1.size===0&&uo&&(uo.close(),uo=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _U="firebase-installations-database",yU=1,To="firebase-installations-store";let jy=null;function HE(){return jy||(jy=ZR(_U,yU,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(To)}}})),jy}async function Zm(n,e){const t=Qp(n),s=(await HE()).transaction(To,"readwrite"),o=s.objectStore(To),u=await o.get(t);return await o.put(e,t),await s.done,(!u||u.fid!==e.fid)&&N1(n,e.fid),e}async function x1(n){const e=Qp(n),i=(await HE()).transaction(To,"readwrite");await i.objectStore(To).delete(e),await i.done}async function Wp(n,e){const t=Qp(n),s=(await HE()).transaction(To,"readwrite"),o=s.objectStore(To),u=await o.get(t),h=e(u);return h===void 0?await o.delete(t):await o.put(h,t),await s.done,h&&(!u||u.fid!==h.fid)&&N1(n,h.fid),h}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GE(n){let e;const t=await Wp(n.appConfig,i=>{const s=vU(i),o=EU(n,s);return e=o.registrationPromise,o.installationEntry});return t.fid===Av?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function vU(n){const e=n||{fid:dU(),registrationStatus:0};return P1(e)}function EU(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(Eo.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=TU(n,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:wU(n)}:{installationEntry:e}}async function TU(n,e){try{const t=await uU(n,e);return Zm(n.appConfig,t)}catch(t){throw w1(t)&&t.customData.serverCode===409?await x1(n.appConfig):await Zm(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function wU(n){let e=await AS(n.appConfig);for(;e.registrationStatus===1;)await C1(100),e=await AS(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await GE(n);return i||t}return e}function AS(n){return Wp(n,e=>{if(!e)throw Eo.create("installation-not-found");return P1(e)})}function P1(n){return bU(n)?{fid:n.fid,registrationStatus:0}:n}function bU(n){return n.registrationStatus===1&&n.registrationTime+v1<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IU({appConfig:n,heartbeatServiceProvider:e},t){const i=SU(n,t),s=aU(n,t),o=e.getImmediate({optional:!0});if(o){const p=await o.getHeartbeatsHeader();p&&s.append("x-firebase-client",p)}const u={installation:{sdkVersion:E1,appId:n.appId}},h={method:"POST",headers:s,body:JSON.stringify(u)},f=await R1(()=>fetch(i,h));if(f.ok){const p=await f.json();return I1(p)}else throw await S1("Generate Auth Token",f)}function SU(n,{fid:e}){return`${b1(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KE(n,e=!1){let t;const i=await Wp(n.appConfig,o=>{if(!k1(o))throw Eo.create("not-registered");const u=o.authToken;if(!e&&CU(u))return o;if(u.requestStatus===1)return t=AU(n,e),o;{if(!navigator.onLine)throw Eo.create("app-offline");const h=NU(o);return t=RU(n,h),h}});return t?await t:i.authToken}async function AU(n,e){let t=await RS(n.appConfig);for(;t.authToken.requestStatus===1;)await C1(100),t=await RS(n.appConfig);const i=t.authToken;return i.requestStatus===0?KE(n,e):i}function RS(n){return Wp(n,e=>{if(!k1(e))throw Eo.create("not-registered");const t=e.authToken;return OU(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function RU(n,e){try{const t=await IU(n,e),i=Object.assign(Object.assign({},e),{authToken:t});return await Zm(n.appConfig,i),t}catch(t){if(w1(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await x1(n.appConfig);else{const i=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Zm(n.appConfig,i)}throw t}}function k1(n){return n!==void 0&&n.registrationStatus===2}function CU(n){return n.requestStatus===2&&!DU(n)}function DU(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+nU}function NU(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function OU(n){return n.requestStatus===1&&n.requestTime+v1<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xU(n){const e=n,{installationEntry:t,registrationPromise:i}=await GE(e);return i?i.catch(console.error):KE(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PU(n,e=!1){const t=n;return await kU(t),(await KE(t,e)).token}async function kU(n){const{registrationPromise:e}=await GE(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MU(n){if(!n||!n.options)throw Hy("App Configuration");if(!n.name)throw Hy("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw Hy(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function Hy(n){return Eo.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M1="installations",VU="installations-internal",LU=n=>{const e=n.getProvider("app").getImmediate(),t=MU(e),i=es(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},UU=n=>{const e=n.getProvider("app").getImmediate(),t=es(e,M1).getImmediate();return{getId:()=>xU(t),getToken:s=>PU(t,s)}};function FU(){wi(new ri(M1,LU,"PUBLIC")),wi(new ri(VU,UU,"PRIVATE"))}FU();Tn(y1,jE);Tn(y1,jE,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ep="analytics",BU="firebase_id",zU="origin",qU=60*1e3,jU="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",YE="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qn=new ud("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HU={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},ni=new ko("analytics","Analytics",HU);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GU(n){if(!n.startsWith(YE)){const e=ni.create("invalid-gtag-resource",{gtagURL:n});return qn.warn(e.message),""}return n}function V1(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function KU(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function YU(n,e){const t=KU("firebase-js-sdk-policy",{createScriptURL:GU}),i=document.createElement("script"),s=`${YE}?l=${n}&id=${e}`;i.src=t?t==null?void 0:t.createScriptURL(s):s,i.async=!0,document.head.appendChild(i)}function QU(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function WU(n,e,t,i,s,o){const u=i[s];try{if(u)await e[u];else{const f=(await V1(t)).find(p=>p.measurementId===s);f&&await e[f.appId]}}catch(h){qn.error(h)}n("config",s,o)}async function $U(n,e,t,i,s){try{let o=[];if(s&&s.send_to){let u=s.send_to;Array.isArray(u)||(u=[u]);const h=await V1(t);for(const f of u){const p=h.find(v=>v.measurementId===f),_=p&&e[p.appId];if(_)o.push(_);else{o=[];break}}}o.length===0&&(o=Object.values(e)),await Promise.all(o),n("event",i,s||{})}catch(o){qn.error(o)}}function XU(n,e,t,i){async function s(o,...u){try{if(o==="event"){const[h,f]=u;await $U(n,e,t,h,f)}else if(o==="config"){const[h,f]=u;await WU(n,e,t,i,h,f)}else if(o==="consent"){const[h,f]=u;n("consent",h,f)}else if(o==="get"){const[h,f,p]=u;n("get",h,f,p)}else if(o==="set"){const[h]=u;n("set",h)}else n(o,...u)}catch(h){qn.error(h)}}return s}function JU(n,e,t,i,s){let o=function(...u){window[i].push(arguments)};return window[s]&&typeof window[s]=="function"&&(o=window[s]),window[s]=XU(o,n,e,t),{gtagCore:o,wrappedGtag:window[s]}}function ZU(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(YE)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e4=30,t4=1e3;class n4{constructor(e={},t=t4){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const L1=new n4;function i4(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function r4(n){var e;const{appId:t,apiKey:i}=n,s={method:"GET",headers:i4(i)},o=jU.replace("{app-id}",t),u=await fetch(o,s);if(u.status!==200&&u.status!==304){let h="";try{const f=await u.json();!((e=f.error)===null||e===void 0)&&e.message&&(h=f.error.message)}catch{}throw ni.create("config-fetch-failed",{httpStatus:u.status,responseMessage:h})}return u.json()}async function s4(n,e=L1,t){const{appId:i,apiKey:s,measurementId:o}=n.options;if(!i)throw ni.create("no-app-id");if(!s){if(o)return{measurementId:o,appId:i};throw ni.create("no-api-key")}const u=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},h=new l4;return setTimeout(async()=>{h.abort()},qU),U1({appId:i,apiKey:s,measurementId:o},u,h,e)}async function U1(n,{throttleEndTimeMillis:e,backoffCount:t},i,s=L1){var o;const{appId:u,measurementId:h}=n;try{await a4(i,e)}catch(f){if(h)return qn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${h} provided in the "measurementId" field in the local Firebase config. [${f==null?void 0:f.message}]`),{appId:u,measurementId:h};throw f}try{const f=await r4(n);return s.deleteThrottleMetadata(u),f}catch(f){const p=f;if(!o4(p)){if(s.deleteThrottleMetadata(u),h)return qn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${h} provided in the "measurementId" field in the local Firebase config. [${p==null?void 0:p.message}]`),{appId:u,measurementId:h};throw f}const _=Number((o=p==null?void 0:p.customData)===null||o===void 0?void 0:o.httpStatus)===503?MI(t,s.intervalMillis,e4):MI(t,s.intervalMillis),v={throttleEndTimeMillis:Date.now()+_,backoffCount:t+1};return s.setThrottleMetadata(u,v),qn.debug(`Calling attemptFetch again in ${_} millis`),U1(n,v,i,s)}}function a4(n,e){return new Promise((t,i)=>{const s=Math.max(e-Date.now(),0),o=setTimeout(t,s);n.addEventListener(()=>{clearTimeout(o),i(ni.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function o4(n){if(!(n instanceof Si)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class l4{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function u4(n,e,t,i,s){if(s&&s.global){n("event",t,i);return}else{const o=await e,u=Object.assign(Object.assign({},i),{send_to:o});n("event",t,u)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c4(){if(uE())try{await WR()}catch(n){return qn.warn(ni.create("indexeddb-unavailable",{errorInfo:n==null?void 0:n.toString()}).message),!1}else return qn.warn(ni.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function h4(n,e,t,i,s,o,u){var h;const f=s4(n);f.then(S=>{t[S.measurementId]=S.appId,n.options.measurementId&&S.measurementId!==n.options.measurementId&&qn.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${S.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(S=>qn.error(S)),e.push(f);const p=c4().then(S=>{if(S)return i.getId()}),[_,v]=await Promise.all([f,p]);ZU(o)||YU(o,_.measurementId),s("js",new Date);const T=(h=u==null?void 0:u.config)!==null&&h!==void 0?h:{};return T[zU]="firebase",T.update=!0,v!=null&&(T[BU]=v),s("config",_.measurementId,T),_.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d4{constructor(e){this.app=e}_delete(){return delete bh[this.app.options.appId],Promise.resolve()}}let bh={},CS=[];const DS={};let Gy="dataLayer",f4="gtag",NS,F1,OS=!1;function m4(){const n=[];if(KR()&&n.push("This is a browser extension environment."),pk()||n.push("Cookies are not available."),n.length>0){const e=n.map((i,s)=>`(${s+1}) ${i}`).join(" "),t=ni.create("invalid-analytics-context",{errorInfo:e});qn.warn(t.message)}}function p4(n,e,t){m4();const i=n.options.appId;if(!i)throw ni.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)qn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw ni.create("no-api-key");if(bh[i]!=null)throw ni.create("already-exists",{id:i});if(!OS){QU(Gy);const{wrappedGtag:o,gtagCore:u}=JU(bh,CS,DS,Gy,f4);F1=o,NS=u,OS=!0}return bh[i]=h4(n,CS,DS,e,NS,Gy,t),new d4(n)}function g4(n=Mp()){n=Ke(n);const e=es(n,ep);return e.isInitialized()?e.getImmediate():_4(n)}function _4(n,e={}){const t=es(n,ep);if(t.isInitialized()){const s=t.getImmediate();if(Yr(e,t.getOptions()))return s;throw ni.create("already-initialized")}return t.initialize({options:e})}function y4(n,e,t,i){n=Ke(n),u4(F1,bh[n.app.options.appId],e,t,i).catch(s=>qn.error(s))}const xS="@firebase/analytics",PS="0.10.15";function v4(){wi(new ri(ep,(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return p4(i,s,t)},"PUBLIC")),wi(new ri("analytics-internal",n,"PRIVATE")),Tn(xS,PS),Tn(xS,PS,"esm2017");function n(e){try{const t=e.getProvider(ep).getImmediate();return{logEvent:(i,s,o)=>y4(t,i,s,o)}}catch(t){throw ni.create("interop-component-reg-failed",{reason:t})}}}v4();function QE(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(t[i[s]]=n[i[s]]);return t}function B1(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const E4=B1,z1=new ko("auth","Firebase",B1());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tp=new ud("@firebase/auth");function T4(n,...e){tp.logLevel<=Be.WARN&&tp.warn(`Auth (${aa}): ${n}`,...e)}function ym(n,...e){tp.logLevel<=Be.ERROR&&tp.error(`Auth (${aa}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bi(n,...e){throw $E(n,...e)}function Li(n,...e){return $E(n,...e)}function WE(n,e,t){const i=Object.assign(Object.assign({},E4()),{[e]:t});return new ko("auth","Firebase",i).create(e,{appName:n.name})}function Gr(n){return WE(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function w4(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&bi(n,"argument-error"),WE(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function $E(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return z1.create(n,...e)}function Ie(n,e,...t){if(!n)throw $E(e,...t)}function zr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw ym(e),new Error(e)}function $r(n,e){n||zr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rv(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function b4(){return kS()==="http:"||kS()==="https:"}function kS(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I4(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(b4()||KR()||"connection"in navigator)?navigator.onLine:!0}function S4(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gd{constructor(e,t){this.shortDelay=e,this.longDelay=t,$r(t>e,"Short delay should be less than long delay!"),this.isMobile=lE()||YR()}get(){return I4()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XE(n,e){$r(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q1{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;zr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;zr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;zr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A4={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R4=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],C4=new gd(3e4,6e4);function oa(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function ns(n,e,t,i,s={}){return j1(n,s,async()=>{let o={},u={};i&&(e==="GET"?u=i:o={body:JSON.stringify(i)});const h=Cu(Object.assign({key:n.config.apiKey},u)).slice(1),f=await n._getAdditionalHeaders();f["Content-Type"]="application/json",n.languageCode&&(f["X-Firebase-Locale"]=n.languageCode);const p=Object.assign({method:e,headers:f},o);return dk()||(p.referrerPolicy="no-referrer"),n.emulatorConfig&&Zr(n.emulatorConfig.host)&&(p.credentials="include"),q1.fetch()(await H1(n,n.config.apiHost,t,h),p)})}async function j1(n,e,t){n._canInitEmulator=!1;const i=Object.assign(Object.assign({},A4),e);try{const s=new N4(n),o=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const u=await o.json();if("needConfirmation"in u)throw sm(n,"account-exists-with-different-credential",u);if(o.ok&&!("errorMessage"in u))return u;{const h=o.ok?u.errorMessage:u.error.message,[f,p]=h.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw sm(n,"credential-already-in-use",u);if(f==="EMAIL_EXISTS")throw sm(n,"email-already-in-use",u);if(f==="USER_DISABLED")throw sm(n,"user-disabled",u);const _=i[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw WE(n,_,p);bi(n,_)}}catch(s){if(s instanceof Si)throw s;bi(n,"network-request-failed",{message:String(s)})}}async function _d(n,e,t,i,s={}){const o=await ns(n,e,t,i,s);return"mfaPendingCredential"in o&&bi(n,"multi-factor-auth-required",{_serverResponse:o}),o}async function H1(n,e,t,i){const s=`${e}${t}?${i}`,o=n,u=o.config.emulator?XE(n.config,s):`${n.config.apiScheme}://${s}`;return R4.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(u).toString():u}function D4(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class N4{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Li(this.auth,"network-request-failed")),C4.get())})}}function sm(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const s=Li(n,e,i);return s.customData._tokenResponse=t,s}function MS(n){return n!==void 0&&n.enterprise!==void 0}class O4{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return D4(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function x4(n,e){return ns(n,"GET","/v2/recaptchaConfig",oa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P4(n,e){return ns(n,"POST","/v1/accounts:delete",e)}async function np(n,e){return ns(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ih(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function k4(n,e=!1){const t=Ke(n),i=await t.getIdToken(e),s=JE(i);Ie(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const o=typeof s.firebase=="object"?s.firebase:void 0,u=o==null?void 0:o.sign_in_provider;return{claims:s,token:i,authTime:Ih(Ky(s.auth_time)),issuedAtTime:Ih(Ky(s.iat)),expirationTime:Ih(Ky(s.exp)),signInProvider:u||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function Ky(n){return Number(n)*1e3}function JE(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return ym("JWT malformed, contained fewer than 3 sections"),null;try{const s=Vm(t);return s?JSON.parse(s):(ym("Failed to decode base64 JWT payload"),null)}catch(s){return ym("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function VS(n){const e=JE(n);return Ie(e,"internal-error"),Ie(typeof e.exp<"u","internal-error"),Ie(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ou(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Si&&M4(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function M4({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V4{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cv{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ih(this.lastLoginAt),this.creationTime=Ih(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ip(n){var e;const t=n.auth,i=await n.getIdToken(),s=await ou(n,np(t,{idToken:i}));Ie(s==null?void 0:s.users.length,t,"internal-error");const o=s.users[0];n._notifyReloadListener(o);const u=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?G1(o.providerUserInfo):[],h=U4(n.providerData,u),f=n.isAnonymous,p=!(n.email&&o.passwordHash)&&!(h!=null&&h.length),_=f?p:!1,v={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:h,metadata:new Cv(o.createdAt,o.lastLoginAt),isAnonymous:_};Object.assign(n,v)}async function L4(n){const e=Ke(n);await ip(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function U4(n,e){return[...n.filter(i=>!e.some(s=>s.providerId===i.providerId)),...e]}function G1(n){return n.map(e=>{var{providerId:t}=e,i=QE(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F4(n,e){const t=await j1(n,{},async()=>{const i=Cu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:o}=n.config,u=await H1(n,s,"/v1/token",`key=${o}`),h=await n._getAdditionalHeaders();return h["Content-Type"]="application/x-www-form-urlencoded",q1.fetch()(u,{method:"POST",headers:h,body:i})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function B4(n,e){return ns(n,"POST","/v2/accounts:revokeToken",oa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ie(e.idToken,"internal-error"),Ie(typeof e.idToken<"u","internal-error"),Ie(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):VS(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ie(e.length!==0,"internal-error");const t=VS(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ie(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:s,expiresIn:o}=await F4(e,t);this.updateTokensAndExpiration(i,s,Number(o))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:s,expirationTime:o}=t,u=new Xl;return i&&(Ie(typeof i=="string","internal-error",{appName:e}),u.refreshToken=i),s&&(Ie(typeof s=="string","internal-error",{appName:e}),u.accessToken=s),o&&(Ie(typeof o=="number","internal-error",{appName:e}),u.expirationTime=o),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Xl,this.toJSON())}_performRefresh(){return zr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ks(n,e){Ie(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Mi{constructor(e){var{uid:t,auth:i,stsTokenManager:s}=e,o=QE(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new V4(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Cv(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await ou(this,this.stsTokenManager.getToken(this.auth,e));return Ie(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return k4(this,e)}reload(){return L4(this)}_assign(e){this!==e&&(Ie(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Mi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Ie(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await ip(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(On(this.auth.app))return Promise.reject(Gr(this.auth));const e=await this.getIdToken();return await ou(this,P4(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,s,o,u,h,f,p,_;const v=(i=t.displayName)!==null&&i!==void 0?i:void 0,T=(s=t.email)!==null&&s!==void 0?s:void 0,S=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,N=(u=t.photoURL)!==null&&u!==void 0?u:void 0,x=(h=t.tenantId)!==null&&h!==void 0?h:void 0,U=(f=t._redirectEventId)!==null&&f!==void 0?f:void 0,Z=(p=t.createdAt)!==null&&p!==void 0?p:void 0,ee=(_=t.lastLoginAt)!==null&&_!==void 0?_:void 0,{uid:Y,emailVerified:ie,isAnonymous:se,providerData:me,stsTokenManager:O}=t;Ie(Y&&O,e,"internal-error");const A=Xl.fromJSON(this.name,O);Ie(typeof Y=="string",e,"internal-error"),ks(v,e.name),ks(T,e.name),Ie(typeof ie=="boolean",e,"internal-error"),Ie(typeof se=="boolean",e,"internal-error"),ks(S,e.name),ks(N,e.name),ks(x,e.name),ks(U,e.name),ks(Z,e.name),ks(ee,e.name);const C=new Mi({uid:Y,auth:e,email:T,emailVerified:ie,displayName:v,isAnonymous:se,photoURL:N,phoneNumber:S,tenantId:x,stsTokenManager:A,createdAt:Z,lastLoginAt:ee});return me&&Array.isArray(me)&&(C.providerData=me.map(M=>Object.assign({},M))),U&&(C._redirectEventId=U),C}static async _fromIdTokenResponse(e,t,i=!1){const s=new Xl;s.updateFromServerResponse(t);const o=new Mi({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:i});return await ip(o),o}static async _fromGetAccountInfoResponse(e,t,i){const s=t.users[0];Ie(s.localId!==void 0,"internal-error");const o=s.providerUserInfo!==void 0?G1(s.providerUserInfo):[],u=!(s.email&&s.passwordHash)&&!(o!=null&&o.length),h=new Xl;h.updateFromIdToken(i);const f=new Mi({uid:s.localId,auth:e,stsTokenManager:h,isAnonymous:u}),p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Cv(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(o!=null&&o.length)};return Object.assign(f,p),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LS=new Map;function qr(n){$r(n instanceof Function,"Expected a class definition");let e=LS.get(n);return e?($r(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,LS.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K1{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}K1.type="NONE";const US=K1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vm(n,e,t){return`firebase:${n}:${e}:${t}`}class Jl{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:s,name:o}=this.auth;this.fullUserKey=vm(this.userKey,s.apiKey,o),this.fullPersistenceKey=vm("persistence",s.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await np(this.auth,{idToken:e}).catch(()=>{});return t?Mi._fromGetAccountInfoResponse(this.auth,t,e):null}return Mi._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Jl(qr(US),e,i);const s=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let o=s[0]||qr(US);const u=vm(i,e.config.apiKey,e.name);let h=null;for(const p of t)try{const _=await p._get(u);if(_){let v;if(typeof _=="string"){const T=await np(e,{idToken:_}).catch(()=>{});if(!T)break;v=await Mi._fromGetAccountInfoResponse(e,T,_)}else v=Mi._fromJSON(e,_);p!==o&&(h=v),o=p;break}}catch{}const f=s.filter(p=>p._shouldAllowMigration);return!o._shouldAllowMigration||!f.length?new Jl(o,e,i):(o=f[0],h&&await o._set(u,h.toJSON()),await Promise.all(t.map(async p=>{if(p!==o)try{await p._remove(u)}catch{}})),new Jl(o,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FS(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if($1(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Y1(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(J1(e))return"Blackberry";if(Z1(e))return"Webos";if(Q1(e))return"Safari";if((e.includes("chrome/")||W1(e))&&!e.includes("edge/"))return"Chrome";if(X1(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function Y1(n=Qt()){return/firefox\//i.test(n)}function Q1(n=Qt()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function W1(n=Qt()){return/crios\//i.test(n)}function $1(n=Qt()){return/iemobile/i.test(n)}function X1(n=Qt()){return/android/i.test(n)}function J1(n=Qt()){return/blackberry/i.test(n)}function Z1(n=Qt()){return/webos/i.test(n)}function ZE(n=Qt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function z4(n=Qt()){var e;return ZE(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function q4(){return fk()&&document.documentMode===10}function eD(n=Qt()){return ZE(n)||X1(n)||Z1(n)||J1(n)||/windows phone/i.test(n)||$1(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tD(n,e=[]){let t;switch(n){case"Browser":t=FS(Qt());break;case"Worker":t=`${FS(Qt())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${aa}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j4{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=o=>new Promise((u,h)=>{try{const f=e(o);u(f)}catch(f){h(f)}});i.onAbort=t,this.queue.push(i);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H4(n,e={}){return ns(n,"GET","/v2/passwordPolicy",oa(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G4=6;class K4{constructor(e){var t,i,s,o;const u=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=u.minPasswordLength)!==null&&t!==void 0?t:G4,u.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=u.maxPasswordLength),u.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=u.containsLowercaseCharacter),u.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=u.containsUppercaseCharacter),u.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=u.containsNumericCharacter),u.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=u.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,i,s,o,u,h;const f={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,f),this.validatePasswordCharacterOptions(e,f),f.isValid&&(f.isValid=(t=f.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),f.isValid&&(f.isValid=(i=f.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),f.isValid&&(f.isValid=(s=f.containsLowercaseLetter)!==null&&s!==void 0?s:!0),f.isValid&&(f.isValid=(o=f.containsUppercaseLetter)!==null&&o!==void 0?o:!0),f.isValid&&(f.isValid=(u=f.containsNumericCharacter)!==null&&u!==void 0?u:!0),f.isValid&&(f.isValid=(h=f.containsNonAlphanumericCharacter)!==null&&h!==void 0?h:!0),f}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let s=0;s<e.length;s++)i=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,s,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y4{constructor(e,t,i,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new BS(this),this.idTokenSubscription=new BS(this),this.beforeStateQueue=new j4(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=z1,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=qr(t)),this._initializationPromise=this.queue(async()=>{var i,s,o;if(!this._deleted&&(this.persistenceManager=await Jl.create(this,e),(i=this._resolvePersistenceManagerAvailable)===null||i===void 0||i.call(this),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((o=this.currentUser)===null||o===void 0?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await np(this,{idToken:e}),i=await Mi._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(On(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(h=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(h,h))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let s=i,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,h=s==null?void 0:s._redirectEventId,f=await this.tryRedirectSignIn(e);(!u||u===h)&&(f!=null&&f.user)&&(s=f.user,o=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(s)}catch(u){s=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Ie(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ip(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=S4()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(On(this.app))return Promise.reject(Gr(this));const t=e?Ke(e):null;return t&&Ie(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ie(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return On(this.app)?Promise.reject(Gr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return On(this.app)?Promise.reject(Gr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(qr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await H4(this),t=new K4(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ko("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await B4(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&qr(e)||this._popupRedirectResolver;Ie(t,this,"argument-error"),this.redirectPersistenceManager=await Jl.create(this,[qr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,s){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let u=!1;const h=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ie(h,this,"internal-error"),h.then(()=>{u||o(this.currentUser)}),typeof t=="function"){const f=e.addObserver(t,i,s);return()=>{u=!0,f()}}else{const f=e.addObserver(t);return()=>{u=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ie(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=tD(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const i=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());i&&(t["X-Firebase-Client"]=i);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){var e;if(On(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&T4(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function la(n){return Ke(n)}class BS{constructor(e){this.auth=e,this.observer=null,this.addObserver=wk(t=>this.observer=t)}get next(){return Ie(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $p={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Q4(n){$p=n}function nD(n){return $p.loadJS(n)}function W4(){return $p.recaptchaEnterpriseScript}function $4(){return $p.gapiScript}function X4(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class J4{constructor(){this.enterprise=new Z4}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Z4{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const e6="recaptcha-enterprise",iD="NO_RECAPTCHA";class t6{constructor(e){this.type=e6,this.auth=la(e)}async verify(e="verify",t=!1){async function i(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(u,h)=>{x4(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)h(new Error("recaptcha Enterprise site key undefined"));else{const p=new O4(f);return o.tenantId==null?o._agentRecaptchaConfig=p:o._tenantRecaptchaConfigs[o.tenantId]=p,u(p.siteKey)}}).catch(f=>{h(f)})})}function s(o,u,h){const f=window.grecaptcha;MS(f)?f.enterprise.ready(()=>{f.enterprise.execute(o,{action:e}).then(p=>{u(p)}).catch(()=>{u(iD)})}):h(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new J4().execute("siteKey",{action:"verify"}):new Promise((o,u)=>{i(this.auth).then(h=>{if(!t&&MS(window.grecaptcha))s(h,o,u);else{if(typeof window>"u"){u(new Error("RecaptchaVerifier is only supported in browser"));return}let f=W4();f.length!==0&&(f+=h),nD(f).then(()=>{s(h,o,u)}).catch(p=>{u(p)})}}).catch(h=>{u(h)})})}}async function zS(n,e,t,i=!1,s=!1){const o=new t6(n);let u;if(s)u=iD;else try{u=await o.verify(t)}catch{u=await o.verify(t,!0)}const h=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in h){const f=h.phoneEnrollmentInfo.phoneNumber,p=h.phoneEnrollmentInfo.recaptchaToken;Object.assign(h,{phoneEnrollmentInfo:{phoneNumber:f,recaptchaToken:p,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in h){const f=h.phoneSignInInfo.recaptchaToken;Object.assign(h,{phoneSignInInfo:{recaptchaToken:f,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return h}return i?Object.assign(h,{captchaResp:u}):Object.assign(h,{captchaResponse:u}),Object.assign(h,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(h,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),h}async function Dv(n,e,t,i,s){var o;if(!((o=n._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await zS(n,e,t,t==="getOobCode");return i(n,u)}else return i(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const h=await zS(n,e,t,t==="getOobCode");return i(n,h)}else return Promise.reject(u)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n6(n,e){const t=es(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),o=t.getOptions();if(Yr(o,e??{}))return s;bi(s,"already-initialized")}return t.initialize({options:e})}function i6(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(qr);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function r6(n,e,t){const i=la(n);Ie(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const s=!1,o=rD(e),{host:u,port:h}=s6(e),f=h===null?"":`:${h}`,p={url:`${o}//${u}${f}/`},_=Object.freeze({host:u,port:h,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!i._canInitEmulator){Ie(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Ie(Yr(p,i.config.emulator)&&Yr(_,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=p,i.emulatorConfig=_,i.settings.appVerificationDisabledForTesting=!0,Zr(u)?(Po("Auth",!0),Pp(`${o}//${u}${f}`)):a6()}function rD(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function s6(n){const e=rD(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(i);if(s){const o=s[1];return{host:o,port:qS(i.substr(o.length+1))}}else{const[o,u]=i.split(":");return{host:o,port:qS(u)}}}function qS(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function a6(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eT{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return zr("not implemented")}_getIdTokenResponse(e){return zr("not implemented")}_linkToIdToken(e,t){return zr("not implemented")}_getReauthenticationResolver(e){return zr("not implemented")}}async function o6(n,e){return ns(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l6(n,e){return _d(n,"POST","/v1/accounts:signInWithPassword",oa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u6(n,e){return _d(n,"POST","/v1/accounts:signInWithEmailLink",oa(n,e))}async function c6(n,e){return _d(n,"POST","/v1/accounts:signInWithEmailLink",oa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh extends eT{constructor(e,t,i,s=null){super("password",i),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new Kh(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new Kh(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Dv(e,t,"signInWithPassword",l6);case"emailLink":return u6(e,{email:this._email,oobCode:this._password});default:bi(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Dv(e,i,"signUpPassword",o6);case"emailLink":return c6(e,{idToken:t,email:this._email,oobCode:this._password});default:bi(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zl(n,e){return _d(n,"POST","/v1/accounts:signInWithIdp",oa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h6="http://localhost";class wo extends eT{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new wo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):bi("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:s}=t,o=QE(t,["providerId","signInMethod"]);if(!i||!s)return null;const u=new wo(i,s);return u.idToken=o.idToken||void 0,u.accessToken=o.accessToken||void 0,u.secret=o.secret,u.nonce=o.nonce,u.pendingToken=o.pendingToken||null,u}_getIdTokenResponse(e){const t=this.buildRequest();return Zl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Zl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Zl(e,t)}buildRequest(){const e={requestUri:h6,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Cu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d6(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function f6(n){const e=uh(ch(n)).link,t=e?uh(ch(e)).deep_link_id:null,i=uh(ch(n)).deep_link_id;return(i?uh(ch(i)).link:null)||i||t||e||n}class tT{constructor(e){var t,i,s,o,u,h;const f=uh(ch(e)),p=(t=f.apiKey)!==null&&t!==void 0?t:null,_=(i=f.oobCode)!==null&&i!==void 0?i:null,v=d6((s=f.mode)!==null&&s!==void 0?s:null);Ie(p&&_&&v,"argument-error"),this.apiKey=p,this.operation=v,this.code=_,this.continueUrl=(o=f.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(u=f.lang)!==null&&u!==void 0?u:null,this.tenantId=(h=f.tenantId)!==null&&h!==void 0?h:null}static parseLink(e){const t=f6(e);try{return new tT(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xu{constructor(){this.providerId=xu.PROVIDER_ID}static credential(e,t){return Kh._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=tT.parseLink(t);return Ie(i,"argument-error"),Kh._fromEmailAndCode(e,i.code,i.tenantId)}}xu.PROVIDER_ID="password";xu.EMAIL_PASSWORD_SIGN_IN_METHOD="password";xu.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nT{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd extends nT{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs extends yd{constructor(){super("facebook.com")}static credential(e){return wo._fromParams({providerId:Fs.PROVIDER_ID,signInMethod:Fs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fs.credentialFromTaggedObject(e)}static credentialFromError(e){return Fs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Fs.credential(e.oauthAccessToken)}catch{return null}}}Fs.FACEBOOK_SIGN_IN_METHOD="facebook.com";Fs.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr extends yd{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return wo._fromParams({providerId:Fr.PROVIDER_ID,signInMethod:Fr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Fr.credentialFromTaggedObject(e)}static credentialFromError(e){return Fr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Fr.credential(t,i)}catch{return null}}}Fr.GOOGLE_SIGN_IN_METHOD="google.com";Fr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs extends yd{constructor(){super("github.com")}static credential(e){return wo._fromParams({providerId:Bs.PROVIDER_ID,signInMethod:Bs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Bs.credentialFromTaggedObject(e)}static credentialFromError(e){return Bs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Bs.credential(e.oauthAccessToken)}catch{return null}}}Bs.GITHUB_SIGN_IN_METHOD="github.com";Bs.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs extends yd{constructor(){super("twitter.com")}static credential(e,t){return wo._fromParams({providerId:zs.PROVIDER_ID,signInMethod:zs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return zs.credentialFromTaggedObject(e)}static credentialFromError(e){return zs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return zs.credential(t,i)}catch{return null}}}zs.TWITTER_SIGN_IN_METHOD="twitter.com";zs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m6(n,e){return _d(n,"POST","/v1/accounts:signUp",oa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,s=!1){const o=await Mi._fromIdTokenResponse(e,i,s),u=jS(i);return new bo({user:o,providerId:u,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const s=jS(i);return new bo({user:e,providerId:s,_tokenResponse:i,operationType:t})}}function jS(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rp extends Si{constructor(e,t,i,s){var o;super(t.code,t.message),this.operationType=i,this.user=s,Object.setPrototypeOf(this,rp.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,s){return new rp(e,t,i,s)}}function sD(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?rp._fromErrorAndOperation(n,o,e,i):o})}async function p6(n,e,t=!1){const i=await ou(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return bo._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g6(n,e,t=!1){const{auth:i}=n;if(On(i.app))return Promise.reject(Gr(i));const s="reauthenticate";try{const o=await ou(n,sD(i,s,e,n),t);Ie(o.idToken,i,"internal-error");const u=JE(o.idToken);Ie(u,i,"internal-error");const{sub:h}=u;return Ie(n.uid===h,i,"user-mismatch"),bo._forOperation(n,s,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&bi(i,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aD(n,e,t=!1){if(On(n.app))return Promise.reject(Gr(n));const i="signIn",s=await sD(n,i,e),o=await bo._fromIdTokenResponse(n,i,s);return t||await n._updateCurrentUser(o.user),o}async function _6(n,e){return aD(la(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oD(n){const e=la(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function y6(n,e,t){if(On(n.app))return Promise.reject(Gr(n));const i=la(n),u=await Dv(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",m6).catch(f=>{throw f.code==="auth/password-does-not-meet-requirements"&&oD(n),f}),h=await bo._fromIdTokenResponse(i,"signIn",u);return await i._updateCurrentUser(h.user),h}function v6(n,e,t){return On(n.app)?Promise.reject(Gr(n)):_6(Ke(n),xu.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&oD(n),i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function E6(n,e){return ns(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lD(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const i=Ke(n),o={idToken:await i.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},u=await ou(i,E6(i.auth,o));i.displayName=u.displayName||null,i.photoURL=u.photoUrl||null;const h=i.providerData.find(({providerId:f})=>f==="password");h&&(h.displayName=i.displayName,h.photoURL=i.photoURL),await i._updateTokensIfNecessary(u)}function T6(n,e,t,i){return Ke(n).onIdTokenChanged(e,t,i)}function w6(n,e,t){return Ke(n).beforeAuthStateChanged(e,t)}function uD(n,e,t,i){return Ke(n).onAuthStateChanged(e,t,i)}function b6(n){return Ke(n).signOut()}const sp="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cD{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(sp,"1"),this.storage.removeItem(sp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I6=1e3,S6=10;class hD extends cD{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=eD(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),s=this.localCache[t];i!==s&&e(t,s,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((u,h,f)=>{this.notifyListeners(u,f)});return}const i=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const u=this.storage.getItem(i);!t&&this.localCache[i]===u||this.notifyListeners(i,u)},o=this.storage.getItem(i);q4()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,S6):s()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const s of Array.from(i))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},I6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}hD.type="LOCAL";const A6=hD;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dD extends cD{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}dD.type="SESSION";const fD=dD;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R6(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const i=new Xp(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:s,data:o}=t.data,u=this.handlersMap[s];if(!(u!=null&&u.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:s});const h=Array.from(u).map(async p=>p(t.origin,o)),f=await R6(h);t.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:f})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Xp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iT(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C6{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let o,u;return new Promise((h,f)=>{const p=iT("",20);s.port1.start();const _=setTimeout(()=>{f(new Error("unsupported_event"))},i);u={messageChannel:s,onMessage(v){const T=v;if(T.data.eventId===p)switch(T.data.status){case"ack":clearTimeout(_),o=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),h(T.data.response);break;default:clearTimeout(_),clearTimeout(o),f(new Error("invalid_response"));break}}},this.handlers.add(u),s.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[s.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function or(){return window}function D6(n){or().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mD(){return typeof or().WorkerGlobalScope<"u"&&typeof or().importScripts=="function"}async function N6(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function O6(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function x6(){return mD()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pD="firebaseLocalStorageDb",P6=1,ap="firebaseLocalStorage",gD="fbase_key";class vd{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Jp(n,e){return n.transaction([ap],e?"readwrite":"readonly").objectStore(ap)}function k6(){const n=indexedDB.deleteDatabase(pD);return new vd(n).toPromise()}function Nv(){const n=indexedDB.open(pD,P6);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(ap,{keyPath:gD})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(ap)?e(i):(i.close(),await k6(),e(await Nv()))})})}async function HS(n,e,t){const i=Jp(n,!0).put({[gD]:e,value:t});return new vd(i).toPromise()}async function M6(n,e){const t=Jp(n,!1).get(e),i=await new vd(t).toPromise();return i===void 0?null:i.value}function GS(n,e){const t=Jp(n,!0).delete(e);return new vd(t).toPromise()}const V6=800,L6=3;class _D{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Nv(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>L6)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return mD()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Xp._getInstance(x6()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await N6(),!this.activeServiceWorker)return;this.sender=new C6(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((e=i[0])===null||e===void 0)&&e.fulfilled&&!((t=i[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||O6()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Nv();return await HS(e,sp,"1"),await GS(e,sp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>HS(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>M6(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>GS(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const o=Jp(s,!1).getAll();return new vd(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:s,value:o}of e)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const s of Array.from(i))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),V6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}_D.type="LOCAL";const U6=_D;new gd(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yD(n,e){return e?qr(e):(Ie(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rT extends eT{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Zl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Zl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Zl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function F6(n){return aD(n.auth,new rT(n),n.bypassAuthState)}function B6(n){const{auth:e,user:t}=n;return Ie(t,e,"internal-error"),g6(t,new rT(n),n.bypassAuthState)}async function z6(n){const{auth:e,user:t}=n;return Ie(t,e,"internal-error"),p6(t,new rT(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vD{constructor(e,t,i,s,o=!1){this.auth=e,this.resolver=i,this.user=s,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:s,tenantId:o,error:u,type:h}=e;if(u){this.reject(u);return}const f={auth:this.auth,requestUri:t,sessionId:i,tenantId:o||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(f))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return F6;case"linkViaPopup":case"linkViaRedirect":return z6;case"reauthViaPopup":case"reauthViaRedirect":return B6;default:bi(this.auth,"internal-error")}}resolve(e){$r(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){$r(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q6=new gd(2e3,1e4);async function j6(n,e,t){if(On(n.app))return Promise.reject(Li(n,"operation-not-supported-in-this-environment"));const i=la(n);w4(n,e,nT);const s=yD(i,t);return new co(i,"signInViaPopup",e,s).executeNotNull()}class co extends vD{constructor(e,t,i,s,o){super(e,t,s,o),this.provider=i,this.authWindow=null,this.pollId=null,co.currentPopupAction&&co.currentPopupAction.cancel(),co.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ie(e,this.auth,"internal-error"),e}async onExecution(){$r(this.filter.length===1,"Popup operations only handle one event");const e=iT();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Li(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Li(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,co.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if(!((i=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Li(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,q6.get())};e()}}co.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H6="pendingRedirect",Em=new Map;class G6 extends vD{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Em.get(this.auth._key());if(!e){try{const i=await K6(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Em.set(this.auth._key(),e)}return this.bypassAuthState||Em.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function K6(n,e){const t=W6(e),i=Q6(n);if(!await i._isAvailable())return!1;const s=await i._get(t)==="true";return await i._remove(t),s}function Y6(n,e){Em.set(n._key(),e)}function Q6(n){return qr(n._redirectPersistence)}function W6(n){return vm(H6,n.config.apiKey,n.name)}async function $6(n,e,t=!1){if(On(n.app))return Promise.reject(Gr(n));const i=la(n),s=yD(i,e),u=await new G6(i,s,t).execute();return u&&!t&&(delete u.user._redirectEventId,await i._persistUserIfCurrent(u.user),await i._setRedirectUser(null,e)),u}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X6=10*60*1e3;class J6{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Z6(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!ED(e)){const s=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";t.onError(Li(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=X6&&this.cachedEventUids.clear(),this.cachedEventUids.has(KS(e))}saveEventToCache(e){this.cachedEventUids.add(KS(e)),this.lastProcessedEventTime=Date.now()}}function KS(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function ED({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Z6(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ED(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e3(n,e={}){return ns(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t3=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,n3=/^https?/;async function i3(n){if(n.config.emulator)return;const{authorizedDomains:e}=await e3(n);for(const t of e)try{if(r3(t))return}catch{}bi(n,"unauthorized-domain")}function r3(n){const e=Rv(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const u=new URL(n);return u.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&u.hostname===i}if(!n3.test(t))return!1;if(t3.test(n))return i===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s3=new gd(3e4,6e4);function YS(){const n=or().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function a3(n){return new Promise((e,t)=>{var i,s,o;function u(){YS(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{YS(),t(Li(n,"network-request-failed"))},timeout:s3.get()})}if(!((s=(i=or().gapi)===null||i===void 0?void 0:i.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((o=or().gapi)===null||o===void 0)&&o.load)u();else{const h=X4("iframefcb");return or()[h]=()=>{gapi.load?u():t(Li(n,"network-request-failed"))},nD(`${$4()}?onload=${h}`).catch(f=>t(f))}}).catch(e=>{throw Tm=null,e})}let Tm=null;function o3(n){return Tm=Tm||a3(n),Tm}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l3=new gd(5e3,15e3),u3="__/auth/iframe",c3="emulator/auth/iframe",h3={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},d3=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function f3(n){const e=n.config;Ie(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?XE(e,c3):`https://${n.config.authDomain}/${u3}`,i={apiKey:e.apiKey,appName:n.name,v:aa},s=d3.get(n.config.apiHost);s&&(i.eid=s);const o=n._getFrameworks();return o.length&&(i.fw=o.join(",")),`${t}?${Cu(i).slice(1)}`}async function m3(n){const e=await o3(n),t=or().gapi;return Ie(t,n,"internal-error"),e.open({where:document.body,url:f3(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:h3,dontclear:!0},i=>new Promise(async(s,o)=>{await i.restyle({setHideOnLeave:!1});const u=Li(n,"network-request-failed"),h=or().setTimeout(()=>{o(u)},l3.get());function f(){or().clearTimeout(h),s(i)}i.ping(f).then(f,()=>{o(u)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p3={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},g3=500,_3=600,y3="_blank",v3="http://localhost";class QS{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function E3(n,e,t,i=g3,s=_3){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),u=Math.max((window.screen.availWidth-i)/2,0).toString();let h="";const f=Object.assign(Object.assign({},p3),{width:i.toString(),height:s.toString(),top:o,left:u}),p=Qt().toLowerCase();t&&(h=W1(p)?y3:t),Y1(p)&&(e=e||v3,f.scrollbars="yes");const _=Object.entries(f).reduce((T,[S,N])=>`${T}${S}=${N},`,"");if(z4(p)&&h!=="_self")return T3(e||"",h),new QS(null);const v=window.open(e||"",h,_);Ie(v,n,"popup-blocked");try{v.focus()}catch{}return new QS(v)}function T3(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w3="__/auth/handler",b3="emulator/auth/handler",I3=encodeURIComponent("fac");async function WS(n,e,t,i,s,o){Ie(n.config.authDomain,n,"auth-domain-config-required"),Ie(n.config.apiKey,n,"invalid-api-key");const u={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:aa,eventId:s};if(e instanceof nT){e.setDefaultLanguage(n.languageCode),u.providerId=e.providerId||"",Lm(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,v]of Object.entries({}))u[_]=v}if(e instanceof yd){const _=e.getScopes().filter(v=>v!=="");_.length>0&&(u.scopes=_.join(","))}n.tenantId&&(u.tid=n.tenantId);const h=u;for(const _ of Object.keys(h))h[_]===void 0&&delete h[_];const f=await n._getAppCheckToken(),p=f?`#${I3}=${encodeURIComponent(f)}`:"";return`${S3(n)}?${Cu(h).slice(1)}${p}`}function S3({config:n}){return n.emulator?XE(n,b3):`https://${n.authDomain}/${w3}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yy="webStorageSupport";class A3{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=fD,this._completeRedirectFn=$6,this._overrideRedirectResult=Y6}async _openPopup(e,t,i,s){var o;$r((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const u=await WS(e,t,i,Rv(),s);return E3(e,u,iT())}async _openRedirect(e,t,i,s){await this._originValidation(e);const o=await WS(e,t,i,Rv(),s);return D6(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:o}=this.eventManagers[t];return s?Promise.resolve(s):($r(o,"If manager is not set, promise should be"),o)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await m3(e),i=new J6(e);return t.register("authEvent",s=>(Ie(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:i.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Yy,{type:Yy},s=>{var o;const u=(o=s==null?void 0:s[0])===null||o===void 0?void 0:o[Yy];u!==void 0&&t(!!u),bi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=i3(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return eD()||Q1()||ZE()}}const R3=A3;var $S="@firebase/auth",XS="1.10.4";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C3{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ie(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D3(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function N3(n){wi(new ri("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:u,authDomain:h}=i.options;Ie(u&&!u.includes(":"),"invalid-api-key",{appName:i.name});const f={apiKey:u,authDomain:h,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:tD(n)},p=new Y4(i,s,o,f);return i6(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),wi(new ri("auth-internal",e=>{const t=la(e.getProvider("auth").getImmediate());return(i=>new C3(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Tn($S,XS,D3(n)),Tn($S,XS,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O3=5*60,x3=HR("authIdTokenMaxAge")||O3;let JS=null;const P3=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>x3)return;const s=t==null?void 0:t.token;JS!==s&&(JS=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function k3(n=Mp()){const e=es(n,"auth");if(e.isInitialized())return e.getImmediate();const t=n6(n,{popupRedirectResolver:R3,persistence:[U6,A6,fD]}),i=HR("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(i,location.origin);if(location.origin===o.origin){const u=P3(o.toString());w6(t,u,()=>u(t.currentUser)),T6(t,h=>u(h))}}const s=zR("auth");return s?r6(t,`http://${s}`):Po("Auth",!1),t}function M3(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}Q4({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=s=>{const o=Li("internal-error");o.customData=s,t(o)},i.type="text/javascript",i.charset="UTF-8",M3().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});N3("Browser");var ZS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ws,TD;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(O,A){function C(){}C.prototype=A.prototype,O.D=A.prototype,O.prototype=new C,O.prototype.constructor=O,O.C=function(M,V,F){for(var D=Array(arguments.length-2),an=2;an<arguments.length;an++)D[an-2]=arguments[an];return A.prototype[V].apply(M,D)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(O,A,C){C||(C=0);var M=Array(16);if(typeof A=="string")for(var V=0;16>V;++V)M[V]=A.charCodeAt(C++)|A.charCodeAt(C++)<<8|A.charCodeAt(C++)<<16|A.charCodeAt(C++)<<24;else for(V=0;16>V;++V)M[V]=A[C++]|A[C++]<<8|A[C++]<<16|A[C++]<<24;A=O.g[0],C=O.g[1],V=O.g[2];var F=O.g[3],D=A+(F^C&(V^F))+M[0]+3614090360&4294967295;A=C+(D<<7&4294967295|D>>>25),D=F+(V^A&(C^V))+M[1]+3905402710&4294967295,F=A+(D<<12&4294967295|D>>>20),D=V+(C^F&(A^C))+M[2]+606105819&4294967295,V=F+(D<<17&4294967295|D>>>15),D=C+(A^V&(F^A))+M[3]+3250441966&4294967295,C=V+(D<<22&4294967295|D>>>10),D=A+(F^C&(V^F))+M[4]+4118548399&4294967295,A=C+(D<<7&4294967295|D>>>25),D=F+(V^A&(C^V))+M[5]+1200080426&4294967295,F=A+(D<<12&4294967295|D>>>20),D=V+(C^F&(A^C))+M[6]+2821735955&4294967295,V=F+(D<<17&4294967295|D>>>15),D=C+(A^V&(F^A))+M[7]+4249261313&4294967295,C=V+(D<<22&4294967295|D>>>10),D=A+(F^C&(V^F))+M[8]+1770035416&4294967295,A=C+(D<<7&4294967295|D>>>25),D=F+(V^A&(C^V))+M[9]+2336552879&4294967295,F=A+(D<<12&4294967295|D>>>20),D=V+(C^F&(A^C))+M[10]+4294925233&4294967295,V=F+(D<<17&4294967295|D>>>15),D=C+(A^V&(F^A))+M[11]+2304563134&4294967295,C=V+(D<<22&4294967295|D>>>10),D=A+(F^C&(V^F))+M[12]+1804603682&4294967295,A=C+(D<<7&4294967295|D>>>25),D=F+(V^A&(C^V))+M[13]+4254626195&4294967295,F=A+(D<<12&4294967295|D>>>20),D=V+(C^F&(A^C))+M[14]+2792965006&4294967295,V=F+(D<<17&4294967295|D>>>15),D=C+(A^V&(F^A))+M[15]+1236535329&4294967295,C=V+(D<<22&4294967295|D>>>10),D=A+(V^F&(C^V))+M[1]+4129170786&4294967295,A=C+(D<<5&4294967295|D>>>27),D=F+(C^V&(A^C))+M[6]+3225465664&4294967295,F=A+(D<<9&4294967295|D>>>23),D=V+(A^C&(F^A))+M[11]+643717713&4294967295,V=F+(D<<14&4294967295|D>>>18),D=C+(F^A&(V^F))+M[0]+3921069994&4294967295,C=V+(D<<20&4294967295|D>>>12),D=A+(V^F&(C^V))+M[5]+3593408605&4294967295,A=C+(D<<5&4294967295|D>>>27),D=F+(C^V&(A^C))+M[10]+38016083&4294967295,F=A+(D<<9&4294967295|D>>>23),D=V+(A^C&(F^A))+M[15]+3634488961&4294967295,V=F+(D<<14&4294967295|D>>>18),D=C+(F^A&(V^F))+M[4]+3889429448&4294967295,C=V+(D<<20&4294967295|D>>>12),D=A+(V^F&(C^V))+M[9]+568446438&4294967295,A=C+(D<<5&4294967295|D>>>27),D=F+(C^V&(A^C))+M[14]+3275163606&4294967295,F=A+(D<<9&4294967295|D>>>23),D=V+(A^C&(F^A))+M[3]+4107603335&4294967295,V=F+(D<<14&4294967295|D>>>18),D=C+(F^A&(V^F))+M[8]+1163531501&4294967295,C=V+(D<<20&4294967295|D>>>12),D=A+(V^F&(C^V))+M[13]+2850285829&4294967295,A=C+(D<<5&4294967295|D>>>27),D=F+(C^V&(A^C))+M[2]+4243563512&4294967295,F=A+(D<<9&4294967295|D>>>23),D=V+(A^C&(F^A))+M[7]+1735328473&4294967295,V=F+(D<<14&4294967295|D>>>18),D=C+(F^A&(V^F))+M[12]+2368359562&4294967295,C=V+(D<<20&4294967295|D>>>12),D=A+(C^V^F)+M[5]+4294588738&4294967295,A=C+(D<<4&4294967295|D>>>28),D=F+(A^C^V)+M[8]+2272392833&4294967295,F=A+(D<<11&4294967295|D>>>21),D=V+(F^A^C)+M[11]+1839030562&4294967295,V=F+(D<<16&4294967295|D>>>16),D=C+(V^F^A)+M[14]+4259657740&4294967295,C=V+(D<<23&4294967295|D>>>9),D=A+(C^V^F)+M[1]+2763975236&4294967295,A=C+(D<<4&4294967295|D>>>28),D=F+(A^C^V)+M[4]+1272893353&4294967295,F=A+(D<<11&4294967295|D>>>21),D=V+(F^A^C)+M[7]+4139469664&4294967295,V=F+(D<<16&4294967295|D>>>16),D=C+(V^F^A)+M[10]+3200236656&4294967295,C=V+(D<<23&4294967295|D>>>9),D=A+(C^V^F)+M[13]+681279174&4294967295,A=C+(D<<4&4294967295|D>>>28),D=F+(A^C^V)+M[0]+3936430074&4294967295,F=A+(D<<11&4294967295|D>>>21),D=V+(F^A^C)+M[3]+3572445317&4294967295,V=F+(D<<16&4294967295|D>>>16),D=C+(V^F^A)+M[6]+76029189&4294967295,C=V+(D<<23&4294967295|D>>>9),D=A+(C^V^F)+M[9]+3654602809&4294967295,A=C+(D<<4&4294967295|D>>>28),D=F+(A^C^V)+M[12]+3873151461&4294967295,F=A+(D<<11&4294967295|D>>>21),D=V+(F^A^C)+M[15]+530742520&4294967295,V=F+(D<<16&4294967295|D>>>16),D=C+(V^F^A)+M[2]+3299628645&4294967295,C=V+(D<<23&4294967295|D>>>9),D=A+(V^(C|~F))+M[0]+4096336452&4294967295,A=C+(D<<6&4294967295|D>>>26),D=F+(C^(A|~V))+M[7]+1126891415&4294967295,F=A+(D<<10&4294967295|D>>>22),D=V+(A^(F|~C))+M[14]+2878612391&4294967295,V=F+(D<<15&4294967295|D>>>17),D=C+(F^(V|~A))+M[5]+4237533241&4294967295,C=V+(D<<21&4294967295|D>>>11),D=A+(V^(C|~F))+M[12]+1700485571&4294967295,A=C+(D<<6&4294967295|D>>>26),D=F+(C^(A|~V))+M[3]+2399980690&4294967295,F=A+(D<<10&4294967295|D>>>22),D=V+(A^(F|~C))+M[10]+4293915773&4294967295,V=F+(D<<15&4294967295|D>>>17),D=C+(F^(V|~A))+M[1]+2240044497&4294967295,C=V+(D<<21&4294967295|D>>>11),D=A+(V^(C|~F))+M[8]+1873313359&4294967295,A=C+(D<<6&4294967295|D>>>26),D=F+(C^(A|~V))+M[15]+4264355552&4294967295,F=A+(D<<10&4294967295|D>>>22),D=V+(A^(F|~C))+M[6]+2734768916&4294967295,V=F+(D<<15&4294967295|D>>>17),D=C+(F^(V|~A))+M[13]+1309151649&4294967295,C=V+(D<<21&4294967295|D>>>11),D=A+(V^(C|~F))+M[4]+4149444226&4294967295,A=C+(D<<6&4294967295|D>>>26),D=F+(C^(A|~V))+M[11]+3174756917&4294967295,F=A+(D<<10&4294967295|D>>>22),D=V+(A^(F|~C))+M[2]+718787259&4294967295,V=F+(D<<15&4294967295|D>>>17),D=C+(F^(V|~A))+M[9]+3951481745&4294967295,O.g[0]=O.g[0]+A&4294967295,O.g[1]=O.g[1]+(V+(D<<21&4294967295|D>>>11))&4294967295,O.g[2]=O.g[2]+V&4294967295,O.g[3]=O.g[3]+F&4294967295}i.prototype.u=function(O,A){A===void 0&&(A=O.length);for(var C=A-this.blockSize,M=this.B,V=this.h,F=0;F<A;){if(V==0)for(;F<=C;)s(this,O,F),F+=this.blockSize;if(typeof O=="string"){for(;F<A;)if(M[V++]=O.charCodeAt(F++),V==this.blockSize){s(this,M),V=0;break}}else for(;F<A;)if(M[V++]=O[F++],V==this.blockSize){s(this,M),V=0;break}}this.h=V,this.o+=A},i.prototype.v=function(){var O=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);O[0]=128;for(var A=1;A<O.length-8;++A)O[A]=0;var C=8*this.o;for(A=O.length-8;A<O.length;++A)O[A]=C&255,C/=256;for(this.u(O),O=Array(16),A=C=0;4>A;++A)for(var M=0;32>M;M+=8)O[C++]=this.g[A]>>>M&255;return O};function o(O,A){var C=h;return Object.prototype.hasOwnProperty.call(C,O)?C[O]:C[O]=A(O)}function u(O,A){this.h=A;for(var C=[],M=!0,V=O.length-1;0<=V;V--){var F=O[V]|0;M&&F==A||(C[V]=F,M=!1)}this.g=C}var h={};function f(O){return-128<=O&&128>O?o(O,function(A){return new u([A|0],0>A?-1:0)}):new u([O|0],0>O?-1:0)}function p(O){if(isNaN(O)||!isFinite(O))return v;if(0>O)return U(p(-O));for(var A=[],C=1,M=0;O>=C;M++)A[M]=O/C|0,C*=4294967296;return new u(A,0)}function _(O,A){if(O.length==0)throw Error("number format error: empty string");if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(O.charAt(0)=="-")return U(_(O.substring(1),A));if(0<=O.indexOf("-"))throw Error('number format error: interior "-" character');for(var C=p(Math.pow(A,8)),M=v,V=0;V<O.length;V+=8){var F=Math.min(8,O.length-V),D=parseInt(O.substring(V,V+F),A);8>F?(F=p(Math.pow(A,F)),M=M.j(F).add(p(D))):(M=M.j(C),M=M.add(p(D)))}return M}var v=f(0),T=f(1),S=f(16777216);n=u.prototype,n.m=function(){if(x(this))return-U(this).m();for(var O=0,A=1,C=0;C<this.g.length;C++){var M=this.i(C);O+=(0<=M?M:4294967296+M)*A,A*=4294967296}return O},n.toString=function(O){if(O=O||10,2>O||36<O)throw Error("radix out of range: "+O);if(N(this))return"0";if(x(this))return"-"+U(this).toString(O);for(var A=p(Math.pow(O,6)),C=this,M="";;){var V=ie(C,A).g;C=Z(C,V.j(A));var F=((0<C.g.length?C.g[0]:C.h)>>>0).toString(O);if(C=V,N(C))return F+M;for(;6>F.length;)F="0"+F;M=F+M}},n.i=function(O){return 0>O?0:O<this.g.length?this.g[O]:this.h};function N(O){if(O.h!=0)return!1;for(var A=0;A<O.g.length;A++)if(O.g[A]!=0)return!1;return!0}function x(O){return O.h==-1}n.l=function(O){return O=Z(this,O),x(O)?-1:N(O)?0:1};function U(O){for(var A=O.g.length,C=[],M=0;M<A;M++)C[M]=~O.g[M];return new u(C,~O.h).add(T)}n.abs=function(){return x(this)?U(this):this},n.add=function(O){for(var A=Math.max(this.g.length,O.g.length),C=[],M=0,V=0;V<=A;V++){var F=M+(this.i(V)&65535)+(O.i(V)&65535),D=(F>>>16)+(this.i(V)>>>16)+(O.i(V)>>>16);M=D>>>16,F&=65535,D&=65535,C[V]=D<<16|F}return new u(C,C[C.length-1]&-2147483648?-1:0)};function Z(O,A){return O.add(U(A))}n.j=function(O){if(N(this)||N(O))return v;if(x(this))return x(O)?U(this).j(U(O)):U(U(this).j(O));if(x(O))return U(this.j(U(O)));if(0>this.l(S)&&0>O.l(S))return p(this.m()*O.m());for(var A=this.g.length+O.g.length,C=[],M=0;M<2*A;M++)C[M]=0;for(M=0;M<this.g.length;M++)for(var V=0;V<O.g.length;V++){var F=this.i(M)>>>16,D=this.i(M)&65535,an=O.i(V)>>>16,St=O.i(V)&65535;C[2*M+2*V]+=D*St,ee(C,2*M+2*V),C[2*M+2*V+1]+=F*St,ee(C,2*M+2*V+1),C[2*M+2*V+1]+=D*an,ee(C,2*M+2*V+1),C[2*M+2*V+2]+=F*an,ee(C,2*M+2*V+2)}for(M=0;M<A;M++)C[M]=C[2*M+1]<<16|C[2*M];for(M=A;M<2*A;M++)C[M]=0;return new u(C,0)};function ee(O,A){for(;(O[A]&65535)!=O[A];)O[A+1]+=O[A]>>>16,O[A]&=65535,A++}function Y(O,A){this.g=O,this.h=A}function ie(O,A){if(N(A))throw Error("division by zero");if(N(O))return new Y(v,v);if(x(O))return A=ie(U(O),A),new Y(U(A.g),U(A.h));if(x(A))return A=ie(O,U(A)),new Y(U(A.g),A.h);if(30<O.g.length){if(x(O)||x(A))throw Error("slowDivide_ only works with positive integers.");for(var C=T,M=A;0>=M.l(O);)C=se(C),M=se(M);var V=me(C,1),F=me(M,1);for(M=me(M,2),C=me(C,2);!N(M);){var D=F.add(M);0>=D.l(O)&&(V=V.add(C),F=D),M=me(M,1),C=me(C,1)}return A=Z(O,V.j(A)),new Y(V,A)}for(V=v;0<=O.l(A);){for(C=Math.max(1,Math.floor(O.m()/A.m())),M=Math.ceil(Math.log(C)/Math.LN2),M=48>=M?1:Math.pow(2,M-48),F=p(C),D=F.j(A);x(D)||0<D.l(O);)C-=M,F=p(C),D=F.j(A);N(F)&&(F=T),V=V.add(F),O=Z(O,D)}return new Y(V,O)}n.A=function(O){return ie(this,O).h},n.and=function(O){for(var A=Math.max(this.g.length,O.g.length),C=[],M=0;M<A;M++)C[M]=this.i(M)&O.i(M);return new u(C,this.h&O.h)},n.or=function(O){for(var A=Math.max(this.g.length,O.g.length),C=[],M=0;M<A;M++)C[M]=this.i(M)|O.i(M);return new u(C,this.h|O.h)},n.xor=function(O){for(var A=Math.max(this.g.length,O.g.length),C=[],M=0;M<A;M++)C[M]=this.i(M)^O.i(M);return new u(C,this.h^O.h)};function se(O){for(var A=O.g.length+1,C=[],M=0;M<A;M++)C[M]=O.i(M)<<1|O.i(M-1)>>>31;return new u(C,O.h)}function me(O,A){var C=A>>5;A%=32;for(var M=O.g.length-C,V=[],F=0;F<M;F++)V[F]=0<A?O.i(F+C)>>>A|O.i(F+C+1)<<32-A:O.i(F+C);return new u(V,O.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,TD=i,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.A,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=p,u.fromString=_,Ws=u}).apply(typeof ZS<"u"?ZS:typeof self<"u"?self:typeof window<"u"?window:{});var am=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var wD,dh,bD,wm,Ov,ID,SD,AD;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(d,y,E){return d==Array.prototype||d==Object.prototype||(d[y]=E.value),d};function t(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof am=="object"&&am];for(var y=0;y<d.length;++y){var E=d[y];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var i=t(this);function s(d,y){if(y)e:{var E=i;d=d.split(".");for(var I=0;I<d.length-1;I++){var B=d[I];if(!(B in E))break e;E=E[B]}d=d[d.length-1],I=E[d],y=y(I),y!=I&&y!=null&&e(E,d,{configurable:!0,writable:!0,value:y})}}function o(d,y){d instanceof String&&(d+="");var E=0,I=!1,B={next:function(){if(!I&&E<d.length){var K=E++;return{value:y(K,d[K]),done:!1}}return I=!0,{done:!0,value:void 0}}};return B[Symbol.iterator]=function(){return B},B}s("Array.prototype.values",function(d){return d||function(){return o(this,function(y,E){return E})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var u=u||{},h=this||self;function f(d){var y=typeof d;return y=y!="object"?y:d?Array.isArray(d)?"array":y:"null",y=="array"||y=="object"&&typeof d.length=="number"}function p(d){var y=typeof d;return y=="object"&&d!=null||y=="function"}function _(d,y,E){return d.call.apply(d.bind,arguments)}function v(d,y,E){if(!d)throw Error();if(2<arguments.length){var I=Array.prototype.slice.call(arguments,2);return function(){var B=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(B,I),d.apply(y,B)}}return function(){return d.apply(y,arguments)}}function T(d,y,E){return T=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?_:v,T.apply(null,arguments)}function S(d,y){var E=Array.prototype.slice.call(arguments,1);return function(){var I=E.slice();return I.push.apply(I,arguments),d.apply(this,I)}}function N(d,y){function E(){}E.prototype=y.prototype,d.aa=y.prototype,d.prototype=new E,d.prototype.constructor=d,d.Qb=function(I,B,K){for(var oe=Array(arguments.length-2),qe=2;qe<arguments.length;qe++)oe[qe-2]=arguments[qe];return y.prototype[B].apply(I,oe)}}function x(d){const y=d.length;if(0<y){const E=Array(y);for(let I=0;I<y;I++)E[I]=d[I];return E}return[]}function U(d,y){for(let E=1;E<arguments.length;E++){const I=arguments[E];if(f(I)){const B=d.length||0,K=I.length||0;d.length=B+K;for(let oe=0;oe<K;oe++)d[B+oe]=I[oe]}else d.push(I)}}class Z{constructor(y,E){this.i=y,this.j=E,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function ee(d){return/^[\s\xa0]*$/.test(d)}function Y(){var d=h.navigator;return d&&(d=d.userAgent)?d:""}function ie(d){return ie[" "](d),d}ie[" "]=function(){};var se=Y().indexOf("Gecko")!=-1&&!(Y().toLowerCase().indexOf("webkit")!=-1&&Y().indexOf("Edge")==-1)&&!(Y().indexOf("Trident")!=-1||Y().indexOf("MSIE")!=-1)&&Y().indexOf("Edge")==-1;function me(d,y,E){for(const I in d)y.call(E,d[I],I,d)}function O(d,y){for(const E in d)y.call(void 0,d[E],E,d)}function A(d){const y={};for(const E in d)y[E]=d[E];return y}const C="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function M(d,y){let E,I;for(let B=1;B<arguments.length;B++){I=arguments[B];for(E in I)d[E]=I[E];for(let K=0;K<C.length;K++)E=C[K],Object.prototype.hasOwnProperty.call(I,E)&&(d[E]=I[E])}}function V(d){var y=1;d=d.split(":");const E=[];for(;0<y&&d.length;)E.push(d.shift()),y--;return d.length&&E.push(d.join(":")),E}function F(d){h.setTimeout(()=>{throw d},0)}function D(){var d=We;let y=null;return d.g&&(y=d.g,d.g=d.g.next,d.g||(d.h=null),y.next=null),y}class an{constructor(){this.h=this.g=null}add(y,E){const I=St.get();I.set(y,E),this.h?this.h.next=I:this.g=I,this.h=I}}var St=new Z(()=>new W,d=>d.reset());class W{constructor(){this.next=this.g=this.h=null}set(y,E){this.h=y,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let ce,ve=!1,We=new an,P=()=>{const d=h.Promise.resolve(void 0);ce=()=>{d.then(te)}};var te=()=>{for(var d;d=D();){try{d.h.call(d.g)}catch(E){F(E)}var y=St;y.j(d),100>y.h&&(y.h++,d.next=y.g,y.g=d)}ve=!1};function he(){this.s=this.s,this.C=this.C}he.prototype.s=!1,he.prototype.ma=function(){this.s||(this.s=!0,this.N())},he.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function re(d,y){this.type=d,this.g=this.target=y,this.defaultPrevented=!1}re.prototype.h=function(){this.defaultPrevented=!0};var Te=function(){if(!h.addEventListener||!Object.defineProperty)return!1;var d=!1,y=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const E=()=>{};h.addEventListener("test",E,y),h.removeEventListener("test",E,y)}catch{}return d}();function ke(d,y){if(re.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d){var E=this.type=d.type,I=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;if(this.target=d.target||d.srcElement,this.g=y,y=d.relatedTarget){if(se){e:{try{ie(y.nodeName);var B=!0;break e}catch{}B=!1}B||(y=null)}}else E=="mouseover"?y=d.fromElement:E=="mouseout"&&(y=d.toElement);this.relatedTarget=y,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=typeof d.pointerType=="string"?d.pointerType:Ce[d.pointerType]||"",this.state=d.state,this.i=d,d.defaultPrevented&&ke.aa.h.call(this)}}N(ke,re);var Ce={2:"touch",3:"pen",4:"mouse"};ke.prototype.h=function(){ke.aa.h.call(this);var d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var Xt="closure_listenable_"+(1e6*Math.random()|0),dt=0;function Ui(d,y,E,I,B){this.listener=d,this.proxy=null,this.src=y,this.type=E,this.capture=!!I,this.ha=B,this.key=++dt,this.da=this.fa=!1}function ss(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function dr(d){this.src=d,this.g={},this.h=0}dr.prototype.add=function(d,y,E,I,B){var K=d.toString();d=this.g[K],d||(d=this.g[K]=[],this.h++);var oe=pa(d,y,I,B);return-1<oe?(y=d[oe],E||(y.fa=!1)):(y=new Ui(y,this.src,K,!!I,B),y.fa=E,d.push(y)),y};function ma(d,y){var E=y.type;if(E in d.g){var I=d.g[E],B=Array.prototype.indexOf.call(I,y,void 0),K;(K=0<=B)&&Array.prototype.splice.call(I,B,1),K&&(ss(y),d.g[E].length==0&&(delete d.g[E],d.h--))}}function pa(d,y,E,I){for(var B=0;B<d.length;++B){var K=d[B];if(!K.da&&K.listener==y&&K.capture==!!E&&K.ha==I)return B}return-1}var ga="closure_lm_"+(1e6*Math.random()|0),zu={};function xd(d,y,E,I,B){if(Array.isArray(y)){for(var K=0;K<y.length;K++)xd(d,y[K],E,I,B);return null}return E=Pd(E),d&&d[Xt]?d.K(y,E,p(I)?!!I.capture:!1,B):ai(d,y,E,!1,I,B)}function ai(d,y,E,I,B,K){if(!y)throw Error("Invalid event type");var oe=p(B)?!!B.capture:!!B,qe=Fo(d);if(qe||(d[ga]=qe=new dr(d)),E=qe.add(y,E,I,oe,K),E.proxy)return E;if(I=Sg(),E.proxy=I,I.src=d,I.listener=E,d.addEventListener)Te||(B=oe),B===void 0&&(B=!1),d.addEventListener(y.toString(),I,B);else if(d.attachEvent)d.attachEvent(_a(y.toString()),I);else if(d.addListener&&d.removeListener)d.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return E}function Sg(){function d(E){return y.call(d.src,d.listener,E)}const y=Ag;return d}function qu(d,y,E,I,B){if(Array.isArray(y))for(var K=0;K<y.length;K++)qu(d,y[K],E,I,B);else I=p(I)?!!I.capture:!!I,E=Pd(E),d&&d[Xt]?(d=d.i,y=String(y).toString(),y in d.g&&(K=d.g[y],E=pa(K,E,I,B),-1<E&&(ss(K[E]),Array.prototype.splice.call(K,E,1),K.length==0&&(delete d.g[y],d.h--)))):d&&(d=Fo(d))&&(y=d.g[y.toString()],d=-1,y&&(d=pa(y,E,I,B)),(E=-1<d?y[d]:null)&&Uo(E))}function Uo(d){if(typeof d!="number"&&d&&!d.da){var y=d.src;if(y&&y[Xt])ma(y.i,d);else{var E=d.type,I=d.proxy;y.removeEventListener?y.removeEventListener(E,I,d.capture):y.detachEvent?y.detachEvent(_a(E),I):y.addListener&&y.removeListener&&y.removeListener(I),(E=Fo(y))?(ma(E,d),E.h==0&&(E.src=null,y[ga]=null)):ss(d)}}}function _a(d){return d in zu?zu[d]:zu[d]="on"+d}function Ag(d,y){if(d.da)d=!0;else{y=new ke(y,this);var E=d.listener,I=d.ha||d.src;d.fa&&Uo(d),d=E.call(I,y)}return d}function Fo(d){return d=d[ga],d instanceof dr?d:null}var ju="__closure_events_fn_"+(1e9*Math.random()>>>0);function Pd(d){return typeof d=="function"?d:(d[ju]||(d[ju]=function(y){return d.handleEvent(y)}),d[ju])}function At(){he.call(this),this.i=new dr(this),this.M=this,this.F=null}N(At,he),At.prototype[Xt]=!0,At.prototype.removeEventListener=function(d,y,E,I){qu(this,d,y,E,I)};function Ze(d,y){var E,I=d.F;if(I)for(E=[];I;I=I.F)E.push(I);if(d=d.M,I=y.type||y,typeof y=="string")y=new re(y,d);else if(y instanceof re)y.target=y.target||d;else{var B=y;y=new re(I,d),M(y,B)}if(B=!0,E)for(var K=E.length-1;0<=K;K--){var oe=y.g=E[K];B=jn(oe,I,!0,y)&&B}if(oe=y.g=d,B=jn(oe,I,!0,y)&&B,B=jn(oe,I,!1,y)&&B,E)for(K=0;K<E.length;K++)oe=y.g=E[K],B=jn(oe,I,!1,y)&&B}At.prototype.N=function(){if(At.aa.N.call(this),this.i){var d=this.i,y;for(y in d.g){for(var E=d.g[y],I=0;I<E.length;I++)ss(E[I]);delete d.g[y],d.h--}}this.F=null},At.prototype.K=function(d,y,E,I){return this.i.add(String(d),y,!1,E,I)},At.prototype.L=function(d,y,E,I){return this.i.add(String(d),y,!0,E,I)};function jn(d,y,E,I){if(y=d.i.g[String(y)],!y)return!0;y=y.concat();for(var B=!0,K=0;K<y.length;++K){var oe=y[K];if(oe&&!oe.da&&oe.capture==E){var qe=oe.listener,jt=oe.ha||oe.src;oe.fa&&ma(d.i,oe),B=qe.call(jt,I)!==!1&&B}}return B&&!I.defaultPrevented}function mn(d,y,E){if(typeof d=="function")E&&(d=T(d,E));else if(d&&typeof d.handleEvent=="function")d=T(d.handleEvent,d);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:h.setTimeout(d,y||0)}function kd(d){d.g=mn(()=>{d.g=null,d.i&&(d.i=!1,kd(d))},d.l);const y=d.h;d.h=null,d.m.apply(null,y)}class Rg extends he{constructor(y,E){super(),this.m=y,this.l=E,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:kd(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ya(d){he.call(this),this.h=d,this.g={}}N(ya,he);var va=[];function Ea(d){me(d.g,function(y,E){this.g.hasOwnProperty(E)&&Uo(y)},d),d.g={}}ya.prototype.N=function(){ya.aa.N.call(this),Ea(this)},ya.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ai=h.JSON.stringify,Bo=h.JSON.parse,Ta=class{stringify(d){return h.JSON.stringify(d,void 0)}parse(d){return h.JSON.parse(d,void 0)}};function Hu(){}Hu.prototype.h=null;function Gu(d){return d.h||(d.h=d.i())}function Ku(){}var fr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function mr(){re.call(this,"d")}N(mr,re);function Yu(){re.call(this,"c")}N(Yu,re);var Fi={},Qu=null;function as(){return Qu=Qu||new At}Fi.La="serverreachability";function zo(d){re.call(this,Fi.La,d)}N(zo,re);function os(d){const y=as();Ze(y,new zo(y))}Fi.STAT_EVENT="statevent";function Md(d,y){re.call(this,Fi.STAT_EVENT,d),this.stat=y}N(Md,re);function _t(d){const y=as();Ze(y,new Md(y,d))}Fi.Ma="timingevent";function qt(d,y){re.call(this,Fi.Ma,d),this.size=y}N(qt,re);function Lt(d,y){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return h.setTimeout(function(){d()},y)}function oi(){this.g=!0}oi.prototype.xa=function(){this.g=!1};function Wu(d,y,E,I,B,K){d.info(function(){if(d.g)if(K)for(var oe="",qe=K.split("&"),jt=0;jt<qe.length;jt++){var je=qe[jt].split("=");if(1<je.length){var Zt=je[0];je=je[1];var Ht=Zt.split("_");oe=2<=Ht.length&&Ht[1]=="type"?oe+(Zt+"="+je+"&"):oe+(Zt+"=redacted&")}}else oe=null;else oe=K;return"XMLHTTP REQ ("+I+") [attempt "+B+"]: "+y+`
`+E+`
`+oe})}function Cg(d,y,E,I,B,K,oe){d.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+B+"]: "+y+`
`+E+`
`+K+" "+oe})}function ls(d,y,E,I){d.info(function(){return"XMLHTTP TEXT ("+y+"): "+wa(d,E)+(I?" "+I:"")})}function Vd(d,y){d.info(function(){return"TIMEOUT: "+y})}oi.prototype.info=function(){};function wa(d,y){if(!d.g)return y;if(!y)return null;try{var E=JSON.parse(y);if(E){for(d=0;d<E.length;d++)if(Array.isArray(E[d])){var I=E[d];if(!(2>I.length)){var B=I[1];if(Array.isArray(B)&&!(1>B.length)){var K=B[0];if(K!="noop"&&K!="stop"&&K!="close")for(var oe=1;oe<B.length;oe++)B[oe]=""}}}}return Ai(E)}catch{return y}}var us={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},pr={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Bi;function zi(){}N(zi,Hu),zi.prototype.g=function(){return new XMLHttpRequest},zi.prototype.i=function(){return{}},Bi=new zi;function Sn(d,y,E,I){this.j=d,this.i=y,this.l=E,this.R=I||1,this.U=new ya(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Nt}function Nt(){this.i=null,this.g="",this.h=!1}var $u={},qo={};function Ri(d,y,E){d.L=1,d.v=Ra(Hn(y)),d.m=E,d.P=!0,gr(d,null)}function gr(d,y){d.F=Date.now(),ba(d),d.A=Hn(d.v);var E=d.A,I=d.R;Array.isArray(I)||(I=[String(I)]),nc(E.i,"t",I),d.C=0,E=d.j.J,d.h=new Nt,d.g=Jd(d.j,E?y:null,!d.m),0<d.O&&(d.M=new Rg(T(d.Y,d,d.g),d.O)),y=d.U,E=d.g,I=d.ca;var B="readystatechange";Array.isArray(B)||(B&&(va[0]=B.toString()),B=va);for(var K=0;K<B.length;K++){var oe=xd(E,B[K],I||y.handleEvent,!1,y.h||y);if(!oe)break;y.g[oe.key]=oe}y=d.H?A(d.H):{},d.m?(d.u||(d.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.A,d.u,d.m,y)):(d.u="GET",d.g.ea(d.A,d.u,null,y)),os(),Wu(d.i,d.u,d.A,d.l,d.R,d.m)}Sn.prototype.ca=function(d){d=d.target;const y=this.M;y&&hi(d)==3?y.j():this.Y(d)},Sn.prototype.Y=function(d){try{if(d==this.g)e:{const Ht=hi(this.g);var y=this.g.Ba();const Ir=this.g.Z();if(!(3>Ht)&&(Ht!=3||this.g&&(this.h.h||this.g.oa()||Hd(this.g)))){this.J||Ht!=4||y==7||(y==8||0>=Ir?os(3):os(2)),cs(this);var E=this.g.Z();this.X=E;t:if(Ld(this)){var I=Hd(this.g);d="";var B=I.length,K=hi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){on(this),qi(this);var oe="";break t}this.h.i=new h.TextDecoder}for(y=0;y<B;y++)this.h.h=!0,d+=this.h.i.decode(I[y],{stream:!(K&&y==B-1)});I.length=0,this.h.g+=d,this.C=0,oe=this.h.g}else oe=this.g.oa();if(this.o=E==200,Cg(this.i,this.u,this.A,this.l,this.R,Ht,E),this.o){if(this.T&&!this.K){t:{if(this.g){var qe,jt=this.g;if((qe=jt.g?jt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ee(qe)){var je=qe;break t}}je=null}if(E=je)ls(this.i,this.l,E,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ia(this,E);else{this.o=!1,this.s=3,_t(12),on(this),qi(this);break e}}if(this.P){E=!0;let ln;for(;!this.J&&this.C<oe.length;)if(ln=Ud(this,oe),ln==qo){Ht==4&&(this.s=4,_t(14),E=!1),ls(this.i,this.l,null,"[Incomplete Response]");break}else if(ln==$u){this.s=4,_t(15),ls(this.i,this.l,oe,"[Invalid Chunk]"),E=!1;break}else ls(this.i,this.l,ln,null),Ia(this,ln);if(Ld(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ht!=4||oe.length!=0||this.h.h||(this.s=1,_t(16),E=!1),this.o=this.o&&E,!E)ls(this.i,this.l,oe,"[Invalid Chunked Response]"),on(this),qi(this);else if(0<oe.length&&!this.W){this.W=!0;var Zt=this.j;Zt.g==this&&Zt.ba&&!Zt.M&&(Zt.j.info("Great, no buffering proxy detected. Bytes received: "+oe.length),Ma(Zt),Zt.M=!0,_t(11))}}else ls(this.i,this.l,oe,null),Ia(this,oe);Ht==4&&on(this),this.o&&!this.J&&(Ht==4?Wd(this.j,this):(this.o=!1,ba(this)))}else Pg(this.g),E==400&&0<oe.indexOf("Unknown SID")?(this.s=3,_t(12)):(this.s=0,_t(13)),on(this),qi(this)}}}catch{}finally{}};function Ld(d){return d.g?d.u=="GET"&&d.L!=2&&d.j.Ca:!1}function Ud(d,y){var E=d.C,I=y.indexOf(`
`,E);return I==-1?qo:(E=Number(y.substring(E,I)),isNaN(E)?$u:(I+=1,I+E>y.length?qo:(y=y.slice(I,I+E),d.C=I+E,y)))}Sn.prototype.cancel=function(){this.J=!0,on(this)};function ba(d){d.S=Date.now()+d.I,Fd(d,d.I)}function Fd(d,y){if(d.B!=null)throw Error("WatchDog timer not null");d.B=Lt(T(d.ba,d),y)}function cs(d){d.B&&(h.clearTimeout(d.B),d.B=null)}Sn.prototype.ba=function(){this.B=null;const d=Date.now();0<=d-this.S?(Vd(this.i,this.A),this.L!=2&&(os(),_t(17)),on(this),this.s=2,qi(this)):Fd(this,this.S-d)};function qi(d){d.j.G==0||d.J||Wd(d.j,d)}function on(d){cs(d);var y=d.M;y&&typeof y.ma=="function"&&y.ma(),d.M=null,Ea(d.U),d.g&&(y=d.g,d.g=null,y.abort(),y.ma())}function Ia(d,y){try{var E=d.j;if(E.G!=0&&(E.g==d||Xu(E.h,d))){if(!d.K&&Xu(E.h,d)&&E.G==3){try{var I=E.Da.g.parse(y)}catch{I=null}if(Array.isArray(I)&&I.length==3){var B=I;if(B[0]==0){e:if(!E.u){if(E.g)if(E.g.F+3e3<d.F)el(E),Jo(E);else break e;oc(E),_t(18)}}else E.za=B[1],0<E.za-E.T&&37500>B[2]&&E.F&&E.v==0&&!E.C&&(E.C=Lt(T(E.Za,E),6e3));if(1>=Ho(E.h)&&E.ca){try{E.ca()}catch{}E.ca=void 0}}else br(E,11)}else if((d.K||E.g==d)&&el(E),!ee(y))for(B=E.Da.g.parse(y),y=0;y<B.length;y++){let je=B[y];if(E.T=je[0],je=je[1],E.G==2)if(je[0]=="c"){E.K=je[1],E.ia=je[2];const Zt=je[3];Zt!=null&&(E.la=Zt,E.j.info("VER="+E.la));const Ht=je[4];Ht!=null&&(E.Aa=Ht,E.j.info("SVER="+E.Aa));const Ir=je[5];Ir!=null&&typeof Ir=="number"&&0<Ir&&(I=1.5*Ir,E.L=I,E.j.info("backChannelRequestTimeoutMs_="+I)),I=E;const ln=d.g;if(ln){const Wi=ln.g?ln.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Wi){var K=I.h;K.g||Wi.indexOf("spdy")==-1&&Wi.indexOf("quic")==-1&&Wi.indexOf("h2")==-1||(K.j=K.l,K.g=new Set,K.h&&(Go(K,K.h),K.h=null))}if(I.D){const uc=ln.g?ln.g.getResponseHeader("X-HTTP-Session-Id"):null;uc&&(I.ya=uc,at(I.I,I.D,uc))}}E.G=3,E.l&&E.l.ua(),E.ba&&(E.R=Date.now()-d.F,E.j.info("Handshake RTT: "+E.R+"ms")),I=E;var oe=d;if(I.qa=Xd(I,I.J?I.ia:null,I.W),oe.K){An(I.h,oe);var qe=oe,jt=I.L;jt&&(qe.I=jt),qe.B&&(cs(qe),ba(qe)),I.g=oe}else Yd(I);0<E.i.length&&Zo(E)}else je[0]!="stop"&&je[0]!="close"||br(E,7);else E.G==3&&(je[0]=="stop"||je[0]=="close"?je[0]=="stop"?br(E,7):sc(E):je[0]!="noop"&&E.l&&E.l.ta(je),E.v=0)}}os(4)}catch{}}var Bd=class{constructor(d,y){this.g=d,this.map=y}};function _r(d){this.l=d||10,h.PerformanceNavigationTiming?(d=h.performance.getEntriesByType("navigation"),d=0<d.length&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(h.chrome&&h.chrome.loadTimes&&h.chrome.loadTimes()&&h.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function jo(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function Ho(d){return d.h?1:d.g?d.g.size:0}function Xu(d,y){return d.h?d.h==y:d.g?d.g.has(y):!1}function Go(d,y){d.g?d.g.add(y):d.h=y}function An(d,y){d.h&&d.h==y?d.h=null:d.g&&d.g.has(y)&&d.g.delete(y)}_r.prototype.cancel=function(){if(this.i=Ju(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function Ju(d){if(d.h!=null)return d.i.concat(d.h.D);if(d.g!=null&&d.g.size!==0){let y=d.i;for(const E of d.g.values())y=y.concat(E.D);return y}return x(d.i)}function Dg(d){if(d.V&&typeof d.V=="function")return d.V();if(typeof Map<"u"&&d instanceof Map||typeof Set<"u"&&d instanceof Set)return Array.from(d.values());if(typeof d=="string")return d.split("");if(f(d)){for(var y=[],E=d.length,I=0;I<E;I++)y.push(d[I]);return y}y=[],E=0;for(I in d)y[E++]=d[I];return y}function Ko(d){if(d.na&&typeof d.na=="function")return d.na();if(!d.V||typeof d.V!="function"){if(typeof Map<"u"&&d instanceof Map)return Array.from(d.keys());if(!(typeof Set<"u"&&d instanceof Set)){if(f(d)||typeof d=="string"){var y=[];d=d.length;for(var E=0;E<d;E++)y.push(E);return y}y=[],E=0;for(const I in d)y[E++]=I;return y}}}function Zu(d,y){if(d.forEach&&typeof d.forEach=="function")d.forEach(y,void 0);else if(f(d)||typeof d=="string")Array.prototype.forEach.call(d,y,void 0);else for(var E=Ko(d),I=Dg(d),B=I.length,K=0;K<B;K++)y.call(void 0,I[K],E&&E[K],d)}var Sa=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ng(d,y){if(d){d=d.split("&");for(var E=0;E<d.length;E++){var I=d[E].indexOf("="),B=null;if(0<=I){var K=d[E].substring(0,I);B=d[E].substring(I+1)}else K=d[E];y(K,B?decodeURIComponent(B.replace(/\+/g," ")):"")}}}function Ut(d){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,d instanceof Ut){this.h=d.h,Aa(this,d.j),this.o=d.o,this.g=d.g,hs(this,d.s),this.l=d.l;var y=d.i,E=new vr;E.i=y.i,y.g&&(E.g=new Map(y.g),E.h=y.h),yr(this,E),this.m=d.m}else d&&(y=String(d).match(Sa))?(this.h=!1,Aa(this,y[1]||"",!0),this.o=li(y[2]||""),this.g=li(y[3]||"",!0),hs(this,y[4]),this.l=li(y[5]||"",!0),yr(this,y[6]||"",!0),this.m=li(y[7]||"")):(this.h=!1,this.i=new vr(null,this.h))}Ut.prototype.toString=function(){var d=[],y=this.j;y&&d.push(Ca(y,ec,!0),":");var E=this.g;return(E||y=="file")&&(d.push("//"),(y=this.o)&&d.push(Ca(y,ec,!0),"@"),d.push(encodeURIComponent(String(E)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.s,E!=null&&d.push(":",String(E))),(E=this.l)&&(this.g&&E.charAt(0)!="/"&&d.push("/"),d.push(Ca(E,E.charAt(0)=="/"?Og:tc,!0))),(E=this.i.toString())&&d.push("?",E),(E=this.m)&&d.push("#",Ca(E,Yo)),d.join("")};function Hn(d){return new Ut(d)}function Aa(d,y,E){d.j=E?li(y,!0):y,d.j&&(d.j=d.j.replace(/:$/,""))}function hs(d,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);d.s=y}else d.s=null}function yr(d,y,E){y instanceof vr?(d.i=y,qd(d.i,d.h)):(E||(y=Ca(y,xg)),d.i=new vr(y,d.h))}function at(d,y,E){d.i.set(y,E)}function Ra(d){return at(d,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),d}function li(d,y){return d?y?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function Ca(d,y,E){return typeof d=="string"?(d=encodeURI(d).replace(y,zd),E&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function zd(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var ec=/[#\/\?@]/g,tc=/[#\?:]/g,Og=/[#\?]/g,xg=/[#\?@]/g,Yo=/#/g;function vr(d,y){this.h=this.g=null,this.i=d||null,this.j=!!y}function ui(d){d.g||(d.g=new Map,d.h=0,d.i&&Ng(d.i,function(y,E){d.add(decodeURIComponent(y.replace(/\+/g," ")),E)}))}n=vr.prototype,n.add=function(d,y){ui(this),this.i=null,d=ji(this,d);var E=this.g.get(d);return E||this.g.set(d,E=[]),E.push(y),this.h+=1,this};function Er(d,y){ui(d),y=ji(d,y),d.g.has(y)&&(d.i=null,d.h-=d.g.get(y).length,d.g.delete(y))}function Tr(d,y){return ui(d),y=ji(d,y),d.g.has(y)}n.forEach=function(d,y){ui(this),this.g.forEach(function(E,I){E.forEach(function(B){d.call(y,B,I,this)},this)},this)},n.na=function(){ui(this);const d=Array.from(this.g.values()),y=Array.from(this.g.keys()),E=[];for(let I=0;I<y.length;I++){const B=d[I];for(let K=0;K<B.length;K++)E.push(y[I])}return E},n.V=function(d){ui(this);let y=[];if(typeof d=="string")Tr(this,d)&&(y=y.concat(this.g.get(ji(this,d))));else{d=Array.from(this.g.values());for(let E=0;E<d.length;E++)y=y.concat(d[E])}return y},n.set=function(d,y){return ui(this),this.i=null,d=ji(this,d),Tr(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[y]),this.h+=1,this},n.get=function(d,y){return d?(d=this.V(d),0<d.length?String(d[0]):y):y};function nc(d,y,E){Er(d,y),0<E.length&&(d.i=null,d.g.set(ji(d,y),x(E)),d.h+=E.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],y=Array.from(this.g.keys());for(var E=0;E<y.length;E++){var I=y[E];const K=encodeURIComponent(String(I)),oe=this.V(I);for(I=0;I<oe.length;I++){var B=K;oe[I]!==""&&(B+="="+encodeURIComponent(String(oe[I]))),d.push(B)}}return this.i=d.join("&")};function ji(d,y){return y=String(y),d.j&&(y=y.toLowerCase()),y}function qd(d,y){y&&!d.j&&(ui(d),d.i=null,d.g.forEach(function(E,I){var B=I.toLowerCase();I!=B&&(Er(this,I),nc(this,B,E))},d)),d.j=y}function Da(d,y){const E=new oi;if(h.Image){const I=new Image;I.onload=S(ci,E,"TestLoadImage: loaded",!0,y,I),I.onerror=S(ci,E,"TestLoadImage: error",!1,y,I),I.onabort=S(ci,E,"TestLoadImage: abort",!1,y,I),I.ontimeout=S(ci,E,"TestLoadImage: timeout",!1,y,I),h.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=d}else y(!1)}function Ci(d,y){const E=new oi,I=new AbortController,B=setTimeout(()=>{I.abort(),ci(E,"TestPingServer: timeout",!1,y)},1e4);fetch(d,{signal:I.signal}).then(K=>{clearTimeout(B),K.ok?ci(E,"TestPingServer: ok",!0,y):ci(E,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(B),ci(E,"TestPingServer: error",!1,y)})}function ci(d,y,E,I,B){try{B&&(B.onload=null,B.onerror=null,B.onabort=null,B.ontimeout=null),I(E)}catch{}}function Na(){this.g=new Ta}function Hi(d,y,E){const I=E||"";try{Zu(d,function(B,K){let oe=B;p(B)&&(oe=Ai(B)),y.push(I+K+"="+encodeURIComponent(oe))})}catch(B){throw y.push(I+"type="+encodeURIComponent("_badmap")),B}}function ds(d){this.l=d.Ub||null,this.j=d.eb||!1}N(ds,Hu),ds.prototype.g=function(){return new wr(this.l,this.j)},ds.prototype.i=function(d){return function(){return d}}({});function wr(d,y){At.call(this),this.D=d,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}N(wr,At),n=wr.prototype,n.open=function(d,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=d,this.A=y,this.readyState=1,Ki(this)},n.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};d&&(y.body=d),(this.D||h).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Gi(this)),this.readyState=0},n.Sa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Ki(this)),this.g&&(this.readyState=3,Ki(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof h.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ic(this)}else d.text().then(this.Ra.bind(this),this.ga.bind(this))};function ic(d){d.j.read().then(d.Pa.bind(d)).catch(d.ga.bind(d))}n.Pa=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var y=d.value?d.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!d.done}))&&(this.response=this.responseText+=y)}d.done?Gi(this):Ki(this),this.readyState==3&&ic(this)}},n.Ra=function(d){this.g&&(this.response=this.responseText=d,Gi(this))},n.Qa=function(d){this.g&&(this.response=d,Gi(this))},n.ga=function(){this.g&&Gi(this)};function Gi(d){d.readyState=4,d.l=null,d.j=null,d.v=null,Ki(d)}n.setRequestHeader=function(d,y){this.u.append(d,y)},n.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],y=this.h.entries();for(var E=y.next();!E.done;)E=E.value,d.push(E[0]+": "+E[1]),E=y.next();return d.join(`\r
`)};function Ki(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(wr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function rc(d){let y="";return me(d,function(E,I){y+=I,y+=":",y+=E,y+=`\r
`}),y}function Jt(d,y,E){e:{for(I in E){var I=!1;break e}I=!0}I||(E=rc(E),typeof d=="string"?E!=null&&encodeURIComponent(String(E)):at(d,y,E))}function Xe(d){At.call(this),this.headers=new Map,this.o=d||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}N(Xe,At);var Qo=/^https?$/i,Oa=["POST","PUT"];n=Xe.prototype,n.Ha=function(d){this.J=d},n.ea=function(d,y,E,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);y=y?y.toUpperCase():"GET",this.D=d,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Bi.g(),this.v=this.o?Gu(this.o):Gu(Bi),this.g.onreadystatechange=T(this.Ea,this);try{this.B=!0,this.g.open(y,String(d),!0),this.B=!1}catch(K){jd(this,K);return}if(d=E||"",E=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var B in I)E.set(B,I[B]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const K of I.keys())E.set(K,I.get(K));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(E.keys()).find(K=>K.toLowerCase()=="content-type"),B=h.FormData&&d instanceof h.FormData,!(0<=Array.prototype.indexOf.call(Oa,y,void 0))||I||B||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[K,oe]of E)this.g.setRequestHeader(K,oe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{xa(this),this.u=!0,this.g.send(d),this.u=!1}catch(K){jd(this,K)}};function jd(d,y){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=y,d.m=5,Wo(d),Yi(d)}function Wo(d){d.A||(d.A=!0,Ze(d,"complete"),Ze(d,"error"))}n.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=d||7,Ze(this,"complete"),Ze(this,"abort"),Yi(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Yi(this,!0)),Xe.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?$o(this):this.bb())},n.bb=function(){$o(this)};function $o(d){if(d.h&&typeof u<"u"&&(!d.v[1]||hi(d)!=4||d.Z()!=2)){if(d.u&&hi(d)==4)mn(d.Ea,0,d);else if(Ze(d,"readystatechange"),hi(d)==4){d.h=!1;try{const oe=d.Z();e:switch(oe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var E;if(!(E=y)){var I;if(I=oe===0){var B=String(d.D).match(Sa)[1]||null;!B&&h.self&&h.self.location&&(B=h.self.location.protocol.slice(0,-1)),I=!Qo.test(B?B.toLowerCase():"")}E=I}if(E)Ze(d,"complete"),Ze(d,"success");else{d.m=6;try{var K=2<hi(d)?d.g.statusText:""}catch{K=""}d.l=K+" ["+d.Z()+"]",Wo(d)}}finally{Yi(d)}}}}function Yi(d,y){if(d.g){xa(d);const E=d.g,I=d.v[0]?()=>{}:null;d.g=null,d.v=null,y||Ze(d,"ready");try{E.onreadystatechange=I}catch{}}}function xa(d){d.I&&(h.clearTimeout(d.I),d.I=null)}n.isActive=function(){return!!this.g};function hi(d){return d.g?d.g.readyState:0}n.Z=function(){try{return 2<hi(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(d){if(this.g){var y=this.g.responseText;return d&&y.indexOf(d)==0&&(y=y.substring(d.length)),Bo(y)}};function Hd(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.H){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function Pg(d){const y={};d=(d.g&&2<=hi(d)&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<d.length;I++){if(ee(d[I]))continue;var E=V(d[I]);const B=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const K=y[B]||[];y[B]=K,K.push(E)}O(y,function(I){return I.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Pa(d,y,E){return E&&E.internalChannelParams&&E.internalChannelParams[d]||y}function Xo(d){this.Aa=0,this.i=[],this.j=new oi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Pa("failFast",!1,d),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Pa("baseRetryDelayMs",5e3,d),this.cb=Pa("retryDelaySeedMs",1e4,d),this.Wa=Pa("forwardChannelMaxRetries",2,d),this.wa=Pa("forwardChannelRequestTimeoutMs",2e4,d),this.pa=d&&d.xmlHttpFactory||void 0,this.Xa=d&&d.Tb||void 0,this.Ca=d&&d.useFetchStreams||!1,this.L=void 0,this.J=d&&d.supportsCrossDomainXhr||!1,this.K="",this.h=new _r(d&&d.concurrentRequestLimit),this.Da=new Na,this.P=d&&d.fastHandshake||!1,this.O=d&&d.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=d&&d.Rb||!1,d&&d.xa&&this.j.xa(),d&&d.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&d&&d.detectBufferingProxy||!1,this.ja=void 0,d&&d.longPollingTimeout&&0<d.longPollingTimeout&&(this.ja=d.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Xo.prototype,n.la=8,n.G=1,n.connect=function(d,y,E,I){_t(0),this.W=d,this.H=y||{},E&&I!==void 0&&(this.H.OSID=E,this.H.OAID=I),this.F=this.X,this.I=Xd(this,null,this.W),Zo(this)};function sc(d){if(Gd(d),d.G==3){var y=d.U++,E=Hn(d.I);if(at(E,"SID",d.K),at(E,"RID",y),at(E,"TYPE","terminate"),ka(d,E),y=new Sn(d,d.j,y),y.L=2,y.v=Ra(Hn(E)),E=!1,h.navigator&&h.navigator.sendBeacon)try{E=h.navigator.sendBeacon(y.v.toString(),"")}catch{}!E&&h.Image&&(new Image().src=y.v,E=!0),E||(y.g=Jd(y.j,null),y.g.ea(y.v)),y.F=Date.now(),ba(y)}$d(d)}function Jo(d){d.g&&(Ma(d),d.g.cancel(),d.g=null)}function Gd(d){Jo(d),d.u&&(h.clearTimeout(d.u),d.u=null),el(d),d.h.cancel(),d.s&&(typeof d.s=="number"&&h.clearTimeout(d.s),d.s=null)}function Zo(d){if(!jo(d.h)&&!d.s){d.s=!0;var y=d.Ga;ce||P(),ve||(ce(),ve=!0),We.add(y,d),d.B=0}}function kg(d,y){return Ho(d.h)>=d.h.j-(d.s?1:0)?!1:d.s?(d.i=y.D.concat(d.i),!0):d.G==1||d.G==2||d.B>=(d.Va?0:d.Wa)?!1:(d.s=Lt(T(d.Ga,d,y),lc(d,d.B)),d.B++,!0)}n.Ga=function(d){if(this.s)if(this.s=null,this.G==1){if(!d){this.U=Math.floor(1e5*Math.random()),d=this.U++;const B=new Sn(this,this.j,d);let K=this.o;if(this.S&&(K?(K=A(K),M(K,this.S)):K=this.S),this.m!==null||this.O||(B.H=K,K=null),this.P)e:{for(var y=0,E=0;E<this.i.length;E++){t:{var I=this.i[E];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break t}I=void 0}if(I===void 0)break;if(y+=I,4096<y){y=E;break e}if(y===4096||E===this.i.length-1){y=E+1;break e}}y=1e3}else y=1e3;y=Kd(this,B,y),E=Hn(this.I),at(E,"RID",d),at(E,"CVER",22),this.D&&at(E,"X-HTTP-Session-Id",this.D),ka(this,E),K&&(this.O?y="headers="+encodeURIComponent(String(rc(K)))+"&"+y:this.m&&Jt(E,this.m,K)),Go(this.h,B),this.Ua&&at(E,"TYPE","init"),this.P?(at(E,"$req",y),at(E,"SID","null"),B.T=!0,Ri(B,E,null)):Ri(B,E,y),this.G=2}}else this.G==3&&(d?ac(this,d):this.i.length==0||jo(this.h)||ac(this))};function ac(d,y){var E;y?E=y.l:E=d.U++;const I=Hn(d.I);at(I,"SID",d.K),at(I,"RID",E),at(I,"AID",d.T),ka(d,I),d.m&&d.o&&Jt(I,d.m,d.o),E=new Sn(d,d.j,E,d.B+1),d.m===null&&(E.H=d.o),y&&(d.i=y.D.concat(d.i)),y=Kd(d,E,1e3),E.I=Math.round(.5*d.wa)+Math.round(.5*d.wa*Math.random()),Go(d.h,E),Ri(E,I,y)}function ka(d,y){d.H&&me(d.H,function(E,I){at(y,I,E)}),d.l&&Zu({},function(E,I){at(y,I,E)})}function Kd(d,y,E){E=Math.min(d.i.length,E);var I=d.l?T(d.l.Na,d.l,d):null;e:{var B=d.i;let K=-1;for(;;){const oe=["count="+E];K==-1?0<E?(K=B[0].g,oe.push("ofs="+K)):K=0:oe.push("ofs="+K);let qe=!0;for(let jt=0;jt<E;jt++){let je=B[jt].g;const Zt=B[jt].map;if(je-=K,0>je)K=Math.max(0,B[jt].g-100),qe=!1;else try{Hi(Zt,oe,"req"+je+"_")}catch{I&&I(Zt)}}if(qe){I=oe.join("&");break e}}}return d=d.i.splice(0,E),y.D=d,I}function Yd(d){if(!d.g&&!d.u){d.Y=1;var y=d.Fa;ce||P(),ve||(ce(),ve=!0),We.add(y,d),d.v=0}}function oc(d){return d.g||d.u||3<=d.v?!1:(d.Y++,d.u=Lt(T(d.Fa,d),lc(d,d.v)),d.v++,!0)}n.Fa=function(){if(this.u=null,Qd(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var d=2*this.R;this.j.info("BP detection timer enabled: "+d),this.A=Lt(T(this.ab,this),d)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,_t(10),Jo(this),Qd(this))};function Ma(d){d.A!=null&&(h.clearTimeout(d.A),d.A=null)}function Qd(d){d.g=new Sn(d,d.j,"rpc",d.Y),d.m===null&&(d.g.H=d.o),d.g.O=0;var y=Hn(d.qa);at(y,"RID","rpc"),at(y,"SID",d.K),at(y,"AID",d.T),at(y,"CI",d.F?"0":"1"),!d.F&&d.ja&&at(y,"TO",d.ja),at(y,"TYPE","xmlhttp"),ka(d,y),d.m&&d.o&&Jt(y,d.m,d.o),d.L&&(d.g.I=d.L);var E=d.g;d=d.ia,E.L=1,E.v=Ra(Hn(y)),E.m=null,E.P=!0,gr(E,d)}n.Za=function(){this.C!=null&&(this.C=null,Jo(this),oc(this),_t(19))};function el(d){d.C!=null&&(h.clearTimeout(d.C),d.C=null)}function Wd(d,y){var E=null;if(d.g==y){el(d),Ma(d),d.g=null;var I=2}else if(Xu(d.h,y))E=y.D,An(d.h,y),I=1;else return;if(d.G!=0){if(y.o)if(I==1){E=y.m?y.m.length:0,y=Date.now()-y.F;var B=d.B;I=as(),Ze(I,new qt(I,E)),Zo(d)}else Yd(d);else if(B=y.s,B==3||B==0&&0<y.X||!(I==1&&kg(d,y)||I==2&&oc(d)))switch(E&&0<E.length&&(y=d.h,y.i=y.i.concat(E)),B){case 1:br(d,5);break;case 4:br(d,10);break;case 3:br(d,6);break;default:br(d,2)}}}function lc(d,y){let E=d.Ta+Math.floor(Math.random()*d.cb);return d.isActive()||(E*=2),E*y}function br(d,y){if(d.j.info("Error code "+y),y==2){var E=T(d.fb,d),I=d.Xa;const B=!I;I=new Ut(I||"//www.google.com/images/cleardot.gif"),h.location&&h.location.protocol=="http"||Aa(I,"https"),Ra(I),B?Da(I.toString(),E):Ci(I.toString(),E)}else _t(2);d.G=0,d.l&&d.l.sa(y),$d(d),Gd(d)}n.fb=function(d){d?(this.j.info("Successfully pinged google.com"),_t(2)):(this.j.info("Failed to ping google.com"),_t(1))};function $d(d){if(d.G=0,d.ka=[],d.l){const y=Ju(d.h);(y.length!=0||d.i.length!=0)&&(U(d.ka,y),U(d.ka,d.i),d.h.i.length=0,x(d.i),d.i.length=0),d.l.ra()}}function Xd(d,y,E){var I=E instanceof Ut?Hn(E):new Ut(E);if(I.g!="")y&&(I.g=y+"."+I.g),hs(I,I.s);else{var B=h.location;I=B.protocol,y=y?y+"."+B.hostname:B.hostname,B=+B.port;var K=new Ut(null);I&&Aa(K,I),y&&(K.g=y),B&&hs(K,B),E&&(K.l=E),I=K}return E=d.D,y=d.ya,E&&y&&at(I,E,y),at(I,"VER",d.la),ka(d,I),I}function Jd(d,y,E){if(y&&!d.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=d.Ca&&!d.pa?new Xe(new ds({eb:E})):new Xe(d.pa),y.Ha(d.J),y}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Zd(){}n=Zd.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function tl(){}tl.prototype.g=function(d,y){return new Rn(d,y)};function Rn(d,y){At.call(this),this.g=new Xo(y),this.l=d,this.h=y&&y.messageUrlParams||null,d=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(d?d["X-WebChannel-Content-Type"]=y.messageContentType:d={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(d?d["X-WebChannel-Client-Profile"]=y.va:d={"X-WebChannel-Client-Profile":y.va}),this.g.S=d,(d=y&&y.Sb)&&!ee(d)&&(this.g.m=d),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!ee(y)&&(this.g.D=y,d=this.h,d!==null&&y in d&&(d=this.h,y in d&&delete d[y])),this.j=new Qi(this)}N(Rn,At),Rn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Rn.prototype.close=function(){sc(this.g)},Rn.prototype.o=function(d){var y=this.g;if(typeof d=="string"){var E={};E.__data__=d,d=E}else this.u&&(E={},E.__data__=Ai(d),d=E);y.i.push(new Bd(y.Ya++,d)),y.G==3&&Zo(y)},Rn.prototype.N=function(){this.g.l=null,delete this.j,sc(this.g),delete this.g,Rn.aa.N.call(this)};function ef(d){mr.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var y=d.__sm__;if(y){e:{for(const E in y){d=E;break e}d=void 0}(this.i=d)&&(d=this.i,y=y!==null&&d in y?y[d]:void 0),this.data=y}else this.data=d}N(ef,mr);function tf(){Yu.call(this),this.status=1}N(tf,Yu);function Qi(d){this.g=d}N(Qi,Zd),Qi.prototype.ua=function(){Ze(this.g,"a")},Qi.prototype.ta=function(d){Ze(this.g,new ef(d))},Qi.prototype.sa=function(d){Ze(this.g,new tf)},Qi.prototype.ra=function(){Ze(this.g,"b")},tl.prototype.createWebChannel=tl.prototype.g,Rn.prototype.send=Rn.prototype.o,Rn.prototype.open=Rn.prototype.m,Rn.prototype.close=Rn.prototype.close,AD=function(){return new tl},SD=function(){return as()},ID=Fi,Ov={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},us.NO_ERROR=0,us.TIMEOUT=8,us.HTTP_ERROR=6,wm=us,pr.COMPLETE="complete",bD=pr,Ku.EventType=fr,fr.OPEN="a",fr.CLOSE="b",fr.ERROR="c",fr.MESSAGE="d",At.prototype.listen=At.prototype.K,dh=Ku,Xe.prototype.listenOnce=Xe.prototype.L,Xe.prototype.getLastError=Xe.prototype.Ka,Xe.prototype.getLastErrorCode=Xe.prototype.Ba,Xe.prototype.getStatus=Xe.prototype.Z,Xe.prototype.getResponseJson=Xe.prototype.Oa,Xe.prototype.getResponseText=Xe.prototype.oa,Xe.prototype.send=Xe.prototype.ea,Xe.prototype.setWithCredentials=Xe.prototype.Ha,wD=Xe}).apply(typeof am<"u"?am:typeof self<"u"?self:typeof window<"u"?window:{});const eA="@firebase/firestore",tA="4.7.14";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}yn.UNAUTHENTICATED=new yn(null),yn.GOOGLE_CREDENTIALS=new yn("google-credentials-uid"),yn.FIRST_PARTY=new yn("first-party-uid"),yn.MOCK_USER=new yn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pu="11.7.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Io=new ud("@firebase/firestore");function Fl(){return Io.logLevel}function ne(n,...e){if(Io.logLevel<=Be.DEBUG){const t=e.map(sT);Io.debug(`Firestore (${Pu}): ${n}`,...t)}}function Mt(n,...e){if(Io.logLevel<=Be.ERROR){const t=e.map(sT);Io.error(`Firestore (${Pu}): ${n}`,...t)}}function Yh(n,...e){if(Io.logLevel<=Be.WARN){const t=e.map(sT);Io.warn(`Firestore (${Pu}): ${n}`,...t)}}function sT(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fe(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,RD(n,i,t)}function RD(n,e,t){let i=`FIRESTORE (${Pu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Mt(i),new Error(i)}function _e(n,e,t,i){let s="Unexpected state";typeof t=="string"?s=t:i=t,n||RD(e,s,i)}function ge(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ue extends Si{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V3{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class L3{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(yn.UNAUTHENTICATED))}shutdown(){}}class U3{constructor(e){this.t=e,this.currentUser=yn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){_e(this.o===void 0,42304);let i=this.i;const s=f=>this.i!==i?(i=this.i,t(f)):Promise.resolve();let o=new lr;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new lr,e.enqueueRetryable(()=>s(this.currentUser))};const u=()=>{const f=o;e.enqueueRetryable(async()=>{await f.promise,await s(this.currentUser)})},h=f=>{ne("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit(f=>h(f)),setTimeout(()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?h(f):(ne("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new lr)}},0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(ne("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(_e(typeof i.accessToken=="string",31837,{l:i}),new V3(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return _e(e===null||typeof e=="string",2055,{h:e}),new yn(e)}}class F3{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=yn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class B3{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new F3(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(yn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class nA{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class z3{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,On(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){_e(this.o===void 0,3512);const i=o=>{o.error!=null&&ne("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const u=o.token!==this.m;return this.m=o.token,ne("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>i(o))};const s=o=>{ne("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>s(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?s(o):ne("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new nA(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(_e(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new nA(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q3(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CD(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DD{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const s=q3(40);for(let o=0;o<s.length;++o)i.length<20&&s[o]<t&&(i+=e.charAt(s[o]%62))}return i}}function Se(n,e){return n<e?-1:n>e?1:0}function xv(n,e){let t=0;for(;t<n.length&&t<e.length;){const i=n.codePointAt(t),s=e.codePointAt(t);if(i!==s){if(i<128&&s<128)return Se(i,s);{const o=CD(),u=j3(o.encode(iA(n,t)),o.encode(iA(e,t)));return u!==0?u:Se(i,s)}}t+=i>65535?2:1}return Se(n.length,e.length)}function iA(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function j3(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return Se(n[t],e[t]);return Se(n.length,e.length)}function lu(n,e,t){return n.length===e.length&&n.every((i,s)=>t(i,e[s]))}function ND(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rA=-62135596800,sA=1e6;class bt{static now(){return bt.fromMillis(Date.now())}static fromDate(e){return bt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*sA);return new bt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ue(Q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ue(Q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<rA)throw new ue(Q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ue(Q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/sA}_compareTo(e){return this.seconds===e.seconds?Se(this.nanoseconds,e.nanoseconds):Se(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-rA;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ee{static fromTimestamp(e){return new Ee(e)}static min(){return new Ee(new bt(0,0))}static max(){return new Ee(new bt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aA="__name__";class tr{constructor(e,t,i){t===void 0?t=0:t>e.length&&fe(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&fe(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return tr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof tr?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let s=0;s<i;s++){const o=tr.compareSegments(e.get(s),t.get(s));if(o!==0)return o}return Se(e.length,t.length)}static compareSegments(e,t){const i=tr.isNumericId(e),s=tr.isNumericId(t);return i&&!s?-1:!i&&s?1:i&&s?tr.extractNumericId(e).compare(tr.extractNumericId(t)):xv(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ws.fromString(e.substring(4,e.length-2))}}class Je extends tr{construct(e,t,i){return new Je(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new ue(Q.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(s=>s.length>0))}return new Je(t)}static emptyPath(){return new Je([])}}const H3=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Tt extends tr{construct(e,t,i){return new Tt(e,t,i)}static isValidIdentifier(e){return H3.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Tt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===aA}static keyField(){return new Tt([aA])}static fromServerFormat(e){const t=[];let i="",s=0;const o=()=>{if(i.length===0)throw new ue(Q.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let u=!1;for(;s<e.length;){const h=e[s];if(h==="\\"){if(s+1===e.length)throw new ue(Q.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[s+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new ue(Q.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=f,s+=2}else h==="`"?(u=!u,s++):h!=="."||u?(i+=h,s++):(o(),s++)}if(o(),u)throw new ue(Q.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Tt(t)}static emptyPath(){return new Tt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class de{constructor(e){this.path=e}static fromPath(e){return new de(Je.fromString(e))}static fromName(e){return new de(Je.fromString(e).popFirst(5))}static empty(){return new de(Je.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Je.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Je.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new de(new Je(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uu=-1;class op{constructor(e,t,i,s){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=s}}function Pv(n){return n.fields.find(e=>e.kind===2)}function eo(n){return n.fields.filter(e=>e.kind!==2)}op.UNKNOWN_ID=-1;class bm{constructor(e,t){this.fieldPath=e,this.kind=t}}class Qh{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Qh(0,si.min())}}function OD(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,s=Ee.fromTimestamp(i===1e9?new bt(t+1,0):new bt(t,i));return new si(s,de.empty(),e)}function xD(n){return new si(n.readTime,n.key,uu)}class si{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new si(Ee.min(),de.empty(),uu)}static max(){return new si(Ee.max(),de.empty(),uu)}}function aT(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=de.comparator(n.documentKey,e.documentKey),t!==0?t:Se(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PD="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class kD{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ua(n){if(n.code!==Q.FAILED_PRECONDITION||n.message!==PD)throw n;ne("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&fe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new z((i,s)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(i,s)},this.catchCallback=o=>{this.wrapFailure(t,o).next(i,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof z?t:z.resolve(t)}catch(t){return z.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):z.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):z.reject(t)}static resolve(e){return new z((t,i)=>{t(e)})}static reject(e){return new z((t,i)=>{i(e)})}static waitFor(e){return new z((t,i)=>{let s=0,o=0,u=!1;e.forEach(h=>{++s,h.next(()=>{++o,u&&o===s&&t()},f=>i(f))}),u=!0,o===s&&t()})}static or(e){let t=z.resolve(!1);for(const i of e)t=t.next(s=>s?z.resolve(s):i());return t}static forEach(e,t){const i=[];return e.forEach((s,o)=>{i.push(t.call(this,s,o))}),this.waitFor(i)}static mapArray(e,t){return new z((i,s)=>{const o=e.length,u=new Array(o);let h=0;for(let f=0;f<o;f++){const p=f;t(e[p]).next(_=>{u[p]=_,++h,h===o&&i(u)},_=>s(_))}})}static doWhile(e,t){return new z((i,s)=>{const o=()=>{e()===!0?t().next(()=>{o()},s):i()};o()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zn="SimpleDb";class Zp{static open(e,t,i,s){try{return new Zp(t,e.transaction(s,i))}catch(o){throw new Sh(t,o)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new lr,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Sh(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const s=oT(i.target.error);this.S.reject(new Sh(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ne(Zn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new K3(t)}}class $s{static delete(e){return ne(Zn,"Removing database:",e),io(BR().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!uE())return!1;if($s.F())return!0;const e=Qt(),t=$s.M(e),i=0<t&&t<10,s=MD(e),o=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||o)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.O)==="YES"}static N(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.B=i,this.L=null,$s.M(Qt())===12.2&&Mt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async k(e){return this.db||(ne(Zn,"Opening database:",this.name),this.db=await new Promise((t,i)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=o=>{const u=o.target.result;t(u)},s.onblocked=()=>{i(new Sh(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=o=>{const u=o.target.error;u.name==="VersionError"?i(new ue(Q.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):u.name==="InvalidStateError"?i(new ue(Q.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+u)):i(new Sh(e,u))},s.onupgradeneeded=o=>{ne(Zn,'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);const u=o.target.result;if(this.L!==null&&this.L!==o.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${o.oldVersion}, event.newVersion=${o.newVersion}, db.version=${u.version}`);this.B.q(u,s.transaction,o.oldVersion,this.version).next(()=>{ne(Zn,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",t=>{const i=t.target;this.L=i.version},{passive:!0})),this.$&&(this.db.onversionchange=t=>this.$(t)),this.db}U(e){this.$=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,s){const o=t==="readonly";let u=0;for(;;){++u;try{this.db=await this.k(e);const h=Zp.open(this.db,e,o?"readonly":"readwrite",i),f=s(h).next(p=>(h.v(),p)).catch(p=>(h.abort(p),z.reject(p))).toPromise();return f.catch(()=>{}),await h.D,f}catch(h){const f=h,p=f.name!=="FirebaseError"&&u<3;if(ne(Zn,"Transaction failed with error:",f.message,"Retrying:",p),this.close(),!p)return Promise.reject(f)}}}close(){this.db&&this.db.close(),this.db=void 0}}function MD(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class G3{constructor(e){this.K=e,this.W=!1,this.G=null}get isDone(){return this.W}get j(){return this.G}set cursor(e){this.K=e}done(){this.W=!0}H(e){this.G=e}delete(){return io(this.K.delete())}}class Sh extends ue{constructor(e,t){super(Q.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ca(n){return n.name==="IndexedDbTransactionError"}class K3{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(ne(Zn,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(ne(Zn,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),io(i)}add(e){return ne(Zn,"ADD",this.store.name,e,e),io(this.store.add(e))}get(e){return io(this.store.get(e)).next(t=>(t===void 0&&(t=null),ne(Zn,"GET",this.store.name,e,t),t))}delete(e){return ne(Zn,"DELETE",this.store.name,e),io(this.store.delete(e))}count(){return ne(Zn,"COUNT",this.store.name),io(this.store.count())}J(e,t){const i=this.options(e,t),s=i.index?this.store.index(i.index):this.store;if(typeof s.getAll=="function"){const o=s.getAll(i.range);return new z((u,h)=>{o.onerror=f=>{h(f.target.error)},o.onsuccess=f=>{u(f.target.result)}})}{const o=this.cursor(i),u=[];return this.Y(o,(h,f)=>{u.push(f)}).next(()=>u)}}Z(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new z((s,o)=>{i.onerror=u=>{o(u.target.error)},i.onsuccess=u=>{s(u.target.result)}})}X(e,t){ne(Zn,"DELETE ALL",this.store.name);const i=this.options(e,t);i.ee=!1;const s=this.cursor(i);return this.Y(s,(o,u,h)=>h.delete())}te(e,t){let i;t?i=e:(i={},t=e);const s=this.cursor(i);return this.Y(s,t)}ne(e){const t=this.cursor({});return new z((i,s)=>{t.onerror=o=>{const u=oT(o.target.error);s(u)},t.onsuccess=o=>{const u=o.target.result;u?e(u.primaryKey,u.value).next(h=>{h?u.continue():i()}):i()}})}Y(e,t){const i=[];return new z((s,o)=>{e.onerror=u=>{o(u.target.error)},e.onsuccess=u=>{const h=u.target.result;if(!h)return void s();const f=new G3(h),p=t(h.primaryKey,h.value,f);if(p instanceof z){const _=p.catch(v=>(f.done(),z.reject(v)));i.push(_)}f.isDone?s():f.j===null?h.continue():h.continue(f.j)}}).next(()=>z.waitFor(i))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.ee?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function io(n){return new z((e,t)=>{n.onsuccess=i=>{const s=i.target.result;e(s)},n.onerror=i=>{const s=oT(i.target.error);t(s)}})}let oA=!1;function oT(n){const e=$s.M(Qt());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new ue("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return oA||(oA=!0,setTimeout(()=>{throw i},0)),i}}return n}const Ah="IndexBackfiller";class Y3{constructor(e,t){this.asyncQueue=e,this.re=t,this.task=null}start(){this.ie(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ie(e){ne(Ah,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const t=await this.re.se();ne(Ah,`Documents written: ${t}`)}catch(t){ca(t)?ne(Ah,"Ignoring IndexedDB error during index backfill: ",t):await ua(t)}await this.ie(6e4)})}}class Q3{constructor(e,t){this.localStore=e,this.persistence=t}async se(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.oe(t,e))}oe(e,t){const i=new Set;let s=t,o=!0;return z.doWhile(()=>o===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(u=>{if(u!==null&&!i.has(u))return ne(Ah,`Processing collection: ${u}`),this._e(e,u,s).next(h=>{s-=h,i.add(u)});o=!1})).next(()=>t-s)}_e(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(s=>this.localStore.localDocuments.getNextDocuments(e,t,s,i).next(o=>{const u=o.changes;return this.localStore.indexManager.updateIndexEntries(e,u).next(()=>this.ae(s,o)).next(h=>(ne(Ah,`Updating offset: ${h}`),this.localStore.indexManager.updateCollectionGroup(e,t,h))).next(()=>u.size)}))}ae(e,t){let i=e;return t.changes.forEach((s,o)=>{const u=xD(o);aT(u,i)>0&&(i=u)}),new si(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ue(i),this.ce=i=>t.writeSequenceNumber(i))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}Fn.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fo=-1;function eg(n){return n==null}function Wh(n){return n===0&&1/n==-1/0}function VD(n){return typeof n=="number"&&Number.isInteger(n)&&!Wh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lp="";function wn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=lA(e)),e=W3(n.get(t),e);return lA(e)}function W3(n,e){let t=e;const i=n.length;for(let s=0;s<i;s++){const o=n.charAt(s);switch(o){case"\0":t+="";break;case lp:t+="";break;default:t+=o}}return t}function lA(n){return n+lp+""}function rr(n){const e=n.length;if(_e(e>=2,64408,{path:n}),e===2)return _e(n.charAt(0)===lp&&n.charAt(1)==="",56145,{path:n}),Je.emptyPath();const t=e-2,i=[];let s="";for(let o=0;o<e;){const u=n.indexOf(lp,o);switch((u<0||u>t)&&fe(50515,{path:n}),n.charAt(u+1)){case"":const h=n.substring(o,u);let f;s.length===0?f=h:(s+=h,f=s,s=""),i.push(f);break;case"":s+=n.substring(o,u),s+="\0";break;case"":s+=n.substring(o,u+1);break;default:fe(61167,{path:n})}o=u+2}return new Je(i)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const to="remoteDocuments",Ed="owner",Ol="owner",$h="mutationQueues",$3="userId",xi="mutations",uA="batchId",ho="userMutationsIndex",cA=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Im(n,e){return[n,wn(e)]}function LD(n,e,t){return[n,wn(e),t]}const X3={},cu="documentMutations",up="remoteDocumentsV14",J3=["prefixPath","collectionGroup","readTime","documentId"],Sm="documentKeyIndex",Z3=["prefixPath","collectionGroup","documentId"],UD="collectionGroupIndex",e9=["collectionGroup","readTime","prefixPath","documentId"],Xh="remoteDocumentGlobal",kv="remoteDocumentGlobalKey",hu="targets",FD="queryTargetsIndex",t9=["canonicalId","targetId"],du="targetDocuments",n9=["targetId","path"],lT="documentTargetsIndex",i9=["path","targetId"],cp="targetGlobalKey",mo="targetGlobal",Jh="collectionParents",r9=["collectionId","parent"],fu="clientMetadata",s9="clientId",tg="bundles",a9="bundleId",ng="namedQueries",o9="name",uT="indexConfiguration",l9="indexId",Mv="collectionGroupIndex",u9="collectionGroup",hp="indexState",c9=["indexId","uid"],BD="sequenceNumberIndex",h9=["uid","sequenceNumber"],dp="indexEntries",d9=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],zD="documentKeyIndex",f9=["indexId","uid","orderedDocumentKey"],ig="documentOverlays",m9=["userId","collectionPath","documentId"],Vv="collectionPathOverlayIndex",p9=["userId","collectionPath","largestBatchId"],qD="collectionGroupOverlayIndex",g9=["userId","collectionGroup","largestBatchId"],cT="globals",_9="name",jD=[$h,xi,cu,to,hu,Ed,mo,du,fu,Xh,Jh,tg,ng],y9=[...jD,ig],HD=[$h,xi,cu,up,hu,Ed,mo,du,fu,Xh,Jh,tg,ng,ig],GD=HD,hT=[...GD,uT,hp,dp],v9=hT,E9=[...hT,cT];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lv extends kD{constructor(e,t){super(),this.he=e,this.currentSequenceNumber=t}}function $t(n,e){const t=ge(n);return $s.N(t.he,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hA(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ha(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function KD(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e,t){this.comparator=e,this.root=t||dn.EMPTY}insert(e,t){return new mt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,dn.BLACK,null,null))}remove(e){return new mt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,dn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const s=this.comparator(e,i.key);if(s===0)return t+i.left.size;s<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){const e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new om(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new om(this.root,e,this.comparator,!1)}getReverseIterator(){return new om(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new om(this.root,e,this.comparator,!0)}}class om{constructor(e,t,i,s){this.isReverse=s,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?i(e.key,t):1,t&&s&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class dn{constructor(e,t,i,s,o){this.key=e,this.value=t,this.color=i??dn.RED,this.left=s??dn.EMPTY,this.right=o??dn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,s,o){return new dn(e??this.key,t??this.value,i??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let s=this;const o=i(e,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(e,t,i),null):o===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return dn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return dn.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,dn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,dn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw fe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw fe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw fe(27949);return e+(this.isRed()?0:1)}}dn.EMPTY=null,dn.RED=!0,dn.BLACK=!1;dn.EMPTY=new class{constructor(){this.size=0}get key(){throw fe(57766)}get value(){throw fe(16141)}get color(){throw fe(16727)}get left(){throw fe(29726)}get right(){throw fe(36894)}copy(e,t,i,s,o){return this}insert(e,t,i){return new dn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{constructor(e){this.comparator=e,this.data=new mt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const s=i.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new dA(this.data.getIterator())}getIteratorFrom(e){return new dA(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof rt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,o=i.getNext().key;if(this.comparator(s,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new rt(this.comparator);return t.data=e,t}}class dA{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function xl(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(e){this.fields=e,e.sort(Tt.comparator)}static empty(){return new Bn([])}unionWith(e){let t=new rt(Tt.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Bn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return lu(this.fields,e.fields,(t,i)=>t.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YD extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new YD("Invalid base64 string: "+o):o}}(e);return new Vt(t)}static fromUint8Array(e){const t=function(s){let o="";for(let u=0;u<s.length;++u)o+=String.fromCharCode(s[u]);return o}(e);return new Vt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const i=new Uint8Array(t.length);for(let s=0;s<t.length;s++)i[s]=t.charCodeAt(s);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Se(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Vt.EMPTY_BYTE_STRING=new Vt("");const T9=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Xr(n){if(_e(!!n,39018),typeof n=="string"){let e=0;const t=T9.exec(n);if(_e(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:vt(n.seconds),nanos:vt(n.nanos)}}function vt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Jr(n){return typeof n=="string"?Vt.fromBase64String(n):Vt.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QD="server_timestamp",WD="__type__",$D="__previous_value__",XD="__local_write_time__";function dT(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[WD])===null||t===void 0?void 0:t.stringValue)===QD}function rg(n){const e=n.mapValue.fields[$D];return dT(e)?rg(e):e}function Zh(n){const e=Xr(n.mapValue.fields[XD].timestampValue);return new bt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w9{constructor(e,t,i,s,o,u,h,f,p,_){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=s,this.ssl=o,this.forceLongPolling=u,this.autoDetectLongPolling=h,this.longPollingOptions=f,this.useFetchStreams=p,this.isUsingEmulator=_}}const fp="(default)";class So{constructor(e,t){this.projectId=e,this.database=t||fp}static empty(){return new So("","")}get isDefaultDatabase(){return this.database===fp}isEqual(e){return e instanceof So&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fT="__type__",JD="__max__",Hs={mapValue:{fields:{__type__:{stringValue:JD}}}},mT="__vector__",mu="value",Am={nullValue:"NULL_VALUE"};function ta(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?dT(n)?4:ZD(n)?9007199254740991:sg(n)?10:11:fe(28295,{value:n})}function cr(n,e){if(n===e)return!0;const t=ta(n);if(t!==ta(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Zh(n).isEqual(Zh(e));case 3:return function(s,o){if(typeof s.timestampValue=="string"&&typeof o.timestampValue=="string"&&s.timestampValue.length===o.timestampValue.length)return s.timestampValue===o.timestampValue;const u=Xr(s.timestampValue),h=Xr(o.timestampValue);return u.seconds===h.seconds&&u.nanos===h.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(s,o){return Jr(s.bytesValue).isEqual(Jr(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,o){return vt(s.geoPointValue.latitude)===vt(o.geoPointValue.latitude)&&vt(s.geoPointValue.longitude)===vt(o.geoPointValue.longitude)}(n,e);case 2:return function(s,o){if("integerValue"in s&&"integerValue"in o)return vt(s.integerValue)===vt(o.integerValue);if("doubleValue"in s&&"doubleValue"in o){const u=vt(s.doubleValue),h=vt(o.doubleValue);return u===h?Wh(u)===Wh(h):isNaN(u)&&isNaN(h)}return!1}(n,e);case 9:return lu(n.arrayValue.values||[],e.arrayValue.values||[],cr);case 10:case 11:return function(s,o){const u=s.mapValue.fields||{},h=o.mapValue.fields||{};if(hA(u)!==hA(h))return!1;for(const f in u)if(u.hasOwnProperty(f)&&(h[f]===void 0||!cr(u[f],h[f])))return!1;return!0}(n,e);default:return fe(52216,{left:n})}}function ed(n,e){return(n.values||[]).find(t=>cr(t,e))!==void 0}function na(n,e){if(n===e)return 0;const t=ta(n),i=ta(e);if(t!==i)return Se(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Se(n.booleanValue,e.booleanValue);case 2:return function(o,u){const h=vt(o.integerValue||o.doubleValue),f=vt(u.integerValue||u.doubleValue);return h<f?-1:h>f?1:h===f?0:isNaN(h)?isNaN(f)?0:-1:1}(n,e);case 3:return fA(n.timestampValue,e.timestampValue);case 4:return fA(Zh(n),Zh(e));case 5:return xv(n.stringValue,e.stringValue);case 6:return function(o,u){const h=Jr(o),f=Jr(u);return h.compareTo(f)}(n.bytesValue,e.bytesValue);case 7:return function(o,u){const h=o.split("/"),f=u.split("/");for(let p=0;p<h.length&&p<f.length;p++){const _=Se(h[p],f[p]);if(_!==0)return _}return Se(h.length,f.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,u){const h=Se(vt(o.latitude),vt(u.latitude));return h!==0?h:Se(vt(o.longitude),vt(u.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return mA(n.arrayValue,e.arrayValue);case 10:return function(o,u){var h,f,p,_;const v=o.fields||{},T=u.fields||{},S=(h=v[mu])===null||h===void 0?void 0:h.arrayValue,N=(f=T[mu])===null||f===void 0?void 0:f.arrayValue,x=Se(((p=S==null?void 0:S.values)===null||p===void 0?void 0:p.length)||0,((_=N==null?void 0:N.values)===null||_===void 0?void 0:_.length)||0);return x!==0?x:mA(S,N)}(n.mapValue,e.mapValue);case 11:return function(o,u){if(o===Hs.mapValue&&u===Hs.mapValue)return 0;if(o===Hs.mapValue)return 1;if(u===Hs.mapValue)return-1;const h=o.fields||{},f=Object.keys(h),p=u.fields||{},_=Object.keys(p);f.sort(),_.sort();for(let v=0;v<f.length&&v<_.length;++v){const T=xv(f[v],_[v]);if(T!==0)return T;const S=na(h[f[v]],p[_[v]]);if(S!==0)return S}return Se(f.length,_.length)}(n.mapValue,e.mapValue);default:throw fe(23264,{Pe:t})}}function fA(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Se(n,e);const t=Xr(n),i=Xr(e),s=Se(t.seconds,i.seconds);return s!==0?s:Se(t.nanos,i.nanos)}function mA(n,e){const t=n.values||[],i=e.values||[];for(let s=0;s<t.length&&s<i.length;++s){const o=na(t[s],i[s]);if(o)return o}return Se(t.length,i.length)}function pu(n){return Uv(n)}function Uv(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const i=Xr(t);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Jr(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return de.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let i="[",s=!0;for(const o of t.values||[])s?s=!1:i+=",",i+=Uv(o);return i+"]"}(n.arrayValue):"mapValue"in n?function(t){const i=Object.keys(t.fields||{}).sort();let s="{",o=!0;for(const u of i)o?o=!1:s+=",",s+=`${u}:${Uv(t.fields[u])}`;return s+"}"}(n.mapValue):fe(61005,{value:n})}function Rm(n){switch(ta(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=rg(n);return e?16+Rm(e):16;case 5:return 2*n.stringValue.length;case 6:return Jr(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(i){return(i.values||[]).reduce((s,o)=>s+Rm(o),0)}(n.arrayValue);case 10:case 11:return function(i){let s=0;return ha(i.fields,(o,u)=>{s+=o.length+Rm(u)}),s}(n.mapValue);default:throw fe(13486,{value:n})}}function td(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Fv(n){return!!n&&"integerValue"in n}function nd(n){return!!n&&"arrayValue"in n}function pA(n){return!!n&&"nullValue"in n}function gA(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Cm(n){return!!n&&"mapValue"in n}function sg(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[fT])===null||t===void 0?void 0:t.stringValue)===mT}function Rh(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return ha(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=Rh(i)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Rh(n.arrayValue.values[t]);return e}return Object.assign({},n)}function ZD(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===JD}const eN={mapValue:{fields:{[fT]:{stringValue:mT},[mu]:{arrayValue:{}}}}};function b9(n){return"nullValue"in n?Am:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?td(So.empty(),de.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?sg(n)?eN:{mapValue:{}}:fe(35942,{value:n})}function I9(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?td(So.empty(),de.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?eN:"mapValue"in n?sg(n)?{mapValue:{}}:Hs:fe(61959,{value:n})}function _A(n,e){const t=na(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function yA(n,e){const t=na(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(e){this.value=e}static empty(){return new En({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Cm(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Rh(t)}setAll(e){let t=Tt.emptyPath(),i={},s=[];e.forEach((u,h)=>{if(!t.isImmediateParentOf(h)){const f=this.getFieldsMap(t);this.applyChanges(f,i,s),i={},s=[],t=h.popLast()}u?i[h.lastSegment()]=Rh(u):s.push(h.lastSegment())});const o=this.getFieldsMap(t);this.applyChanges(o,i,s)}delete(e){const t=this.field(e.popLast());Cm(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return cr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let s=t.mapValue.fields[e.get(i)];Cm(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,i){ha(t,(s,o)=>e[s]=o);for(const s of i)delete e[s]}clone(){return new En(Rh(this.value))}}function tN(n){const e=[];return ha(n.fields,(t,i)=>{const s=new Tt([t]);if(Cm(i)){const o=tN(i.mapValue).fields;if(o.length===0)e.push(s);else for(const u of o)e.push(s.child(u))}else e.push(s)}),new Bn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e,t,i,s,o,u,h){this.key=e,this.documentType=t,this.version=i,this.readTime=s,this.createTime=o,this.data=u,this.documentState=h}static newInvalidDocument(e){return new Dt(e,0,Ee.min(),Ee.min(),Ee.min(),En.empty(),0)}static newFoundDocument(e,t,i,s){return new Dt(e,1,t,Ee.min(),i,s,0)}static newNoDocument(e,t){return new Dt(e,2,t,Ee.min(),Ee.min(),En.empty(),0)}static newUnknownDocument(e,t){return new Dt(e,3,t,Ee.min(),Ee.min(),En.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ee.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=En.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=En.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ee.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Dt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Dt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(e,t){this.position=e,this.inclusive=t}}function vA(n,e,t){let i=0;for(let s=0;s<n.position.length;s++){const o=e[s],u=n.position[s];if(o.field.isKeyField()?i=de.comparator(de.fromName(u.referenceValue),t.key):i=na(u,t.data.field(o.field)),o.dir==="desc"&&(i*=-1),i!==0)break}return i}function EA(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!cr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(e,t="asc"){this.field=e,this.dir=t}}function S9(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nN{}class ze extends nN{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new A9(e,t,i):t==="array-contains"?new D9(e,i):t==="in"?new lN(e,i):t==="not-in"?new N9(e,i):t==="array-contains-any"?new O9(e,i):new ze(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new R9(e,i):new C9(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(na(t,this.value)):t!==null&&ta(this.value)===ta(t)&&this.matchesComparison(na(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return fe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class it extends nN{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new it(e,t)}matches(e){return _u(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function _u(n){return n.op==="and"}function Bv(n){return n.op==="or"}function pT(n){return iN(n)&&_u(n)}function iN(n){for(const e of n.filters)if(e instanceof it)return!1;return!0}function zv(n){if(n instanceof ze)return n.field.canonicalString()+n.op.toString()+pu(n.value);if(pT(n))return n.filters.map(e=>zv(e)).join(",");{const e=n.filters.map(t=>zv(t)).join(",");return`${n.op}(${e})`}}function rN(n,e){return n instanceof ze?function(i,s){return s instanceof ze&&i.op===s.op&&i.field.isEqual(s.field)&&cr(i.value,s.value)}(n,e):n instanceof it?function(i,s){return s instanceof it&&i.op===s.op&&i.filters.length===s.filters.length?i.filters.reduce((o,u,h)=>o&&rN(u,s.filters[h]),!0):!1}(n,e):void fe(19439)}function sN(n,e){const t=n.filters.concat(e);return it.create(t,n.op)}function aN(n){return n instanceof ze?function(t){return`${t.field.canonicalString()} ${t.op} ${pu(t.value)}`}(n):n instanceof it?function(t){return t.op.toString()+" {"+t.getFilters().map(aN).join(" ,")+"}"}(n):"Filter"}class A9 extends ze{constructor(e,t,i){super(e,t,i),this.key=de.fromName(i.referenceValue)}matches(e){const t=de.comparator(e.key,this.key);return this.matchesComparison(t)}}class R9 extends ze{constructor(e,t){super(e,"in",t),this.keys=oN("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class C9 extends ze{constructor(e,t){super(e,"not-in",t),this.keys=oN("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function oN(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(i=>de.fromName(i.referenceValue))}class D9 extends ze{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return nd(t)&&ed(t.arrayValue,this.value)}}class lN extends ze{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&ed(this.value.arrayValue,t)}}class N9 extends ze{constructor(e,t){super(e,"not-in",t)}matches(e){if(ed(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ed(this.value.arrayValue,t)}}class O9 extends ze{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!nd(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>ed(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x9{constructor(e,t=null,i=[],s=[],o=null,u=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=s,this.limit=o,this.startAt=u,this.endAt=h,this.Ie=null}}function qv(n,e=null,t=[],i=[],s=null,o=null,u=null){return new x9(n,e,t,i,s,o,u)}function Ao(n){const e=ge(n);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>zv(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>function(o){return o.field.canonicalString()+o.dir}(i)).join(","),eg(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>pu(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>pu(i)).join(",")),e.Ie=t}return e.Ie}function Td(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!S9(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!rN(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!EA(n.startAt,e.startAt)&&EA(n.endAt,e.endAt)}function mp(n){return de.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function pp(n,e){return n.filters.filter(t=>t instanceof ze&&t.field.isEqual(e))}function TA(n,e,t){let i=Am,s=!0;for(const o of pp(n,e)){let u=Am,h=!0;switch(o.op){case"<":case"<=":u=b9(o.value);break;case"==":case"in":case">=":u=o.value;break;case">":u=o.value,h=!1;break;case"!=":case"not-in":u=Am}_A({value:i,inclusive:s},{value:u,inclusive:h})<0&&(i=u,s=h)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const u=t.position[o];_A({value:i,inclusive:s},{value:u,inclusive:t.inclusive})<0&&(i=u,s=t.inclusive);break}}return{value:i,inclusive:s}}function wA(n,e,t){let i=Hs,s=!0;for(const o of pp(n,e)){let u=Hs,h=!0;switch(o.op){case">=":case">":u=I9(o.value),h=!1;break;case"==":case"in":case"<=":u=o.value;break;case"<":u=o.value,h=!1;break;case"!=":case"not-in":u=Hs}yA({value:i,inclusive:s},{value:u,inclusive:h})>0&&(i=u,s=h)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const u=t.position[o];yA({value:i,inclusive:s},{value:u,inclusive:t.inclusive})>0&&(i=u,s=t.inclusive);break}}return{value:i,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku{constructor(e,t=null,i=[],s=[],o=null,u="F",h=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=s,this.limit=o,this.limitType=u,this.startAt=h,this.endAt=f,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function uN(n,e,t,i,s,o,u,h){return new ku(n,e,t,i,s,o,u,h)}function wd(n){return new ku(n)}function bA(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function cN(n){return n.collectionGroup!==null}function Ch(n){const e=ge(n);if(e.Ee===null){e.Ee=[];const t=new Set;for(const o of e.explicitOrderBy)e.Ee.push(o),t.add(o.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let h=new rt(Tt.comparator);return u.filters.forEach(f=>{f.getFlattenedFilters().forEach(p=>{p.isInequality()&&(h=h.add(p.field))})}),h})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ee.push(new id(o,i))}),t.has(Tt.keyField().canonicalString())||e.Ee.push(new id(Tt.keyField(),i))}return e.Ee}function ii(n){const e=ge(n);return e.de||(e.de=P9(e,Ch(n))),e.de}function P9(n,e){if(n.limitType==="F")return qv(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{const o=s.dir==="desc"?"asc":"desc";return new id(s.field,o)});const t=n.endAt?new gu(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new gu(n.startAt.position,n.startAt.inclusive):null;return qv(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function jv(n,e){const t=n.filters.concat([e]);return new ku(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Hv(n,e,t){return new ku(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function ag(n,e){return Td(ii(n),ii(e))&&n.limitType===e.limitType}function hN(n){return`${Ao(ii(n))}|lt:${n.limitType}`}function Bl(n){return`Query(target=${function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(s=>aN(s)).join(", ")}]`),eg(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(s=>function(u){return`${u.field.canonicalString()} (${u.dir})`}(s)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(s=>pu(s)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(s=>pu(s)).join(",")),`Target(${i})`}(ii(n))}; limitType=${n.limitType})`}function bd(n,e){return e.isFoundDocument()&&function(i,s){const o=s.key.path;return i.collectionGroup!==null?s.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):de.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o)}(n,e)&&function(i,s){for(const o of Ch(i))if(!o.field.isKeyField()&&s.data.field(o.field)===null)return!1;return!0}(n,e)&&function(i,s){for(const o of i.filters)if(!o.matches(s))return!1;return!0}(n,e)&&function(i,s){return!(i.startAt&&!function(u,h,f){const p=vA(u,h,f);return u.inclusive?p<=0:p<0}(i.startAt,Ch(i),s)||i.endAt&&!function(u,h,f){const p=vA(u,h,f);return u.inclusive?p>=0:p>0}(i.endAt,Ch(i),s))}(n,e)}function dN(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function fN(n){return(e,t)=>{let i=!1;for(const s of Ch(n)){const o=k9(s,e,t);if(o!==0)return o;i=i||s.field.isKeyField()}return 0}}function k9(n,e,t){const i=n.field.isKeyField()?de.comparator(e.key,t.key):function(o,u,h){const f=u.data.field(o),p=h.data.field(o);return f!==null&&p!==null?na(f,p):fe(42886)}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return fe(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[s,o]of i)if(this.equalsFn(s,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),s=this.inner[i];if(s===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],e))return void(s[o]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return i.length===1?delete this.inner[t]:i.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ha(this.inner,(t,i)=>{for(const[s,o]of i)e(s,o)})}isEmpty(){return KD(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M9=new mt(de.comparator);function ei(){return M9}const mN=new mt(de.comparator);function fh(...n){let e=mN;for(const t of n)e=e.insert(t.key,t);return e}function pN(n){let e=mN;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function sr(){return Dh()}function gN(){return Dh()}function Dh(){return new is(n=>n.toString(),(n,e)=>n.isEqual(e))}const V9=new mt(de.comparator),L9=new rt(de.comparator);function Pe(...n){let e=L9;for(const t of n)e=e.add(t);return e}const U9=new rt(Se);function gT(){return U9}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _T(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Wh(e)?"-0":e}}function _N(n){return{integerValue:""+n}}function F9(n,e){return VD(e)?_N(e):_T(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class og{constructor(){this._=void 0}}function B9(n,e,t){return n instanceof yu?function(s,o){const u={fields:{[WD]:{stringValue:QD},[XD]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return o&&dT(o)&&(o=rg(o)),o&&(u.fields[$D]=o),{mapValue:u}}(t,e):n instanceof vu?vN(n,e):n instanceof Eu?EN(n,e):function(s,o){const u=yN(s,o),h=IA(u)+IA(s.Re);return Fv(u)&&Fv(s.Re)?_N(h):_T(s.serializer,h)}(n,e)}function z9(n,e,t){return n instanceof vu?vN(n,e):n instanceof Eu?EN(n,e):t}function yN(n,e){return n instanceof rd?function(i){return Fv(i)||function(o){return!!o&&"doubleValue"in o}(i)}(e)?e:{integerValue:0}:null}class yu extends og{}class vu extends og{constructor(e){super(),this.elements=e}}function vN(n,e){const t=TN(e);for(const i of n.elements)t.some(s=>cr(s,i))||t.push(i);return{arrayValue:{values:t}}}class Eu extends og{constructor(e){super(),this.elements=e}}function EN(n,e){let t=TN(e);for(const i of n.elements)t=t.filter(s=>!cr(s,i));return{arrayValue:{values:t}}}class rd extends og{constructor(e,t){super(),this.serializer=e,this.Re=t}}function IA(n){return vt(n.integerValue||n.doubleValue)}function TN(n){return nd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wN{constructor(e,t){this.field=e,this.transform=t}}function q9(n,e){return n.field.isEqual(e.field)&&function(i,s){return i instanceof vu&&s instanceof vu||i instanceof Eu&&s instanceof Eu?lu(i.elements,s.elements,cr):i instanceof rd&&s instanceof rd?cr(i.Re,s.Re):i instanceof yu&&s instanceof yu}(n.transform,e.transform)}class j9{constructor(e,t){this.version=e,this.transformResults=t}}class Pn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Pn}static exists(e){return new Pn(void 0,e)}static updateTime(e){return new Pn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Dm(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class lg{}function bN(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new yT(n.key,Pn.none()):new Mu(n.key,n.data,Pn.none());{const t=n.data,i=En.empty();let s=new rt(Tt.comparator);for(let o of e.fields)if(!s.has(o)){let u=t.field(o);u===null&&o.length>1&&(o=o.popLast(),u=t.field(o)),u===null?i.delete(o):i.set(o,u),s=s.add(o)}return new rs(n.key,i,new Bn(s.toArray()),Pn.none())}}function H9(n,e,t){n instanceof Mu?function(s,o,u){const h=s.value.clone(),f=AA(s.fieldTransforms,o,u.transformResults);h.setAll(f),o.convertToFoundDocument(u.version,h).setHasCommittedMutations()}(n,e,t):n instanceof rs?function(s,o,u){if(!Dm(s.precondition,o))return void o.convertToUnknownDocument(u.version);const h=AA(s.fieldTransforms,o,u.transformResults),f=o.data;f.setAll(IN(s)),f.setAll(h),o.convertToFoundDocument(u.version,f).setHasCommittedMutations()}(n,e,t):function(s,o,u){o.convertToNoDocument(u.version).setHasCommittedMutations()}(0,e,t)}function Nh(n,e,t,i){return n instanceof Mu?function(o,u,h,f){if(!Dm(o.precondition,u))return h;const p=o.value.clone(),_=RA(o.fieldTransforms,f,u);return p.setAll(_),u.convertToFoundDocument(u.version,p).setHasLocalMutations(),null}(n,e,t,i):n instanceof rs?function(o,u,h,f){if(!Dm(o.precondition,u))return h;const p=RA(o.fieldTransforms,f,u),_=u.data;return _.setAll(IN(o)),_.setAll(p),u.convertToFoundDocument(u.version,_).setHasLocalMutations(),h===null?null:h.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(v=>v.field))}(n,e,t,i):function(o,u,h){return Dm(o.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):h}(n,e,t)}function G9(n,e){let t=null;for(const i of n.fieldTransforms){const s=e.data.field(i.field),o=yN(i.transform,s||null);o!=null&&(t===null&&(t=En.empty()),t.set(i.field,o))}return t||null}function SA(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(i,s){return i===void 0&&s===void 0||!(!i||!s)&&lu(i,s,(o,u)=>q9(o,u))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Mu extends lg{constructor(e,t,i,s=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class rs extends lg{constructor(e,t,i,s,o=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=s,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function IN(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}}),e}function AA(n,e,t){const i=new Map;_e(n.length===t.length,32656,{Ve:t.length,me:n.length});for(let s=0;s<t.length;s++){const o=n[s],u=o.transform,h=e.data.field(o.field);i.set(o.field,z9(u,h,t[s]))}return i}function RA(n,e,t){const i=new Map;for(const s of n){const o=s.transform,u=t.data.field(s.field);i.set(s.field,B9(o,u,e))}return i}class yT extends lg{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class SN extends lg{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vT{constructor(e,t,i,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=s}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const o=this.mutations[s];o.key.isEqual(e.key)&&H9(o,e,i[s])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Nh(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Nh(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=gN();return this.mutations.forEach(s=>{const o=e.get(s.key),u=o.overlayedDocument;let h=this.applyToLocalView(u,o.mutatedFields);h=t.has(s.key)?null:h;const f=bN(u,h);f!==null&&i.set(s.key,f),u.isValidDocument()||u.convertToNoDocument(Ee.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Pe())}isEqual(e){return this.batchId===e.batchId&&lu(this.mutations,e.mutations,(t,i)=>SA(t,i))&&lu(this.baseMutations,e.baseMutations,(t,i)=>SA(t,i))}}class ET{constructor(e,t,i,s){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=s}static from(e,t,i){_e(e.mutations.length===i.length,58842,{fe:e.mutations.length,ge:i.length});let s=function(){return V9}();const o=e.mutations;for(let u=0;u<o.length;u++)s=s.insert(o[u].key,i[u].version);return new ET(e,t,i,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TT{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K9{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zt,Ge;function Y9(n){switch(n){case Q.OK:return fe(64938);case Q.CANCELLED:case Q.UNKNOWN:case Q.DEADLINE_EXCEEDED:case Q.RESOURCE_EXHAUSTED:case Q.INTERNAL:case Q.UNAVAILABLE:case Q.UNAUTHENTICATED:return!1;case Q.INVALID_ARGUMENT:case Q.NOT_FOUND:case Q.ALREADY_EXISTS:case Q.PERMISSION_DENIED:case Q.FAILED_PRECONDITION:case Q.ABORTED:case Q.OUT_OF_RANGE:case Q.UNIMPLEMENTED:case Q.DATA_LOSS:return!0;default:return fe(15467,{code:n})}}function AN(n){if(n===void 0)return Mt("GRPC error has no .code"),Q.UNKNOWN;switch(n){case zt.OK:return Q.OK;case zt.CANCELLED:return Q.CANCELLED;case zt.UNKNOWN:return Q.UNKNOWN;case zt.DEADLINE_EXCEEDED:return Q.DEADLINE_EXCEEDED;case zt.RESOURCE_EXHAUSTED:return Q.RESOURCE_EXHAUSTED;case zt.INTERNAL:return Q.INTERNAL;case zt.UNAVAILABLE:return Q.UNAVAILABLE;case zt.UNAUTHENTICATED:return Q.UNAUTHENTICATED;case zt.INVALID_ARGUMENT:return Q.INVALID_ARGUMENT;case zt.NOT_FOUND:return Q.NOT_FOUND;case zt.ALREADY_EXISTS:return Q.ALREADY_EXISTS;case zt.PERMISSION_DENIED:return Q.PERMISSION_DENIED;case zt.FAILED_PRECONDITION:return Q.FAILED_PRECONDITION;case zt.ABORTED:return Q.ABORTED;case zt.OUT_OF_RANGE:return Q.OUT_OF_RANGE;case zt.UNIMPLEMENTED:return Q.UNIMPLEMENTED;case zt.DATA_LOSS:return Q.DATA_LOSS;default:return fe(39323,{code:n})}}(Ge=zt||(zt={}))[Ge.OK=0]="OK",Ge[Ge.CANCELLED=1]="CANCELLED",Ge[Ge.UNKNOWN=2]="UNKNOWN",Ge[Ge.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ge[Ge.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ge[Ge.NOT_FOUND=5]="NOT_FOUND",Ge[Ge.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ge[Ge.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ge[Ge.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ge[Ge.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ge[Ge.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ge[Ge.ABORTED=10]="ABORTED",Ge[Ge.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ge[Ge.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ge[Ge.INTERNAL=13]="INTERNAL",Ge[Ge.UNAVAILABLE=14]="UNAVAILABLE",Ge[Ge.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q9=new Ws([4294967295,4294967295],0);function CA(n){const e=CD().encode(n),t=new TD;return t.update(e),new Uint8Array(t.digest())}function DA(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),s=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Ws([t,i],0),new Ws([s,o],0)]}class wT{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new mh(`Invalid padding: ${t}`);if(i<0)throw new mh(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new mh(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new mh(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=Ws.fromNumber(this.pe)}we(e,t,i){let s=e.add(t.multiply(Ws.fromNumber(i)));return s.compare(Q9)===1&&(s=new Ws([s.getBits(0),s.getBits(1)],0)),s.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const t=CA(e),[i,s]=DA(t);for(let o=0;o<this.hashCount;o++){const u=this.we(i,s,o);if(!this.be(u))return!1}return!0}static create(e,t,i){const s=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),u=new wT(o,s,t);return i.forEach(h=>u.insert(h)),u}insert(e){if(this.pe===0)return;const t=CA(e),[i,s]=DA(t);for(let o=0;o<this.hashCount;o++){const u=this.we(i,s,o);this.Se(u)}}Se(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class mh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Id{constructor(e,t,i,s,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=s,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const s=new Map;return s.set(e,Sd.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new Id(Ee.min(),s,new mt(Se),ei(),Pe())}}class Sd{constructor(e,t,i,s,o){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=s,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Sd(i,t,Pe(),Pe(),Pe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nm{constructor(e,t,i,s){this.De=e,this.removedTargetIds=t,this.key=i,this.ve=s}}class RN{constructor(e,t){this.targetId=e,this.Ce=t}}class CN{constructor(e,t,i=Vt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=s}}class NA{constructor(){this.Fe=0,this.Me=OA(),this.xe=Vt.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=Pe(),t=Pe(),i=Pe();return this.Me.forEach((s,o)=>{switch(o){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:i=i.add(s);break;default:fe(38017,{changeType:o})}}),new Sd(this.xe,this.Oe,e,t,i)}Qe(){this.Ne=!1,this.Me=OA()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,_e(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class W9{constructor(e){this.ze=e,this.je=new Map,this.He=ei(),this.Je=lm(),this.Ye=lm(),this.Ze=new mt(Se)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{const i=this.rt(t);switch(e.state){case 0:this.it(t)&&i.ke(e.resumeToken);break;case 1:i.We(),i.Be||i.Qe(),i.ke(e.resumeToken);break;case 2:i.We(),i.Be||this.removeTarget(t);break;case 3:this.it(t)&&(i.Ge(),i.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),i.ke(e.resumeToken));break;default:fe(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((i,s)=>{this.it(s)&&t(s)})}ot(e){const t=e.targetId,i=e.Ce.count,s=this._t(t);if(s){const o=s.target;if(mp(o))if(i===0){const u=new de(o.path);this.tt(t,u,Dt.newNoDocument(u,Ee.min()))}else _e(i===1,20013,{expectedCount:i});else{const u=this.ut(t);if(u!==i){const h=this.ct(e),f=h?this.lt(h,e,u):1;if(f!==0){this.st(t);const p=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,p)}}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:s=0},hashCount:o=0}=t;let u,h;try{u=Jr(i).toUint8Array()}catch(f){if(f instanceof YD)return Yh("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{h=new wT(u,s,o)}catch(f){return Yh(f instanceof mh?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return h.pe===0?null:h}lt(e,t,i){return t.Ce.count===i-this.Tt(e,t.targetId)?0:2}Tt(e,t){const i=this.ze.getRemoteKeysForTarget(t);let s=0;return i.forEach(o=>{const u=this.ze.Pt(),h=`projects/${u.projectId}/databases/${u.database}/documents/${o.path.canonicalString()}`;e.mightContain(h)||(this.tt(t,o,null),s++)}),s}It(e){const t=new Map;this.je.forEach((o,u)=>{const h=this._t(u);if(h){if(o.current&&mp(h.target)){const f=new de(h.target.path);this.Et(f).has(u)||this.dt(u,f)||this.tt(u,f,Dt.newNoDocument(f,e))}o.Le&&(t.set(u,o.qe()),o.Qe())}});let i=Pe();this.Ye.forEach((o,u)=>{let h=!0;u.forEachWhile(f=>{const p=this._t(f);return!p||p.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)}),h&&(i=i.add(o))}),this.He.forEach((o,u)=>u.setReadTime(e));const s=new Id(e,t,this.Ze,this.He,i);return this.He=ei(),this.Je=lm(),this.Ye=lm(),this.Ze=new mt(Se),s}et(e,t){if(!this.it(e))return;const i=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,i),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,i){if(!this.it(e))return;const s=this.rt(e);this.dt(e,t)?s.$e(t,1):s.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),i&&(this.He=this.He.insert(t,i))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new NA,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new rt(Se),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new rt(Se),this.Je=this.Je.insert(e,t)),t}it(e){const t=this._t(e)!==null;return t||ne("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new NA),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function lm(){return new mt(de.comparator)}function OA(){return new mt(de.comparator)}const $9={asc:"ASCENDING",desc:"DESCENDING"},X9={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},J9={and:"AND",or:"OR"};class Z9{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Gv(n,e){return n.useProto3Json||eg(e)?e:{value:e}}function Tu(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function DN(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function eF(n,e){return Tu(n,e.toTimestamp())}function kn(n){return _e(!!n,49232),Ee.fromTimestamp(function(t){const i=Xr(t);return new bt(i.seconds,i.nanos)}(n))}function bT(n,e){return Kv(n,e).canonicalString()}function Kv(n,e){const t=function(s){return new Je(["projects",s.projectId,"databases",s.database])}(n).child("documents");return e===void 0?t:t.child(e)}function NN(n){const e=Je.fromString(n);return _e(FN(e),10190,{key:e.toString()}),e}function gp(n,e){return bT(n.databaseId,e.path)}function po(n,e){const t=NN(e);if(t.get(1)!==n.databaseId.projectId)throw new ue(Q.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ue(Q.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new de(PN(t))}function ON(n,e){return bT(n.databaseId,e)}function xN(n){const e=NN(n);return e.length===4?Je.emptyPath():PN(e)}function Yv(n){return new Je(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function PN(n){return _e(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function xA(n,e,t){return{name:gp(n,e),fields:t.value.mapValue.fields}}function tF(n,e,t){const i=po(n,e.name),s=kn(e.updateTime),o=e.createTime?kn(e.createTime):Ee.min(),u=new En({mapValue:{fields:e.fields}}),h=Dt.newFoundDocument(i,s,o,u);return t&&h.setHasCommittedMutations(),t?h.setHasCommittedMutations():h}function nF(n,e){let t;if("targetChange"in e){e.targetChange;const i=function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:fe(39313,{state:p})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],o=function(p,_){return p.useProto3Json?(_e(_===void 0||typeof _=="string",58123),Vt.fromBase64String(_||"")):(_e(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),Vt.fromUint8Array(_||new Uint8Array))}(n,e.targetChange.resumeToken),u=e.targetChange.cause,h=u&&function(p){const _=p.code===void 0?Q.UNKNOWN:AN(p.code);return new ue(_,p.message||"")}(u);t=new CN(i,s,o,h||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const s=po(n,i.document.name),o=kn(i.document.updateTime),u=i.document.createTime?kn(i.document.createTime):Ee.min(),h=new En({mapValue:{fields:i.document.fields}}),f=Dt.newFoundDocument(s,o,u,h),p=i.targetIds||[],_=i.removedTargetIds||[];t=new Nm(p,_,f.key,f)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const s=po(n,i.document),o=i.readTime?kn(i.readTime):Ee.min(),u=Dt.newNoDocument(s,o),h=i.removedTargetIds||[];t=new Nm([],h,u.key,u)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const s=po(n,i.document),o=i.removedTargetIds||[];t=new Nm([],o,s,null)}else{if(!("filter"in e))return fe(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:s=0,unchangedNames:o}=i,u=new K9(s,o),h=i.targetId;t=new RN(h,u)}}return t}function _p(n,e){let t;if(e instanceof Mu)t={update:xA(n,e.key,e.value)};else if(e instanceof yT)t={delete:gp(n,e.key)};else if(e instanceof rs)t={update:xA(n,e.key,e.data),updateMask:lF(e.fieldMask)};else{if(!(e instanceof SN))return fe(16599,{ft:e.type});t={verify:gp(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(o,u){const h=u.transform;if(h instanceof yu)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof vu)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof Eu)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof rd)return{fieldPath:u.field.canonicalString(),increment:h.Re};throw fe(20930,{transform:u.transform})}(0,i))),e.precondition.isNone||(t.currentDocument=function(s,o){return o.updateTime!==void 0?{updateTime:eF(s,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:fe(27497)}(n,e.precondition)),t}function Qv(n,e){const t=e.currentDocument?function(o){return o.updateTime!==void 0?Pn.updateTime(kn(o.updateTime)):o.exists!==void 0?Pn.exists(o.exists):Pn.none()}(e.currentDocument):Pn.none(),i=e.updateTransforms?e.updateTransforms.map(s=>function(u,h){let f=null;if("setToServerValue"in h)_e(h.setToServerValue==="REQUEST_TIME",16630,{proto:h}),f=new yu;else if("appendMissingElements"in h){const _=h.appendMissingElements.values||[];f=new vu(_)}else if("removeAllFromArray"in h){const _=h.removeAllFromArray.values||[];f=new Eu(_)}else"increment"in h?f=new rd(u,h.increment):fe(16584,{proto:h});const p=Tt.fromServerFormat(h.fieldPath);return new wN(p,f)}(n,s)):[];if(e.update){e.update.name;const s=po(n,e.update.name),o=new En({mapValue:{fields:e.update.fields}});if(e.updateMask){const u=function(f){const p=f.fieldPaths||[];return new Bn(p.map(_=>Tt.fromServerFormat(_)))}(e.updateMask);return new rs(s,o,u,t,i)}return new Mu(s,o,t,i)}if(e.delete){const s=po(n,e.delete);return new yT(s,t)}if(e.verify){const s=po(n,e.verify);return new SN(s,t)}return fe(1463,{proto:e})}function iF(n,e){return n&&n.length>0?(_e(e!==void 0,14353),n.map(t=>function(s,o){let u=s.updateTime?kn(s.updateTime):kn(o);return u.isEqual(Ee.min())&&(u=kn(o)),new j9(u,s.transformResults||[])}(t,e))):[]}function kN(n,e){return{documents:[ON(n,e.path)]}}function MN(n,e){const t={structuredQuery:{}},i=e.path;let s;e.collectionGroup!==null?(s=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=ON(n,s);const o=function(p){if(p.length!==0)return UN(it.create(p,"and"))}(e.filters);o&&(t.structuredQuery.where=o);const u=function(p){if(p.length!==0)return p.map(_=>function(T){return{field:zl(T.field),direction:sF(T.dir)}}(_))}(e.orderBy);u&&(t.structuredQuery.orderBy=u);const h=Gv(n,e.limit);return h!==null&&(t.structuredQuery.limit=h),e.startAt&&(t.structuredQuery.startAt=function(p){return{before:p.inclusive,values:p.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(p){return{before:!p.inclusive,values:p.position}}(e.endAt)),{gt:t,parent:s}}function VN(n){let e=xN(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let s=null;if(i>0){_e(i===1,65062);const _=t.from[0];_.allDescendants?s=_.collectionId:e=e.child(_.collectionId)}let o=[];t.where&&(o=function(v){const T=LN(v);return T instanceof it&&pT(T)?T.getFilters():[T]}(t.where));let u=[];t.orderBy&&(u=function(v){return v.map(T=>function(N){return new id(ql(N.field),function(U){switch(U){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(N.direction))}(T))}(t.orderBy));let h=null;t.limit&&(h=function(v){let T;return T=typeof v=="object"?v.value:v,eg(T)?null:T}(t.limit));let f=null;t.startAt&&(f=function(v){const T=!!v.before,S=v.values||[];return new gu(S,T)}(t.startAt));let p=null;return t.endAt&&(p=function(v){const T=!v.before,S=v.values||[];return new gu(S,T)}(t.endAt)),uN(e,s,u,o,h,"F",f,p)}function rF(n,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return fe(28987,{purpose:s})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function LN(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=ql(t.unaryFilter.field);return ze.create(i,"==",{doubleValue:NaN});case"IS_NULL":const s=ql(t.unaryFilter.field);return ze.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=ql(t.unaryFilter.field);return ze.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=ql(t.unaryFilter.field);return ze.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return fe(61313);default:return fe(60726)}}(n):n.fieldFilter!==void 0?function(t){return ze.create(ql(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return fe(58110);default:return fe(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return it.create(t.compositeFilter.filters.map(i=>LN(i)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return fe(1026)}}(t.compositeFilter.op))}(n):fe(30097,{filter:n})}function sF(n){return $9[n]}function aF(n){return X9[n]}function oF(n){return J9[n]}function zl(n){return{fieldPath:n.canonicalString()}}function ql(n){return Tt.fromServerFormat(n.fieldPath)}function UN(n){return n instanceof ze?function(t){if(t.op==="=="){if(gA(t.value))return{unaryFilter:{field:zl(t.field),op:"IS_NAN"}};if(pA(t.value))return{unaryFilter:{field:zl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(gA(t.value))return{unaryFilter:{field:zl(t.field),op:"IS_NOT_NAN"}};if(pA(t.value))return{unaryFilter:{field:zl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:zl(t.field),op:aF(t.op),value:t.value}}}(n):n instanceof it?function(t){const i=t.getFilters().map(s=>UN(s));return i.length===1?i[0]:{compositeFilter:{op:oF(t.op),filters:i}}}(n):fe(54877,{filter:n})}function lF(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function FN(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr{constructor(e,t,i,s,o=Ee.min(),u=Ee.min(),h=Vt.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=s,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=h,this.expectedCount=f}withSequenceNumber(e){return new jr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new jr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new jr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new jr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BN{constructor(e){this.wt=e}}function uF(n,e){let t;if(e.document)t=tF(n.wt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=de.fromSegments(e.noDocument.path),s=Co(e.noDocument.readTime);t=Dt.newNoDocument(i,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return fe(56709);{const i=de.fromSegments(e.unknownDocument.path),s=Co(e.unknownDocument.version);t=Dt.newUnknownDocument(i,s)}}return e.readTime&&t.setReadTime(function(s){const o=new bt(s[0],s[1]);return Ee.fromTimestamp(o)}(e.readTime)),t}function PA(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:yp(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=function(o,u){return{name:gp(o,u.key),fields:u.data.value.mapValue.fields,updateTime:Tu(o,u.version.toTimestamp()),createTime:Tu(o,u.createTime.toTimestamp())}}(n.wt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Ro(e.version)};else{if(!e.isUnknownDocument())return fe(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:Ro(e.version)}}return i}function yp(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ro(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Co(n){const e=new bt(n.seconds,n.nanoseconds);return Ee.fromTimestamp(e)}function ro(n,e){const t=(e.baseMutations||[]).map(o=>Qv(n.wt,o));for(let o=0;o<e.mutations.length-1;++o){const u=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){const h=e.mutations[o+1];u.updateTransforms=h.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}const i=e.mutations.map(o=>Qv(n.wt,o)),s=bt.fromMillis(e.localWriteTimeMs);return new vT(e.batchId,s,t,i)}function ph(n){const e=Co(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Co(n.lastLimboFreeSnapshotVersion):Ee.min();let i;return i=function(o){return o.documents!==void 0}(n.query)?function(o){const u=o.documents.length;return _e(u===1,1966,{count:u}),ii(wd(xN(o.documents[0])))}(n.query):function(o){return ii(VN(o))}(n.query),new jr(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Vt.fromBase64String(n.resumeToken))}function zN(n,e){const t=Ro(e.snapshotVersion),i=Ro(e.lastLimboFreeSnapshotVersion);let s;s=mp(e.target)?kN(n.wt,e.target):MN(n.wt,e.target).gt;const o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ao(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:s}}function qN(n){const e=VN({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Hv(e,e.limit,"L"):e}function Qy(n,e){return new TT(e.largestBatchId,Qv(n.wt,e.overlayMutation))}function kA(n,e){const t=e.path.lastSegment();return[n,wn(e.path.popLast()),t]}function MA(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:Ro(i.readTime),documentKey:wn(i.documentKey.path),largestBatchId:i.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cF{getBundleMetadata(e,t){return VA(e).get(t).next(i=>{if(i)return function(o){return{id:o.bundleId,createTime:Co(o.createTime),version:o.version}}(i)})}saveBundleMetadata(e,t){return VA(e).put(function(s){return{bundleId:s.id,createTime:Ro(kn(s.createTime)),version:s.version}}(t))}getNamedQuery(e,t){return LA(e).get(t).next(i=>{if(i)return function(o){return{name:o.name,query:qN(o.bundledQuery),readTime:Co(o.readTime)}}(i)})}saveNamedQuery(e,t){return LA(e).put(function(s){return{name:s.name,readTime:Ro(kn(s.readTime)),bundledQuery:s.bundledQuery}}(t))}}function VA(n){return $t(n,tg)}function LA(n){return $t(n,ng)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ug{constructor(e,t){this.serializer=e,this.userId=t}static bt(e,t){const i=t.uid||"";return new ug(e,i)}getOverlay(e,t){return th(e).get(kA(this.userId,t)).next(i=>i?Qy(this.serializer,i):null)}getOverlays(e,t){const i=sr();return z.forEach(t,s=>this.getOverlay(e,s).next(o=>{o!==null&&i.set(s,o)})).next(()=>i)}saveOverlays(e,t,i){const s=[];return i.forEach((o,u)=>{const h=new TT(t,u);s.push(this.St(e,h))}),z.waitFor(s)}removeOverlaysForBatchId(e,t,i){const s=new Set;t.forEach(u=>s.add(wn(u.getCollectionPath())));const o=[];return s.forEach(u=>{const h=IDBKeyRange.bound([this.userId,u,i],[this.userId,u,i+1],!1,!0);o.push(th(e).X(Vv,h))}),z.waitFor(o)}getOverlaysForCollection(e,t,i){const s=sr(),o=wn(t),u=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,Number.POSITIVE_INFINITY],!0);return th(e).J(Vv,u).next(h=>{for(const f of h){const p=Qy(this.serializer,f);s.set(p.getKey(),p)}return s})}getOverlaysForCollectionGroup(e,t,i,s){const o=sr();let u;const h=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return th(e).te({index:qD,range:h},(f,p,_)=>{const v=Qy(this.serializer,p);o.size()<s||v.largestBatchId===u?(o.set(v.getKey(),v),u=v.largestBatchId):_.done()}).next(()=>o)}St(e,t){return th(e).put(function(s,o,u){const[h,f,p]=kA(o,u.mutation.key);return{userId:o,collectionPath:f,documentId:p,collectionGroup:u.mutation.key.getCollectionGroup(),largestBatchId:u.largestBatchId,overlayMutation:_p(s.wt,u.mutation)}}(this.serializer,this.userId,t))}}function th(n){return $t(n,ig)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hF{Dt(e){return $t(e,cT)}getSessionToken(e){return this.Dt(e).get("sessionToken").next(t=>{const i=t==null?void 0:t.value;return i?Vt.fromUint8Array(i):Vt.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Dt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so{constructor(){}vt(e,t){this.Ct(e,t),t.Ft()}Ct(e,t){if("nullValue"in e)this.Mt(t,5);else if("booleanValue"in e)this.Mt(t,10),t.xt(e.booleanValue?1:0);else if("integerValue"in e)this.Mt(t,15),t.xt(vt(e.integerValue));else if("doubleValue"in e){const i=vt(e.doubleValue);isNaN(i)?this.Mt(t,13):(this.Mt(t,15),Wh(i)?t.xt(0):t.xt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Mt(t,20),typeof i=="string"&&(i=Xr(i)),t.Ot(`${i.seconds||""}`),t.xt(i.nanos||0)}else if("stringValue"in e)this.Nt(e.stringValue,t),this.Bt(t);else if("bytesValue"in e)this.Mt(t,30),t.Lt(Jr(e.bytesValue)),this.Bt(t);else if("referenceValue"in e)this.kt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Mt(t,45),t.xt(i.latitude||0),t.xt(i.longitude||0)}else"mapValue"in e?ZD(e)?this.Mt(t,Number.MAX_SAFE_INTEGER):sg(e)?this.qt(e.mapValue,t):(this.Qt(e.mapValue,t),this.Bt(t)):"arrayValue"in e?(this.$t(e.arrayValue,t),this.Bt(t)):fe(19022,{Ut:e})}Nt(e,t){this.Mt(t,25),this.Kt(e,t)}Kt(e,t){t.Ot(e)}Qt(e,t){const i=e.fields||{};this.Mt(t,55);for(const s of Object.keys(i))this.Nt(s,t),this.Ct(i[s],t)}qt(e,t){var i,s;const o=e.fields||{};this.Mt(t,53);const u=mu,h=((s=(i=o[u].arrayValue)===null||i===void 0?void 0:i.values)===null||s===void 0?void 0:s.length)||0;this.Mt(t,15),t.xt(vt(h)),this.Nt(u,t),this.Ct(o[u],t)}$t(e,t){const i=e.values||[];this.Mt(t,50);for(const s of i)this.Ct(s,t)}kt(e,t){this.Mt(t,37),de.fromName(e).path.forEach(i=>{this.Mt(t,60),this.Kt(i,t)})}Mt(e,t){e.xt(t)}Bt(e){e.xt(2)}}so.Wt=new so;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pl=255;function dF(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function UA(n){const e=64-function(i){let s=0;for(let o=0;o<8;++o){const u=dF(255&i[o]);if(s+=u,u!==8)break}return s}(n);return Math.ceil(e/8)}class fF{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Gt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.zt(i.value),i=t.next();this.jt()}Ht(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Jt(i.value),i=t.next();this.Yt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.zt(i);else if(i<2048)this.zt(960|i>>>6),this.zt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.zt(480|i>>>12),this.zt(128|63&i>>>6),this.zt(128|63&i);else{const s=t.codePointAt(0);this.zt(240|s>>>18),this.zt(128|63&s>>>12),this.zt(128|63&s>>>6),this.zt(128|63&s)}}this.jt()}Xt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Jt(i);else if(i<2048)this.Jt(960|i>>>6),this.Jt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i);else{const s=t.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Yt()}en(e){const t=this.tn(e),i=UA(t);this.nn(1+i),this.buffer[this.position++]=255&i;for(let s=t.length-i;s<t.length;++s)this.buffer[this.position++]=255&t[s]}rn(e){const t=this.tn(e),i=UA(t);this.nn(1+i),this.buffer[this.position++]=~(255&i);for(let s=t.length-i;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}sn(){this._n(Pl),this._n(255)}an(){this.un(Pl),this.un(255)}reset(){this.position=0}seed(e){this.nn(e.length),this.buffer.set(e,this.position),this.position+=e.length}cn(){return this.buffer.slice(0,this.position)}tn(e){const t=function(o){const u=new DataView(new ArrayBuffer(8));return u.setFloat64(0,o,!1),new Uint8Array(u.buffer)}(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let s=1;s<t.length;++s)t[s]^=i?255:0;return t}zt(e){const t=255&e;t===0?(this._n(0),this._n(255)):t===Pl?(this._n(Pl),this._n(0)):this._n(t)}Jt(e){const t=255&e;t===0?(this.un(0),this.un(255)):t===Pl?(this.un(Pl),this.un(0)):this.un(e)}jt(){this._n(0),this._n(1)}Yt(){this.un(0),this.un(1)}_n(e){this.nn(1),this.buffer[this.position++]=e}un(e){this.nn(1),this.buffer[this.position++]=~e}nn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const s=new Uint8Array(i);s.set(this.buffer),this.buffer=s}}class mF{constructor(e){this.ln=e}Lt(e){this.ln.Gt(e)}Ot(e){this.ln.Zt(e)}xt(e){this.ln.en(e)}Ft(){this.ln.sn()}}class pF{constructor(e){this.ln=e}Lt(e){this.ln.Ht(e)}Ot(e){this.ln.Xt(e)}xt(e){this.ln.rn(e)}Ft(){this.ln.an()}}class nh{constructor(){this.ln=new fF,this.hn=new mF(this.ln),this.Pn=new pF(this.ln)}seed(e){this.ln.seed(e)}Tn(e){return e===0?this.hn:this.Pn}cn(){return this.ln.cn()}reset(){this.ln.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(e,t,i,s){this.indexId=e,this.documentKey=t,this.arrayValue=i,this.directionalValue=s}In(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.directionalValue,0),t!==e?i.set([0],this.directionalValue.length):++i[i.length-1],new ao(this.indexId,this.documentKey,this.arrayValue,i)}}function Ms(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=FA(n.arrayValue,e.arrayValue),t!==0?t:(t=FA(n.directionalValue,e.directionalValue),t!==0?t:de.comparator(n.documentKey,e.documentKey)))}function FA(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BA{constructor(e){this.En=new rt((t,i)=>Tt.comparator(t.field,i.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.An=[];for(const t of e.filters){const i=t;i.isInequality()?this.En=this.En.add(i):this.An.push(i)}}get Rn(){return this.En.size>1}Vn(e){if(_e(e.collectionGroup===this.collectionId,49279),this.Rn)return!1;const t=Pv(e);if(t!==void 0&&!this.mn(t))return!1;const i=eo(e);let s=new Set,o=0,u=0;for(;o<i.length&&this.mn(i[o]);++o)s=s.add(i[o].fieldPath.canonicalString());if(o===i.length)return!0;if(this.En.size>0){const h=this.En.getIterator().getNext();if(!s.has(h.field.canonicalString())){const f=i[o];if(!this.fn(h,f)||!this.gn(this.dn[u++],f))return!1}++o}for(;o<i.length;++o){const h=i[o];if(u>=this.dn.length||!this.gn(this.dn[u++],h))return!1}return!0}pn(){if(this.Rn)return null;let e=new rt(Tt.comparator);const t=[];for(const i of this.An)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new bm(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new bm(i.field,0))}for(const i of this.dn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new bm(i.field,i.dir==="asc"?0:1)));return new op(op.UNKNOWN_ID,this.collectionId,t,Qh.empty())}mn(e){for(const t of this.An)if(this.fn(t,e))return!0;return!1}fn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}gn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jN(n){var e,t;if(_e(n instanceof ze||n instanceof it,20012),n instanceof ze){if(n instanceof lN){const s=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(o=>ze.create(n.field,"==",o)))||[];return it.create(s,"or")}return n}const i=n.filters.map(s=>jN(s));return it.create(i,n.op)}function gF(n){if(n.getFilters().length===0)return[];const e=Xv(jN(n));return _e(HN(e),7391),Wv(e)||$v(e)?[e]:e.getFilters()}function Wv(n){return n instanceof ze}function $v(n){return n instanceof it&&pT(n)}function HN(n){return Wv(n)||$v(n)||function(t){if(t instanceof it&&Bv(t)){for(const i of t.getFilters())if(!Wv(i)&&!$v(i))return!1;return!0}return!1}(n)}function Xv(n){if(_e(n instanceof ze||n instanceof it,34018),n instanceof ze)return n;if(n.filters.length===1)return Xv(n.filters[0]);const e=n.filters.map(i=>Xv(i));let t=it.create(e,n.op);return t=vp(t),HN(t)?t:(_e(t instanceof it,64498),_e(_u(t),40251),_e(t.filters.length>1,57927),t.filters.reduce((i,s)=>IT(i,s)))}function IT(n,e){let t;return _e(n instanceof ze||n instanceof it,38388),_e(e instanceof ze||e instanceof it,25473),t=n instanceof ze?e instanceof ze?function(s,o){return it.create([s,o],"and")}(n,e):zA(n,e):e instanceof ze?zA(e,n):function(s,o){if(_e(s.filters.length>0&&o.filters.length>0,48005),_u(s)&&_u(o))return sN(s,o.getFilters());const u=Bv(s)?s:o,h=Bv(s)?o:s,f=u.filters.map(p=>IT(p,h));return it.create(f,"or")}(n,e),vp(t)}function zA(n,e){if(_u(e))return sN(e,n.getFilters());{const t=e.filters.map(i=>IT(n,i));return it.create(t,"or")}}function vp(n){if(_e(n instanceof ze||n instanceof it,11850),n instanceof ze)return n;const e=n.getFilters();if(e.length===1)return vp(e[0]);if(iN(n))return n;const t=e.map(s=>vp(s)),i=[];return t.forEach(s=>{s instanceof ze?i.push(s):s instanceof it&&(s.op===n.op?i.push(...s.filters):i.push(s))}),i.length===1?i[0]:it.create(i,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _F{constructor(){this.yn=new ST}addToCollectionParentIndex(e,t){return this.yn.add(t),z.resolve()}getCollectionParents(e,t){return z.resolve(this.yn.getEntries(t))}addFieldIndex(e,t){return z.resolve()}deleteFieldIndex(e,t){return z.resolve()}deleteAllFieldIndexes(e){return z.resolve()}createTargetIndexes(e,t){return z.resolve()}getDocumentsMatchingTarget(e,t){return z.resolve(null)}getIndexType(e,t){return z.resolve(0)}getFieldIndexes(e,t){return z.resolve([])}getNextCollectionGroupToUpdate(e){return z.resolve(null)}getMinOffset(e,t){return z.resolve(si.min())}getMinOffsetFromCollectionGroup(e,t){return z.resolve(si.min())}updateCollectionGroup(e,t,i){return z.resolve()}updateIndexEntries(e,t){return z.resolve()}}class ST{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),s=this.index[t]||new rt(Je.comparator),o=!s.has(i);return this.index[t]=s.add(i),o}has(e){const t=e.lastSegment(),i=e.popLast(),s=this.index[t];return s&&s.has(i)}getEntries(e){return(this.index[e]||new rt(Je.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qA="IndexedDbIndexManager",um=new Uint8Array(0);class yF{constructor(e,t){this.databaseId=t,this.wn=new ST,this.bn=new is(i=>Ao(i),(i,s)=>Td(i,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.wn.has(t)){const i=t.lastSegment(),s=t.popLast();e.addOnCommittedListener(()=>{this.wn.add(t)});const o={collectionId:i,parent:wn(s)};return jA(e).put(o)}return z.resolve()}getCollectionParents(e,t){const i=[],s=IDBKeyRange.bound([t,""],[ND(t),""],!1,!0);return jA(e).J(s).next(o=>{for(const u of o){if(u.collectionId!==t)break;i.push(rr(u.parent))}return i})}addFieldIndex(e,t){const i=ih(e),s=function(h){return{indexId:h.indexId,collectionGroup:h.collectionGroup,fields:h.fields.map(f=>[f.fieldPath.canonicalString(),f.kind])}}(t);delete s.indexId;const o=i.add(s);if(t.indexState){const u=Ml(e);return o.next(h=>{u.put(MA(h,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return o.next()}deleteFieldIndex(e,t){const i=ih(e),s=Ml(e),o=kl(e);return i.delete(t.indexId).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=ih(e),i=kl(e),s=Ml(e);return t.X().next(()=>i.X()).next(()=>s.X())}createTargetIndexes(e,t){return z.forEach(this.Sn(t),i=>this.getIndexType(e,i).next(s=>{if(s===0||s===1){const o=new BA(i).pn();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,t){const i=kl(e);let s=!0;const o=new Map;return z.forEach(this.Sn(t),u=>this.Dn(e,u).next(h=>{s&&(s=!!h),o.set(u,h)})).next(()=>{if(s){let u=Pe();const h=[];return z.forEach(o,(f,p)=>{ne(qA,`Using index ${function(Y){return`id=${Y.indexId}|cg=${Y.collectionGroup}|f=${Y.fields.map(ie=>`${ie.fieldPath}:${ie.kind}`).join(",")}`}(f)} to execute ${Ao(t)}`);const _=function(Y,ie){const se=Pv(ie);if(se===void 0)return null;for(const me of pp(Y,se.fieldPath))switch(me.op){case"array-contains-any":return me.value.arrayValue.values||[];case"array-contains":return[me.value]}return null}(p,f),v=function(Y,ie){const se=new Map;for(const me of eo(ie))for(const O of pp(Y,me.fieldPath))switch(O.op){case"==":case"in":se.set(me.fieldPath.canonicalString(),O.value);break;case"not-in":case"!=":return se.set(me.fieldPath.canonicalString(),O.value),Array.from(se.values())}return null}(p,f),T=function(Y,ie){const se=[];let me=!0;for(const O of eo(ie)){const A=O.kind===0?TA(Y,O.fieldPath,Y.startAt):wA(Y,O.fieldPath,Y.startAt);se.push(A.value),me&&(me=A.inclusive)}return new gu(se,me)}(p,f),S=function(Y,ie){const se=[];let me=!0;for(const O of eo(ie)){const A=O.kind===0?wA(Y,O.fieldPath,Y.endAt):TA(Y,O.fieldPath,Y.endAt);se.push(A.value),me&&(me=A.inclusive)}return new gu(se,me)}(p,f),N=this.vn(f,p,T),x=this.vn(f,p,S),U=this.Cn(f,p,v),Z=this.Fn(f.indexId,_,N,T.inclusive,x,S.inclusive,U);return z.forEach(Z,ee=>i.Z(ee,t.limit).next(Y=>{Y.forEach(ie=>{const se=de.fromSegments(ie.documentKey);u.has(se)||(u=u.add(se),h.push(se))})}))}).next(()=>h)}return z.resolve(null)})}Sn(e){let t=this.bn.get(e);return t||(e.filters.length===0?t=[e]:t=gF(it.create(e.filters,"and")).map(i=>qv(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt)),this.bn.set(e,t),t)}Fn(e,t,i,s,o,u,h){const f=(t!=null?t.length:1)*Math.max(i.length,o.length),p=f/(t!=null?t.length:1),_=[];for(let v=0;v<f;++v){const T=t?this.Mn(t[v/p]):um,S=this.xn(e,T,i[v%p],s),N=this.On(e,T,o[v%p],u),x=h.map(U=>this.xn(e,T,U,!0));_.push(...this.createRange(S,N,x))}return _}xn(e,t,i,s){const o=new ao(e,de.empty(),t,i);return s?o:o.In()}On(e,t,i,s){const o=new ao(e,de.empty(),t,i);return s?o.In():o}Dn(e,t){const i=new BA(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next(o=>{let u=null;for(const h of o)i.Vn(h)&&(!u||h.fields.length>u.fields.length)&&(u=h);return u})}getIndexType(e,t){let i=2;const s=this.Sn(t);return z.forEach(s,o=>this.Dn(e,o).next(u=>{u?i!==0&&u.fields.length<function(f){let p=new rt(Tt.comparator),_=!1;for(const v of f.filters)for(const T of v.getFlattenedFilters())T.field.isKeyField()||(T.op==="array-contains"||T.op==="array-contains-any"?_=!0:p=p.add(T.field));for(const v of f.orderBy)v.field.isKeyField()||(p=p.add(v.field));return p.size+(_?1:0)}(o)&&(i=1):i=0})).next(()=>function(u){return u.limit!==null}(t)&&s.length>1&&i===2?1:i)}Nn(e,t){const i=new nh;for(const s of eo(e)){const o=t.data.field(s.fieldPath);if(o==null)return null;const u=i.Tn(s.kind);so.Wt.vt(o,u)}return i.cn()}Mn(e){const t=new nh;return so.Wt.vt(e,t.Tn(0)),t.cn()}Bn(e,t){const i=new nh;return so.Wt.vt(td(this.databaseId,t),i.Tn(function(o){const u=eo(o);return u.length===0?0:u[u.length-1].kind}(e))),i.cn()}Cn(e,t,i){if(i===null)return[];let s=[];s.push(new nh);let o=0;for(const u of eo(e)){const h=i[o++];for(const f of s)if(this.Ln(t,u.fieldPath)&&nd(h))s=this.kn(s,u,h);else{const p=f.Tn(u.kind);so.Wt.vt(h,p)}}return this.qn(s)}vn(e,t,i){return this.Cn(e,t,i.position)}qn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].cn();return t}kn(e,t,i){const s=[...e],o=[];for(const u of i.arrayValue.values||[])for(const h of s){const f=new nh;f.seed(h.cn()),so.Wt.vt(u,f.Tn(t.kind)),o.push(f)}return o}Ln(e,t){return!!e.filters.find(i=>i instanceof ze&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in"))}getFieldIndexes(e,t){const i=ih(e),s=Ml(e);return(t?i.J(Mv,IDBKeyRange.bound(t,t)):i.J()).next(o=>{const u=[];return z.forEach(o,h=>s.get([h.indexId,this.uid]).next(f=>{u.push(function(_,v){const T=v?new Qh(v.sequenceNumber,new si(Co(v.readTime),new de(rr(v.documentKey)),v.largestBatchId)):Qh.empty(),S=_.fields.map(([N,x])=>new bm(Tt.fromServerFormat(N),x));return new op(_.indexId,_.collectionGroup,S,T)}(h,f))})).next(()=>u)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((i,s)=>{const o=i.indexState.sequenceNumber-s.indexState.sequenceNumber;return o!==0?o:Se(i.collectionGroup,s.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,i){const s=ih(e),o=Ml(e);return this.Qn(e).next(u=>s.J(Mv,IDBKeyRange.bound(t,t)).next(h=>z.forEach(h,f=>o.put(MA(f.indexId,this.uid,u,i)))))}updateIndexEntries(e,t){const i=new Map;return z.forEach(t,(s,o)=>{const u=i.get(s.collectionGroup);return(u?z.resolve(u):this.getFieldIndexes(e,s.collectionGroup)).next(h=>(i.set(s.collectionGroup,h),z.forEach(h,f=>this.$n(e,s,f).next(p=>{const _=this.Un(o,f);return p.isEqual(_)?z.resolve():this.Kn(e,o,f,p,_)}))))})}Wn(e,t,i,s){return kl(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.Bn(i,t.key),documentKey:t.key.path.toArray()})}Gn(e,t,i,s){return kl(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.Bn(i,t.key),t.key.path.toArray()])}$n(e,t,i){const s=kl(e);let o=new rt(Ms);return s.te({index:zD,range:IDBKeyRange.only([i.indexId,this.uid,this.Bn(i,t)])},(u,h)=>{o=o.add(new ao(i.indexId,t,h.arrayValue,h.directionalValue))}).next(()=>o)}Un(e,t){let i=new rt(Ms);const s=this.Nn(t,e);if(s==null)return i;const o=Pv(t);if(o!=null){const u=e.data.field(o.fieldPath);if(nd(u))for(const h of u.arrayValue.values||[])i=i.add(new ao(t.indexId,e.key,this.Mn(h),s))}else i=i.add(new ao(t.indexId,e.key,um,s));return i}Kn(e,t,i,s,o){ne(qA,"Updating index entries for document '%s'",t.key);const u=[];return function(f,p,_,v,T){const S=f.getIterator(),N=p.getIterator();let x=xl(S),U=xl(N);for(;x||U;){let Z=!1,ee=!1;if(x&&U){const Y=_(x,U);Y<0?ee=!0:Y>0&&(Z=!0)}else x!=null?ee=!0:Z=!0;Z?(v(U),U=xl(N)):ee?(T(x),x=xl(S)):(x=xl(S),U=xl(N))}}(s,o,Ms,h=>{u.push(this.Wn(e,t,i,h))},h=>{u.push(this.Gn(e,t,i,h))}),z.waitFor(u)}Qn(e){let t=1;return Ml(e).te({index:BD,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(i,s,o)=>{o.done(),t=s.sequenceNumber+1}).next(()=>t)}createRange(e,t,i){i=i.sort((u,h)=>Ms(u,h)).filter((u,h,f)=>!h||Ms(u,f[h-1])!==0);const s=[];s.push(e);for(const u of i){const h=Ms(u,e),f=Ms(u,t);if(h===0)s[0]=e.In();else if(h>0&&f<0)s.push(u),s.push(u.In());else if(f>0)break}s.push(t);const o=[];for(let u=0;u<s.length;u+=2){if(this.zn(s[u],s[u+1]))return[];const h=[s[u].indexId,this.uid,s[u].arrayValue,s[u].directionalValue,um,[]],f=[s[u+1].indexId,this.uid,s[u+1].arrayValue,s[u+1].directionalValue,um,[]];o.push(IDBKeyRange.bound(h,f))}return o}zn(e,t){return Ms(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(HA)}getMinOffset(e,t){return z.mapArray(this.Sn(t),i=>this.Dn(e,i).next(s=>s||fe(44426))).next(HA)}}function jA(n){return $t(n,Jh)}function kl(n){return $t(n,dp)}function ih(n){return $t(n,uT)}function Ml(n){return $t(n,hp)}function HA(n){_e(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const s=n[i].indexState.offset;aT(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new si(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GA={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},GN=41943040;class vn{static withCacheSize(e){return new vn(e,vn.DEFAULT_COLLECTION_PERCENTILE,vn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KN(n,e,t){const i=n.store(xi),s=n.store(cu),o=[],u=IDBKeyRange.only(t.batchId);let h=0;const f=i.te({range:u},(_,v,T)=>(h++,T.delete()));o.push(f.next(()=>{_e(h===1,47070,{batchId:t.batchId})}));const p=[];for(const _ of t.mutations){const v=LD(e,_.key.path,t.batchId);o.push(s.delete(v)),p.push(_.key)}return z.waitFor(o).next(()=>p)}function Ep(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw fe(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */vn.DEFAULT_COLLECTION_PERCENTILE=10,vn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,vn.DEFAULT=new vn(GN,vn.DEFAULT_COLLECTION_PERCENTILE,vn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),vn.DISABLED=new vn(-1,0,0);class cg{constructor(e,t,i,s){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=s,this.jn={}}static bt(e,t,i,s){_e(e.uid!=="",64387);const o=e.isAuthenticated()?e.uid:"";return new cg(o,t,i,s)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Vs(e).te({index:ho,range:i},(s,o,u)=>{t=!1,u.done()}).next(()=>t)}addMutationBatch(e,t,i,s){const o=jl(e),u=Vs(e);return u.add({}).next(h=>{_e(typeof h=="number",49019);const f=new vT(h,t,i,s),p=function(S,N,x){const U=x.baseMutations.map(ee=>_p(S.wt,ee)),Z=x.mutations.map(ee=>_p(S.wt,ee));return{userId:N,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:U,mutations:Z}}(this.serializer,this.userId,f),_=[];let v=new rt((T,S)=>Se(T.canonicalString(),S.canonicalString()));for(const T of s){const S=LD(this.userId,T.key.path,h);v=v.add(T.key.path.popLast()),_.push(u.put(p)),_.push(o.put(S,X3))}return v.forEach(T=>{_.push(this.indexManager.addToCollectionParentIndex(e,T))}),e.addOnCommittedListener(()=>{this.jn[h]=f.keys()}),z.waitFor(_).next(()=>f)})}lookupMutationBatch(e,t){return Vs(e).get(t).next(i=>i?(_e(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),ro(this.serializer,i)):null)}Hn(e,t){return this.jn[t]?z.resolve(this.jn[t]):this.lookupMutationBatch(e,t).next(i=>{if(i){const s=i.keys();return this.jn[t]=s,s}return null})}getNextMutationBatchAfterBatchId(e,t){const i=t+1,s=IDBKeyRange.lowerBound([this.userId,i]);let o=null;return Vs(e).te({index:ho,range:s},(u,h,f)=>{h.userId===this.userId&&(_e(h.batchId>=i,47524,{Jn:i}),o=ro(this.serializer,h)),f.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=fo;return Vs(e).te({index:ho,range:t,reverse:!0},(s,o,u)=>{i=o.batchId,u.done()}).next(()=>i)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,fo],[this.userId,Number.POSITIVE_INFINITY]);return Vs(e).J(ho,t).next(i=>i.map(s=>ro(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=Im(this.userId,t.path),s=IDBKeyRange.lowerBound(i),o=[];return jl(e).te({range:s},(u,h,f)=>{const[p,_,v]=u,T=rr(_);if(p===this.userId&&t.path.isEqual(T))return Vs(e).get(v).next(S=>{if(!S)throw fe(61480,{Yn:u,batchId:v});_e(S.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:S.userId,batchId:v}),o.push(ro(this.serializer,S))});f.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new rt(Se);const s=[];return t.forEach(o=>{const u=Im(this.userId,o.path),h=IDBKeyRange.lowerBound(u),f=jl(e).te({range:h},(p,_,v)=>{const[T,S,N]=p,x=rr(S);T===this.userId&&o.path.isEqual(x)?i=i.add(N):v.done()});s.push(f)}),z.waitFor(s).next(()=>this.Zn(e,i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,s=i.length+1,o=Im(this.userId,i),u=IDBKeyRange.lowerBound(o);let h=new rt(Se);return jl(e).te({range:u},(f,p,_)=>{const[v,T,S]=f,N=rr(T);v===this.userId&&i.isPrefixOf(N)?N.length===s&&(h=h.add(S)):_.done()}).next(()=>this.Zn(e,h))}Zn(e,t){const i=[],s=[];return t.forEach(o=>{s.push(Vs(e).get(o).next(u=>{if(u===null)throw fe(35274,{batchId:o});_e(u.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:u.userId,batchId:o}),i.push(ro(this.serializer,u))}))}),z.waitFor(s).next(()=>i)}removeMutationBatch(e,t){return KN(e.he,this.userId,t).next(i=>(e.addOnCommittedListener(()=>{this.Xn(t.batchId)}),z.forEach(i,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}Xn(e){delete this.jn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return z.resolve();const i=IDBKeyRange.lowerBound(function(u){return[u]}(this.userId)),s=[];return jl(e).te({range:i},(o,u,h)=>{if(o[0]===this.userId){const f=rr(o[1]);s.push(f)}else h.done()}).next(()=>{_e(s.length===0,56720,{er:s.map(o=>o.canonicalString())})})})}containsKey(e,t){return YN(e,this.userId,t)}tr(e){return QN(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:fo,lastStreamToken:""})}}function YN(n,e,t){const i=Im(e,t.path),s=i[1],o=IDBKeyRange.lowerBound(i);let u=!1;return jl(n).te({range:o,ee:!0},(h,f,p)=>{const[_,v,T]=h;_===e&&v===s&&(u=!0),p.done()}).next(()=>u)}function Vs(n){return $t(n,xi)}function jl(n){return $t(n,cu)}function QN(n){return $t(n,$h)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(e){this.nr=e}next(){return this.nr+=2,this.nr}static rr(){return new Do(0)}static ir(){return new Do(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vF{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.sr(e).next(t=>{const i=new Do(t.highestTargetId);return t.highestTargetId=i.next(),this._r(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.sr(e).next(t=>Ee.fromTimestamp(new bt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.sr(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,i){return this.sr(e).next(s=>(s.highestListenSequenceNumber=t,i&&(s.lastRemoteSnapshotVersion=i.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this._r(e,s)))}addTargetData(e,t){return this.ar(e,t).next(()=>this.sr(e).next(i=>(i.targetCount+=1,this.ur(t,i),this._r(e,i))))}updateTargetData(e,t){return this.ar(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Vl(e).delete(t.targetId)).next(()=>this.sr(e)).next(i=>(_e(i.targetCount>0,8065),i.targetCount-=1,this._r(e,i)))}removeTargets(e,t,i){let s=0;const o=[];return Vl(e).te((u,h)=>{const f=ph(h);f.sequenceNumber<=t&&i.get(f.targetId)===null&&(s++,o.push(this.removeTargetData(e,f)))}).next(()=>z.waitFor(o)).next(()=>s)}forEachTarget(e,t){return Vl(e).te((i,s)=>{const o=ph(s);t(o)})}sr(e){return KA(e).get(cp).next(t=>(_e(t!==null,2888),t))}_r(e,t){return KA(e).put(cp,t)}ar(e,t){return Vl(e).put(zN(this.serializer,t))}ur(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.sr(e).next(t=>t.targetCount)}getTargetData(e,t){const i=Ao(t),s=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let o=null;return Vl(e).te({range:s,index:FD},(u,h,f)=>{const p=ph(h);Td(t,p.target)&&(o=p,f.done())}).next(()=>o)}addMatchingKeys(e,t,i){const s=[],o=qs(e);return t.forEach(u=>{const h=wn(u.path);s.push(o.put({targetId:i,path:h})),s.push(this.referenceDelegate.addReference(e,i,u))}),z.waitFor(s)}removeMatchingKeys(e,t,i){const s=qs(e);return z.forEach(t,o=>{const u=wn(o.path);return z.waitFor([s.delete([i,u]),this.referenceDelegate.removeReference(e,i,o)])})}removeMatchingKeysForTargetId(e,t){const i=qs(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(s)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),s=qs(e);let o=Pe();return s.te({range:i,ee:!0},(u,h,f)=>{const p=rr(u[1]),_=new de(p);o=o.add(_)}).next(()=>o)}containsKey(e,t){const i=wn(t.path),s=IDBKeyRange.bound([i],[ND(i)],!1,!0);let o=0;return qs(e).te({index:lT,ee:!0,range:s},([u,h],f,p)=>{u!==0&&(o++,p.done())}).next(()=>o>0)}Rt(e,t){return Vl(e).get(t).next(i=>i?ph(i):null)}}function Vl(n){return $t(n,hu)}function KA(n){return $t(n,mo)}function qs(n){return $t(n,du)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YA="LruGarbageCollector",WN=1048576;function QA([n,e],[t,i]){const s=Se(n,t);return s===0?Se(e,i):s}class EF{constructor(e){this.cr=e,this.buffer=new rt(QA),this.lr=0}hr(){return++this.lr}Pr(e){const t=[e,this.hr()];if(this.buffer.size<this.cr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();QA(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class $N{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Tr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ir(6e4)}stop(){this.Tr&&(this.Tr.cancel(),this.Tr=null)}get started(){return this.Tr!==null}Ir(e){ne(YA,`Garbage collection scheduled in ${e}ms`),this.Tr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Tr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ca(t)?ne(YA,"Ignoring IndexedDB error during garbage collection: ",t):await ua(t)}await this.Ir(3e5)})}}class TF{constructor(e,t){this.Er=e,this.params=t}calculateTargetCount(e,t){return this.Er.dr(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(t===0)return z.resolve(Fn.le);const i=new EF(t);return this.Er.forEachTarget(e,s=>i.Pr(s.sequenceNumber)).next(()=>this.Er.Ar(e,s=>i.Pr(s))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.Er.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Er.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ne("LruGarbageCollector","Garbage collection skipped; disabled"),z.resolve(GA)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(ne("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),GA):this.Rr(e,t))}getCacheSize(e){return this.Er.getCacheSize(e)}Rr(e,t){let i,s,o,u,h,f,p;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(v=>(v>this.params.maximumSequenceNumbersToCollect?(ne("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),s=this.params.maximumSequenceNumbersToCollect):s=v,u=Date.now(),this.nthSequenceNumber(e,s))).next(v=>(i=v,h=Date.now(),this.removeTargets(e,i,t))).next(v=>(o=v,f=Date.now(),this.removeOrphanedDocuments(e,i))).next(v=>(p=Date.now(),Fl()<=Be.DEBUG&&ne("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-_}ms
	Determined least recently used ${s} in `+(h-u)+`ms
	Removed ${o} targets in `+(f-h)+`ms
	Removed ${v} documents in `+(p-f)+`ms
Total Duration: ${p-_}ms`),z.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:o,documentsRemoved:v})))}}function XN(n,e){return new TF(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wF{constructor(e,t){this.db=e,this.garbageCollector=XN(this,t)}dr(e){const t=this.Vr(e);return this.db.getTargetCache().getTargetCount(e).next(i=>t.next(s=>i+s))}Vr(e){let t=0;return this.Ar(e,i=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Ar(e,t){return this.mr(e,(i,s)=>t(s))}addReference(e,t,i){return cm(e,i)}removeReference(e,t,i){return cm(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return cm(e,t)}gr(e,t){return function(s,o){let u=!1;return QN(s).ne(h=>YN(s,h,o).next(f=>(f&&(u=!0),z.resolve(!f)))).next(()=>u)}(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let o=0;return this.mr(e,(u,h)=>{if(h<=t){const f=this.gr(e,u).next(p=>{if(!p)return o++,i.getEntry(e,u).next(()=>(i.removeEntry(u,Ee.min()),qs(e).delete(function(v){return[0,wn(v.path)]}(u))))});s.push(f)}}).next(()=>z.waitFor(s)).next(()=>i.apply(e)).next(()=>o)}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return cm(e,t)}mr(e,t){const i=qs(e);let s,o=Fn.le;return i.te({index:lT},([u,h],{path:f,sequenceNumber:p})=>{u===0?(o!==Fn.le&&t(new de(rr(s)),o),o=p,s=f):o=Fn.le}).next(()=>{o!==Fn.le&&t(new de(rr(s)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function cm(n,e){return qs(n).put(function(i,s){return{targetId:0,path:wn(i.path),sequenceNumber:s}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JN{constructor(){this.changes=new is(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Dt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?z.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bF{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return Xa(e).put(i)}removeEntry(e,t,i){return Xa(e).delete(function(o,u){const h=o.path.toArray();return[h.slice(0,h.length-2),h[h.length-2],yp(u),h[h.length-1]]}(t,i))}updateMetadata(e,t){return this.getMetadata(e).next(i=>(i.byteSize+=t,this.pr(e,i)))}getEntry(e,t){let i=Dt.newInvalidDocument(t);return Xa(e).te({index:Sm,range:IDBKeyRange.only(rh(t))},(s,o)=>{i=this.yr(t,o)}).next(()=>i)}wr(e,t){let i={size:0,document:Dt.newInvalidDocument(t)};return Xa(e).te({index:Sm,range:IDBKeyRange.only(rh(t))},(s,o)=>{i={document:this.yr(t,o),size:Ep(o)}}).next(()=>i)}getEntries(e,t){let i=ei();return this.br(e,t,(s,o)=>{const u=this.yr(s,o);i=i.insert(s,u)}).next(()=>i)}Sr(e,t){let i=ei(),s=new mt(de.comparator);return this.br(e,t,(o,u)=>{const h=this.yr(o,u);i=i.insert(o,h),s=s.insert(o,Ep(u))}).next(()=>({documents:i,Dr:s}))}br(e,t,i){if(t.isEmpty())return z.resolve();let s=new rt(XA);t.forEach(f=>s=s.add(f));const o=IDBKeyRange.bound(rh(s.first()),rh(s.last())),u=s.getIterator();let h=u.getNext();return Xa(e).te({index:Sm,range:o},(f,p,_)=>{const v=de.fromSegments([...p.prefixPath,p.collectionGroup,p.documentId]);for(;h&&XA(h,v)<0;)i(h,null),h=u.getNext();h&&h.isEqual(v)&&(i(h,p),h=u.hasNext()?u.getNext():null),h?_.H(rh(h)):_.done()}).next(()=>{for(;h;)i(h,null),h=u.hasNext()?u.getNext():null})}getDocumentsMatchingQuery(e,t,i,s,o){const u=t.path,h=[u.popLast().toArray(),u.lastSegment(),yp(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],f=[u.popLast().toArray(),u.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Xa(e).J(IDBKeyRange.bound(h,f,!0)).next(p=>{o==null||o.incrementDocumentReadCount(p.length);let _=ei();for(const v of p){const T=this.yr(de.fromSegments(v.prefixPath.concat(v.collectionGroup,v.documentId)),v);T.isFoundDocument()&&(bd(t,T)||s.has(T.key))&&(_=_.insert(T.key,T))}return _})}getAllFromCollectionGroup(e,t,i,s){let o=ei();const u=$A(t,i),h=$A(t,si.max());return Xa(e).te({index:UD,range:IDBKeyRange.bound(u,h,!0)},(f,p,_)=>{const v=this.yr(de.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);o=o.insert(v.key,v),o.size===s&&_.done()}).next(()=>o)}newChangeBuffer(e){return new IF(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return WA(e).get(kv).next(t=>(_e(!!t,20021),t))}pr(e,t){return WA(e).put(kv,t)}yr(e,t){if(t){const i=uF(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(Ee.min())))return i}return Dt.newInvalidDocument(e)}}function ZN(n){return new bF(n)}class IF extends JN{constructor(e,t){super(),this.vr=e,this.trackRemovals=t,this.Cr=new is(i=>i.toString(),(i,s)=>i.isEqual(s))}applyChanges(e){const t=[];let i=0,s=new rt((o,u)=>Se(o.canonicalString(),u.canonicalString()));return this.changes.forEach((o,u)=>{const h=this.Cr.get(o);if(t.push(this.vr.removeEntry(e,o,h.readTime)),u.isValidDocument()){const f=PA(this.vr.serializer,u);s=s.add(o.path.popLast());const p=Ep(f);i+=p-h.size,t.push(this.vr.addEntry(e,o,f))}else if(i-=h.size,this.trackRemovals){const f=PA(this.vr.serializer,u.convertToNoDocument(Ee.min()));t.push(this.vr.addEntry(e,o,f))}}),s.forEach(o=>{t.push(this.vr.indexManager.addToCollectionParentIndex(e,o))}),t.push(this.vr.updateMetadata(e,i)),z.waitFor(t)}getFromCache(e,t){return this.vr.wr(e,t).next(i=>(this.Cr.set(t,{size:i.size,readTime:i.document.readTime}),i.document))}getAllFromCache(e,t){return this.vr.Sr(e,t).next(({documents:i,Dr:s})=>(s.forEach((o,u)=>{this.Cr.set(o,{size:u,readTime:i.get(o).readTime})}),i))}}function WA(n){return $t(n,Xh)}function Xa(n){return $t(n,up)}function rh(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function $A(n,e){const t=e.documentKey.path.toArray();return[n,yp(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function XA(n,e){const t=n.path.toArray(),i=e.path.toArray();let s=0;for(let o=0;o<t.length-2&&o<i.length-2;++o)if(s=Se(t[o],i[o]),s)return s;return s=Se(t.length,i.length),s||(s=Se(t[t.length-2],i[i.length-2]),s||Se(t[t.length-1],i[i.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SF{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eO{constructor(e,t,i,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=s}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(i=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(i!==null&&Nh(i.mutation,s,Bn.empty(),bt.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,Pe()).next(()=>i))}getLocalViewOfDocuments(e,t,i=Pe()){const s=sr();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,i).next(o=>{let u=fh();return o.forEach((h,f)=>{u=u.insert(h,f.overlayedDocument)}),u}))}getOverlayedDocuments(e,t){const i=sr();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,Pe()))}populateOverlays(e,t,i){const s=[];return i.forEach(o=>{t.has(o)||s.push(o)}),this.documentOverlayCache.getOverlays(e,s).next(o=>{o.forEach((u,h)=>{t.set(u,h)})})}computeViews(e,t,i,s){let o=ei();const u=Dh(),h=function(){return Dh()}();return t.forEach((f,p)=>{const _=i.get(p.key);s.has(p.key)&&(_===void 0||_.mutation instanceof rs)?o=o.insert(p.key,p):_!==void 0?(u.set(p.key,_.mutation.getFieldMask()),Nh(_.mutation,p,_.mutation.getFieldMask(),bt.now())):u.set(p.key,Bn.empty())}),this.recalculateAndSaveOverlays(e,o).next(f=>(f.forEach((p,_)=>u.set(p,_)),t.forEach((p,_)=>{var v;return h.set(p,new SF(_,(v=u.get(p))!==null&&v!==void 0?v:null))}),h))}recalculateAndSaveOverlays(e,t){const i=Dh();let s=new mt((u,h)=>u-h),o=Pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(u=>{for(const h of u)h.keys().forEach(f=>{const p=t.get(f);if(p===null)return;let _=i.get(f)||Bn.empty();_=h.applyToLocalView(p,_),i.set(f,_);const v=(s.get(h.batchId)||Pe()).add(f);s=s.insert(h.batchId,v)})}).next(()=>{const u=[],h=s.getReverseIterator();for(;h.hasNext();){const f=h.getNext(),p=f.key,_=f.value,v=gN();_.forEach(T=>{if(!o.has(T)){const S=bN(t.get(T),i.get(T));S!==null&&v.set(T,S),o=o.add(T)}}),u.push(this.documentOverlayCache.saveOverlays(e,p,v))}return z.waitFor(u)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,s){return function(u){return de.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):cN(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,s):this.getDocumentsMatchingCollectionQuery(e,t,i,s)}getNextDocuments(e,t,i,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,s).next(o=>{const u=s-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,s-o.size):z.resolve(sr());let h=uu,f=o;return u.next(p=>z.forEach(p,(_,v)=>(h<v.largestBatchId&&(h=v.largestBatchId),o.get(_)?z.resolve():this.remoteDocumentCache.getEntry(e,_).next(T=>{f=f.insert(_,T)}))).next(()=>this.populateOverlays(e,p,o)).next(()=>this.computeViews(e,f,p,Pe())).next(_=>({batchId:h,changes:pN(_)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new de(t)).next(i=>{let s=fh();return i.isFoundDocument()&&(s=s.insert(i.key,i)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,i,s){const o=t.collectionGroup;let u=fh();return this.indexManager.getCollectionParents(e,o).next(h=>z.forEach(h,f=>{const p=function(v,T){return new ku(T,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)}(t,f.child(o));return this.getDocumentsMatchingCollectionQuery(e,p,i,s).next(_=>{_.forEach((v,T)=>{u=u.insert(v,T)})})}).next(()=>u))}getDocumentsMatchingCollectionQuery(e,t,i,s){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(u=>(o=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,o,s))).next(u=>{o.forEach((f,p)=>{const _=p.getKey();u.get(_)===null&&(u=u.insert(_,Dt.newInvalidDocument(_)))});let h=fh();return u.forEach((f,p)=>{const _=o.get(f);_!==void 0&&Nh(_.mutation,p,Bn.empty(),bt.now()),bd(t,p)&&(h=h.insert(f,p))}),h})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AF{constructor(e){this.serializer=e,this.Fr=new Map,this.Mr=new Map}getBundleMetadata(e,t){return z.resolve(this.Fr.get(t))}saveBundleMetadata(e,t){return this.Fr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:kn(s.createTime)}}(t)),z.resolve()}getNamedQuery(e,t){return z.resolve(this.Mr.get(t))}saveNamedQuery(e,t){return this.Mr.set(t.name,function(s){return{name:s.name,query:qN(s.bundledQuery),readTime:kn(s.readTime)}}(t)),z.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RF{constructor(){this.overlays=new mt(de.comparator),this.Or=new Map}getOverlay(e,t){return z.resolve(this.overlays.get(t))}getOverlays(e,t){const i=sr();return z.forEach(t,s=>this.getOverlay(e,s).next(o=>{o!==null&&i.set(s,o)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((s,o)=>{this.St(e,t,o)}),z.resolve()}removeOverlaysForBatchId(e,t,i){const s=this.Or.get(i);return s!==void 0&&(s.forEach(o=>this.overlays=this.overlays.remove(o)),this.Or.delete(i)),z.resolve()}getOverlaysForCollection(e,t,i){const s=sr(),o=t.length+1,u=new de(t.child("")),h=this.overlays.getIteratorFrom(u);for(;h.hasNext();){const f=h.getNext().value,p=f.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===o&&f.largestBatchId>i&&s.set(f.getKey(),f)}return z.resolve(s)}getOverlaysForCollectionGroup(e,t,i,s){let o=new mt((p,_)=>p-_);const u=this.overlays.getIterator();for(;u.hasNext();){const p=u.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>i){let _=o.get(p.largestBatchId);_===null&&(_=sr(),o=o.insert(p.largestBatchId,_)),_.set(p.getKey(),p)}}const h=sr(),f=o.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach((p,_)=>h.set(p,_)),!(h.size()>=s)););return z.resolve(h)}St(e,t,i){const s=this.overlays.get(i.key);if(s!==null){const u=this.Or.get(s.largestBatchId).delete(i.key);this.Or.set(s.largestBatchId,u)}this.overlays=this.overlays.insert(i.key,new TT(t,i));let o=this.Or.get(t);o===void 0&&(o=Pe(),this.Or.set(t,o)),this.Or.set(t,o.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CF{constructor(){this.sessionToken=Vt.EMPTY_BYTE_STRING}getSessionToken(e){return z.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,z.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AT{constructor(){this.Nr=new rt(sn.Br),this.Lr=new rt(sn.kr)}isEmpty(){return this.Nr.isEmpty()}addReference(e,t){const i=new sn(e,t);this.Nr=this.Nr.add(i),this.Lr=this.Lr.add(i)}qr(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.Qr(new sn(e,t))}$r(e,t){e.forEach(i=>this.removeReference(i,t))}Ur(e){const t=new de(new Je([])),i=new sn(t,e),s=new sn(t,e+1),o=[];return this.Lr.forEachInRange([i,s],u=>{this.Qr(u),o.push(u.key)}),o}Kr(){this.Nr.forEach(e=>this.Qr(e))}Qr(e){this.Nr=this.Nr.delete(e),this.Lr=this.Lr.delete(e)}Wr(e){const t=new de(new Je([])),i=new sn(t,e),s=new sn(t,e+1);let o=Pe();return this.Lr.forEachInRange([i,s],u=>{o=o.add(u.key)}),o}containsKey(e){const t=new sn(e,0),i=this.Nr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class sn{constructor(e,t){this.key=e,this.Gr=t}static Br(e,t){return de.comparator(e.key,t.key)||Se(e.Gr,t.Gr)}static kr(e,t){return Se(e.Gr,t.Gr)||de.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DF{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Jn=1,this.zr=new rt(sn.Br)}checkEmpty(e){return z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,s){const o=this.Jn;this.Jn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new vT(o,t,i,s);this.mutationQueue.push(u);for(const h of s)this.zr=this.zr.add(new sn(h.key,o)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return z.resolve(u)}lookupMutationBatch(e,t){return z.resolve(this.jr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,s=this.Hr(i),o=s<0?0:s;return z.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return z.resolve(this.mutationQueue.length===0?fo:this.Jn-1)}getAllMutationBatches(e){return z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new sn(t,0),s=new sn(t,Number.POSITIVE_INFINITY),o=[];return this.zr.forEachInRange([i,s],u=>{const h=this.jr(u.Gr);o.push(h)}),z.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new rt(Se);return t.forEach(s=>{const o=new sn(s,0),u=new sn(s,Number.POSITIVE_INFINITY);this.zr.forEachInRange([o,u],h=>{i=i.add(h.Gr)})}),z.resolve(this.Jr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,s=i.length+1;let o=i;de.isDocumentKey(o)||(o=o.child(""));const u=new sn(new de(o),0);let h=new rt(Se);return this.zr.forEachWhile(f=>{const p=f.key.path;return!!i.isPrefixOf(p)&&(p.length===s&&(h=h.add(f.Gr)),!0)},u),z.resolve(this.Jr(h))}Jr(e){const t=[];return e.forEach(i=>{const s=this.jr(i);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){_e(this.Yr(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.zr;return z.forEach(t.mutations,s=>{const o=new sn(s.key,t.batchId);return i=i.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.zr=i})}Xn(e){}containsKey(e,t){const i=new sn(t,0),s=this.zr.firstAfterOrEqual(i);return z.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,z.resolve()}Yr(e,t){return this.Hr(e)}Hr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}jr(e){const t=this.Hr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NF{constructor(e){this.Zr=e,this.docs=function(){return new mt(de.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,s=this.docs.get(i),o=s?s.size:0,u=this.Zr(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:u}),this.size+=u-o,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return z.resolve(i?i.document.mutableCopy():Dt.newInvalidDocument(t))}getEntries(e,t){let i=ei();return t.forEach(s=>{const o=this.docs.get(s);i=i.insert(s,o?o.document.mutableCopy():Dt.newInvalidDocument(s))}),z.resolve(i)}getDocumentsMatchingQuery(e,t,i,s){let o=ei();const u=t.path,h=new de(u.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(h);for(;f.hasNext();){const{key:p,value:{document:_}}=f.getNext();if(!u.isPrefixOf(p.path))break;p.path.length>u.length+1||aT(xD(_),i)<=0||(s.has(_.key)||bd(t,_))&&(o=o.insert(_.key,_.mutableCopy()))}return z.resolve(o)}getAllFromCollectionGroup(e,t,i,s){fe(9500)}Xr(e,t){return z.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new OF(this)}getSize(e){return z.resolve(this.size)}}class OF extends JN{constructor(e){super(),this.vr=e}applyChanges(e){const t=[];return this.changes.forEach((i,s)=>{s.isValidDocument()?t.push(this.vr.addEntry(e,s)):this.vr.removeEntry(i)}),z.waitFor(t)}getFromCache(e,t){return this.vr.getEntry(e,t)}getAllFromCache(e,t){return this.vr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xF{constructor(e){this.persistence=e,this.ei=new is(t=>Ao(t),Td),this.lastRemoteSnapshotVersion=Ee.min(),this.highestTargetId=0,this.ti=0,this.ni=new AT,this.targetCount=0,this.ri=Do.rr()}forEachTarget(e,t){return this.ei.forEach((i,s)=>t(s)),z.resolve()}getLastRemoteSnapshotVersion(e){return z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return z.resolve(this.ti)}allocateTargetId(e){return this.highestTargetId=this.ri.next(),z.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ti&&(this.ti=t),z.resolve()}ar(e){this.ei.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ri=new Do(t),this.highestTargetId=t),e.sequenceNumber>this.ti&&(this.ti=e.sequenceNumber)}addTargetData(e,t){return this.ar(t),this.targetCount+=1,z.resolve()}updateTargetData(e,t){return this.ar(t),z.resolve()}removeTargetData(e,t){return this.ei.delete(t.target),this.ni.Ur(t.targetId),this.targetCount-=1,z.resolve()}removeTargets(e,t,i){let s=0;const o=[];return this.ei.forEach((u,h)=>{h.sequenceNumber<=t&&i.get(h.targetId)===null&&(this.ei.delete(u),o.push(this.removeMatchingKeysForTargetId(e,h.targetId)),s++)}),z.waitFor(o).next(()=>s)}getTargetCount(e){return z.resolve(this.targetCount)}getTargetData(e,t){const i=this.ei.get(t)||null;return z.resolve(i)}addMatchingKeys(e,t,i){return this.ni.qr(t,i),z.resolve()}removeMatchingKeys(e,t,i){this.ni.$r(t,i);const s=this.persistence.referenceDelegate,o=[];return s&&t.forEach(u=>{o.push(s.markPotentiallyOrphaned(e,u))}),z.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.ni.Ur(t),z.resolve()}getMatchingKeysForTargetId(e,t){const i=this.ni.Wr(t);return z.resolve(i)}containsKey(e,t){return z.resolve(this.ni.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RT{constructor(e,t){this.ii={},this.overlays={},this.si=new Fn(0),this.oi=!1,this.oi=!0,this._i=new CF,this.referenceDelegate=e(this),this.ai=new xF(this),this.indexManager=new _F,this.remoteDocumentCache=function(s){return new NF(s)}(i=>this.referenceDelegate.ui(i)),this.serializer=new BN(t),this.ci=new AF(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.oi=!1,Promise.resolve()}get started(){return this.oi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new RF,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ii[e.toKey()];return i||(i=new DF(t,this.referenceDelegate),this.ii[e.toKey()]=i),i}getGlobalsCache(){return this._i}getTargetCache(){return this.ai}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.ci}runTransaction(e,t,i){ne("MemoryPersistence","Starting transaction:",e);const s=new PF(this.si.next());return this.referenceDelegate.li(),i(s).next(o=>this.referenceDelegate.hi(s).next(()=>o)).toPromise().then(o=>(s.raiseOnCommittedEvent(),o))}Pi(e,t){return z.or(Object.values(this.ii).map(i=>()=>i.containsKey(e,t)))}}class PF extends kD{constructor(e){super(),this.currentSequenceNumber=e}}class hg{constructor(e){this.persistence=e,this.Ti=new AT,this.Ii=null}static Ei(e){return new hg(e)}get di(){if(this.Ii)return this.Ii;throw fe(60996)}addReference(e,t,i){return this.Ti.addReference(i,t),this.di.delete(i.toString()),z.resolve()}removeReference(e,t,i){return this.Ti.removeReference(i,t),this.di.add(i.toString()),z.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),z.resolve()}removeTarget(e,t){this.Ti.Ur(t.targetId).forEach(s=>this.di.add(s.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(o=>this.di.add(o.toString()))}).next(()=>i.removeTargetData(e,t))}li(){this.Ii=new Set}hi(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return z.forEach(this.di,i=>{const s=de.fromPath(i);return this.Ai(e,s).next(o=>{o||t.removeEntry(s,Ee.min())})}).next(()=>(this.Ii=null,t.apply(e)))}updateLimboDocument(e,t){return this.Ai(e,t).next(i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())})}ui(e){return 0}Ai(e,t){return z.or([()=>z.resolve(this.Ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Pi(e,t)])}}class Tp{constructor(e,t){this.persistence=e,this.Ri=new is(i=>wn(i.path),(i,s)=>i.isEqual(s)),this.garbageCollector=XN(this,t)}static Ei(e,t){return new Tp(e,t)}li(){}hi(e){return z.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.Vr(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>t.next(s=>i+s))}Vr(e){let t=0;return this.Ar(e,i=>{t++}).next(()=>t)}Ar(e,t){return z.forEach(this.Ri,(i,s)=>this.gr(e,i,s).next(o=>o?z.resolve():t(s)))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const s=this.persistence.getRemoteDocumentCache(),o=s.newChangeBuffer();return s.Xr(e,u=>this.gr(e,u,t).next(h=>{h||(i++,o.removeEntry(u,Ee.min()))})).next(()=>o.apply(e)).next(()=>i)}markPotentiallyOrphaned(e,t){return this.Ri.set(t,e.currentSequenceNumber),z.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.Ri.set(i,e.currentSequenceNumber),z.resolve()}removeReference(e,t,i){return this.Ri.set(i,e.currentSequenceNumber),z.resolve()}updateLimboDocument(e,t){return this.Ri.set(t,e.currentSequenceNumber),z.resolve()}ui(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Rm(e.data.value)),t}gr(e,t,i){return z.or([()=>this.persistence.Pi(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.Ri.get(t);return z.resolve(s!==void 0&&s>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kF{constructor(e){this.serializer=e}q(e,t,i,s){const o=new Zp("createOrUpgrade",t);i<1&&s>=1&&(function(f){f.createObjectStore(Ed)}(e),function(f){f.createObjectStore($h,{keyPath:$3}),f.createObjectStore(xi,{keyPath:uA,autoIncrement:!0}).createIndex(ho,cA,{unique:!0}),f.createObjectStore(cu)}(e),JA(e),function(f){f.createObjectStore(to)}(e));let u=z.resolve();return i<3&&s>=3&&(i!==0&&(function(f){f.deleteObjectStore(du),f.deleteObjectStore(hu),f.deleteObjectStore(mo)}(e),JA(e)),u=u.next(()=>function(f){const p=f.store(mo),_={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ee.min().toTimestamp(),targetCount:0};return p.put(cp,_)}(o))),i<4&&s>=4&&(i!==0&&(u=u.next(()=>function(f,p){return p.store(xi).J().next(v=>{f.deleteObjectStore(xi),f.createObjectStore(xi,{keyPath:uA,autoIncrement:!0}).createIndex(ho,cA,{unique:!0});const T=p.store(xi),S=v.map(N=>T.put(N));return z.waitFor(S)})}(e,o))),u=u.next(()=>{(function(f){f.createObjectStore(fu,{keyPath:s9})})(e)})),i<5&&s>=5&&(u=u.next(()=>this.Vi(o))),i<6&&s>=6&&(u=u.next(()=>(function(f){f.createObjectStore(Xh)}(e),this.mi(o)))),i<7&&s>=7&&(u=u.next(()=>this.fi(o))),i<8&&s>=8&&(u=u.next(()=>this.gi(e,o))),i<9&&s>=9&&(u=u.next(()=>{(function(f){f.objectStoreNames.contains("remoteDocumentChanges")&&f.deleteObjectStore("remoteDocumentChanges")})(e)})),i<10&&s>=10&&(u=u.next(()=>this.pi(o))),i<11&&s>=11&&(u=u.next(()=>{(function(f){f.createObjectStore(tg,{keyPath:a9})})(e),function(f){f.createObjectStore(ng,{keyPath:o9})}(e)})),i<12&&s>=12&&(u=u.next(()=>{(function(f){const p=f.createObjectStore(ig,{keyPath:m9});p.createIndex(Vv,p9,{unique:!1}),p.createIndex(qD,g9,{unique:!1})})(e)})),i<13&&s>=13&&(u=u.next(()=>function(f){const p=f.createObjectStore(up,{keyPath:J3});p.createIndex(Sm,Z3),p.createIndex(UD,e9)}(e)).next(()=>this.yi(e,o)).next(()=>e.deleteObjectStore(to))),i<14&&s>=14&&(u=u.next(()=>this.wi(e,o))),i<15&&s>=15&&(u=u.next(()=>function(f){f.createObjectStore(uT,{keyPath:l9,autoIncrement:!0}).createIndex(Mv,u9,{unique:!1}),f.createObjectStore(hp,{keyPath:c9}).createIndex(BD,h9,{unique:!1}),f.createObjectStore(dp,{keyPath:d9}).createIndex(zD,f9,{unique:!1})}(e))),i<16&&s>=16&&(u=u.next(()=>{t.objectStore(hp).clear()}).next(()=>{t.objectStore(dp).clear()})),i<17&&s>=17&&(u=u.next(()=>{(function(f){f.createObjectStore(cT,{keyPath:_9})})(e)})),u}mi(e){let t=0;return e.store(to).te((i,s)=>{t+=Ep(s)}).next(()=>{const i={byteSize:t};return e.store(Xh).put(kv,i)})}Vi(e){const t=e.store($h),i=e.store(xi);return t.J().next(s=>z.forEach(s,o=>{const u=IDBKeyRange.bound([o.userId,fo],[o.userId,o.lastAcknowledgedBatchId]);return i.J(ho,u).next(h=>z.forEach(h,f=>{_e(f.userId===o.userId,18650,"Cannot process batch from unexpected user",{batchId:f.batchId});const p=ro(this.serializer,f);return KN(e,o.userId,p).next(()=>{})}))}))}fi(e){const t=e.store(du),i=e.store(to);return e.store(mo).get(cp).next(s=>{const o=[];return i.te((u,h)=>{const f=new Je(u),p=function(v){return[0,wn(v)]}(f);o.push(t.get(p).next(_=>_?z.resolve():(v=>t.put({targetId:0,path:wn(v),sequenceNumber:s.highestListenSequenceNumber}))(f)))}).next(()=>z.waitFor(o))})}gi(e,t){e.createObjectStore(Jh,{keyPath:r9});const i=t.store(Jh),s=new ST,o=u=>{if(s.add(u)){const h=u.lastSegment(),f=u.popLast();return i.put({collectionId:h,parent:wn(f)})}};return t.store(to).te({ee:!0},(u,h)=>{const f=new Je(u);return o(f.popLast())}).next(()=>t.store(cu).te({ee:!0},([u,h,f],p)=>{const _=rr(h);return o(_.popLast())}))}pi(e){const t=e.store(hu);return t.te((i,s)=>{const o=ph(s),u=zN(this.serializer,o);return t.put(u)})}yi(e,t){const i=t.store(to),s=[];return i.te((o,u)=>{const h=t.store(up),f=function(v){return v.document?new de(Je.fromString(v.document.name).popFirst(5)):v.noDocument?de.fromSegments(v.noDocument.path):v.unknownDocument?de.fromSegments(v.unknownDocument.path):fe(36783)}(u).path.toArray(),p={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:u.readTime||[0,0],unknownDocument:u.unknownDocument,noDocument:u.noDocument,document:u.document,hasCommittedMutations:!!u.hasCommittedMutations};s.push(h.put(p))}).next(()=>z.waitFor(s))}wi(e,t){const i=t.store(xi),s=ZN(this.serializer),o=new RT(hg.Ei,this.serializer.wt);return i.J().next(u=>{const h=new Map;return u.forEach(f=>{var p;let _=(p=h.get(f.userId))!==null&&p!==void 0?p:Pe();ro(this.serializer,f).keys().forEach(v=>_=_.add(v)),h.set(f.userId,_)}),z.forEach(h,(f,p)=>{const _=new yn(p),v=ug.bt(this.serializer,_),T=o.getIndexManager(_),S=cg.bt(_,this.serializer,T,o.referenceDelegate);return new eO(s,S,v,T).recalculateAndSaveOverlaysForDocumentKeys(new Lv(t,Fn.le),f).next()})})}}function JA(n){n.createObjectStore(du,{keyPath:n9}).createIndex(lT,i9,{unique:!0}),n.createObjectStore(hu,{keyPath:"targetId"}).createIndex(FD,t9,{unique:!0}),n.createObjectStore(mo)}const Ls="IndexedDbPersistence",Wy=18e5,$y=5e3,Xy="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",MF="main";class CT{constructor(e,t,i,s,o,u,h,f,p,_,v=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.bi=o,this.window=u,this.document=h,this.Si=p,this.Di=_,this.Ci=v,this.si=null,this.oi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fi=null,this.inForeground=!1,this.Mi=null,this.xi=null,this.Oi=Number.NEGATIVE_INFINITY,this.Ni=T=>Promise.resolve(),!CT.C())throw new ue(Q.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new wF(this,s),this.Bi=t+MF,this.serializer=new BN(f),this.Li=new $s(this.Bi,this.Ci,new kF(this.serializer)),this._i=new hF,this.ai=new vF(this.referenceDelegate,this.serializer),this.remoteDocumentCache=ZN(this.serializer),this.ci=new cF,this.window&&this.window.localStorage?this.ki=this.window.localStorage:(this.ki=null,_===!1&&Mt(Ls,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.qi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ue(Q.FAILED_PRECONDITION,Xy);return this.Qi(),this.$i(),this.Ui(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.ai.getHighestSequenceNumber(e))}).then(e=>{this.si=new Fn(e,this.Si)}).then(()=>{this.oi=!0}).catch(e=>(this.Li&&this.Li.close(),Promise.reject(e)))}Ki(e){return this.Ni=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Li.U(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.bi.enqueueAndForget(async()=>{this.started&&await this.qi()}))}qi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>hm(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Wi(e).next(t=>{t||(this.isPrimary=!1,this.bi.enqueueRetryable(()=>this.Ni(!1)))})}).next(()=>this.Gi(e)).next(t=>this.isPrimary&&!t?this.zi(e).next(()=>!1):!!t&&this.ji(e).next(()=>!0))).catch(e=>{if(ca(e))return ne(Ls,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ne(Ls,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.bi.enqueueRetryable(()=>this.Ni(e)),this.isPrimary=e})}Wi(e){return sh(e).get(Ol).next(t=>z.resolve(this.Hi(t)))}Ji(e){return hm(e).delete(this.clientId)}async Yi(){if(this.isPrimary&&!this.Zi(this.Oi,Wy)){this.Oi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const i=$t(t,fu);return i.J().next(s=>{const o=this.Xi(s,Wy),u=s.filter(h=>o.indexOf(h)===-1);return z.forEach(u,h=>i.delete(h.clientId)).next(()=>u)})}).catch(()=>[]);if(this.ki)for(const t of e)this.ki.removeItem(this.es(t.clientId))}}Ui(){this.xi=this.bi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.qi().then(()=>this.Yi()).then(()=>this.Ui()))}Hi(e){return!!e&&e.ownerId===this.clientId}Gi(e){return this.Di?z.resolve(!0):sh(e).get(Ol).next(t=>{if(t!==null&&this.Zi(t.leaseTimestampMs,$y)&&!this.ts(t.ownerId)){if(this.Hi(t)&&this.networkEnabled)return!0;if(!this.Hi(t)){if(!t.allowTabSynchronization)throw new ue(Q.FAILED_PRECONDITION,Xy);return!1}}return!(!this.networkEnabled||!this.inForeground)||hm(e).J().next(i=>this.Xi(i,$y).find(s=>{if(this.clientId!==s.clientId){const o=!this.networkEnabled&&s.networkEnabled,u=!this.inForeground&&s.inForeground,h=this.networkEnabled===s.networkEnabled;if(o||u&&h)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&ne(Ls,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.oi=!1,this.ns(),this.xi&&(this.xi.cancel(),this.xi=null),this.rs(),this.ss(),await this.Li.runTransaction("shutdown","readwrite",[Ed,fu],e=>{const t=new Lv(e,Fn.le);return this.zi(t).next(()=>this.Ji(t))}),this.Li.close(),this._s()}Xi(e,t){return e.filter(i=>this.Zi(i.updateTimeMs,t)&&!this.ts(i.clientId))}us(){return this.runTransaction("getActiveClients","readonly",e=>hm(e).J().next(t=>this.Xi(t,Wy).map(i=>i.clientId)))}get started(){return this.oi}getGlobalsCache(){return this._i}getMutationQueue(e,t){return cg.bt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.ai}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new yF(e,this.serializer.wt.databaseId)}getDocumentOverlayCache(e){return ug.bt(this.serializer,e)}getBundleCache(){return this.ci}runTransaction(e,t,i){ne(Ls,"Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",o=function(f){return f===17?E9:f===16?v9:f===15?hT:f===14?GD:f===13?HD:f===12?y9:f===11?jD:void fe(60245)}(this.Ci);let u;return this.Li.runTransaction(e,s,o,h=>(u=new Lv(h,this.si?this.si.next():Fn.le),t==="readwrite-primary"?this.Wi(u).next(f=>!!f||this.Gi(u)).next(f=>{if(!f)throw Mt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.bi.enqueueRetryable(()=>this.Ni(!1)),new ue(Q.FAILED_PRECONDITION,PD);return i(u)}).next(f=>this.ji(u).next(()=>f)):this.cs(u).next(()=>i(u)))).then(h=>(u.raiseOnCommittedEvent(),h))}cs(e){return sh(e).get(Ol).next(t=>{if(t!==null&&this.Zi(t.leaseTimestampMs,$y)&&!this.ts(t.ownerId)&&!this.Hi(t)&&!(this.Di||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ue(Q.FAILED_PRECONDITION,Xy)})}ji(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return sh(e).put(Ol,t)}static C(){return $s.C()}zi(e){const t=sh(e);return t.get(Ol).next(i=>this.Hi(i)?(ne(Ls,"Releasing primary lease."),t.delete(Ol)):z.resolve())}Zi(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(Mt(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Qi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Mi=()=>{this.bi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.qi()))},this.document.addEventListener("visibilitychange",this.Mi),this.inForeground=this.document.visibilityState==="visible")}rs(){this.Mi&&(this.document.removeEventListener("visibilitychange",this.Mi),this.Mi=null)}$i(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Fi=()=>{this.ns();const t=/(?:Version|Mobile)\/1[456]/;QR()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.bi.enterRestrictedMode(!0),this.bi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Fi))}ss(){this.Fi&&(this.window.removeEventListener("pagehide",this.Fi),this.Fi=null)}ts(e){var t;try{const i=((t=this.ki)===null||t===void 0?void 0:t.getItem(this.es(e)))!==null;return ne(Ls,`Client '${e}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return Mt(Ls,"Failed to get zombied client id.",i),!1}}ns(){if(this.ki)try{this.ki.setItem(this.es(this.clientId),String(Date.now()))}catch(e){Mt("Failed to set zombie client id.",e)}}_s(){if(this.ki)try{this.ki.removeItem(this.es(this.clientId))}catch{}}es(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function sh(n){return $t(n,Ed)}function hm(n){return $t(n,fu)}function tO(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DT{constructor(e,t,i,s){this.targetId=e,this.fromCache=t,this.ls=i,this.hs=s}static Ps(e,t){let i=Pe(),s=Pe();for(const o of t.docChanges)switch(o.type){case 0:i=i.add(o.doc.key);break;case 1:s=s.add(o.doc.key)}return new DT(e,t.fromCache,i,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VF{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nO{constructor(){this.Ts=!1,this.Is=!1,this.Es=100,this.ds=function(){return QR()?8:MD(Qt())>0?6:4}()}initialize(e,t){this.As=e,this.indexManager=t,this.Ts=!0}getDocumentsMatchingQuery(e,t,i,s){const o={result:null};return this.Rs(e,t).next(u=>{o.result=u}).next(()=>{if(!o.result)return this.Vs(e,t,s,i).next(u=>{o.result=u})}).next(()=>{if(o.result)return;const u=new VF;return this.fs(e,t,u).next(h=>{if(o.result=h,this.Is)return this.gs(e,t,u,h.size)})}).next(()=>o.result)}gs(e,t,i,s){return i.documentReadCount<this.Es?(Fl()<=Be.DEBUG&&ne("QueryEngine","SDK will not create cache indexes for query:",Bl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Es,"documents"),z.resolve()):(Fl()<=Be.DEBUG&&ne("QueryEngine","Query:",Bl(t),"scans",i.documentReadCount,"local documents and returns",s,"documents as results."),i.documentReadCount>this.ds*s?(Fl()<=Be.DEBUG&&ne("QueryEngine","The SDK decides to create cache indexes for query:",Bl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ii(t))):z.resolve())}Rs(e,t){if(bA(t))return z.resolve(null);let i=ii(t);return this.indexManager.getIndexType(e,i).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=Hv(t,null,"F"),i=ii(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(o=>{const u=Pe(...o);return this.As.getDocuments(e,u).next(h=>this.indexManager.getMinOffset(e,i).next(f=>{const p=this.ps(t,h);return this.ys(t,p,u,f.readTime)?this.Rs(e,Hv(t,null,"F")):this.ws(e,p,t,f)}))})))}Vs(e,t,i,s){return bA(t)||s.isEqual(Ee.min())?z.resolve(null):this.As.getDocuments(e,i).next(o=>{const u=this.ps(t,o);return this.ys(t,u,i,s)?z.resolve(null):(Fl()<=Be.DEBUG&&ne("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Bl(t)),this.ws(e,u,t,OD(s,uu)).next(h=>h))})}ps(e,t){let i=new rt(fN(e));return t.forEach((s,o)=>{bd(e,o)&&(i=i.add(o))}),i}ys(e,t,i,s){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(s)>0)}fs(e,t,i){return Fl()<=Be.DEBUG&&ne("QueryEngine","Using full collection scan to execute query:",Bl(t)),this.As.getDocumentsMatchingQuery(e,t,si.min(),i)}ws(e,t,i,s){return this.As.getDocumentsMatchingQuery(e,i,s).next(o=>(t.forEach(u=>{o=o.insert(u.key,u)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NT="LocalStore",LF=3e8;class UF{constructor(e,t,i,s){this.persistence=e,this.bs=t,this.serializer=s,this.Ss=new mt(Se),this.Ds=new is(o=>Ao(o),Td),this.vs=new Map,this.Cs=e.getRemoteDocumentCache(),this.ai=e.getTargetCache(),this.ci=e.getBundleCache(),this.Fs(i)}Fs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new eO(this.Cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Cs.setIndexManager(this.indexManager),this.bs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ss))}}function iO(n,e,t,i){return new UF(n,e,t,i)}async function rO(n,e){const t=ge(n);return await t.persistence.runTransaction("Handle user change","readonly",i=>{let s;return t.mutationQueue.getAllMutationBatches(i).next(o=>(s=o,t.Fs(e),t.mutationQueue.getAllMutationBatches(i))).next(o=>{const u=[],h=[];let f=Pe();for(const p of s){u.push(p.batchId);for(const _ of p.mutations)f=f.add(_.key)}for(const p of o){h.push(p.batchId);for(const _ of p.mutations)f=f.add(_.key)}return t.localDocuments.getDocuments(i,f).next(p=>({Ms:p,removedBatchIds:u,addedBatchIds:h}))})})}function FF(n,e){const t=ge(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const s=e.batch.keys(),o=t.Cs.newChangeBuffer({trackRemovals:!0});return function(h,f,p,_){const v=p.batch,T=v.keys();let S=z.resolve();return T.forEach(N=>{S=S.next(()=>_.getEntry(f,N)).next(x=>{const U=p.docVersions.get(N);_e(U!==null,48541),x.version.compareTo(U)<0&&(v.applyToRemoteDocument(x,p),x.isValidDocument()&&(x.setReadTime(p.commitVersion),_.addEntry(x)))})}),S.next(()=>h.mutationQueue.removeMutationBatch(f,v))}(t,i,e,o).next(()=>o.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(h){let f=Pe();for(let p=0;p<h.mutationResults.length;++p)h.mutationResults[p].transformResults.length>0&&(f=f.add(h.batch.mutations[p].key));return f}(e))).next(()=>t.localDocuments.getDocuments(i,s))})}function sO(n){const e=ge(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.ai.getLastRemoteSnapshotVersion(t))}function BF(n,e){const t=ge(n),i=e.snapshotVersion;let s=t.Ss;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const u=t.Cs.newChangeBuffer({trackRemovals:!0});s=t.Ss;const h=[];e.targetChanges.forEach((_,v)=>{const T=s.get(v);if(!T)return;h.push(t.ai.removeMatchingKeys(o,_.removedDocuments,v).next(()=>t.ai.addMatchingKeys(o,_.addedDocuments,v)));let S=T.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(v)!==null?S=S.withResumeToken(Vt.EMPTY_BYTE_STRING,Ee.min()).withLastLimboFreeSnapshotVersion(Ee.min()):_.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(_.resumeToken,i)),s=s.insert(v,S),function(x,U,Z){return x.resumeToken.approximateByteSize()===0||U.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=LF?!0:Z.addedDocuments.size+Z.modifiedDocuments.size+Z.removedDocuments.size>0}(T,S,_)&&h.push(t.ai.updateTargetData(o,S))});let f=ei(),p=Pe();if(e.documentUpdates.forEach(_=>{e.resolvedLimboDocuments.has(_)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(o,_))}),h.push(zF(o,u,e.documentUpdates).next(_=>{f=_.xs,p=_.Os})),!i.isEqual(Ee.min())){const _=t.ai.getLastRemoteSnapshotVersion(o).next(v=>t.ai.setTargetsMetadata(o,o.currentSequenceNumber,i));h.push(_)}return z.waitFor(h).next(()=>u.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,f,p)).next(()=>f)}).then(o=>(t.Ss=s,o))}function zF(n,e,t){let i=Pe(),s=Pe();return t.forEach(o=>i=i.add(o)),e.getEntries(n,i).next(o=>{let u=ei();return t.forEach((h,f)=>{const p=o.get(h);f.isFoundDocument()!==p.isFoundDocument()&&(s=s.add(h)),f.isNoDocument()&&f.version.isEqual(Ee.min())?(e.removeEntry(h,f.readTime),u=u.insert(h,f)):!p.isValidDocument()||f.version.compareTo(p.version)>0||f.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(f),u=u.insert(h,f)):ne(NT,"Ignoring outdated watch update for ",h,". Current version:",p.version," Watch version:",f.version)}),{xs:u,Os:s}})}function qF(n,e){const t=ge(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=fo),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function wp(n,e){const t=ge(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let s;return t.ai.getTargetData(i,e).next(o=>o?(s=o,z.resolve(s)):t.ai.allocateTargetId(i).next(u=>(s=new jr(e,u,"TargetPurposeListen",i.currentSequenceNumber),t.ai.addTargetData(i,s).next(()=>s))))}).then(i=>{const s=t.Ss.get(i.targetId);return(s===null||i.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ss=t.Ss.insert(i.targetId,i),t.Ds.set(e,i.targetId)),i})}async function wu(n,e,t){const i=ge(n),s=i.Ss.get(e),o=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",o,u=>i.persistence.referenceDelegate.removeTarget(u,s))}catch(u){if(!ca(u))throw u;ne(NT,`Failed to update sequence numbers for target ${e}: ${u}`)}i.Ss=i.Ss.remove(e),i.Ds.delete(s.target)}function Jv(n,e,t){const i=ge(n);let s=Ee.min(),o=Pe();return i.persistence.runTransaction("Execute query","readwrite",u=>function(f,p,_){const v=ge(f),T=v.Ds.get(_);return T!==void 0?z.resolve(v.Ss.get(T)):v.ai.getTargetData(p,_)}(i,u,ii(e)).next(h=>{if(h)return s=h.lastLimboFreeSnapshotVersion,i.ai.getMatchingKeysForTargetId(u,h.targetId).next(f=>{o=f})}).next(()=>i.bs.getDocumentsMatchingQuery(u,e,t?s:Ee.min(),t?o:Pe())).next(h=>(lO(i,dN(e),h),{documents:h,Ns:o})))}function aO(n,e){const t=ge(n),i=ge(t.ai),s=t.Ss.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",o=>i.Rt(o,e).next(u=>u?u.target:null))}function oO(n,e){const t=ge(n),i=t.vs.get(e)||Ee.min();return t.persistence.runTransaction("Get new document changes","readonly",s=>t.Cs.getAllFromCollectionGroup(s,e,OD(i,uu),Number.MAX_SAFE_INTEGER)).then(s=>(lO(t,e,s),s))}function lO(n,e,t){let i=n.vs.get(e)||Ee.min();t.forEach((s,o)=>{o.readTime.compareTo(i)>0&&(i=o.readTime)}),n.vs.set(e,i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uO="firestore_clients";function ZA(n,e){return`${uO}_${n}_${e}`}const cO="firestore_mutations";function eR(n,e,t){let i=`${cO}_${n}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}const hO="firestore_targets";function Jy(n,e){return`${hO}_${n}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nr="SharedClientState";class bp{constructor(e,t,i,s){this.user=e,this.batchId=t,this.state=i,this.error=s}static qs(e,t,i){const s=JSON.parse(i);let o,u=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return u&&s.error&&(u=typeof s.error.message=="string"&&typeof s.error.code=="string",u&&(o=new ue(s.error.code,s.error.message))),u?new bp(e,t,s.state,o):(Mt(nr,`Failed to parse mutation state for ID '${t}': ${i}`),null)}Qs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Oh{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static qs(e,t){const i=JSON.parse(t);let s,o=typeof i=="object"&&["not-current","current","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new ue(i.error.code,i.error.message))),o?new Oh(e,i.state,s):(Mt(nr,`Failed to parse target state for ID '${e}': ${t}`),null)}Qs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ip{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static qs(e,t){const i=JSON.parse(t);let s=typeof i=="object"&&i.activeTargetIds instanceof Array,o=gT();for(let u=0;s&&u<i.activeTargetIds.length;++u)s=VD(i.activeTargetIds[u]),o=o.add(i.activeTargetIds[u]);return s?new Ip(e,o):(Mt(nr,`Failed to parse client data for instance '${e}': ${t}`),null)}}class OT{constructor(e,t){this.clientId=e,this.onlineState=t}static qs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new OT(t.clientId,t.onlineState):(Mt(nr,`Failed to parse online state: ${e}`),null)}}class Zv{constructor(){this.activeTargetIds=gT()}$s(e){this.activeTargetIds=this.activeTargetIds.add(e)}Us(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Qs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Zy{constructor(e,t,i,s,o){this.window=e,this.bi=t,this.persistenceKey=i,this.Ks=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Ws=this.Gs.bind(this),this.zs=new mt(Se),this.started=!1,this.js=[];const u=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Hs=ZA(this.persistenceKey,this.Ks),this.Js=function(f){return`firestore_sequence_number_${f}`}(this.persistenceKey),this.zs=this.zs.insert(this.Ks,new Zv),this.Ys=new RegExp(`^${uO}_${u}_([^_]*)$`),this.Zs=new RegExp(`^${cO}_${u}_(\\d+)(?:_(.*))?$`),this.Xs=new RegExp(`^${hO}_${u}_(\\d+)$`),this.eo=function(f){return`firestore_online_state_${f}`}(this.persistenceKey),this.no=function(f){return`firestore_bundle_loaded_v2_${f}`}(this.persistenceKey),this.window.addEventListener("storage",this.Ws)}static C(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.us();for(const i of e){if(i===this.Ks)continue;const s=this.getItem(ZA(this.persistenceKey,i));if(s){const o=Ip.qs(i,s);o&&(this.zs=this.zs.insert(o.clientId,o))}}this.ro();const t=this.storage.getItem(this.eo);if(t){const i=this.io(t);i&&this.so(i)}for(const i of this.js)this.Gs(i);this.js=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.Js,JSON.stringify(e))}getAllActiveQueryTargets(){return this.oo(this.zs)}isActiveQueryTarget(e){let t=!1;return this.zs.forEach((i,s)=>{s.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this._o(e,"pending")}updateMutationState(e,t,i){this._o(e,t,i),this.ao(e)}addLocalQueryTarget(e,t=!0){let i="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(Jy(this.persistenceKey,e));if(s){const o=Oh.qs(e,s);o&&(i=o.state)}}return t&&this.uo.$s(e),this.ro(),i}removeLocalQueryTarget(e){this.uo.Us(e),this.ro()}isLocalQueryTarget(e){return this.uo.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Jy(this.persistenceKey,e))}updateQueryState(e,t,i){this.co(e,t,i)}handleUserChange(e,t,i){t.forEach(s=>{this.ao(s)}),this.currentUser=e,i.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.lo(e)}notifyBundleLoaded(e){this.ho(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Ws),this.removeItem(this.Hs),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return ne(nr,"READ",e,t),t}setItem(e,t){ne(nr,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){ne(nr,"REMOVE",e),this.storage.removeItem(e)}Gs(e){const t=e;if(t.storageArea===this.storage){if(ne(nr,"EVENT",t.key,t.newValue),t.key===this.Hs)return void Mt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.bi.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.Ys.test(t.key)){if(t.newValue==null){const i=this.Po(t.key);return this.To(i,null)}{const i=this.Io(t.key,t.newValue);if(i)return this.To(i.clientId,i)}}else if(this.Zs.test(t.key)){if(t.newValue!==null){const i=this.Eo(t.key,t.newValue);if(i)return this.Ao(i)}}else if(this.Xs.test(t.key)){if(t.newValue!==null){const i=this.Ro(t.key,t.newValue);if(i)return this.Vo(i)}}else if(t.key===this.eo){if(t.newValue!==null){const i=this.io(t.newValue);if(i)return this.so(i)}}else if(t.key===this.Js){const i=function(o){let u=Fn.le;if(o!=null)try{const h=JSON.parse(o);_e(typeof h=="number",30636,{mo:o}),u=h}catch(h){Mt(nr,"Failed to read sequence number from WebStorage",h)}return u}(t.newValue);i!==Fn.le&&this.sequenceNumberHandler(i)}else if(t.key===this.no){const i=this.fo(t.newValue);await Promise.all(i.map(s=>this.syncEngine.po(s)))}}}else this.js.push(t)})}}get uo(){return this.zs.get(this.Ks)}ro(){this.setItem(this.Hs,this.uo.Qs())}_o(e,t,i){const s=new bp(this.currentUser,e,t,i),o=eR(this.persistenceKey,this.currentUser,e);this.setItem(o,s.Qs())}ao(e){const t=eR(this.persistenceKey,this.currentUser,e);this.removeItem(t)}lo(e){const t={clientId:this.Ks,onlineState:e};this.storage.setItem(this.eo,JSON.stringify(t))}co(e,t,i){const s=Jy(this.persistenceKey,e),o=new Oh(e,t,i);this.setItem(s,o.Qs())}ho(e){const t=JSON.stringify(Array.from(e));this.setItem(this.no,t)}Po(e){const t=this.Ys.exec(e);return t?t[1]:null}Io(e,t){const i=this.Po(e);return Ip.qs(i,t)}Eo(e,t){const i=this.Zs.exec(e),s=Number(i[1]),o=i[2]!==void 0?i[2]:null;return bp.qs(new yn(o),s,t)}Ro(e,t){const i=this.Xs.exec(e),s=Number(i[1]);return Oh.qs(s,t)}io(e){return OT.qs(e)}fo(e){return JSON.parse(e)}async Ao(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.yo(e.batchId,e.state,e.error);ne(nr,`Ignoring mutation for non-active user ${e.user.uid}`)}Vo(e){return this.syncEngine.wo(e.targetId,e.state,e.error)}To(e,t){const i=t?this.zs.insert(e,t):this.zs.remove(e),s=this.oo(this.zs),o=this.oo(i),u=[],h=[];return o.forEach(f=>{s.has(f)||u.push(f)}),s.forEach(f=>{o.has(f)||h.push(f)}),this.syncEngine.bo(u,h).then(()=>{this.zs=i})}so(e){this.zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}oo(e){let t=gT();return e.forEach((i,s)=>{t=t.unionWith(s.activeTargetIds)}),t}}class dO{constructor(){this.So=new Zv,this.Do={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.So.$s(e),this.Do[e]||"not-current"}updateQueryState(e,t,i){this.Do[e]=t}removeLocalQueryTarget(e){this.So.Us(e)}isLocalQueryTarget(e){return this.So.activeTargetIds.has(e)}clearQueryState(e){delete this.Do[e]}getAllActiveQueryTargets(){return this.So.activeTargetIds}isActiveQueryTarget(e){return this.So.activeTargetIds.has(e)}start(){return this.So=new Zv,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jF{vo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tR="ConnectivityMonitor";class nR{constructor(){this.Co=()=>this.Fo(),this.Mo=()=>this.xo(),this.Oo=[],this.No()}vo(e){this.Oo.push(e)}shutdown(){window.removeEventListener("online",this.Co),window.removeEventListener("offline",this.Mo)}No(){window.addEventListener("online",this.Co),window.addEventListener("offline",this.Mo)}Fo(){ne(tR,"Network connectivity changed: AVAILABLE");for(const e of this.Oo)e(0)}xo(){ne(tR,"Network connectivity changed: UNAVAILABLE");for(const e of this.Oo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dm=null;function eE(){return dm===null?dm=function(){return 268435456+Math.round(2147483648*Math.random())}():dm++,"0x"+dm.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ev="RestConnection",HF={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class GF{get Bo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Lo=t+"://"+e.host,this.ko=`projects/${i}/databases/${s}`,this.qo=this.databaseId.database===fp?`project_id=${i}`:`project_id=${i}&database_id=${s}`}Qo(e,t,i,s,o){const u=eE(),h=this.$o(e,t.toUriEncodedString());ne(ev,`Sending RPC '${e}' ${u}:`,h,i);const f={"google-cloud-resource-prefix":this.ko,"x-goog-request-params":this.qo};this.Uo(f,s,o);const{host:p}=new URL(h),_=Zr(p);return this.Ko(e,h,f,i,_).then(v=>(ne(ev,`Received RPC '${e}' ${u}: `,v),v),v=>{throw Yh(ev,`RPC '${e}' ${u} failed with error: `,v,"url: ",h,"request:",i),v})}Wo(e,t,i,s,o,u){return this.Qo(e,t,i,s,o)}Uo(e,t,i){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Pu}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((s,o)=>e[o]=s),i&&i.headers.forEach((s,o)=>e[o]=s)}$o(e,t){const i=HF[e];return`${this.Lo}/v1/${t}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KF{constructor(e){this.Go=e.Go,this.zo=e.zo}jo(e){this.Ho=e}Jo(e){this.Yo=e}Zo(e){this.Xo=e}onMessage(e){this.e_=e}close(){this.zo()}send(e){this.Go(e)}t_(){this.Ho()}n_(){this.Yo()}r_(e){this.Xo(e)}i_(e){this.e_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _n="WebChannelConnection";class YF extends GF{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ko(e,t,i,s,o){const u=eE();return new Promise((h,f)=>{const p=new wD;p.setWithCredentials(!0),p.listenOnce(bD.COMPLETE,()=>{try{switch(p.getLastErrorCode()){case wm.NO_ERROR:const v=p.getResponseJson();ne(_n,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(v)),h(v);break;case wm.TIMEOUT:ne(_n,`RPC '${e}' ${u} timed out`),f(new ue(Q.DEADLINE_EXCEEDED,"Request time out"));break;case wm.HTTP_ERROR:const T=p.getStatus();if(ne(_n,`RPC '${e}' ${u} failed with status:`,T,"response text:",p.getResponseText()),T>0){let S=p.getResponseJson();Array.isArray(S)&&(S=S[0]);const N=S==null?void 0:S.error;if(N&&N.status&&N.message){const x=function(Z){const ee=Z.toLowerCase().replace(/_/g,"-");return Object.values(Q).indexOf(ee)>=0?ee:Q.UNKNOWN}(N.status);f(new ue(x,N.message))}else f(new ue(Q.UNKNOWN,"Server responded with status "+p.getStatus()))}else f(new ue(Q.UNAVAILABLE,"Connection failed."));break;default:fe(9055,{s_:e,streamId:u,o_:p.getLastErrorCode(),__:p.getLastError()})}}finally{ne(_n,`RPC '${e}' ${u} completed.`)}});const _=JSON.stringify(s);ne(_n,`RPC '${e}' ${u} sending request:`,s),p.send(t,"POST",_,i,15)})}a_(e,t,i){const s=eE(),o=[this.Lo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=AD(),h=SD(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(f.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(f.useFetchStreams=!0),this.Uo(f.initMessageHeaders,t,i),f.encodeInitMessageHeaders=!0;const _=o.join("");ne(_n,`Creating RPC '${e}' stream ${s}: ${_}`,f);const v=u.createWebChannel(_,f);let T=!1,S=!1;const N=new KF({Go:U=>{S?ne(_n,`Not sending because RPC '${e}' stream ${s} is closed:`,U):(T||(ne(_n,`Opening RPC '${e}' stream ${s} transport.`),v.open(),T=!0),ne(_n,`RPC '${e}' stream ${s} sending:`,U),v.send(U))},zo:()=>v.close()}),x=(U,Z,ee)=>{U.listen(Z,Y=>{try{ee(Y)}catch(ie){setTimeout(()=>{throw ie},0)}})};return x(v,dh.EventType.OPEN,()=>{S||(ne(_n,`RPC '${e}' stream ${s} transport opened.`),N.t_())}),x(v,dh.EventType.CLOSE,()=>{S||(S=!0,ne(_n,`RPC '${e}' stream ${s} transport closed`),N.r_())}),x(v,dh.EventType.ERROR,U=>{S||(S=!0,Yh(_n,`RPC '${e}' stream ${s} transport errored. Name:`,U.name,"Message:",U.message),N.r_(new ue(Q.UNAVAILABLE,"The operation could not be completed")))}),x(v,dh.EventType.MESSAGE,U=>{var Z;if(!S){const ee=U.data[0];_e(!!ee,16349);const Y=ee,ie=(Y==null?void 0:Y.error)||((Z=Y[0])===null||Z===void 0?void 0:Z.error);if(ie){ne(_n,`RPC '${e}' stream ${s} received error:`,ie);const se=ie.status;let me=function(C){const M=zt[C];if(M!==void 0)return AN(M)}(se),O=ie.message;me===void 0&&(me=Q.INTERNAL,O="Unknown error status: "+se+" with message "+ie.message),S=!0,N.r_(new ue(me,O)),v.close()}else ne(_n,`RPC '${e}' stream ${s} received:`,ee),N.i_(ee)}}),x(h,ID.STAT_EVENT,U=>{U.stat===Ov.PROXY?ne(_n,`RPC '${e}' stream ${s} detected buffering proxy`):U.stat===Ov.NOPROXY&&ne(_n,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{N.n_()},0),N}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fO(){return typeof window<"u"?window:null}function Om(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dg(n){return new Z9(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mO{constructor(e,t,i=1e3,s=1.5,o=6e4){this.bi=e,this.timerId=t,this.u_=i,this.c_=s,this.l_=o,this.h_=0,this.P_=null,this.T_=Date.now(),this.reset()}reset(){this.h_=0}I_(){this.h_=this.l_}E_(e){this.cancel();const t=Math.floor(this.h_+this.d_()),i=Math.max(0,Date.now()-this.T_),s=Math.max(0,t-i);s>0&&ne("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.h_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.P_=this.bi.enqueueAfterDelay(this.timerId,s,()=>(this.T_=Date.now(),e())),this.h_*=this.c_,this.h_<this.u_&&(this.h_=this.u_),this.h_>this.l_&&(this.h_=this.l_)}A_(){this.P_!==null&&(this.P_.skipDelay(),this.P_=null)}cancel(){this.P_!==null&&(this.P_.cancel(),this.P_=null)}d_(){return(Math.random()-.5)*this.h_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iR="PersistentStream";class pO{constructor(e,t,i,s,o,u,h,f){this.bi=e,this.R_=i,this.V_=s,this.connection=o,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=h,this.listener=f,this.state=0,this.m_=0,this.f_=null,this.g_=null,this.stream=null,this.p_=0,this.y_=new mO(e,t)}w_(){return this.state===1||this.state===5||this.b_()}b_(){return this.state===2||this.state===3}start(){this.p_=0,this.state!==4?this.auth():this.S_()}async stop(){this.w_()&&await this.close(0)}D_(){this.state=0,this.y_.reset()}v_(){this.b_()&&this.f_===null&&(this.f_=this.bi.enqueueAfterDelay(this.R_,6e4,()=>this.C_()))}F_(e){this.M_(),this.stream.send(e)}async C_(){if(this.b_())return this.close(0)}M_(){this.f_&&(this.f_.cancel(),this.f_=null)}x_(){this.g_&&(this.g_.cancel(),this.g_=null)}async close(e,t){this.M_(),this.x_(),this.y_.cancel(),this.m_++,e!==4?this.y_.reset():t&&t.code===Q.RESOURCE_EXHAUSTED?(Mt(t.toString()),Mt("Using maximum backoff delay to prevent overloading the backend."),this.y_.I_()):t&&t.code===Q.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.O_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Zo(t)}O_(){}auth(){this.state=1;const e=this.N_(this.m_),t=this.m_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,s])=>{this.m_===t&&this.B_(i,s)},i=>{e(()=>{const s=new ue(Q.UNKNOWN,"Fetching auth token failed: "+i.message);return this.L_(s)})})}B_(e,t){const i=this.N_(this.m_);this.stream=this.k_(e,t),this.stream.jo(()=>{i(()=>this.listener.jo())}),this.stream.Jo(()=>{i(()=>(this.state=2,this.g_=this.bi.enqueueAfterDelay(this.V_,1e4,()=>(this.b_()&&(this.state=3),Promise.resolve())),this.listener.Jo()))}),this.stream.Zo(s=>{i(()=>this.L_(s))}),this.stream.onMessage(s=>{i(()=>++this.p_==1?this.q_(s):this.onNext(s))})}S_(){this.state=5,this.y_.E_(async()=>{this.state=0,this.start()})}L_(e){return ne(iR,`close with error: ${e}`),this.stream=null,this.close(4,e)}N_(e){return t=>{this.bi.enqueueAndForget(()=>this.m_===e?t():(ne(iR,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class QF extends pO{constructor(e,t,i,s,o,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,s,u),this.serializer=o}k_(e,t){return this.connection.a_("Listen",e,t)}q_(e){return this.onNext(e)}onNext(e){this.y_.reset();const t=nF(this.serializer,e),i=function(o){if(!("targetChange"in o))return Ee.min();const u=o.targetChange;return u.targetIds&&u.targetIds.length?Ee.min():u.readTime?kn(u.readTime):Ee.min()}(e);return this.listener.Q_(t,i)}U_(e){const t={};t.database=Yv(this.serializer),t.addTarget=function(o,u){let h;const f=u.target;if(h=mp(f)?{documents:kN(o,f)}:{query:MN(o,f).gt},h.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){h.resumeToken=DN(o,u.resumeToken);const p=Gv(o,u.expectedCount);p!==null&&(h.expectedCount=p)}else if(u.snapshotVersion.compareTo(Ee.min())>0){h.readTime=Tu(o,u.snapshotVersion.toTimestamp());const p=Gv(o,u.expectedCount);p!==null&&(h.expectedCount=p)}return h}(this.serializer,e);const i=rF(this.serializer,e);i&&(t.labels=i),this.F_(t)}K_(e){const t={};t.database=Yv(this.serializer),t.removeTarget=e,this.F_(t)}}class WF extends pO{constructor(e,t,i,s,o,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,s,u),this.serializer=o}get W_(){return this.p_>0}start(){this.lastStreamToken=void 0,super.start()}O_(){this.W_&&this.G_([])}k_(e,t){return this.connection.a_("Write",e,t)}q_(e){return _e(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,_e(!e.writeResults||e.writeResults.length===0,55816),this.listener.z_()}onNext(e){_e(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.y_.reset();const t=iF(e.writeResults,e.commitTime),i=kn(e.commitTime);return this.listener.j_(i,t)}H_(){const e={};e.database=Yv(this.serializer),this.F_(e)}G_(e){const t={streamToken:this.lastStreamToken,writes:e.map(i=>_p(this.serializer,i))};this.F_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $F{}class XF extends $F{constructor(e,t,i,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=s,this.J_=!1}Y_(){if(this.J_)throw new ue(Q.FAILED_PRECONDITION,"The client has already been terminated.")}Qo(e,t,i,s){return this.Y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,u])=>this.connection.Qo(e,Kv(t,i),s,o,u)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ue(Q.UNKNOWN,o.toString())})}Wo(e,t,i,s,o){return this.Y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([u,h])=>this.connection.Wo(e,Kv(t,i),s,u,h,o)).catch(u=>{throw u.name==="FirebaseError"?(u.code===Q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new ue(Q.UNKNOWN,u.toString())})}terminate(){this.J_=!0,this.connection.terminate()}}class JF{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.Z_=0,this.X_=null,this.ea=!0}ta(){this.Z_===0&&(this.na("Unknown"),this.X_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.X_=null,this.ra("Backend didn't respond within 10 seconds."),this.na("Offline"),Promise.resolve())))}ia(e){this.state==="Online"?this.na("Unknown"):(this.Z_++,this.Z_>=1&&(this.sa(),this.ra(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.na("Offline")))}set(e){this.sa(),this.Z_=0,e==="Online"&&(this.ea=!1),this.na(e)}na(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ra(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ea?(Mt(t),this.ea=!1):ne("OnlineStateTracker",t)}sa(){this.X_!==null&&(this.X_.cancel(),this.X_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const No="RemoteStore";class ZF{constructor(e,t,i,s,o){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.oa=[],this._a=new Map,this.aa=new Set,this.ua=[],this.ca=o,this.ca.vo(u=>{i.enqueueAndForget(async()=>{Lo(this)&&(ne(No,"Restarting streams for network reachability change."),await async function(f){const p=ge(f);p.aa.add(4),await Ad(p),p.la.set("Unknown"),p.aa.delete(4),await fg(p)}(this))})}),this.la=new JF(i,s)}}async function fg(n){if(Lo(n))for(const e of n.ua)await e(!0)}async function Ad(n){for(const e of n.ua)await e(!1)}function mg(n,e){const t=ge(n);t._a.has(e.targetId)||(t._a.set(e.targetId,e),kT(t)?PT(t):Lu(t).b_()&&xT(t,e))}function bu(n,e){const t=ge(n),i=Lu(t);t._a.delete(e),i.b_()&&gO(t,e),t._a.size===0&&(i.b_()?i.v_():Lo(t)&&t.la.set("Unknown"))}function xT(n,e){if(n.ha.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ee.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Lu(n).U_(e)}function gO(n,e){n.ha.Ke(e),Lu(n).K_(e)}function PT(n){n.ha=new W9({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>n._a.get(e)||null,Pt:()=>n.datastore.serializer.databaseId}),Lu(n).start(),n.la.ta()}function kT(n){return Lo(n)&&!Lu(n).w_()&&n._a.size>0}function Lo(n){return ge(n).aa.size===0}function _O(n){n.ha=void 0}async function eB(n){n.la.set("Online")}async function tB(n){n._a.forEach((e,t)=>{xT(n,e)})}async function nB(n,e){_O(n),kT(n)?(n.la.ia(e),PT(n)):n.la.set("Unknown")}async function iB(n,e,t){if(n.la.set("Online"),e instanceof CN&&e.state===2&&e.cause)try{await async function(s,o){const u=o.cause;for(const h of o.targetIds)s._a.has(h)&&(await s.remoteSyncer.rejectListen(h,u),s._a.delete(h),s.ha.removeTarget(h))}(n,e)}catch(i){ne(No,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Sp(n,i)}else if(e instanceof Nm?n.ha.Xe(e):e instanceof RN?n.ha.ot(e):n.ha.nt(e),!t.isEqual(Ee.min()))try{const i=await sO(n.localStore);t.compareTo(i)>=0&&await function(o,u){const h=o.ha.It(u);return h.targetChanges.forEach((f,p)=>{if(f.resumeToken.approximateByteSize()>0){const _=o._a.get(p);_&&o._a.set(p,_.withResumeToken(f.resumeToken,u))}}),h.targetMismatches.forEach((f,p)=>{const _=o._a.get(f);if(!_)return;o._a.set(f,_.withResumeToken(Vt.EMPTY_BYTE_STRING,_.snapshotVersion)),gO(o,f);const v=new jr(_.target,f,p,_.sequenceNumber);xT(o,v)}),o.remoteSyncer.applyRemoteEvent(h)}(n,t)}catch(i){ne(No,"Failed to raise snapshot:",i),await Sp(n,i)}}async function Sp(n,e,t){if(!ca(e))throw e;n.aa.add(1),await Ad(n),n.la.set("Offline"),t||(t=()=>sO(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{ne(No,"Retrying IndexedDB access"),await t(),n.aa.delete(1),await fg(n)})}function yO(n,e){return e().catch(t=>Sp(n,t,e))}async function Vu(n){const e=ge(n),t=ia(e);let i=e.oa.length>0?e.oa[e.oa.length-1].batchId:fo;for(;rB(e);)try{const s=await qF(e.localStore,i);if(s===null){e.oa.length===0&&t.v_();break}i=s.batchId,sB(e,s)}catch(s){await Sp(e,s)}vO(e)&&EO(e)}function rB(n){return Lo(n)&&n.oa.length<10}function sB(n,e){n.oa.push(e);const t=ia(n);t.b_()&&t.W_&&t.G_(e.mutations)}function vO(n){return Lo(n)&&!ia(n).w_()&&n.oa.length>0}function EO(n){ia(n).start()}async function aB(n){ia(n).H_()}async function oB(n){const e=ia(n);for(const t of n.oa)e.G_(t.mutations)}async function lB(n,e,t){const i=n.oa.shift(),s=ET.from(i,e,t);await yO(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await Vu(n)}async function uB(n,e){e&&ia(n).W_&&await async function(i,s){if(function(u){return Y9(u)&&u!==Q.ABORTED}(s.code)){const o=i.oa.shift();ia(i).D_(),await yO(i,()=>i.remoteSyncer.rejectFailedWrite(o.batchId,s)),await Vu(i)}}(n,e),vO(n)&&EO(n)}async function rR(n,e){const t=ge(n);t.asyncQueue.verifyOperationInProgress(),ne(No,"RemoteStore received new credentials");const i=Lo(t);t.aa.add(3),await Ad(t),i&&t.la.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.aa.delete(3),await fg(t)}async function tE(n,e){const t=ge(n);e?(t.aa.delete(2),await fg(t)):e||(t.aa.add(2),await Ad(t),t.la.set("Unknown"))}function Lu(n){return n.Pa||(n.Pa=function(t,i,s){const o=ge(t);return o.Y_(),new QF(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)}(n.datastore,n.asyncQueue,{jo:eB.bind(null,n),Jo:tB.bind(null,n),Zo:nB.bind(null,n),Q_:iB.bind(null,n)}),n.ua.push(async e=>{e?(n.Pa.D_(),kT(n)?PT(n):n.la.set("Unknown")):(await n.Pa.stop(),_O(n))})),n.Pa}function ia(n){return n.Ta||(n.Ta=function(t,i,s){const o=ge(t);return o.Y_(),new WF(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)}(n.datastore,n.asyncQueue,{jo:()=>Promise.resolve(),Jo:aB.bind(null,n),Zo:uB.bind(null,n),z_:oB.bind(null,n),j_:lB.bind(null,n)}),n.ua.push(async e=>{e?(n.Ta.D_(),await Vu(n)):(await n.Ta.stop(),n.oa.length>0&&(ne(No,`Stopping write stream with ${n.oa.length} pending writes`),n.oa=[]))})),n.Ta}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MT{constructor(e,t,i,s,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=s,this.removalCallback=o,this.deferred=new lr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(u=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,s,o){const u=Date.now()+i,h=new MT(e,t,u,s,o);return h.start(i),h}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ue(Q.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function VT(n,e){if(Mt("AsyncQueue",`${e}: ${n}`),ca(n))return new ue(Q.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eu{static emptySet(e){return new eu(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||de.comparator(t.key,i.key):(t,i)=>de.comparator(t.key,i.key),this.keyedMap=fh(),this.sortedSet=new mt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof eu)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,o=i.getNext().key;if(!s.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new eu;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sR{constructor(){this.Ia=new mt(de.comparator)}track(e){const t=e.doc.key,i=this.Ia.get(t);i?e.type!==0&&i.type===3?this.Ia=this.Ia.insert(t,e):e.type===3&&i.type!==1?this.Ia=this.Ia.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.Ia=this.Ia.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.Ia=this.Ia.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.Ia=this.Ia.remove(t):e.type===1&&i.type===2?this.Ia=this.Ia.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.Ia=this.Ia.insert(t,{type:2,doc:e.doc}):fe(63341,{Vt:e,Ea:i}):this.Ia=this.Ia.insert(t,e)}da(){const e=[];return this.Ia.inorderTraversal((t,i)=>{e.push(i)}),e}}class Iu{constructor(e,t,i,s,o,u,h,f,p){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=s,this.mutatedKeys=o,this.fromCache=u,this.syncStateChanged=h,this.excludesMetadataChanges=f,this.hasCachedResults=p}static fromInitialDocuments(e,t,i,s,o){const u=[];return t.forEach(h=>{u.push({type:0,doc:h})}),new Iu(e,t,eu.emptySet(t),u,i,s,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ag(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==i[s].type||!t[s].doc.isEqual(i[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cB{constructor(){this.Aa=void 0,this.Ra=[]}Va(){return this.Ra.some(e=>e.ma())}}class hB{constructor(){this.queries=aR(),this.onlineState="Unknown",this.fa=new Set}terminate(){(function(t,i){const s=ge(t),o=s.queries;s.queries=aR(),o.forEach((u,h)=>{for(const f of h.Ra)f.onError(i)})})(this,new ue(Q.ABORTED,"Firestore shutting down"))}}function aR(){return new is(n=>hN(n),ag)}async function LT(n,e){const t=ge(n);let i=3;const s=e.query;let o=t.queries.get(s);o?!o.Va()&&e.ma()&&(i=2):(o=new cB,i=e.ma()?0:1);try{switch(i){case 0:o.Aa=await t.onListen(s,!0);break;case 1:o.Aa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(u){const h=VT(u,`Initialization of query '${Bl(e.query)}' failed`);return void e.onError(h)}t.queries.set(s,o),o.Ra.push(e),e.ga(t.onlineState),o.Aa&&e.pa(o.Aa)&&FT(t)}async function UT(n,e){const t=ge(n),i=e.query;let s=3;const o=t.queries.get(i);if(o){const u=o.Ra.indexOf(e);u>=0&&(o.Ra.splice(u,1),o.Ra.length===0?s=e.ma()?0:1:!o.Va()&&e.ma()&&(s=2))}switch(s){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function dB(n,e){const t=ge(n);let i=!1;for(const s of e){const o=s.query,u=t.queries.get(o);if(u){for(const h of u.Ra)h.pa(s)&&(i=!0);u.Aa=s}}i&&FT(t)}function fB(n,e,t){const i=ge(n),s=i.queries.get(e);if(s)for(const o of s.Ra)o.onError(t);i.queries.delete(e)}function FT(n){n.fa.forEach(e=>{e.next()})}var nE,oR;(oR=nE||(nE={})).ya="default",oR.Cache="cache";class BT{constructor(e,t,i){this.query=e,this.wa=t,this.ba=!1,this.Sa=null,this.onlineState="Unknown",this.options=i||{}}pa(e){if(!this.options.includeMetadataChanges){const i=[];for(const s of e.docChanges)s.type!==3&&i.push(s);e=new Iu(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ba?this.Da(e)&&(this.wa.next(e),t=!0):this.va(e,this.onlineState)&&(this.Ca(e),t=!0),this.Sa=e,t}onError(e){this.wa.error(e)}ga(e){this.onlineState=e;let t=!1;return this.Sa&&!this.ba&&this.va(this.Sa,e)&&(this.Ca(this.Sa),t=!0),t}va(e,t){if(!e.fromCache||!this.ma())return!0;const i=t!=="Offline";return(!this.options.Fa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Da(e){if(e.docChanges.length>0)return!0;const t=this.Sa&&this.Sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}Ca(e){e=Iu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ba=!0,this.wa.next(e)}ma(){return this.options.source!==nE.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TO{constructor(e){this.key=e}}class wO{constructor(e){this.key=e}}class mB{constructor(e,t){this.query=e,this.qa=t,this.Qa=null,this.hasCachedResults=!1,this.current=!1,this.$a=Pe(),this.mutatedKeys=Pe(),this.Ua=fN(e),this.Ka=new eu(this.Ua)}get Wa(){return this.qa}Ga(e,t){const i=t?t.za:new sR,s=t?t.Ka:this.Ka;let o=t?t.mutatedKeys:this.mutatedKeys,u=s,h=!1;const f=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,p=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((_,v)=>{const T=s.get(_),S=bd(this.query,v)?v:null,N=!!T&&this.mutatedKeys.has(T.key),x=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let U=!1;T&&S?T.data.isEqual(S.data)?N!==x&&(i.track({type:3,doc:S}),U=!0):this.ja(T,S)||(i.track({type:2,doc:S}),U=!0,(f&&this.Ua(S,f)>0||p&&this.Ua(S,p)<0)&&(h=!0)):!T&&S?(i.track({type:0,doc:S}),U=!0):T&&!S&&(i.track({type:1,doc:T}),U=!0,(f||p)&&(h=!0)),U&&(S?(u=u.add(S),o=x?o.add(_):o.delete(_)):(u=u.delete(_),o=o.delete(_)))}),this.query.limit!==null)for(;u.size>this.query.limit;){const _=this.query.limitType==="F"?u.last():u.first();u=u.delete(_.key),o=o.delete(_.key),i.track({type:1,doc:_})}return{Ka:u,za:i,ys:h,mutatedKeys:o}}ja(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,s){const o=this.Ka;this.Ka=e.Ka,this.mutatedKeys=e.mutatedKeys;const u=e.za.da();u.sort((_,v)=>function(S,N){const x=U=>{switch(U){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return fe(20277,{Vt:U})}};return x(S)-x(N)}(_.type,v.type)||this.Ua(_.doc,v.doc)),this.Ha(i),s=s!=null&&s;const h=t&&!s?this.Ja():[],f=this.$a.size===0&&this.current&&!s?1:0,p=f!==this.Qa;return this.Qa=f,u.length!==0||p?{snapshot:new Iu(this.query,e.Ka,o,u,e.mutatedKeys,f===0,p,!1,!!i&&i.resumeToken.approximateByteSize()>0),Ya:h}:{Ya:h}}ga(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ka:this.Ka,za:new sR,mutatedKeys:this.mutatedKeys,ys:!1},!1)):{Ya:[]}}Za(e){return!this.qa.has(e)&&!!this.Ka.has(e)&&!this.Ka.get(e).hasLocalMutations}Ha(e){e&&(e.addedDocuments.forEach(t=>this.qa=this.qa.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.qa=this.qa.delete(t)),this.current=e.current)}Ja(){if(!this.current)return[];const e=this.$a;this.$a=Pe(),this.Ka.forEach(i=>{this.Za(i.key)&&(this.$a=this.$a.add(i.key))});const t=[];return e.forEach(i=>{this.$a.has(i)||t.push(new wO(i))}),this.$a.forEach(i=>{e.has(i)||t.push(new TO(i))}),t}Xa(e){this.qa=e.Ns,this.$a=Pe();const t=this.Ga(e.documents);return this.applyChanges(t,!0)}eu(){return Iu.fromInitialDocuments(this.query,this.Ka,this.mutatedKeys,this.Qa===0,this.hasCachedResults)}}const Uu="SyncEngine";class pB{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class gB{constructor(e){this.key=e,this.tu=!1}}class _B{constructor(e,t,i,s,o,u){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=s,this.currentUser=o,this.maxConcurrentLimboResolutions=u,this.nu={},this.ru=new is(h=>hN(h),ag),this.iu=new Map,this.su=new Set,this.ou=new mt(de.comparator),this._u=new Map,this.au=new AT,this.uu={},this.cu=new Map,this.lu=Do.ir(),this.onlineState="Unknown",this.hu=void 0}get isPrimaryClient(){return this.hu===!0}}async function yB(n,e,t=!0){const i=pg(n);let s;const o=i.ru.get(e);return o?(i.sharedClientState.addLocalQueryTarget(o.targetId),s=o.view.eu()):s=await bO(i,e,t,!0),s}async function vB(n,e){const t=pg(n);await bO(t,e,!0,!1)}async function bO(n,e,t,i){const s=await wp(n.localStore,ii(e)),o=s.targetId,u=n.sharedClientState.addLocalQueryTarget(o,t);let h;return i&&(h=await zT(n,e,o,u==="current",s.resumeToken)),n.isPrimaryClient&&t&&mg(n.remoteStore,s),h}async function zT(n,e,t,i,s){n.Pu=(v,T,S)=>async function(x,U,Z,ee){let Y=U.view.Ga(Z);Y.ys&&(Y=await Jv(x.localStore,U.query,!1).then(({documents:O})=>U.view.Ga(O,Y)));const ie=ee&&ee.targetChanges.get(U.targetId),se=ee&&ee.targetMismatches.get(U.targetId)!=null,me=U.view.applyChanges(Y,x.isPrimaryClient,ie,se);return iE(x,U.targetId,me.Ya),me.snapshot}(n,v,T,S);const o=await Jv(n.localStore,e,!0),u=new mB(e,o.Ns),h=u.Ga(o.documents),f=Sd.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",s),p=u.applyChanges(h,n.isPrimaryClient,f);iE(n,t,p.Ya);const _=new pB(e,t,u);return n.ru.set(e,_),n.iu.has(t)?n.iu.get(t).push(e):n.iu.set(t,[e]),p.snapshot}async function EB(n,e,t){const i=ge(n),s=i.ru.get(e),o=i.iu.get(s.targetId);if(o.length>1)return i.iu.set(s.targetId,o.filter(u=>!ag(u,e))),void i.ru.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(s.targetId),i.sharedClientState.isActiveQueryTarget(s.targetId)||await wu(i.localStore,s.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(s.targetId),t&&bu(i.remoteStore,s.targetId),Su(i,s.targetId)}).catch(ua)):(Su(i,s.targetId),await wu(i.localStore,s.targetId,!0))}async function TB(n,e){const t=ge(n),i=t.ru.get(e),s=t.iu.get(i.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),bu(t.remoteStore,i.targetId))}async function wB(n,e,t){const i=GT(n);try{const s=await function(u,h){const f=ge(u),p=bt.now(),_=h.reduce((S,N)=>S.add(N.key),Pe());let v,T;return f.persistence.runTransaction("Locally write mutations","readwrite",S=>{let N=ei(),x=Pe();return f.Cs.getEntries(S,_).next(U=>{N=U,N.forEach((Z,ee)=>{ee.isValidDocument()||(x=x.add(Z))})}).next(()=>f.localDocuments.getOverlayedDocuments(S,N)).next(U=>{v=U;const Z=[];for(const ee of h){const Y=G9(ee,v.get(ee.key).overlayedDocument);Y!=null&&Z.push(new rs(ee.key,Y,tN(Y.value.mapValue),Pn.exists(!0)))}return f.mutationQueue.addMutationBatch(S,p,Z,h)}).next(U=>{T=U;const Z=U.applyToLocalDocumentSet(v,x);return f.documentOverlayCache.saveOverlays(S,U.batchId,Z)})}).then(()=>({batchId:T.batchId,changes:pN(v)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(s.batchId),function(u,h,f){let p=u.uu[u.currentUser.toKey()];p||(p=new mt(Se)),p=p.insert(h,f),u.uu[u.currentUser.toKey()]=p}(i,s.batchId,t),await da(i,s.changes),await Vu(i.remoteStore)}catch(s){const o=VT(s,"Failed to persist write");t.reject(o)}}async function IO(n,e){const t=ge(n);try{const i=await BF(t.localStore,e);e.targetChanges.forEach((s,o)=>{const u=t._u.get(o);u&&(_e(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?u.tu=!0:s.modifiedDocuments.size>0?_e(u.tu,14607):s.removedDocuments.size>0&&(_e(u.tu,42227),u.tu=!1))}),await da(t,i,e)}catch(i){await ua(i)}}function lR(n,e,t){const i=ge(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const s=[];i.ru.forEach((o,u)=>{const h=u.view.ga(e);h.snapshot&&s.push(h.snapshot)}),function(u,h){const f=ge(u);f.onlineState=h;let p=!1;f.queries.forEach((_,v)=>{for(const T of v.Ra)T.ga(h)&&(p=!0)}),p&&FT(f)}(i.eventManager,e),s.length&&i.nu.Q_(s),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function bB(n,e,t){const i=ge(n);i.sharedClientState.updateQueryState(e,"rejected",t);const s=i._u.get(e),o=s&&s.key;if(o){let u=new mt(de.comparator);u=u.insert(o,Dt.newNoDocument(o,Ee.min()));const h=Pe().add(o),f=new Id(Ee.min(),new Map,new mt(Se),u,h);await IO(i,f),i.ou=i.ou.remove(o),i._u.delete(e),HT(i)}else await wu(i.localStore,e,!1).then(()=>Su(i,e,t)).catch(ua)}async function IB(n,e){const t=ge(n),i=e.batch.batchId;try{const s=await FF(t.localStore,e);jT(t,i,null),qT(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await da(t,s)}catch(s){await ua(s)}}async function SB(n,e,t){const i=ge(n);try{const s=await function(u,h){const f=ge(u);return f.persistence.runTransaction("Reject batch","readwrite-primary",p=>{let _;return f.mutationQueue.lookupMutationBatch(p,h).next(v=>(_e(v!==null,37113),_=v.keys(),f.mutationQueue.removeMutationBatch(p,v))).next(()=>f.mutationQueue.performConsistencyCheck(p)).next(()=>f.documentOverlayCache.removeOverlaysForBatchId(p,_,h)).next(()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,_)).next(()=>f.localDocuments.getDocuments(p,_))})}(i.localStore,e);jT(i,e,t),qT(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await da(i,s)}catch(s){await ua(s)}}function qT(n,e){(n.cu.get(e)||[]).forEach(t=>{t.resolve()}),n.cu.delete(e)}function jT(n,e,t){const i=ge(n);let s=i.uu[i.currentUser.toKey()];if(s){const o=s.get(e);o&&(t?o.reject(t):o.resolve(),s=s.remove(e)),i.uu[i.currentUser.toKey()]=s}}function Su(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.iu.get(e))n.ru.delete(i),t&&n.nu.Tu(i,t);n.iu.delete(e),n.isPrimaryClient&&n.au.Ur(e).forEach(i=>{n.au.containsKey(i)||SO(n,i)})}function SO(n,e){n.su.delete(e.path.canonicalString());const t=n.ou.get(e);t!==null&&(bu(n.remoteStore,t),n.ou=n.ou.remove(e),n._u.delete(t),HT(n))}function iE(n,e,t){for(const i of t)i instanceof TO?(n.au.addReference(i.key,e),AB(n,i)):i instanceof wO?(ne(Uu,"Document no longer in limbo: "+i.key),n.au.removeReference(i.key,e),n.au.containsKey(i.key)||SO(n,i.key)):fe(19791,{Iu:i})}function AB(n,e){const t=e.key,i=t.path.canonicalString();n.ou.get(t)||n.su.has(i)||(ne(Uu,"New document in limbo: "+t),n.su.add(i),HT(n))}function HT(n){for(;n.su.size>0&&n.ou.size<n.maxConcurrentLimboResolutions;){const e=n.su.values().next().value;n.su.delete(e);const t=new de(Je.fromString(e)),i=n.lu.next();n._u.set(i,new gB(t)),n.ou=n.ou.insert(t,i),mg(n.remoteStore,new jr(ii(wd(t.path)),i,"TargetPurposeLimboResolution",Fn.le))}}async function da(n,e,t){const i=ge(n),s=[],o=[],u=[];i.ru.isEmpty()||(i.ru.forEach((h,f)=>{u.push(i.Pu(f,e,t).then(p=>{var _;if((p||t)&&i.isPrimaryClient){const v=p?!p.fromCache:(_=t==null?void 0:t.targetChanges.get(f.targetId))===null||_===void 0?void 0:_.current;i.sharedClientState.updateQueryState(f.targetId,v?"current":"not-current")}if(p){s.push(p);const v=DT.Ps(f.targetId,p);o.push(v)}}))}),await Promise.all(u),i.nu.Q_(s),await async function(f,p){const _=ge(f);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",v=>z.forEach(p,T=>z.forEach(T.ls,S=>_.persistence.referenceDelegate.addReference(v,T.targetId,S)).next(()=>z.forEach(T.hs,S=>_.persistence.referenceDelegate.removeReference(v,T.targetId,S)))))}catch(v){if(!ca(v))throw v;ne(NT,"Failed to update sequence numbers: "+v)}for(const v of p){const T=v.targetId;if(!v.fromCache){const S=_.Ss.get(T),N=S.snapshotVersion,x=S.withLastLimboFreeSnapshotVersion(N);_.Ss=_.Ss.insert(T,x)}}}(i.localStore,o))}async function RB(n,e){const t=ge(n);if(!t.currentUser.isEqual(e)){ne(Uu,"User change. New user:",e.toKey());const i=await rO(t.localStore,e);t.currentUser=e,function(o,u){o.cu.forEach(h=>{h.forEach(f=>{f.reject(new ue(Q.CANCELLED,u))})}),o.cu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await da(t,i.Ms)}}function CB(n,e){const t=ge(n),i=t._u.get(e);if(i&&i.tu)return Pe().add(i.key);{let s=Pe();const o=t.iu.get(e);if(!o)return s;for(const u of o){const h=t.ru.get(u);s=s.unionWith(h.view.Wa)}return s}}async function DB(n,e){const t=ge(n),i=await Jv(t.localStore,e.query,!0),s=e.view.Xa(i);return t.isPrimaryClient&&iE(t,e.targetId,s.Ya),s}async function NB(n,e){const t=ge(n);return oO(t.localStore,e).then(i=>da(t,i))}async function OB(n,e,t,i){const s=ge(n),o=await function(h,f){const p=ge(h),_=ge(p.mutationQueue);return p.persistence.runTransaction("Lookup mutation documents","readonly",v=>_.Hn(v,f).next(T=>T?p.localDocuments.getDocuments(v,T):z.resolve(null)))}(s.localStore,e);o!==null?(t==="pending"?await Vu(s.remoteStore):t==="acknowledged"||t==="rejected"?(jT(s,e,i||null),qT(s,e),function(h,f){ge(ge(h).mutationQueue).Xn(f)}(s.localStore,e)):fe(6720,"Unknown batchState",{Eu:t}),await da(s,o)):ne(Uu,"Cannot apply mutation batch with id: "+e)}async function xB(n,e){const t=ge(n);if(pg(t),GT(t),e===!0&&t.hu!==!0){const i=t.sharedClientState.getAllActiveQueryTargets(),s=await uR(t,i.toArray());t.hu=!0,await tE(t.remoteStore,!0);for(const o of s)mg(t.remoteStore,o)}else if(e===!1&&t.hu!==!1){const i=[];let s=Promise.resolve();t.iu.forEach((o,u)=>{t.sharedClientState.isLocalQueryTarget(u)?i.push(u):s=s.then(()=>(Su(t,u),wu(t.localStore,u,!0))),bu(t.remoteStore,u)}),await s,await uR(t,i),function(u){const h=ge(u);h._u.forEach((f,p)=>{bu(h.remoteStore,p)}),h.au.Kr(),h._u=new Map,h.ou=new mt(de.comparator)}(t),t.hu=!1,await tE(t.remoteStore,!1)}}async function uR(n,e,t){const i=ge(n),s=[],o=[];for(const u of e){let h;const f=i.iu.get(u);if(f&&f.length!==0){h=await wp(i.localStore,ii(f[0]));for(const p of f){const _=i.ru.get(p),v=await DB(i,_);v.snapshot&&o.push(v.snapshot)}}else{const p=await aO(i.localStore,u);h=await wp(i.localStore,p),await zT(i,AO(p),u,!1,h.resumeToken)}s.push(h)}return i.nu.Q_(o),s}function AO(n){return uN(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function PB(n){return function(t){return ge(ge(t).persistence).us()}(ge(n).localStore)}async function kB(n,e,t,i){const s=ge(n);if(s.hu)return void ne(Uu,"Ignoring unexpected query state notification.");const o=s.iu.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{const u=await oO(s.localStore,dN(o[0])),h=Id.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Vt.EMPTY_BYTE_STRING);await da(s,u,h);break}case"rejected":await wu(s.localStore,e,!0),Su(s,e,i);break;default:fe(64155,t)}}async function MB(n,e,t){const i=pg(n);if(i.hu){for(const s of e){if(i.iu.has(s)&&i.sharedClientState.isActiveQueryTarget(s)){ne(Uu,"Adding an already active target "+s);continue}const o=await aO(i.localStore,s),u=await wp(i.localStore,o);await zT(i,AO(o),u.targetId,!1,u.resumeToken),mg(i.remoteStore,u)}for(const s of t)i.iu.has(s)&&await wu(i.localStore,s,!1).then(()=>{bu(i.remoteStore,s),Su(i,s)}).catch(ua)}}function pg(n){const e=ge(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=IO.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=CB.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=bB.bind(null,e),e.nu.Q_=dB.bind(null,e.eventManager),e.nu.Tu=fB.bind(null,e.eventManager),e}function GT(n){const e=ge(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=IB.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=SB.bind(null,e),e}class sd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=dg(e.databaseInfo.databaseId),this.sharedClientState=this.Au(e),this.persistence=this.Ru(e),await this.persistence.start(),this.localStore=this.Vu(e),this.gcScheduler=this.mu(e,this.localStore),this.indexBackfillerScheduler=this.fu(e,this.localStore)}mu(e,t){return null}fu(e,t){return null}Vu(e){return iO(this.persistence,new nO,e.initialUser,this.serializer)}Ru(e){return new RT(hg.Ei,this.serializer)}Au(e){return new dO}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}sd.provider={build:()=>new sd};class VB extends sd{constructor(e){super(),this.cacheSizeBytes=e}mu(e,t){_e(this.persistence.referenceDelegate instanceof Tp,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new $N(i,e.asyncQueue,t)}Ru(e){const t=this.cacheSizeBytes!==void 0?vn.withCacheSize(this.cacheSizeBytes):vn.DEFAULT;return new RT(i=>Tp.Ei(i,t),this.serializer)}}class RO extends sd{constructor(e,t,i){super(),this.gu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.gu.initialize(this,e),await GT(this.gu.syncEngine),await Vu(this.gu.remoteStore),await this.persistence.Ki(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}Vu(e){return iO(this.persistence,new nO,e.initialUser,this.serializer)}mu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new $N(i,e.asyncQueue,t)}fu(e,t){const i=new Q3(t,this.persistence);return new Y3(e.asyncQueue,i)}Ru(e){const t=tO(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?vn.withCacheSize(this.cacheSizeBytes):vn.DEFAULT;return new CT(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,fO(),Om(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Au(e){return new dO}}class LB extends RO{constructor(e,t){super(e,t,!1),this.gu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.gu.syncEngine;this.sharedClientState instanceof Zy&&(this.sharedClientState.syncEngine={yo:OB.bind(null,t),wo:kB.bind(null,t),bo:MB.bind(null,t),us:PB.bind(null,t),po:NB.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ki(async i=>{await xB(this.gu.syncEngine,i),this.gcScheduler&&(i&&!this.gcScheduler.started?this.gcScheduler.start():i||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(i&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():i||this.indexBackfillerScheduler.stop())})}Au(e){const t=fO();if(!Zy.C(t))throw new ue(Q.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const i=tO(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Zy(t,e.asyncQueue,i,e.clientId,e.initialUser)}}class ad{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>lR(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=RB.bind(null,this.syncEngine),await tE(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new hB}()}createDatastore(e){const t=dg(e.databaseInfo.databaseId),i=function(o){return new YF(o)}(e.databaseInfo);return function(o,u,h,f){return new XF(o,u,h,f)}(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return function(i,s,o,u,h){return new ZF(i,s,o,u,h)}(this.localStore,this.datastore,e.asyncQueue,t=>lR(this.syncEngine,t,0),function(){return nR.C()?new nR:new jF}())}createSyncEngine(e,t){return function(s,o,u,h,f,p,_){const v=new _B(s,o,u,h,f,p);return _&&(v.hu=!0),v}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(s){const o=ge(s);ne(No,"RemoteStore shutting down."),o.aa.add(5),await Ad(o),o.ca.shutdown(),o.la.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}ad.provider={build:()=>new ad};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KT{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.pu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.pu(this.observer.error,e):Mt("Uncaught Error in snapshot listener:",e.toString()))}yu(){this.muted=!0}pu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ra="FirestoreClient";class UB{constructor(e,t,i,s,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=s,this.user=yn.UNAUTHENTICATED,this.clientId=DD.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(i,async u=>{ne(ra,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u}),this.appCheckCredentials.start(i,u=>(ne(ra,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new lr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=VT(t,"Failed to shutdown persistence");e.reject(i)}}),e.promise}}async function tv(n,e){n.asyncQueue.verifyOperationInProgress(),ne(ra,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(async s=>{i.isEqual(s)||(await rO(e.localStore,s),i=s)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function cR(n,e){n.asyncQueue.verifyOperationInProgress();const t=await FB(n);ne(ra,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>rR(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,s)=>rR(e.remoteStore,s)),n._onlineComponents=e}async function FB(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ne(ra,"Using user provided OfflineComponentProvider");try{await tv(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(s){return s.name==="FirebaseError"?s.code===Q.FAILED_PRECONDITION||s.code===Q.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;Yh("Error using user provided cache. Falling back to memory cache: "+t),await tv(n,new sd)}}else ne(ra,"Using default OfflineComponentProvider"),await tv(n,new VB(void 0));return n._offlineComponents}async function CO(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ne(ra,"Using user provided OnlineComponentProvider"),await cR(n,n._uninitializedComponentsProvider._online)):(ne(ra,"Using default OnlineComponentProvider"),await cR(n,new ad))),n._onlineComponents}function BB(n){return CO(n).then(e=>e.syncEngine)}async function Ap(n){const e=await CO(n),t=e.eventManager;return t.onListen=yB.bind(null,e.syncEngine),t.onUnlisten=EB.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=vB.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=TB.bind(null,e.syncEngine),t}function zB(n,e,t={}){const i=new lr;return n.asyncQueue.enqueueAndForget(async()=>function(o,u,h,f,p){const _=new KT({next:T=>{_.yu(),u.enqueueAndForget(()=>UT(o,v));const S=T.docs.has(h);!S&&T.fromCache?p.reject(new ue(Q.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&T.fromCache&&f&&f.source==="server"?p.reject(new ue(Q.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(T)},error:T=>p.reject(T)}),v=new BT(wd(h.path),_,{includeMetadataChanges:!0,Fa:!0});return LT(o,v)}(await Ap(n),n.asyncQueue,e,t,i)),i.promise}function qB(n,e,t={}){const i=new lr;return n.asyncQueue.enqueueAndForget(async()=>function(o,u,h,f,p){const _=new KT({next:T=>{_.yu(),u.enqueueAndForget(()=>UT(o,v)),T.fromCache&&f.source==="server"?p.reject(new ue(Q.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(T)},error:T=>p.reject(T)}),v=new BT(h,_,{includeMetadataChanges:!0,Fa:!0});return LT(o,v)}(await Ap(n),n.asyncQueue,e,t,i)),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DO(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hR=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NO(n,e,t){if(!t)throw new ue(Q.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function jB(n,e,t,i){if(e===!0&&i===!0)throw new ue(Q.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function dR(n){if(!de.isDocumentKey(n))throw new ue(Q.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function fR(n){if(de.isDocumentKey(n))throw new ue(Q.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function gg(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(i){return i.constructor?i.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":fe(12329,{type:typeof n})}function Ti(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ue(Q.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=gg(n);throw new ue(Q.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HB="firestore.googleapis.com",mR=!0;class pR{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new ue(Q.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=HB,this.ssl=mR}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:mR;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=GN;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<WN)throw new ue(Q.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}jB("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=DO((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new ue(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new ue(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new ue(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,s){return i.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class YT{constructor(e,t,i,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new pR({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ue(Q.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ue(Q.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new pR(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new L3;switch(i.type){case"firstParty":return new B3(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new ue(Q.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,Po("Firestore",this._settings.isUsingEmulator),this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const i=hR.get(t);i&&(ne("ComponentProvider","Removing Datastore"),hR.delete(t),i.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new fa(this.firestore,e,this._query)}}class bn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Xs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new bn(this.firestore,e,this._key)}}class Xs extends fa{constructor(e,t,i){super(e,t,wd(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new bn(this.firestore,null,new de(e))}withConverter(e){return new Xs(this.firestore,e,this._path)}}function Yl(n,e,...t){if(n=Ke(n),NO("collection","path",e),n instanceof YT){const i=Je.fromString(e,...t);return fR(i),new Xs(n,null,i)}{if(!(n instanceof bn||n instanceof Xs))throw new ue(Q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Je.fromString(e,...t));return fR(i),new Xs(n.firestore,null,i)}}function Oo(n,e,...t){if(n=Ke(n),arguments.length===1&&(e=DD.newId()),NO("doc","path",e),n instanceof YT){const i=Je.fromString(e,...t);return dR(i),new bn(n,null,new de(i))}{if(!(n instanceof bn||n instanceof Xs))throw new ue(Q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Je.fromString(e,...t));return dR(i),new bn(n.firestore,n instanceof Xs?n.converter:null,new de(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gR="AsyncQueue";class _R{constructor(e=Promise.resolve()){this.Qu=[],this.$u=!1,this.Uu=[],this.Ku=null,this.Wu=!1,this.Gu=!1,this.zu=[],this.y_=new mO(this,"async_queue_retry"),this.ju=()=>{const i=Om();i&&ne(gR,"Visibility state changed to "+i.visibilityState),this.y_.A_()},this.Hu=e;const t=Om();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.ju)}get isShuttingDown(){return this.$u}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Ju(),this.Yu(e)}enterRestrictedMode(e){if(!this.$u){this.$u=!0,this.Gu=e||!1;const t=Om();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.ju)}}enqueue(e){if(this.Ju(),this.$u)return new Promise(()=>{});const t=new lr;return this.Yu(()=>this.$u&&this.Gu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qu.push(e),this.Zu()))}async Zu(){if(this.Qu.length!==0){try{await this.Qu[0](),this.Qu.shift(),this.y_.reset()}catch(e){if(!ca(e))throw e;ne(gR,"Operation failed with retryable error: "+e)}this.Qu.length>0&&this.y_.E_(()=>this.Zu())}}Yu(e){const t=this.Hu.then(()=>(this.Wu=!0,e().catch(i=>{throw this.Ku=i,this.Wu=!1,Mt("INTERNAL UNHANDLED ERROR: ",yR(i)),i}).then(i=>(this.Wu=!1,i))));return this.Hu=t,t}enqueueAfterDelay(e,t,i){this.Ju(),this.zu.indexOf(e)>-1&&(t=0);const s=MT.createAndSchedule(this,e,t,i,o=>this.Xu(o));return this.Uu.push(s),s}Ju(){this.Ku&&fe(47125,{ec:yR(this.Ku)})}verifyOperationInProgress(){}async tc(){let e;do e=this.Hu,await e;while(e!==this.Hu)}nc(e){for(const t of this.Uu)if(t.timerId===e)return!0;return!1}rc(e){return this.tc().then(()=>{this.Uu.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(const t of this.Uu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.tc()})}sc(e){this.zu.push(e)}Xu(e){const t=this.Uu.indexOf(e);this.Uu.splice(t,1)}}function yR(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vR(n){return function(t,i){if(typeof t!="object"||t===null)return!1;const s=t;for(const o of i)if(o in s&&typeof s[o]=="function")return!0;return!1}(n,["next","error","complete"])}class sa extends YT{constructor(e,t,i,s){super(e,t,i,s),this.type="firestore",this._queue=new _R,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new _R(e),this._firestoreClient=void 0,await e}}}function GB(n,e,t){t||(t=fp);const i=es(n,"firestore");if(i.isInitialized(t)){const s=i.getImmediate({identifier:t}),o=i.getOptions(t);if(Yr(o,e))return s;throw new ue(Q.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new ue(Q.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<WN)throw new ue(Q.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&Zr(e.host)&&Pp(e.host),i.initialize({options:e,instanceIdentifier:t})}function _g(n){if(n._terminated)throw new ue(Q.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||KB(n),n._firestoreClient}function KB(n){var e,t,i;const s=n._freezeSettings(),o=function(h,f,p,_){return new w9(h,f,p,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,DO(_.experimentalLongPollingOptions),_.useFetchStreams,_.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=s.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new UB(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&function(h){const f=h==null?void 0:h._online.build();return{_offline:h==null?void 0:h._offline.build(f),_online:f}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Au{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Au(Vt.fromBase64String(e))}catch(t){throw new ue(Q.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Au(Vt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yg{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ue(Q.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Tt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vg{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QT{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ue(Q.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ue(Q.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Se(this._lat,e._lat)||Se(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(i,s){if(i.length!==s.length)return!1;for(let o=0;o<i.length;++o)if(i[o]!==s[o])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YB=/^__.*__$/;class QB{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new rs(e,this.data,this.fieldMask,t,this.fieldTransforms):new Mu(e,this.data,t,this.fieldTransforms)}}class OO{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new rs(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function xO(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw fe(40011,{oc:n})}}class $T{constructor(e,t,i,s,o,u){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=s,o===void 0&&this._c(),this.fieldTransforms=o||[],this.fieldMask=u||[]}get path(){return this.settings.path}get oc(){return this.settings.oc}ac(e){return new $T(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}uc(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.ac({path:i,cc:!1});return s.lc(e),s}hc(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.ac({path:i,cc:!1});return s._c(),s}Pc(e){return this.ac({path:void 0,cc:!0})}Tc(e){return Rp(e,this.settings.methodName,this.settings.Ic||!1,this.path,this.settings.Ec)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}_c(){if(this.path)for(let e=0;e<this.path.length;e++)this.lc(this.path.get(e))}lc(e){if(e.length===0)throw this.Tc("Document fields must not be empty");if(xO(this.oc)&&YB.test(e))throw this.Tc('Document fields cannot begin and end with "__"')}}class WB{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||dg(e)}dc(e,t,i,s=!1){return new $T({oc:e,methodName:t,Ec:i,path:Tt.emptyPath(),cc:!1,Ic:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Eg(n){const e=n._freezeSettings(),t=dg(n._databaseId);return new WB(n._databaseId,!!e.ignoreUndefinedProperties,t)}function PO(n,e,t,i,s,o={}){const u=n.dc(o.merge||o.mergeFields?2:0,e,t,s);JT("Data must be an object, but it was:",u,i);const h=kO(i,u);let f,p;if(o.merge)f=new Bn(u.fieldMask),p=u.fieldTransforms;else if(o.mergeFields){const _=[];for(const v of o.mergeFields){const T=rE(e,v,t);if(!u.contains(T))throw new ue(Q.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);VO(_,T)||_.push(T)}f=new Bn(_),p=u.fieldTransforms.filter(v=>f.covers(v.field))}else f=null,p=u.fieldTransforms;return new QB(new En(h),f,p)}class Tg extends vg{_toFieldTransform(e){if(e.oc!==2)throw e.oc===1?e.Tc(`${this._methodName}() can only appear at the top level of your update data`):e.Tc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Tg}}class XT extends vg{_toFieldTransform(e){return new wN(e.path,new yu)}isEqual(e){return e instanceof XT}}function $B(n,e,t,i){const s=n.dc(1,e,t);JT("Data must be an object, but it was:",s,i);const o=[],u=En.empty();ha(i,(f,p)=>{const _=ZT(e,f,t);p=Ke(p);const v=s.hc(_);if(p instanceof Tg)o.push(_);else{const T=Rd(p,v);T!=null&&(o.push(_),u.set(_,T))}});const h=new Bn(o);return new OO(u,h,s.fieldTransforms)}function XB(n,e,t,i,s,o){const u=n.dc(1,e,t),h=[rE(e,i,t)],f=[s];if(o.length%2!=0)throw new ue(Q.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<o.length;T+=2)h.push(rE(e,o[T])),f.push(o[T+1]);const p=[],_=En.empty();for(let T=h.length-1;T>=0;--T)if(!VO(p,h[T])){const S=h[T];let N=f[T];N=Ke(N);const x=u.hc(S);if(N instanceof Tg)p.push(S);else{const U=Rd(N,x);U!=null&&(p.push(S),_.set(S,U))}}const v=new Bn(p);return new OO(_,v,u.fieldTransforms)}function JB(n,e,t,i=!1){return Rd(t,n.dc(i?4:3,e))}function Rd(n,e){if(MO(n=Ke(n)))return JT("Unsupported field value:",e,n),kO(n,e);if(n instanceof vg)return function(i,s){if(!xO(s.oc))throw s.Tc(`${i._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Tc(`${i._methodName}() is not currently supported inside arrays`);const o=i._toFieldTransform(s);o&&s.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.cc&&e.oc!==4)throw e.Tc("Nested arrays are not supported");return function(i,s){const o=[];let u=0;for(const h of i){let f=Rd(h,s.Pc(u));f==null&&(f={nullValue:"NULL_VALUE"}),o.push(f),u++}return{arrayValue:{values:o}}}(n,e)}return function(i,s){if((i=Ke(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return F9(s.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const o=bt.fromDate(i);return{timestampValue:Tu(s.serializer,o)}}if(i instanceof bt){const o=new bt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Tu(s.serializer,o)}}if(i instanceof QT)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Au)return{bytesValue:DN(s.serializer,i._byteString)};if(i instanceof bn){const o=s.databaseId,u=i.firestore._databaseId;if(!u.isEqual(o))throw s.Tc(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:bT(i.firestore._databaseId||s.databaseId,i._key.path)}}if(i instanceof WT)return function(u,h){return{mapValue:{fields:{[fT]:{stringValue:mT},[mu]:{arrayValue:{values:u.toArray().map(p=>{if(typeof p!="number")throw h.Tc("VectorValues must only contain numeric values.");return _T(h.serializer,p)})}}}}}}(i,s);throw s.Tc(`Unsupported field value: ${gg(i)}`)}(n,e)}function kO(n,e){const t={};return KD(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ha(n,(i,s)=>{const o=Rd(s,e.uc(i));o!=null&&(t[i]=o)}),{mapValue:{fields:t}}}function MO(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof bt||n instanceof QT||n instanceof Au||n instanceof bn||n instanceof vg||n instanceof WT)}function JT(n,e,t){if(!MO(t)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(t)){const i=gg(t);throw i==="an object"?e.Tc(n+" a custom object"):e.Tc(n+" "+i)}}function rE(n,e,t){if((e=Ke(e))instanceof yg)return e._internalPath;if(typeof e=="string")return ZT(n,e);throw Rp("Field path arguments must be of type string or ",n,!1,void 0,t)}const ZB=new RegExp("[~\\*/\\[\\]]");function ZT(n,e,t){if(e.search(ZB)>=0)throw Rp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new yg(...e.split("."))._internalPath}catch{throw Rp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Rp(n,e,t,i,s){const o=i&&!i.isEmpty(),u=s!==void 0;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let f="";return(o||u)&&(f+=" (found",o&&(f+=` in field ${i}`),u&&(f+=` in document ${s}`),f+=")"),new ue(Q.INVALID_ARGUMENT,h+n+f)}function VO(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LO{constructor(e,t,i,s,o){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=s,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new bn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new ez(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(wg("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class ez extends LO{data(){return super.data()}}function wg(n,e){return typeof e=="string"?ZT(n,e):e instanceof yg?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UO(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ue(Q.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ew{}class FO extends ew{}function tz(n,e,...t){let i=[];e instanceof ew&&i.push(e),i=i.concat(t),function(o){const u=o.filter(f=>f instanceof tw).length,h=o.filter(f=>f instanceof bg).length;if(u>1||u>0&&h>0)throw new ue(Q.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const s of i)n=s._apply(n);return n}class bg extends FO{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new bg(e,t,i)}_apply(e){const t=this._parse(e);return zO(e._query,t),new fa(e.firestore,e.converter,jv(e._query,t))}_parse(e){const t=Eg(e.firestore);return function(o,u,h,f,p,_,v){let T;if(p.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new ue(Q.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){TR(v,_);const N=[];for(const x of v)N.push(ER(f,o,x));T={arrayValue:{values:N}}}else T=ER(f,o,v)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||TR(v,_),T=JB(h,u,v,_==="in"||_==="not-in");return ze.create(p,_,T)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function nz(n,e,t){const i=e,s=wg("where",n);return bg._create(s,i,t)}class tw extends ew{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new tw(e,t)}_parse(e){const t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:it.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(s,o){let u=s;const h=o.getFlattenedFilters();for(const f of h)zO(u,f),u=jv(u,f)}(e._query,t),new fa(e.firestore,e.converter,jv(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class nw extends FO{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new nw(e,t)}_apply(e){const t=function(s,o,u){if(s.startAt!==null)throw new ue(Q.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new ue(Q.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new id(o,u)}(e._query,this._field,this._direction);return new fa(e.firestore,e.converter,function(s,o){const u=s.explicitOrderBy.concat([o]);return new ku(s.path,s.collectionGroup,u,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,t))}}function BO(n,e="asc"){const t=e,i=wg("orderBy",n);return nw._create(i,t)}function ER(n,e,t){if(typeof(t=Ke(t))=="string"){if(t==="")throw new ue(Q.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!cN(e)&&t.indexOf("/")!==-1)throw new ue(Q.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Je.fromString(t));if(!de.isDocumentKey(i))throw new ue(Q.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return td(n,new de(i))}if(t instanceof bn)return td(n,t._key);throw new ue(Q.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${gg(t)}.`)}function TR(n,e){if(!Array.isArray(n)||n.length===0)throw new ue(Q.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function zO(n,e){const t=function(s,o){for(const u of s)for(const h of u.getFlattenedFilters())if(o.indexOf(h.op)>=0)return h.op;return null}(n.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new ue(Q.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ue(Q.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class iz{convertValue(e,t="none"){switch(ta(e)){case 0:return null;case 1:return e.booleanValue;case 2:return vt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Jr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw fe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return ha(e,(s,o)=>{i[s]=this.convertValue(o,t)}),i}convertVectorValue(e){var t,i,s;const o=(s=(i=(t=e.fields)===null||t===void 0?void 0:t[mu].arrayValue)===null||i===void 0?void 0:i.values)===null||s===void 0?void 0:s.map(u=>vt(u.doubleValue));return new WT(o)}convertGeoPoint(e){return new QT(vt(e.latitude),vt(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":const i=rg(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Zh(e));default:return null}}convertTimestamp(e){const t=Xr(e);return new bt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Je.fromString(e);_e(FN(i),9688,{name:e});const s=new So(i.get(1),i.get(3)),o=new de(i.popFirst(5));return s.isEqual(t)||Mt(`Document ${o} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qO(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gh{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class jO extends LO{constructor(e,t,i,s,o,u){super(e,t,i,s,u),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new xm(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(wg("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}}class xm extends jO{data(e={}){return super.data(e)}}class HO{constructor(e,t,i,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new gh(s.hasPendingWrites,s.fromCache),this.query=i}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new xm(this._firestore,this._userDataWriter,i.key,i,new gh(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ue(Q.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,o){if(s._snapshot.oldDocs.isEmpty()){let u=0;return s._snapshot.docChanges.map(h=>{const f=new xm(s._firestore,s._userDataWriter,h.doc.key,h.doc,new gh(s._snapshot.mutatedKeys.has(h.doc.key),s._snapshot.fromCache),s.query.converter);return h.doc,{type:"added",doc:f,oldIndex:-1,newIndex:u++}})}{let u=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(h=>o||h.type!==3).map(h=>{const f=new xm(s._firestore,s._userDataWriter,h.doc.key,h.doc,new gh(s._snapshot.mutatedKeys.has(h.doc.key),s._snapshot.fromCache),s.query.converter);let p=-1,_=-1;return h.type!==0&&(p=u.indexOf(h.doc.key),u=u.delete(h.doc.key)),h.type!==1&&(u=u.add(h.doc),_=u.indexOf(h.doc.key)),{type:rz(h.type),doc:f,oldIndex:p,newIndex:_}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function rz(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return fe(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iw(n){n=Ti(n,bn);const e=Ti(n.firestore,sa);return zB(_g(e),n._key).then(t=>GO(e,n,t))}class rw extends iz{constructor(e){super(),this.firestore=e}convertBytes(e){return new Au(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new bn(this.firestore,null,t)}}function sz(n){n=Ti(n,fa);const e=Ti(n.firestore,sa),t=_g(e),i=new rw(e);return UO(n._query),qB(t,n._query).then(s=>new HO(e,i,n,s))}function od(n,e,t){n=Ti(n,bn);const i=Ti(n.firestore,sa),s=qO(n.converter,e,t);return sw(i,[PO(Eg(i),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,Pn.none())])}function az(n,e,t,...i){n=Ti(n,bn);const s=Ti(n.firestore,sa),o=Eg(s);let u;return u=typeof(e=Ke(e))=="string"||e instanceof yg?XB(o,"updateDoc",n._key,e,t,i):$B(o,"updateDoc",n._key,e),sw(s,[u.toMutation(n._key,Pn.exists(!0))])}function oz(n,e){const t=Ti(n.firestore,sa),i=Oo(n),s=qO(n.converter,e);return sw(t,[PO(Eg(n.firestore),"addDoc",i._key,s,n.converter!==null,{}).toMutation(i._key,Pn.exists(!1))]).then(()=>i)}function Pm(n,...e){var t,i,s;n=Ke(n);let o={includeMetadataChanges:!1,source:"default"},u=0;typeof e[u]!="object"||vR(e[u])||(o=e[u],u++);const h={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(vR(e[u])){const v=e[u];e[u]=(t=v.next)===null||t===void 0?void 0:t.bind(v),e[u+1]=(i=v.error)===null||i===void 0?void 0:i.bind(v),e[u+2]=(s=v.complete)===null||s===void 0?void 0:s.bind(v)}let f,p,_;if(n instanceof bn)p=Ti(n.firestore,sa),_=wd(n._key.path),f={next:v=>{e[u]&&e[u](GO(p,n,v))},error:e[u+1],complete:e[u+2]};else{const v=Ti(n,fa);p=Ti(v.firestore,sa),_=v._query;const T=new rw(p);f={next:S=>{e[u]&&e[u](new HO(p,T,v,S))},error:e[u+1],complete:e[u+2]},UO(n._query)}return function(T,S,N,x){const U=new KT(x),Z=new BT(S,U,N);return T.asyncQueue.enqueueAndForget(async()=>LT(await Ap(T),Z)),()=>{U.yu(),T.asyncQueue.enqueueAndForget(async()=>UT(await Ap(T),Z))}}(_g(p),_,h,f)}function sw(n,e){return function(i,s){const o=new lr;return i.asyncQueue.enqueueAndForget(async()=>wB(await BB(i),s,o)),o.promise}(_g(n),e)}function GO(n,e,t){const i=t.docs.get(e._key),s=new rw(n);return new jO(n,s,e._key,i,new gh(t.hasPendingWrites,t.fromCache),e.converter)}class lz{constructor(e){let t;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=dz(),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function uz(n){return new lz(n)}class cz{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=ad.provider,this._offlineComponentProvider={build:t=>new RO(t,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class hz{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=ad.provider,this._offlineComponentProvider={build:t=>new LB(t,e==null?void 0:e.cacheSizeBytes)}}}function dz(n){return new cz(void 0)}function fz(){return new hz}function wR(){return new XT("serverTimestamp")}(function(e,t=!0){(function(s){Pu=s})(aa),wi(new ri("firestore",(i,{instanceIdentifier:s,options:o})=>{const u=i.getProvider("app").getImmediate(),h=new sa(new U3(i.getProvider("auth-internal")),new z3(u,i.getProvider("app-check-internal")),function(p,_){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new ue(Q.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new So(p.options.projectId,_)}(u,s),u);return o=Object.assign({useFetchStreams:t},o),h._setSettings(o),h},"PUBLIC").setMultipleInstances(!0)),Tn(eA,tA,e),Tn(eA,tA,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KO="firebasestorage.googleapis.com",YO="storageBucket",mz=2*60*1e3,pz=10*60*1e3,gz=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It extends Si{constructor(e,t,i=0){super(nv(e),`Firebase Storage: ${t} (${nv(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,It.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return nv(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var gt;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(gt||(gt={}));function nv(n){return"storage/"+n}function aw(){const n="An unknown error occurred, please check the error payload for server response.";return new It(gt.UNKNOWN,n)}function _z(n){return new It(gt.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function yz(n){return new It(gt.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function vz(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new It(gt.UNAUTHENTICATED,n)}function Ez(){return new It(gt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function Tz(n){return new It(gt.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function QO(){return new It(gt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function WO(){return new It(gt.CANCELED,"User canceled the upload/download.")}function wz(n){return new It(gt.INVALID_URL,"Invalid URL '"+n+"'.")}function bz(n){return new It(gt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function Iz(){return new It(gt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+YO+"' property when initializing the app?")}function $O(){return new It(gt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Sz(){return new It(gt.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function Az(){return new It(gt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function Rz(n){return new It(gt.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function sE(n){return new It(gt.INVALID_ARGUMENT,n)}function XO(){return new It(gt.APP_DELETED,"The Firebase app was deleted.")}function Cz(n){return new It(gt.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function xh(n,e){return new It(gt.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function ah(n){throw new It(gt.INTERNAL_ERROR,"Internal error: "+n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=ti.makeFromUrl(e,t)}catch{return new ti(e,"")}if(i.path==="")return i;throw bz(e)}static makeFromUrl(e,t){let i=null;const s="([A-Za-z0-9.\\-_]+)";function o(ie){ie.path.charAt(ie.path.length-1)==="/"&&(ie.path_=ie.path_.slice(0,-1))}const u="(/(.*))?$",h=new RegExp("^gs://"+s+u,"i"),f={bucket:1,path:3};function p(ie){ie.path_=decodeURIComponent(ie.path)}const _="v[A-Za-z0-9_]+",v=t.replace(/[.]/g,"\\."),T="(/([^?#]*).*)?$",S=new RegExp(`^https?://${v}/${_}/b/${s}/o${T}`,"i"),N={bucket:1,path:3},x=t===KO?"(?:storage.googleapis.com|storage.cloud.google.com)":t,U="([^?#]*)",Z=new RegExp(`^https?://${x}/${s}/${U}`,"i"),Y=[{regex:h,indices:f,postModify:o},{regex:S,indices:N,postModify:p},{regex:Z,indices:{bucket:1,path:2},postModify:p}];for(let ie=0;ie<Y.length;ie++){const se=Y[ie],me=se.regex.exec(e);if(me){const O=me[se.indices.bucket];let A=me[se.indices.path];A||(A=""),i=new ti(O,A),se.postModify(i);break}}if(i==null)throw wz(e);return i}}class Dz{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nz(n,e,t){let i=1,s=null,o=null,u=!1,h=0;function f(){return h===2}let p=!1;function _(...U){p||(p=!0,e.apply(null,U))}function v(U){s=setTimeout(()=>{s=null,n(S,f())},U)}function T(){o&&clearTimeout(o)}function S(U,...Z){if(p){T();return}if(U){T(),_.call(null,U,...Z);return}if(f()||u){T(),_.call(null,U,...Z);return}i<64&&(i*=2);let Y;h===1?(h=2,Y=0):Y=(i+Math.random())*1e3,v(Y)}let N=!1;function x(U){N||(N=!0,T(),!p&&(s!==null?(U||(h=2),clearTimeout(s),v(0)):U||(h=1)))}return v(0),o=setTimeout(()=>{u=!0,x(!0)},t),x}function Oz(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xz(n){return n!==void 0}function Pz(n){return typeof n=="function"}function kz(n){return typeof n=="object"&&!Array.isArray(n)}function Ig(n){return typeof n=="string"||n instanceof String}function bR(n){return ow()&&n instanceof Blob}function ow(){return typeof Blob<"u"}function IR(n,e,t,i){if(i<e)throw sE(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw sE(`Invalid value for '${n}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cd(n,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${n}`}function JO(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const s=e(i)+"="+e(n[i]);t=t+s+"&"}return t=t.slice(0,-1),t}var go;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(go||(go={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZO(n,e){const t=n>=500&&n<600,s=[408,429].indexOf(n)!==-1,o=e.indexOf(n)!==-1;return t||s||o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mz{constructor(e,t,i,s,o,u,h,f,p,_,v,T=!0,S=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=s,this.successCodes_=o,this.additionalRetryCodes_=u,this.callback_=h,this.errorCallback_=f,this.timeout_=p,this.progressCallback_=_,this.connectionFactory_=v,this.retry=T,this.isUsingEmulator=S,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((N,x)=>{this.resolve_=N,this.reject_=x,this.start_()})}start_(){const e=(i,s)=>{if(s){i(!1,new fm(!1,null,!0));return}const o=this.connectionFactory_();this.pendingConnection_=o;const u=h=>{const f=h.loaded,p=h.lengthComputable?h.total:-1;this.progressCallback_!==null&&this.progressCallback_(f,p)};this.progressCallback_!==null&&o.addUploadProgressListener(u),o.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(u),this.pendingConnection_=null;const h=o.getErrorCode()===go.NO_ERROR,f=o.getStatus();if(!h||ZO(f,this.additionalRetryCodes_)&&this.retry){const _=o.getErrorCode()===go.ABORT;i(!1,new fm(!1,null,_));return}const p=this.successCodes_.indexOf(f)!==-1;i(!0,new fm(p,o))})},t=(i,s)=>{const o=this.resolve_,u=this.reject_,h=s.connection;if(s.wasSuccessCode)try{const f=this.callback_(h,h.getResponse());xz(f)?o(f):o()}catch(f){u(f)}else if(h!==null){const f=aw();f.serverResponse=h.getErrorText(),this.errorCallback_?u(this.errorCallback_(h,f)):u(f)}else if(s.canceled){const f=this.appDelete_?XO():WO();u(f)}else{const f=QO();u(f)}};this.canceled_?t(!1,new fm(!1,null,!0)):this.backoffId_=Nz(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Oz(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class fm{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function Vz(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function Lz(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Uz(n,e){e&&(n["X-Firebase-GMPID"]=e)}function Fz(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function Bz(n,e,t,i,s,o,u=!0,h=!1){const f=JO(n.urlParams),p=n.url+f,_=Object.assign({},n.headers);return Uz(_,e),Vz(_,t),Lz(_,o),Fz(_,i),new Mz(p,n.method,_,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,s,u,h)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zz(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function qz(...n){const e=zz();if(e!==void 0){const t=new e;for(let i=0;i<n.length;i++)t.append(n[i]);return t.getBlob()}else{if(ow())return new Blob(n);throw new It(gt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function jz(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hz(n){if(typeof atob>"u")throw Rz("base-64");return atob(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ar={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class iv{constructor(e,t){this.data=e,this.contentType=t||null}}function Gz(n,e){switch(n){case ar.RAW:return new iv(ex(e));case ar.BASE64:case ar.BASE64URL:return new iv(tx(n,e));case ar.DATA_URL:return new iv(Yz(e),Qz(e))}throw aw()}function ex(n){const e=[];for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const o=i,u=n.charCodeAt(++t);i=65536|(o&1023)<<10|u&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function Kz(n){let e;try{e=decodeURIComponent(n)}catch{throw xh(ar.DATA_URL,"Malformed data URL.")}return ex(e)}function tx(n,e){switch(n){case ar.BASE64:{const s=e.indexOf("-")!==-1,o=e.indexOf("_")!==-1;if(s||o)throw xh(n,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case ar.BASE64URL:{const s=e.indexOf("+")!==-1,o=e.indexOf("/")!==-1;if(s||o)throw xh(n,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=Hz(e)}catch(s){throw s.message.includes("polyfill")?s:xh(n,"Invalid character found")}const i=new Uint8Array(t.length);for(let s=0;s<t.length;s++)i[s]=t.charCodeAt(s);return i}class nx{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw xh(ar.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=Wz(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function Yz(n){const e=new nx(n);return e.base64?tx(ar.BASE64,e.rest):Kz(e.rest)}function Qz(n){return new nx(n).contentType}function Wz(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class js{constructor(e,t){let i=0,s="";bR(e)?(this.data_=e,i=e.size,s=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,t){if(bR(this.data_)){const i=this.data_,s=jz(i,e,t);return s===null?null:new js(s)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new js(i,!0)}}static getBlob(...e){if(ow()){const t=e.map(i=>i instanceof js?i.data_:i);return new js(qz.apply(null,t))}else{const t=e.map(u=>Ig(u)?Gz(ar.RAW,u).data:u.data_);let i=0;t.forEach(u=>{i+=u.byteLength});const s=new Uint8Array(i);let o=0;return t.forEach(u=>{for(let h=0;h<u.length;h++)s[o++]=u[h]}),new js(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ix(n){let e;try{e=JSON.parse(n)}catch{return null}return kz(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $z(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function Xz(n,e){const t=e.split("/").filter(i=>i.length>0).join("/");return n.length===0?t:n+"/"+t}function rx(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jz(n,e){return e}class Dn{constructor(e,t,i,s){this.server=e,this.local=t||e,this.writable=!!i,this.xform=s||Jz}}let mm=null;function Zz(n){return!Ig(n)||n.length<2?n:rx(n)}function sx(){if(mm)return mm;const n=[];n.push(new Dn("bucket")),n.push(new Dn("generation")),n.push(new Dn("metageneration")),n.push(new Dn("name","fullPath",!0));function e(o,u){return Zz(u)}const t=new Dn("name");t.xform=e,n.push(t);function i(o,u){return u!==void 0?Number(u):u}const s=new Dn("size");return s.xform=i,n.push(s),n.push(new Dn("timeCreated")),n.push(new Dn("updated")),n.push(new Dn("md5Hash",null,!0)),n.push(new Dn("cacheControl",null,!0)),n.push(new Dn("contentDisposition",null,!0)),n.push(new Dn("contentEncoding",null,!0)),n.push(new Dn("contentLanguage",null,!0)),n.push(new Dn("contentType",null,!0)),n.push(new Dn("metadata","customMetadata",!0)),mm=n,mm}function e5(n,e){function t(){const i=n.bucket,s=n.fullPath,o=new ti(i,s);return e._makeStorageReference(o)}Object.defineProperty(n,"ref",{get:t})}function t5(n,e,t){const i={};i.type="file";const s=t.length;for(let o=0;o<s;o++){const u=t[o];i[u.local]=u.xform(i,e[u.server])}return e5(i,n),i}function ax(n,e,t){const i=ix(e);return i===null?null:t5(n,i,t)}function n5(n,e,t,i){const s=ix(e);if(s===null||!Ig(s.downloadTokens))return null;const o=s.downloadTokens;if(o.length===0)return null;const u=encodeURIComponent;return o.split(",").map(p=>{const _=n.bucket,v=n.fullPath,T="/b/"+u(_)+"/o/"+u(v),S=Cd(T,t,i),N=JO({alt:"media",token:p});return S+N})[0]}function ox(n,e){const t={},i=e.length;for(let s=0;s<i;s++){const o=e[s];o.writable&&(t[o.server]=n[o.local])}return JSON.stringify(t)}class Fu{constructor(e,t,i,s){this.url=e,this.method=t,this.handler=i,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kr(n){if(!n)throw aw()}function lw(n,e){function t(i,s){const o=ax(n,s,e);return Kr(o!==null),o}return t}function i5(n,e){function t(i,s){const o=ax(n,s,e);return Kr(o!==null),n5(o,s,n.host,n._protocol)}return t}function Dd(n){function e(t,i){let s;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?s=Ez():s=vz():t.getStatus()===402?s=yz(n.bucket):t.getStatus()===403?s=Tz(n.path):s=i,s.status=t.getStatus(),s.serverResponse=i.serverResponse,s}return e}function lx(n){const e=Dd(n);function t(i,s){let o=e(i,s);return i.getStatus()===404&&(o=_z(n.path)),o.serverResponse=s.serverResponse,o}return t}function r5(n,e,t){const i=e.fullServerUrl(),s=Cd(i,n.host,n._protocol),o="GET",u=n.maxOperationRetryTime,h=new Fu(s,o,lw(n,t),u);return h.errorHandler=lx(e),h}function s5(n,e,t){const i=e.fullServerUrl(),s=Cd(i,n.host,n._protocol),o="GET",u=n.maxOperationRetryTime,h=new Fu(s,o,i5(n,t),u);return h.errorHandler=lx(e),h}function a5(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function ux(n,e,t){const i=Object.assign({},t);return i.fullPath=n.path,i.size=e.size(),i.contentType||(i.contentType=a5(null,e)),i}function o5(n,e,t,i,s){const o=e.bucketOnlyServerUrl(),u={"X-Goog-Upload-Protocol":"multipart"};function h(){let Y="";for(let ie=0;ie<2;ie++)Y=Y+Math.random().toString().slice(2);return Y}const f=h();u["Content-Type"]="multipart/related; boundary="+f;const p=ux(e,i,s),_=ox(p,t),v="--"+f+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+_+`\r
--`+f+`\r
Content-Type: `+p.contentType+`\r
\r
`,T=`\r
--`+f+"--",S=js.getBlob(v,i,T);if(S===null)throw $O();const N={name:p.fullPath},x=Cd(o,n.host,n._protocol),U="POST",Z=n.maxUploadRetryTime,ee=new Fu(x,U,lw(n,t),Z);return ee.urlParams=N,ee.headers=u,ee.body=S.uploadData(),ee.errorHandler=Dd(e),ee}class Cp{constructor(e,t,i,s){this.current=e,this.total=t,this.finalized=!!i,this.metadata=s||null}}function uw(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{Kr(!1)}return Kr(!!t&&(e||["active"]).indexOf(t)!==-1),t}function l5(n,e,t,i,s){const o=e.bucketOnlyServerUrl(),u=ux(e,i,s),h={name:u.fullPath},f=Cd(o,n.host,n._protocol),p="POST",_={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${i.size()}`,"X-Goog-Upload-Header-Content-Type":u.contentType,"Content-Type":"application/json; charset=utf-8"},v=ox(u,t),T=n.maxUploadRetryTime;function S(x){uw(x);let U;try{U=x.getResponseHeader("X-Goog-Upload-URL")}catch{Kr(!1)}return Kr(Ig(U)),U}const N=new Fu(f,p,S,T);return N.urlParams=h,N.headers=_,N.body=v,N.errorHandler=Dd(e),N}function u5(n,e,t,i){const s={"X-Goog-Upload-Command":"query"};function o(p){const _=uw(p,["active","final"]);let v=null;try{v=p.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Kr(!1)}v||Kr(!1);const T=Number(v);return Kr(!isNaN(T)),new Cp(T,i.size(),_==="final")}const u="POST",h=n.maxUploadRetryTime,f=new Fu(t,u,o,h);return f.headers=s,f.errorHandler=Dd(e),f}const SR=256*1024;function c5(n,e,t,i,s,o,u,h){const f=new Cp(0,0);if(u?(f.current=u.current,f.total=u.total):(f.current=0,f.total=i.size()),i.size()!==f.total)throw Sz();const p=f.total-f.current;let _=p;s>0&&(_=Math.min(_,s));const v=f.current,T=v+_;let S="";_===0?S="finalize":p===_?S="upload, finalize":S="upload";const N={"X-Goog-Upload-Command":S,"X-Goog-Upload-Offset":`${f.current}`},x=i.slice(v,T);if(x===null)throw $O();function U(ie,se){const me=uw(ie,["active","final"]),O=f.current+_,A=i.size();let C;return me==="final"?C=lw(e,o)(ie,se):C=null,new Cp(O,A,me==="final",C)}const Z="POST",ee=e.maxUploadRetryTime,Y=new Fu(t,Z,U,ee);return Y.headers=N,Y.body=x.uploadData(),Y.progressCallback=h||null,Y.errorHandler=Dd(n),Y}const Un={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function rv(n){switch(n){case"running":case"pausing":case"canceling":return Un.RUNNING;case"paused":return Un.PAUSED;case"success":return Un.SUCCESS;case"canceled":return Un.CANCELED;case"error":return Un.ERROR;default:return Un.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h5{constructor(e,t,i){if(Pz(e)||t!=null||i!=null)this.next=e,this.error=t??void 0,this.complete=i??void 0;else{const o=e;this.next=o.next,this.error=o.error,this.complete=o.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ll(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}class d5{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=go.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=go.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=go.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,s,o){if(this.sent_)throw ah("cannot .send() more than once");if(Zr(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),o!==void 0)for(const u in o)o.hasOwnProperty(u)&&this.xhr_.setRequestHeader(u,o[u].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ah("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ah("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw ah("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ah("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class f5 extends d5{initXhr(){this.xhr_.responseType="text"}}function Hl(){return new f5}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m5{isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}constructor(e,t,i=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=i,this._mappings=sx(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=s=>{if(this._request=void 0,this._chunkMultiplier=1,s._codeEquals(gt.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const o=this.isExponentialBackoffExpired();if(ZO(s.status,[]))if(o)s=QO();else{this.sleepTime=Math.max(this.sleepTime*2,gz),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=s,this._transition("error")}},this._metadataErrorHandler=s=>{this._request=void 0,s._codeEquals(gt.CANCELED)?this.completeTransitions_():(this._error=s,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((s,o)=>{this._resolve=s,this._reject=o,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,i])=>{switch(this._state){case"running":e(t,i);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,t)=>{const i=l5(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(i,Hl,e,t);this._request=s,s.getPromise().then(o=>{this._request=void 0,this._uploadUrl=o,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,i)=>{const s=u5(this._ref.storage,this._ref._location,e,this._blob),o=this._ref.storage._makeRequest(s,Hl,t,i);this._request=o,o.getPromise().then(u=>{u=u,this._request=void 0,this._updateProgress(u.current),this._needToFetchStatus=!1,u.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=SR*this._chunkMultiplier,t=new Cp(this._transferred,this._blob.size()),i=this._uploadUrl;this._resolveToken((s,o)=>{let u;try{u=c5(this._ref._location,this._ref.storage,i,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(f){this._error=f,this._transition("error");return}const h=this._ref.storage._makeRequest(u,Hl,s,o,!1);this._request=h,h.getPromise().then(f=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(f.current),f.finalized?(this._metadata=f.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){SR*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const i=r5(this._ref.storage,this._ref._location,this._mappings),s=this._ref.storage._makeRequest(i,Hl,e,t);this._request=s,s.getPromise().then(o=>{this._request=void 0,this._metadata=o,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const i=o5(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(i,Hl,e,t);this._request=s,s.getPromise().then(o=>{this._request=void 0,this._metadata=o,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const t=this._state==="paused";this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=WO(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=rv(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,i,s){const o=new h5(t||void 0,i||void 0,s||void 0);return this._addObserver(o),()=>{this._removeObserver(o)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);t!==-1&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(rv(this._state)){case Un.SUCCESS:Ll(this._resolve.bind(null,this.snapshot))();break;case Un.CANCELED:case Un.ERROR:const t=this._reject;Ll(t.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(rv(this._state)){case Un.RUNNING:case Un.PAUSED:e.next&&Ll(e.next.bind(e,this.snapshot))();break;case Un.SUCCESS:e.complete&&Ll(e.complete.bind(e))();break;case Un.CANCELED:case Un.ERROR:e.error&&Ll(e.error.bind(e,this._error))();break;default:e.error&&Ll(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(e,t){this._service=e,t instanceof ti?this._location=t:this._location=ti.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new xo(e,t)}get root(){const e=new ti(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return rx(this._location.path)}get storage(){return this._service}get parent(){const e=$z(this._location.path);if(e===null)return null;const t=new ti(this._location.bucket,e);return new xo(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw Cz(e)}}function p5(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new m5(n,new js(e),t)}function g5(n){n._throwIfRoot("getDownloadURL");const e=s5(n.storage,n._location,sx());return n.storage.makeRequestWithTokens(e,Hl).then(t=>{if(t===null)throw Az();return t})}function _5(n,e){const t=Xz(n._location.path,e),i=new ti(n._location.bucket,t);return new xo(n.storage,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y5(n){return/^[A-Za-z]+:\/\//.test(n)}function v5(n,e){return new xo(n,e)}function cx(n,e){if(n instanceof cw){const t=n;if(t._bucket==null)throw Iz();const i=new xo(t,t._bucket);return e!=null?cx(i,e):i}else return e!==void 0?_5(n,e):n}function E5(n,e){if(e&&y5(e)){if(n instanceof cw)return v5(n,e);throw sE("To use ref(service, url), the first argument must be a Storage instance.")}else return cx(n,e)}function AR(n,e){const t=e==null?void 0:e[YO];return t==null?null:ti.makeFromBucketSpec(t,n)}function T5(n,e,t,i={}){n.host=`${e}:${t}`;const s=Zr(e);s&&(Pp(`https://${n.host}`),Po("Storage",!0)),n._isUsingEmulator=!0,n._protocol=s?"https":"http";const{mockUserToken:o}=i;o&&(n._overrideAuthToken=typeof o=="string"?o:GR(o,n.app.options.projectId))}class cw{constructor(e,t,i,s,o,u=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=s,this._firebaseVersion=o,this._isUsingEmulator=u,this._bucket=null,this._host=KO,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=mz,this._maxUploadRetryTime=pz,this._requests=new Set,s!=null?this._bucket=ti.makeFromBucketSpec(s,this._host):this._bucket=AR(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ti.makeFromBucketSpec(this._url,e):this._bucket=AR(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){IR("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){IR("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(On(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new xo(this,e)}_makeRequest(e,t,i,s,o=!0){if(this._deleted)return new Dz(XO());{const u=Bz(e,this._appId,i,s,t,this._firebaseVersion,o,this._isUsingEmulator);return this._requests.add(u),u.getPromise().then(()=>this._requests.delete(u),()=>this._requests.delete(u)),u}}async makeRequestWithTokens(e,t){const[i,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,s).getPromise()}}const RR="@firebase/storage",CR="0.13.10";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hx="storage";function w5(n,e,t){return n=Ke(n),p5(n,e,t)}function b5(n){return n=Ke(n),g5(n)}function I5(n,e){return n=Ke(n),E5(n,e)}function S5(n=Mp(),e){n=Ke(n),Po("Storage",!1);const i=es(n,hx).getImmediate({identifier:e}),s=qR("storage");return s&&A5(i,...s),i}function A5(n,e,t,i={}){T5(n,e,t,i)}function R5(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),s=n.getProvider("app-check-internal");return new cw(t,i,s,e,aa)}function C5(){wi(new ri(hx,R5,"PUBLIC").setMultipleInstances(!0)),Tn(RR,CR,""),Tn(RR,CR,"esm2017")}C5();const D5={apiKey:"AIzaSyALxbf1D62JQYo8M6FHdluKtU_e1TmottY",authDomain:"chatting-app-f7ebe.firebaseapp.com",projectId:"chatting-app-f7ebe",storageBucket:"chatting-app-f7ebe.firebasestorage.app",messagingSenderId:"881016333499",appId:"1:881016333499:web:b9b2542cdadb7e3b05f59e",databaseURL:"https://chatting-app-f7ebe-default-rtdb.asia-southeast1.firebasedatabase.app"},Bu=eC(D5),vi=GB(Bu,{localCache:uz({tabManager:fz()})}),Ph=_1(Bu);g4(Bu);const Nn=k3(Bu),N5=new Fr,O5=S5(Bu),x5=_1(Bu),DR=()=>Date.now(),P5=n=>{if(!n)return;const e=Gh(x5,`/status/${n.uid}`);qE(e,{state:"online",last_changed:DR()}),BL(e).set({state:"offline",last_changed:DR()})};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function k5(n,e,t,i){function s(o){return o instanceof t?o:new t(function(u){u(o)})}return new(t||(t=Promise))(function(o,u){function h(_){try{p(i.next(_))}catch(v){u(v)}}function f(_){try{p(i.throw(_))}catch(v){u(v)}}function p(_){_.done?o(_.value):s(_.value).then(h,f)}p((i=i.apply(n,[])).next())})}function M5(n,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,s,o,u;return u={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function h(p){return function(_){return f([p,_])}}function f(p){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,s&&(o=p[0]&2?s.return:p[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,p[1])).done)return o;switch(s=0,o&&(p=[p[0]&2,o.value]),p[0]){case 0:case 1:o=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,s=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!o||p[1]>o[0]&&p[1]<o[3])){t.label=p[1];break}if(p[0]===6&&t.label<o[1]){t.label=o[1],o=p;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(p);break}o[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(_){p=[6,_],s=0}finally{i=o=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ql=function(){return Ql=Object.assign||function(e){for(var t,i=1,s=arguments.length;i<s;i++){t=arguments[i];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Ql.apply(this,arguments)},dx=function(n){return{loading:n==null,value:n}},V5=function(){return function(n,e){switch(e.type){case"error":return Ql(Ql({},n),{error:e.error,loading:!1,value:void 0});case"reset":return dx(e.defaultValue);case"value":return Ql(Ql({},n),{error:void 0,loading:!1,value:e.value});default:return n}}},L5=function(n){var e=n?n():void 0,t=De.useReducer(V5(),dx(e)),i=t[0],s=t[1],o=De.useCallback(function(){var f=n?n():void 0;s({type:"reset",defaultValue:f})},[n]),u=De.useCallback(function(f){s({type:"error",error:f})},[]),h=De.useCallback(function(f){s({type:"value",value:f})},[]);return De.useMemo(function(){return{error:i.error,loading:i.loading,reset:o,setError:u,setValue:h,value:i.value}},[i.error,i.loading,o,u,h,i.value])},fx=function(n,e){var t=L5(function(){return n.currentUser}),i=t.error,s=t.loading,o=t.setError,u=t.setValue,h=t.value;return De.useEffect(function(){var f=uD(n,function(p){return k5(void 0,void 0,void 0,function(){var _;return M5(this,function(v){switch(v.label){case 0:return[3,4];case 1:return v.trys.push([1,3,,4]),[4,e.onUserChanged(p)];case 2:return v.sent(),[3,4];case 3:return _=v.sent(),o(_),[3,4];case 4:return u(p),[2]}})})},o);return function(){f()}},[n]),[h,s,i]};const U5=({onSwitch:n})=>{const[e,t]=De.useState(""),[i,s]=De.useState(""),[o,u]=De.useState(!1),h=async p=>{p.preventDefault();try{await v6(Nn,e,i)}catch(_){alert(_.message)}},f=async()=>{try{const _=(await j6(Nn,N5)).user,v=Oo(vi,"users",_.uid);(await iw(v)).exists()||await od(v,{uid:_.uid,email:_.email,displayName:_.displayName||"Anonymous",photoURL:_.photoURL||`https://ui-avatars.com/api/?name=${encodeURIComponent(_.displayName||"User")}`}),console.log("User signed in:",_)}catch(p){console.log("Sign in error:",p),alert(p.message)}};return ae.jsx("div",{className:"signin-container",children:ae.jsxs("div",{className:"signin-box",children:[ae.jsx("h2",{className:"signin-title",children:"Sign In"}),ae.jsxs("form",{onSubmit:h,className:"signin-form",children:[ae.jsx("input",{type:"email",placeholder:"Email",value:e,className:"signin-input",onChange:p=>t(p.target.value),required:!0}),ae.jsx("br",{}),ae.jsx("input",{type:o?"text":"password",placeholder:"Password",value:i,className:"signin-input",onChange:p=>s(p.target.value),required:!0}),ae.jsxs("label",{children:[ae.jsx("input",{type:"checkbox",checked:o,onChange:()=>u(!o)})," Show Password"]}),ae.jsx("br",{}),ae.jsx("button",{type:"submit",className:"signin-button",children:"Sign In"})]}),ae.jsxs("div",{className:"google-section",children:[ae.jsx("p",{className:"or-text",children:"or"}),ae.jsxs("button",{onClick:f,className:"google-button",children:[ae.jsx("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"Google",className:"google-icon"}),"Sign In With GooGle "]})]}),ae.jsxs("p",{className:"switch-auth",children:["Don't have an account? "," ",ae.jsx("button",{onClick:n,className:"switch-link",children:"Sign Up"})]})]})})},mx=6048e5,F5=864e5,pm=43200,NR=1440,OR=Symbol.for("constructDateFrom");function Ii(n,e){return typeof n=="function"?n(e):n&&typeof n=="object"&&OR in n?n[OR](e):n instanceof Date?new n.constructor(e):new Date(e)}function Wt(n,e){return Ii(e||n,n)}function B5(n,e,t){const i=Wt(n,t==null?void 0:t.in);return isNaN(e)?Ii(n,NaN):(i.setDate(i.getDate()+e),i)}let z5={};function Nd(){return z5}function ld(n,e){var h,f,p,_;const t=Nd(),i=(e==null?void 0:e.weekStartsOn)??((f=(h=e==null?void 0:e.locale)==null?void 0:h.options)==null?void 0:f.weekStartsOn)??t.weekStartsOn??((_=(p=t.locale)==null?void 0:p.options)==null?void 0:_.weekStartsOn)??0,s=Wt(n,e==null?void 0:e.in),o=s.getDay(),u=(o<i?7:0)+o-i;return s.setDate(s.getDate()-u),s.setHours(0,0,0,0),s}function Dp(n,e){return ld(n,{...e,weekStartsOn:1})}function px(n,e){const t=Wt(n,e==null?void 0:e.in),i=t.getFullYear(),s=Ii(t,0);s.setFullYear(i+1,0,4),s.setHours(0,0,0,0);const o=Dp(s),u=Ii(t,0);u.setFullYear(i,0,4),u.setHours(0,0,0,0);const h=Dp(u);return t.getTime()>=o.getTime()?i+1:t.getTime()>=h.getTime()?i:i-1}function Np(n){const e=Wt(n),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+n-+t}function Od(n,...e){const t=Ii.bind(null,n||e.find(i=>typeof i=="object"));return e.map(t)}function Op(n,e){const t=Wt(n,e==null?void 0:e.in);return t.setHours(0,0,0,0),t}function q5(n,e,t){const[i,s]=Od(t==null?void 0:t.in,n,e),o=Op(i),u=Op(s),h=+o-Np(o),f=+u-Np(u);return Math.round((h-f)/F5)}function j5(n,e){const t=px(n,e),i=Ii(n,0);return i.setFullYear(t,0,4),i.setHours(0,0,0,0),Dp(i)}function km(n,e){const t=+Wt(n)-+Wt(e);return t<0?-1:t>0?1:t}function hw(n){return Ii(n,Date.now())}function gx(n,e,t){const[i,s]=Od(t==null?void 0:t.in,n,e);return+Op(i)==+Op(s)}function H5(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function G5(n){return!(!H5(n)&&typeof n!="number"||isNaN(+Wt(n)))}function K5(n,e,t){const[i,s]=Od(t==null?void 0:t.in,n,e),o=i.getFullYear()-s.getFullYear(),u=i.getMonth()-s.getMonth();return o*12+u}function Y5(n){return e=>{const i=(n?Math[n]:Math.trunc)(e);return i===0?0:i}}function Q5(n,e){return+Wt(n)-+Wt(e)}function W5(n,e){const t=Wt(n,e==null?void 0:e.in);return t.setHours(23,59,59,999),t}function $5(n,e){const t=Wt(n,e==null?void 0:e.in),i=t.getMonth();return t.setFullYear(t.getFullYear(),i+1,0),t.setHours(23,59,59,999),t}function X5(n,e){const t=Wt(n,e==null?void 0:e.in);return+W5(t,e)==+$5(t,e)}function J5(n,e,t){const[i,s,o]=Od(t==null?void 0:t.in,n,n,e),u=km(s,o),h=Math.abs(K5(s,o));if(h<1)return 0;s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-u*h);let f=km(s,o)===-u;X5(i)&&h===1&&km(i,o)===1&&(f=!1);const p=u*(h-+f);return p===0?0:p}function Z5(n,e,t){const i=Q5(n,e)/1e3;return Y5(t==null?void 0:t.roundingMethod)(i)}function eq(n,e){const t=Wt(n,e==null?void 0:e.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}const tq={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},nq=(n,e,t)=>{let i;const s=tq[n];return typeof s=="string"?i=s:e===1?i=s.one:i=s.other.replace("{{count}}",e.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+i:i+" ago":i};function sv(n){return(e={})=>{const t=e.width?String(e.width):n.defaultWidth;return n.formats[t]||n.formats[n.defaultWidth]}}const iq={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},rq={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},sq={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},aq={date:sv({formats:iq,defaultWidth:"full"}),time:sv({formats:rq,defaultWidth:"full"}),dateTime:sv({formats:sq,defaultWidth:"full"})},oq={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},lq=(n,e,t,i)=>oq[n];function oh(n){return(e,t)=>{const i=t!=null&&t.context?String(t.context):"standalone";let s;if(i==="formatting"&&n.formattingValues){const u=n.defaultFormattingWidth||n.defaultWidth,h=t!=null&&t.width?String(t.width):u;s=n.formattingValues[h]||n.formattingValues[u]}else{const u=n.defaultWidth,h=t!=null&&t.width?String(t.width):n.defaultWidth;s=n.values[h]||n.values[u]}const o=n.argumentCallback?n.argumentCallback(e):e;return s[o]}}const uq={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},cq={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},hq={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},dq={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},fq={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},mq={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},pq=(n,e)=>{const t=Number(n),i=t%100;if(i>20||i<10)switch(i%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},gq={ordinalNumber:pq,era:oh({values:uq,defaultWidth:"wide"}),quarter:oh({values:cq,defaultWidth:"wide",argumentCallback:n=>n-1}),month:oh({values:hq,defaultWidth:"wide"}),day:oh({values:dq,defaultWidth:"wide"}),dayPeriod:oh({values:fq,defaultWidth:"wide",formattingValues:mq,defaultFormattingWidth:"wide"})};function lh(n){return(e,t={})=>{const i=t.width,s=i&&n.matchPatterns[i]||n.matchPatterns[n.defaultMatchWidth],o=e.match(s);if(!o)return null;const u=o[0],h=i&&n.parsePatterns[i]||n.parsePatterns[n.defaultParseWidth],f=Array.isArray(h)?yq(h,v=>v.test(u)):_q(h,v=>v.test(u));let p;p=n.valueCallback?n.valueCallback(f):f,p=t.valueCallback?t.valueCallback(p):p;const _=e.slice(u.length);return{value:p,rest:_}}}function _q(n,e){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&e(n[t]))return t}function yq(n,e){for(let t=0;t<n.length;t++)if(e(n[t]))return t}function vq(n){return(e,t={})=>{const i=e.match(n.matchPattern);if(!i)return null;const s=i[0],o=e.match(n.parsePattern);if(!o)return null;let u=n.valueCallback?n.valueCallback(o[0]):o[0];u=t.valueCallback?t.valueCallback(u):u;const h=e.slice(s.length);return{value:u,rest:h}}}const Eq=/^(\d+)(th|st|nd|rd)?/i,Tq=/\d+/i,wq={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},bq={any:[/^b/i,/^(a|c)/i]},Iq={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Sq={any:[/1/i,/2/i,/3/i,/4/i]},Aq={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Rq={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Cq={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Dq={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Nq={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Oq={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},xq={ordinalNumber:vq({matchPattern:Eq,parsePattern:Tq,valueCallback:n=>parseInt(n,10)}),era:lh({matchPatterns:wq,defaultMatchWidth:"wide",parsePatterns:bq,defaultParseWidth:"any"}),quarter:lh({matchPatterns:Iq,defaultMatchWidth:"wide",parsePatterns:Sq,defaultParseWidth:"any",valueCallback:n=>n+1}),month:lh({matchPatterns:Aq,defaultMatchWidth:"wide",parsePatterns:Rq,defaultParseWidth:"any"}),day:lh({matchPatterns:Cq,defaultMatchWidth:"wide",parsePatterns:Dq,defaultParseWidth:"any"}),dayPeriod:lh({matchPatterns:Nq,defaultMatchWidth:"any",parsePatterns:Oq,defaultParseWidth:"any"})},_x={code:"en-US",formatDistance:nq,formatLong:aq,formatRelative:lq,localize:gq,match:xq,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Pq(n,e){const t=Wt(n,e==null?void 0:e.in);return q5(t,eq(t))+1}function kq(n,e){const t=Wt(n,e==null?void 0:e.in),i=+Dp(t)-+j5(t);return Math.round(i/mx)+1}function yx(n,e){var _,v,T,S;const t=Wt(n,e==null?void 0:e.in),i=t.getFullYear(),s=Nd(),o=(e==null?void 0:e.firstWeekContainsDate)??((v=(_=e==null?void 0:e.locale)==null?void 0:_.options)==null?void 0:v.firstWeekContainsDate)??s.firstWeekContainsDate??((S=(T=s.locale)==null?void 0:T.options)==null?void 0:S.firstWeekContainsDate)??1,u=Ii((e==null?void 0:e.in)||n,0);u.setFullYear(i+1,0,o),u.setHours(0,0,0,0);const h=ld(u,e),f=Ii((e==null?void 0:e.in)||n,0);f.setFullYear(i,0,o),f.setHours(0,0,0,0);const p=ld(f,e);return+t>=+h?i+1:+t>=+p?i:i-1}function Mq(n,e){var h,f,p,_;const t=Nd(),i=(e==null?void 0:e.firstWeekContainsDate)??((f=(h=e==null?void 0:e.locale)==null?void 0:h.options)==null?void 0:f.firstWeekContainsDate)??t.firstWeekContainsDate??((_=(p=t.locale)==null?void 0:p.options)==null?void 0:_.firstWeekContainsDate)??1,s=yx(n,e),o=Ii((e==null?void 0:e.in)||n,0);return o.setFullYear(s,0,i),o.setHours(0,0,0,0),ld(o,e)}function Vq(n,e){const t=Wt(n,e==null?void 0:e.in),i=+ld(t,e)-+Mq(t,e);return Math.round(i/mx)+1}function nt(n,e){const t=n<0?"-":"",i=Math.abs(n).toString().padStart(e,"0");return t+i}const Us={y(n,e){const t=n.getFullYear(),i=t>0?t:1-t;return nt(e==="yy"?i%100:i,e.length)},M(n,e){const t=n.getMonth();return e==="M"?String(t+1):nt(t+1,2)},d(n,e){return nt(n.getDate(),e.length)},a(n,e){const t=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(n,e){return nt(n.getHours()%12||12,e.length)},H(n,e){return nt(n.getHours(),e.length)},m(n,e){return nt(n.getMinutes(),e.length)},s(n,e){return nt(n.getSeconds(),e.length)},S(n,e){const t=e.length,i=n.getMilliseconds(),s=Math.trunc(i*Math.pow(10,t-3));return nt(s,e.length)}},Ul={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},xR={G:function(n,e,t){const i=n.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(i,{width:"abbreviated"});case"GGGGG":return t.era(i,{width:"narrow"});case"GGGG":default:return t.era(i,{width:"wide"})}},y:function(n,e,t){if(e==="yo"){const i=n.getFullYear(),s=i>0?i:1-i;return t.ordinalNumber(s,{unit:"year"})}return Us.y(n,e)},Y:function(n,e,t,i){const s=yx(n,i),o=s>0?s:1-s;if(e==="YY"){const u=o%100;return nt(u,2)}return e==="Yo"?t.ordinalNumber(o,{unit:"year"}):nt(o,e.length)},R:function(n,e){const t=px(n);return nt(t,e.length)},u:function(n,e){const t=n.getFullYear();return nt(t,e.length)},Q:function(n,e,t){const i=Math.ceil((n.getMonth()+1)/3);switch(e){case"Q":return String(i);case"QQ":return nt(i,2);case"Qo":return t.ordinalNumber(i,{unit:"quarter"});case"QQQ":return t.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(i,{width:"wide",context:"formatting"})}},q:function(n,e,t){const i=Math.ceil((n.getMonth()+1)/3);switch(e){case"q":return String(i);case"qq":return nt(i,2);case"qo":return t.ordinalNumber(i,{unit:"quarter"});case"qqq":return t.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(i,{width:"wide",context:"standalone"})}},M:function(n,e,t){const i=n.getMonth();switch(e){case"M":case"MM":return Us.M(n,e);case"Mo":return t.ordinalNumber(i+1,{unit:"month"});case"MMM":return t.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(i,{width:"wide",context:"formatting"})}},L:function(n,e,t){const i=n.getMonth();switch(e){case"L":return String(i+1);case"LL":return nt(i+1,2);case"Lo":return t.ordinalNumber(i+1,{unit:"month"});case"LLL":return t.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(i,{width:"wide",context:"standalone"})}},w:function(n,e,t,i){const s=Vq(n,i);return e==="wo"?t.ordinalNumber(s,{unit:"week"}):nt(s,e.length)},I:function(n,e,t){const i=kq(n);return e==="Io"?t.ordinalNumber(i,{unit:"week"}):nt(i,e.length)},d:function(n,e,t){return e==="do"?t.ordinalNumber(n.getDate(),{unit:"date"}):Us.d(n,e)},D:function(n,e,t){const i=Pq(n);return e==="Do"?t.ordinalNumber(i,{unit:"dayOfYear"}):nt(i,e.length)},E:function(n,e,t){const i=n.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(i,{width:"short",context:"formatting"});case"EEEE":default:return t.day(i,{width:"wide",context:"formatting"})}},e:function(n,e,t,i){const s=n.getDay(),o=(s-i.weekStartsOn+8)%7||7;switch(e){case"e":return String(o);case"ee":return nt(o,2);case"eo":return t.ordinalNumber(o,{unit:"day"});case"eee":return t.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(s,{width:"short",context:"formatting"});case"eeee":default:return t.day(s,{width:"wide",context:"formatting"})}},c:function(n,e,t,i){const s=n.getDay(),o=(s-i.weekStartsOn+8)%7||7;switch(e){case"c":return String(o);case"cc":return nt(o,e.length);case"co":return t.ordinalNumber(o,{unit:"day"});case"ccc":return t.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(s,{width:"narrow",context:"standalone"});case"cccccc":return t.day(s,{width:"short",context:"standalone"});case"cccc":default:return t.day(s,{width:"wide",context:"standalone"})}},i:function(n,e,t){const i=n.getDay(),s=i===0?7:i;switch(e){case"i":return String(s);case"ii":return nt(s,e.length);case"io":return t.ordinalNumber(s,{unit:"day"});case"iii":return t.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(i,{width:"short",context:"formatting"});case"iiii":default:return t.day(i,{width:"wide",context:"formatting"})}},a:function(n,e,t){const s=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(n,e,t){const i=n.getHours();let s;switch(i===12?s=Ul.noon:i===0?s=Ul.midnight:s=i/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(n,e,t){const i=n.getHours();let s;switch(i>=17?s=Ul.evening:i>=12?s=Ul.afternoon:i>=4?s=Ul.morning:s=Ul.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(n,e,t){if(e==="ho"){let i=n.getHours()%12;return i===0&&(i=12),t.ordinalNumber(i,{unit:"hour"})}return Us.h(n,e)},H:function(n,e,t){return e==="Ho"?t.ordinalNumber(n.getHours(),{unit:"hour"}):Us.H(n,e)},K:function(n,e,t){const i=n.getHours()%12;return e==="Ko"?t.ordinalNumber(i,{unit:"hour"}):nt(i,e.length)},k:function(n,e,t){let i=n.getHours();return i===0&&(i=24),e==="ko"?t.ordinalNumber(i,{unit:"hour"}):nt(i,e.length)},m:function(n,e,t){return e==="mo"?t.ordinalNumber(n.getMinutes(),{unit:"minute"}):Us.m(n,e)},s:function(n,e,t){return e==="so"?t.ordinalNumber(n.getSeconds(),{unit:"second"}):Us.s(n,e)},S:function(n,e){return Us.S(n,e)},X:function(n,e,t){const i=n.getTimezoneOffset();if(i===0)return"Z";switch(e){case"X":return kR(i);case"XXXX":case"XX":return no(i);case"XXXXX":case"XXX":default:return no(i,":")}},x:function(n,e,t){const i=n.getTimezoneOffset();switch(e){case"x":return kR(i);case"xxxx":case"xx":return no(i);case"xxxxx":case"xxx":default:return no(i,":")}},O:function(n,e,t){const i=n.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+PR(i,":");case"OOOO":default:return"GMT"+no(i,":")}},z:function(n,e,t){const i=n.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+PR(i,":");case"zzzz":default:return"GMT"+no(i,":")}},t:function(n,e,t){const i=Math.trunc(+n/1e3);return nt(i,e.length)},T:function(n,e,t){return nt(+n,e.length)}};function PR(n,e=""){const t=n>0?"-":"+",i=Math.abs(n),s=Math.trunc(i/60),o=i%60;return o===0?t+String(s):t+String(s)+e+nt(o,2)}function kR(n,e){return n%60===0?(n>0?"-":"+")+nt(Math.abs(n)/60,2):no(n,e)}function no(n,e=""){const t=n>0?"-":"+",i=Math.abs(n),s=nt(Math.trunc(i/60),2),o=nt(i%60,2);return t+s+e+o}const MR=(n,e)=>{switch(n){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},vx=(n,e)=>{switch(n){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},Lq=(n,e)=>{const t=n.match(/(P+)(p+)?/)||[],i=t[1],s=t[2];if(!s)return MR(n,e);let o;switch(i){case"P":o=e.dateTime({width:"short"});break;case"PP":o=e.dateTime({width:"medium"});break;case"PPP":o=e.dateTime({width:"long"});break;case"PPPP":default:o=e.dateTime({width:"full"});break}return o.replace("{{date}}",MR(i,e)).replace("{{time}}",vx(s,e))},Uq={p:vx,P:Lq},Fq=/^D+$/,Bq=/^Y+$/,zq=["D","DD","YY","YYYY"];function qq(n){return Fq.test(n)}function jq(n){return Bq.test(n)}function Hq(n,e,t){const i=Gq(n,e,t);if(console.warn(i),zq.includes(n))throw new RangeError(i)}function Gq(n,e,t){const i=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${e}\`) for formatting ${i} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Kq=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Yq=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Qq=/^'([^]*?)'?$/,Wq=/''/g,$q=/[a-zA-Z]/;function av(n,e,t){var _,v,T,S;const i=Nd(),s=i.locale??_x,o=i.firstWeekContainsDate??((v=(_=i.locale)==null?void 0:_.options)==null?void 0:v.firstWeekContainsDate)??1,u=i.weekStartsOn??((S=(T=i.locale)==null?void 0:T.options)==null?void 0:S.weekStartsOn)??0,h=Wt(n,t==null?void 0:t.in);if(!G5(h))throw new RangeError("Invalid time value");let f=e.match(Yq).map(N=>{const x=N[0];if(x==="p"||x==="P"){const U=Uq[x];return U(N,s.formatLong)}return N}).join("").match(Kq).map(N=>{if(N==="''")return{isToken:!1,value:"'"};const x=N[0];if(x==="'")return{isToken:!1,value:Xq(N)};if(xR[x])return{isToken:!0,value:N};if(x.match($q))throw new RangeError("Format string contains an unescaped latin alphabet character `"+x+"`");return{isToken:!1,value:N}});s.localize.preprocessor&&(f=s.localize.preprocessor(h,f));const p={firstWeekContainsDate:o,weekStartsOn:u,locale:s};return f.map(N=>{if(!N.isToken)return N.value;const x=N.value;(jq(x)||qq(x))&&Hq(x,e,String(n));const U=xR[x[0]];return U(h,x,s.localize,p)}).join("")}function Xq(n){const e=n.match(Qq);return e?e[1].replace(Wq,"'"):n}function Jq(n,e,t){const i=Nd(),s=(t==null?void 0:t.locale)??i.locale??_x,o=2520,u=km(n,e);if(isNaN(u))throw new RangeError("Invalid time value");const h=Object.assign({},t,{addSuffix:t==null?void 0:t.addSuffix,comparison:u}),[f,p]=Od(t==null?void 0:t.in,...u>0?[e,n]:[n,e]),_=Z5(p,f),v=(Np(p)-Np(f))/1e3,T=Math.round((_-v)/60);let S;if(T<2)return t!=null&&t.includeSeconds?_<5?s.formatDistance("lessThanXSeconds",5,h):_<10?s.formatDistance("lessThanXSeconds",10,h):_<20?s.formatDistance("lessThanXSeconds",20,h):_<40?s.formatDistance("halfAMinute",0,h):_<60?s.formatDistance("lessThanXMinutes",1,h):s.formatDistance("xMinutes",1,h):T===0?s.formatDistance("lessThanXMinutes",1,h):s.formatDistance("xMinutes",T,h);if(T<45)return s.formatDistance("xMinutes",T,h);if(T<90)return s.formatDistance("aboutXHours",1,h);if(T<NR){const N=Math.round(T/60);return s.formatDistance("aboutXHours",N,h)}else{if(T<o)return s.formatDistance("xDays",1,h);if(T<pm){const N=Math.round(T/NR);return s.formatDistance("xDays",N,h)}else if(T<pm*2)return S=Math.round(T/pm),s.formatDistance("aboutXMonths",S,h)}if(S=J5(p,f),S<12){const N=Math.round(T/pm);return s.formatDistance("xMonths",N,h)}else{const N=S%12,x=Math.trunc(S/12);return N<3?s.formatDistance("aboutXYears",x,h):N<9?s.formatDistance("overXYears",x,h):s.formatDistance("almostXYears",x+1,h)}}function Zq(n,e){return Jq(n,hw(n),e)}function ej(n,e){return gx(Ii(n,n),hw(n))}function tj(n,e,t){return B5(n,-1,t)}function nj(n,e){return gx(Ii(n,n),tj(hw(n)))}function ij(n){return n?ej(n)?"Today at "+av(n,"hh:mm a"):nj(n)?"Yesterday at "+av(n,"hh:mm a"):av(n,"dd MMM yyyy, hh:mm a"):""}const rj=({selectedUser:n})=>{var U;const[e,t]=De.useState([]),[i,s]=De.useState(""),[o,u]=De.useState(!1),[h,f]=De.useState(""),p=De.useRef(null),_=(U=Nn.currentUser)==null?void 0:U.uid,v=n==null?void 0:n.uid,T=[_,v].sort().join("_");De.useEffect(()=>{if(!T||!_||!v)return;const Z=tz(Yl(vi,"chats",T,"messages"),BO("createdAt")),ee=Pm(Z,async Y=>{const ie=Y.docs.map(O=>({id:O.id,...O.data()}));t(ie);const me=ie.filter(O=>O.isRead===!1&&O.uid!==_).map(O=>od(Oo(vi,"chats",T,"messages",O.id),{isRead:!0},{merge:!0}));await Promise.all(me)});return()=>ee()},[T,_,v]),De.useEffect(()=>{var Z;(Z=p.current)==null||Z.scrollIntoView({behavior:"smooth"})},[e]);const S=async Z=>{var Y;if(Z.preventDefault(),i.trim()==="")return;const ee=Oo(vi,"chats",T);console.log("sending msg, chatId:",T);try{(await iw(ee)).exists()||(console.log("Creating new chat doc",T),await od(ee,{participants:[_,v],createdAt:wR()})),console.log("Current user ID:",(Y=Nn.currentUser)==null?void 0:Y.uid),console.log("Adding message in:",T),await oz(Yl(vi,"chats",T,"messages"),{text:i,uid:Nn.currentUser.uid,displayName:Nn.currentUser.displayName||"You",photoURL:Nn.currentUser.photoURL||"",createdAt:wR(),isRead:!1}),console.log("Message sent ✅")}catch(ie){console.error("Firestore error during sendMessage:",ie),alert("Error sending message: "+ie.message)}s("")},N=De.useRef(),x=Z=>{s(Z.target.value);const ee=Gh(Ph,`/typing/${v}`);qE(ee,{uid:_,displayName:Nn.currentUser.displayName||"You"}),clearTimeout(N.current),N.current=setTimeout(()=>{zL(ee)},2e3)};return De.useEffect(()=>{if(!v)return;const Z=Gh(Ph,`/typing/${_}`),ee=g1(Z,Y=>{const ie=Y.val();ie?(f(ie.displayName),u(!0)):u(!1)});return()=>ee()},[_,v]),!_||!v?ae.jsx("div",{className:"chat-container",children:ae.jsx("div",{className:"chat-header",children:ae.jsx("h2",{className:"chat-header-name",children:"No user selected"})})}):ae.jsxs("div",{className:"chat-container",children:[ae.jsxs("div",{className:"chat-header",children:[ae.jsx("h2",{className:"chat-header-name",children:(n==null?void 0:n.name)||(n==null?void 0:n.displayName)||"User"}),o&&ae.jsxs("div",{className:"typing-status",children:[h," is typing..."]})]}),ae.jsxs("div",{className:"messages-container",children:[e.map(Z=>{var Y,ie,se;const ee=Z.uid===_;return(ie=(Y=Z.createdAt)==null?void 0:Y.toDate)==null||ie.call(Y).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"}),ae.jsxs("div",{className:`message ${ee?"sent":"received"}`,children:[ae.jsx("img",{className:"message-avatar",src:Z.photoURL||`https://ui-avatars.com/api/?name=${Z.displayName}&background=random&bold=true`,alt:"User",width:"30"}),ae.jsxs("div",{className:"message-content",children:[ae.jsx("p",{children:Z.text}),ae.jsxs("div",{className:"message-meta",children:[((se=Z.createdAt)==null?void 0:se.toDate)&&ae.jsxs("small",{style:{color:"gray",fontSize:"0.75rem"},children:["Sent: ",ij(Z.createdAt.toDate())]}),Z.isRead&&ae.jsx("small",{style:{color:"green",fontSize:"0.75rem",marginLeft:"0.5rem"},children:"✓ Read"})]})]})]},Z.id)}),ae.jsx("div",{ref:p})]}),ae.jsxs("form",{className:"chat-form",onSubmit:S,children:[ae.jsx("input",{value:i,className:"chat-input",onChange:x,placeholder:"Type a message...."}),ae.jsx("button",{className:"chat-send-btn",type:"submit",children:"Send"})]})]})},sj=({onSwitch:n})=>{const[e,t]=De.useState(""),[i,s]=De.useState(""),[o,u]=De.useState(""),[h,f]=De.useState(!1),p=async _=>{_.preventDefault();try{const T=(await y6(Nn,i,o)).user;await lD(T,{displayName:e,photoURL:`https://ui-avatars.com/api/?name=${encodeURIComponent(e)}`}),await od(Oo(vi,"users",T.uid),{uid:T.uid,email:T.email,displayName:e,photoURL:`https://ui-avatars.com/api/?name=${encodeURIComponent(e)}`}),alert("Account created successfully")}catch(v){alert(v.message)}};return ae.jsx("div",{className:"signup-container",children:ae.jsxs("div",{className:"signup-box",children:[ae.jsx("h2",{className:"signup-title",children:"Sign Up"}),ae.jsxs("form",{onSubmit:p,className:"signup-form",children:[ae.jsx("input",{type:"text",placeholder:"Full Name",value:e,className:"signup-input",onChange:_=>t(_.target.value),required:!0}),ae.jsx("input",{type:"email",placeholder:"Email",value:i,className:"signup-input",onChange:_=>s(_.target.value),required:!0}),ae.jsx("input",{type:h?"text":"password",placeholder:"password",value:o,className:"signup-input",onChange:_=>u(_.target.value),required:!0}),ae.jsxs("label",{children:[ae.jsx("input",{type:"checkbox",checked:h,onChange:()=>f(!h)})," Show Password"]}),ae.jsx("br",{}),ae.jsx("button",{type:"submit",className:"signup-button",children:"Sign Up"})]}),ae.jsxs("p",{className:"switch-auth",children:["Already have an account? "," ",ae.jsx("button",{onClick:n,className:"switch-link",children:"Sign In"})]})]})})},aj=({isOpen:n,onClose:e})=>{const[t,i]=fx(Nn),[s,o]=De.useState(""),[u,h]=De.useState(null),[f,p]=De.useState(""),[_,v]=De.useState(!1),[T,S]=De.useState("");if(De.useEffect(()=>{t&&(o(t.displayName||""),h(null),S(t.photoURL||""))},[t,n]),i||!t||!n)return null;const N=async x=>{x.preventDefault(),v(!0),console.log("Current user:",Nn.currentUser);try{let U=t.photoURL;if(u){const Z=I5(O5,`profileImages/${t.uid}_${Date.now()}`),ee=w5(Z,u);await new Promise((Y,ie)=>{ee.on("state_changed",null,se=>ie(se),()=>Y())}),U=await b5(Z)}await lD(Nn.currentUser,{displayName:s,photoURL:U}),await t.reload(),await az(Oo(vi,"users",t.uid),{displayName:s,photoURL:U,updatedAt:new Date}),p("Profile updated successfully"),setTimeout(()=>{p(""),e()},3e3)}catch(U){console.log(U),p("Failed to update profile")}finally{v(!1)}};return ae.jsx("div",{children:ae.jsx("div",{className:"modal-overlay",children:ae.jsxs("div",{className:"modal-content",children:[ae.jsx("h3",{className:"modal-heading",children:"Update Profile"}),ae.jsxs("form",{onSubmit:N,className:"modal-form",children:[ae.jsx("input",{className:"modal-input",type:"text",placeholder:"Display Name",value:s,onChange:x=>o(x.target.value)}),ae.jsx("input",{className:"modal-input",type:"file",accept:"image/*",placeholder:"Photo URL",onChange:x=>{const U=x.target.files[0];h(U),U&&S(URL.createObjectURL(U))}}),T&&ae.jsx("div",{className:"image-preview",children:ae.jsx("img",{src:T,alt:"Preview"})}),ae.jsxs("div",{className:"modal-actions",children:[ae.jsx("button",{type:"submit",className:"update-btn",disabled:_,children:_?ae.jsx("span",{className:"loader"}):"Update"}),ae.jsx("button",{onClick:e,className:"cancel-btn",type:"button",children:"Cancel"})]})]}),f&&ae.jsx("p",{className:"status-message",children:f})]})})})},Ex=De.createContext(),oj=({children:n})=>{const[e,t]=De.useState(null);return De.useEffect(()=>{const i=uD(Nn,s=>{t(s)});return()=>{i()}},[]),ae.jsx(Ex.Provider,{value:{currentUser:e},children:n})},lj=({onSelectUser:n})=>{const[e,t]=De.useState([]),[i,s]=De.useState([]),[o,u]=De.useState(null),[h,f]=De.useState(""),[p,_]=De.useState({}),{currentUser:v}=De.useContext(Ex),T=x=>x?Zq(new Date(x),{addSuffix:!0}):"";De.useEffect(()=>{if(!(v!=null&&v.uid))return;const x=Pm(Yl(vi,"users"),async U=>{const Z=await Promise.all(U.docs.filter(ee=>ee.data().uid!==v.uid).map(async ee=>{const Y=ee.data(),se=(await qL(Gh(Ph,`/status/${Y.uid}`))).val();return{...Y,online:(se==null?void 0:se.state)==="online",last_changed:se==null?void 0:se.last_changed,photoURL:Y.photoURL?`${Y.photoURL}?t=${Date.now()}`:`https://ui-avatars.com/api/?name=${encodeURIComponent(Y.displayName||Y.name||"User")}`}}));t(Z)});return()=>x()},[v]),De.useEffect(()=>{if(!(v!=null&&v.uid))return;const x=[];return(async()=>{(await sz(Yl(vi,"users"))).docs.filter(ee=>ee.data().uid!==v.uid).forEach(ee=>{const Y=ee.data(),ie=Gh(Ph,`/typing/${v.uid}/${Y.uid}`),se=me=>{_(O=>({...O,[Y.uid]:me.exists()}))};g1(ie,se),x.push(()=>Ph.off(ie,"value",se))})})(),()=>x.forEach(Z=>Z())},[v]),De.useEffect(()=>{if(!(v!=null&&v.uid))return;const x=SS(Yl(vi,"chats"),nz("participants","array-contains",v.uid)),U=Pm(x,Z=>{const ee=[];return Z.docs.forEach(Y=>{const ie=Y.id,se=SS(Yl(vi,"chats",ie,"messages"),BO("createdAt")),me=Pm(se,O=>{const A=O.docs.map(C=>({...C.data(),id:C.id,chatId:ie}));s(C=>[...C.filter(V=>V.chatId!==ie),...A])});ee.push(me)}),()=>ee.forEach(Y=>Y())});return()=>U()},[v]);const S=async x=>{if(!(v!=null&&v.uid)||!(x!=null&&x.uid))return;const U=v.uid,Z=x.uid,ee=[U,Z].sort().join("_"),Y=Oo(vi,"chats",ee);(await iw(Y)).exists()||await od(Y,{participants:[U,Z],createdAt:new Date}),n(x),u(x.uid)},N=x=>{const U=[v.uid,x].sort().join("_");return i.filter(Z=>Z.chatId===U&&Z.uid===x&&Z.isRead===!1).length};return ae.jsxs("div",{className:"chat-list",children:[ae.jsx("h3",{className:"chat-list-heading",children:"Chats"}),ae.jsx("input",{type:"text",className:"chat-search",placeholder:"Search users...",value:h,onChange:x=>f(x.target.value)}),e.filter(x=>(x.displayName||x.name||"").toLowerCase().includes(h.toLowerCase())).map(x=>ae.jsxs("div",{className:`chat-list-item ${x.uid===o?"active-user":""}`,onClick:()=>S(x),children:[ae.jsxs("div",{className:"avatar-container",children:[ae.jsx("img",{src:x.photoURL,alt:"User",className:"user-avatar",width:"30"}),ae.jsx("span",{className:x.online?"online-dot":"offline-dot"})]}),ae.jsx("span",{className:"chat-user-name",children:x.displayName||x.name||x.email||x.uid.slice(0,7)}),!x.online&&x.last_changed&&ae.jsxs("div",{className:"last-seen",children:["Last seen: ",T(x.last_changed)]}),N(x.uid)>0&&ae.jsx("span",{className:"unread-badge",children:N(x.uid)}),x.isTyping&&ae.jsx("div",{className:"typing-indicator",children:"Typing..."})]},x.uid))]})};function uj(){const[n,e]=De.useState(null),[t]=fx(Nn),[i,s]=De.useState(!1),[o,u]=De.useState(!1),[h,f]=De.useState(null),p=()=>s(_=>!_);return De.useEffect(()=>{t&&P5(t)},[t]),t?ae.jsxs("div",{className:"App",children:[ae.jsx("button",{onClick:()=>b6(Nn),className:"btn-signout",children:"Sign Out"}),ae.jsx("button",{className:"open-modal-btn",onClick:()=>u(!0),children:"Edit Profile"}),o&&ae.jsx(aj,{isOpen:o,onClose:()=>u(!1)}),ae.jsxs("div",{className:"chat-wrapper",children:[ae.jsx(lj,{onSelectUser:_=>{f(_),e(_.uid)}}),ae.jsx(rj,{selectedUid:n,selectedUser:h})]})]}):ae.jsx("div",{className:"App",children:i?ae.jsx(sj,{onSwitch:p}):ae.jsx(U5,{onSwitch:p})})}ek.createRoot(document.getElementById("root")).render(ae.jsx(oj,{children:ae.jsx(uj,{})}));
